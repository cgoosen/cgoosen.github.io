---
layout: post
status: publish
published: true
title: Getting started with AAD conditional access - Location based access rules
author:
  display_name: Chris
  login: chris
  email: chris@cgoosen.com
  url: http://www.cgoosen.com
author_login: chris
author_email: chris@cgoosen.com
author_url: http://www.cgoosen.com
wordpress_id: 2169
wordpress_url: http://www.cgoosen.com/?p=2169
date: '2016-11-30 18:00:03 +0000'
date_gmt: '2016-12-01 00:00:03 +0000'
categories:
- Cloud
- Office 365
- Azure AD
tags: []
comments: []
---
<p>Azure Active Directory (AAD) conditional access is something I&rsquo;ve been wanting to post about for a while now. A scenario I come across fairly often is the desire to prevent access or add an additional layer of security to certain Office 365 workloads when the user is connecting from a remote, non-corporate location. In the past, this could be achieved by making use of claims rules and Active Directory Federation Services (AD FS) which meant that it wasn&rsquo;t possible for those organizations not making use of federated identities with Office 365.</p>
<p>AAD conditional access solves this problem and makes it really simple to apply access policies to AAD connected applications. Conditional access does require an AAD premium license (P1). In this post we&rsquo;ll cover a simple location based scenario where we prevent users from accessing Outlook on the web (OWA) from outside of the organization&rsquo;s network. In order to configure conditional access you will require:</p>
<ul>
<ul>
<li>Azure Active Directory premium licensing</li>
<li>Access to the Azure management portal (classic portal)</li>
</ul>
</ul>
<p>Conditional access policies are configured via the classic Azure management portal (http://manage.windowsazure.com). Locate &ldquo;Active Directory&rdquo; on the left-hand side, select your Office 365 directory and click the &ldquo;Applications&rdquo; option.</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2016/12/Screen-Shot-2016-11-30-at-3.10.34-PM.png"><img class="aligncenter size-medium wp-image-2170" src="http://www.cgoosen.com/wp-content/uploads/2016/12/Screen-Shot-2016-11-30-at-3.10.34-PM-300x178.png" alt="screen-shot-2016-11-30-at-3-10-34-pm" width="300" height="178" /></a></p>
<p>Next, select the &ldquo;Office 365 Exchange Online&rdquo; application and turn access rules &ldquo;On&rdquo; under the &ldquo;Multi-factor authentication and location based access rules&rdquo; section. You have the option of applying your rules to all users or select groups. You then select the &ldquo;Block access when not at work&rdquo; option. You also have to option to enforce MFA for an application which is useful if you would like to enable MFA only for specific applications or you could require MFA only when users are accessing the application from outside the corporate network.</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2016/12/Screen-Shot-2016-11-30-at-3.19.39-PM.png"><img class="aligncenter size-medium wp-image-2171" src="http://www.cgoosen.com/wp-content/uploads/2016/12/Screen-Shot-2016-11-30-at-3.19.39-PM-300x284.png" alt="screen-shot-2016-11-30-at-3-19-39-pm" width="300" height="284" /></a></p>
<p>It is important to ensure that you define your corporate network ranges by clicking link. All connections from locations outside the definted network ranges will be treated as remote.</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2016/12/Screen-Shot-2016-11-30-at-3.16.18-PM.png"><img class="aligncenter size-medium wp-image-2172" src="http://www.cgoosen.com/wp-content/uploads/2016/12/Screen-Shot-2016-11-30-at-3.16.18-PM-276x300.png" alt="screen-shot-2016-11-30-at-3-16-18-pm" width="276" height="300" /></a>Once configured, you will notice that users are still able to access the Office 365 portal however, once they click the mail option in the app launcher they will no longer be able to access Outlook on the web unless they are connecting from a approved location.</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2016/12/Screen-Shot-2016-11-30-at-3.22.49-PM-1.png"><img class="aligncenter size-medium wp-image-2173" src="http://www.cgoosen.com/wp-content/uploads/2016/12/Screen-Shot-2016-11-30-at-3.22.49-PM-1-300x156.png" alt="screen-shot-2016-11-30-at-3-22-49-pm" width="300" height="156" /></a></p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2016/12/Screen-Shot-2016-11-30-at-3.23.23-PM.png"><img class="aligncenter size-medium wp-image-2174" src="http://www.cgoosen.com/wp-content/uploads/2016/12/Screen-Shot-2016-11-30-at-3.23.23-PM-300x184.png" alt="screen-shot-2016-11-30-at-3-23-23-pm" width="300" height="184" /></a></p>
<p>This is a very simple example of how to use location based access rules. It is also possible to configure device based access policies which provide an incredible amount of control over which devices can access your applications. I&rsquo;ll cover device based access policies in a future post.</p>
<p>&nbsp;</p>
