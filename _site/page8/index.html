<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title> Chris&#39;s Blog &mdash; It&#39;s called thinking...  go with it! </title>
    <meta property="og:title" content=" Chris&#39;s Blog &mdash; It&#39;s called thinking...  go with it! " />
    <meta name="twitter:title" content=" Chris&#39;s Blog &mdash; It&#39;s called thinking...  go with it! " />

    <meta name="description" content="">
    <meta name="description" property="og:description" content="" />
    <meta name="twitter:description" content="" />

    <meta name="twitter:card" content="summary_large_image" />
    
    <meta name="twitter:site" content="@chrisgoosen" />
    
    <meta property="og:url" content="http://172.16.7.177:4000/page8/" />

    <meta property="og:image" content="" />
    <meta name="twitter:image" content="" />

    <meta name="author" content="Chris's Blog" />

    <meta name="copyright" content="Copyright by Chris's Blog. All Rights Reserved." />

    <style>
        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 300;
            src: local('Roboto Light'), local('Roboto-Light'), url(https://fonts.gstatic.com/s/roboto/v15/Hgo13k-tfSpn0qi1SFdUfVtXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 400;
            src: local('Roboto'), local('Roboto-Regular'), url(https://fonts.gstatic.com/s/roboto/v15/CWB0XYA8bzo0kSThX0UTuA.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 700;
            src: local('Roboto Bold'), local('Roboto-Bold'), url(https://fonts.gstatic.com/s/roboto/v15/d-6IYplOFocCacKzxwXSOFtXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 900;
            src: local('Roboto Black'), local('Roboto-Black'), url(https://fonts.gstatic.com/s/roboto/v15/mnpfi9pxYH-Go5UiibESIltXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 300;
            src: local('Roboto Light Italic'), local('Roboto-LightItalic'), url(https://fonts.gstatic.com/s/roboto/v15/7m8l7TlFO-S3VkhHuR0at44P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 400;
            src: local('Roboto Italic'), local('Roboto-Italic'), url(https://fonts.gstatic.com/s/roboto/v15/vPcynSL0qHq_6dX7lKVByfesZW2xOQ-xsNqO47m55DA.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 700;
            src: local('Roboto Bold Italic'), local('Roboto-BoldItalic'), url(https://fonts.gstatic.com/s/roboto/v15/t6Nd4cfPRhZP44Q5QAjcC44P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 900;
            src: local('Roboto Black Italic'), local('Roboto-BlackItalic'), url(https://fonts.gstatic.com/s/roboto/v15/bmC0pGMXrhphrZJmniIZpY4P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }
    </style>
    
    <link href="/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    
    <link rel="stylesheet" href="http://172.16.7.177:4000/assets/css/main.css">

    <link rel="canonical" href="http://172.16.7.177:4000/page8/">

    <link rel="alternate" type="application/rss+xml" title="" href="http://172.16.7.177:4000/feed.xml">
</head>

    <body>
        <div class="wrapper">
            <aside class="user-profile fixed" role="complementary">
    <div class="burger">
        <input class="trigger hidden" id="toggleBurger" type="checkbox" />
        <label for="toggleBurger">
            <span>Navigation</span>
        </label>
    </div>

    <div class="compact-header">
        <a class="avatar" href="http://172.16.7.177:4000"><img alt="Avatar" src="/assets/img/headshot.jpg" /></a>
        <div class="my-info">
            <strong class="my-name">Chris's Blog</strong>
            <span class="my-job-title">It's called thinking...  go with it!</span>
        </div>
    </div>

    
        
        <div class="mainmenu">
            <a href="http://172.16.7.177:4000" >Home</a>
            
                
            
                
            
                
                    <a href="http://172.16.7.177:4000/contact/" >Contact</a>
                
            
                
                    <a href="http://172.16.7.177:4000/about/" >About</a>
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
        </div>
        
    
    
    <div>
    	<img src="/assets/img/mvp.png" style="width:181px;height:74px;">
    </div>

    <p class="about-me"> </p>
    
    <ul class="socials">
        <li><a href="https://twitter.com/chrisgoosen" target="_blank"><svg title="twitter" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li><li><a href="https://www.linkedin.com/in/ctgoosen/" target="_blank"><svg title="linkedin" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#linkedin-icon"></use></svg></a></li><li><a href="https://github.com/cgoosen" target="_blank"><svg title="github" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#github-icon"></use></svg></a></li>

        
            <li><a href="/contact" target="_blank"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#email-icon"></use></svg></a></li>
        

        
         <li><a href="http://feeds.cgoosen.com/cgoosen"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#rss-icon"></use></svg></a></li>
        
    </ul>
</aside>


            <main class="the-content" role="main">
                <div class="search" role="search">
    <div>
        <div class="show-results-count">0 Results</div>
        <div class="search-holder">
            <input type="text" id="search-input" placeholder="search for..." />
        </div>
    </div>
    <ul id="results-container" class="results-container"></ul>
</div>


                
<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-03-20T03:36:09-05:00" itemprop="datePublished">20 Mar, 2014</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2014/03/step-away-from-that-exchange-2013-sp1-update">Step away from that Exchange 2013 SP1 update!</a></h2>
    </header>

    <div class="post-content">
        <p>The Exchange Team <a href="http://blogs.technet.com/b/exchange/archive/2014/02/25/exchange-server-2013-service-pack-1-available.aspx" target="_blank">announced the release of Exchange 2013 SP1</a> in late Feb and while SP1 introduced some great new features and functionality like Windows Server 2012 R2 support, it didn&rsquo;t take long for customers to start reporting transport issues after the update. To their credit, Microsoft responded quickly to address these issues and released <a href="http://support.microsoft.com/kb/2938053" target="_blank">KB 2938053</a>. The issue affected environments that make use of third-party or custom-developed transport agents, typically in the form of anti-virus or disclaimer software.</p>
<p>All good then? Well, yes and no.. If you were affected by the issue you can now <a href="http://www.microsoft.com/en-us/download/details.aspx?id=42065" target="_blank">download the relevant PowerShell script</a> that corrects a formatting error in the configuration files that govern the transport extensibility built into Exchange Server 2013 and issue will be resolved. If you are about to update your Exchange 2013 environment to SP1 you should note that this fix has not been included in the SP1 download and a permanent fix for this will only be delivered in Exchange Server 2013 CU5. There also doesn&rsquo;t appear to be any warning about this issue on the any of the SP1 pages on the Microsoft website so if you make use of any third-party software or custom-developed transport agents <u>you will break</u> your Exchange environment if you apple the SP1 update. </p>
<p>It is important to be aware of any applications running on your Exchange servers that may be making use of transport extensibility and as always I recommend thorough planning and testing before deploying SP1 in your production environment. </p>
<p>For more information about the issue, see <a href="http://support.microsoft.com/kb/2938053" target="_blank">KB 2938053</a></p>
<p>Tony Redmond has also written <a href="http://windowsitpro.com/blog/exchange-2013-sp1-bug-breaks-third-party-products" target="_blank">a great, in-depth article about this on windowsitpro.com</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Step away from that Exchange 2013 SP1 update!&p[summary]=The Exchange Team announced the release of Exchange 2013 SP1 in late Feb and while SP1 introduced some great new features and functionali...&p[url]=http://172.16.7.177:4000/2014/03/step-away-from-that-exchange-2013-sp1-update" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2014/03/step-away-from-that-exchange-2013-sp1-update&text=The Exchange Team announced the release of Exchange 2013 SP1 in late Feb and while SP1 introduced some great new features and functionali...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-02-10T07:55:44-06:00" itemprop="datePublished">10 Feb, 2014</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2014/02/how-to-find-office-365-support-phone-number">How to find Office 365 Support Phone Number</a></h2>
    </header>

    <div class="post-content">
        <p>Every now and then I have a need to contact Office 365 support in order to help a customer resolve a particular issue. Logging a support request is easily done via the &ldquo;Support&rdquo; menu in the Office 365 admin portal, however it usually takes me a while to find a a contact telephone number for Office 365 support. The support engineers always have phone numbers listed in their email signatures, however these are rarely local numbers.</p>
<p>Earlier today, I was once again in a position where I needed to call Office 365 support and since I had to call from my mobile phone, an international number just wasn&rsquo;t going to work. I finally found this link buried in some support documentation and thought I would post it here in order to help someone else out and spare myself the effort next time I need it.</p>
<p><a title="http://virtualchat.support.microsoft.com/client/default.aspx?siteid=32ECF580-B446-44E5-8B4D-25F0AFE07779&amp;scope=S&amp;query=Support%20phone%20number" href="http://virtualchat.support.microsoft.com/client/default.aspx?siteid=32ECF580-B446-44E5-8B4D-25F0AFE07779&amp;scope=S&amp;query=Support%20phone%20number" target="_blank">http://virtualchat.support.microsoft.com/client/default.aspx?siteid=32ECF580-B446-44E5-8B4D-25F0AFE07779&amp;scope=S&amp;query=Support%20phone%20number</a></p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2014/02/image.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="image" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2014/02/image_thumb.png" width="916" height="566" border="0" /></a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=How to find Office 365 Support Phone Number&p[summary]=Every now and then I have a need to contact Office 365 support in order to help a customer resolve a particular issue. Logging a support ...&p[url]=http://172.16.7.177:4000/2014/02/how-to-find-office-365-support-phone-number" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2014/02/how-to-find-office-365-support-phone-number&text=Every now and then I have a need to contact Office 365 support in order to help a customer resolve a particular issue. Logging a support ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-01-29T05:41:28-06:00" itemprop="datePublished">29 Jan, 2014</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2014/01/ill-be-at-mec-2014-iammec">I&rsquo;ll be at MEC 2014 #IAMMEC</a></h2>
    </header>

    <div class="post-content">
        <p>Only a couple of months to go before the Microsoft Exchange Conference 2014 (MEC) in Austin (March 31 - April 2). I&rsquo;ll be attending and I am really looking forward to catching up with everyone in the community. This event truly is worth getting to - I'll prove it, I'm travelling from Australia! The first 100 sessions have already been posted <a href="http://www.iammec.com/Sessions.aspx" target="_blank">here</a>. For more info, check out <a title="http://www.iammec.com/" href="http://www.iammec.com/">http://www.iammec.com/</a></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/01/mec-icon.png"><img title="mec-icon" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="mec-icon" src="http://www.cgoosen.com/wp-content/uploads/2014/01/mec-icon_thumb.png" width="311" height="232"></a></p>
<p align="left">Let me know if you are also planning to attend, it would be great to catch up!</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=I&rsquo;ll be at MEC 2014 #IAMMEC&p[summary]=Only a couple of months to go before the Microsoft Exchange Conference 2014 (MEC) in Austin (March 31 - April 2). I&rsquo;ll be attending...&p[url]=http://172.16.7.177:4000/2014/01/ill-be-at-mec-2014-iammec" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2014/01/ill-be-at-mec-2014-iammec&text=Only a couple of months to go before the Microsoft Exchange Conference 2014 (MEC) in Austin (March 31 - April 2). I&rsquo;ll be attending...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-12-24T05:01:39-06:00" itemprop="datePublished">24 Dec, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/12/configure-mailbox-regional-settings">Configure Mailbox Regional Settings</a></h2>
    </header>

    <div class="post-content">
        <p>I recently completed a small migration for a customer using the <a href="https://www.migrationwiz.com/" target="_blank">MigrationWiz</a> online migration tools. This wasn&rsquo;t the first time I&rsquo;ve used these tools, but it was the first time I&rsquo;ve actually provisioned new destination mailboxes myself. I used PowerShell with a .csv file as input to automate the process of creating each mailbox, granting the correct level of access to the migration account as well as performing a few other tasks that were relevant to the particular migration.</p>
<p>Once I started the migration I was confused for a second when I received the following error message: &ldquo;Connection did not succeed. Try again later.&rdquo; The associated MigrationWiz <a href="https://migrationwiz.zendesk.com/entries/20442656" target="_blank">knowledgebase article</a> contained a few suggestions, but none of them applied to my particular situation. When trying to log into one of the test mailboxes, I noticed that it asked me to set my preferred language and time zone.. which is expected:</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2013/12/image3.png"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="image" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2013/12/image_thumb3.png" width="517" height="378" border="0" /></a></p>
<p>Once I had set these, I was able to connect and migrate data to that mailbox as expected. Obviously, I didn&rsquo;t want to manually configure these settings for each mailbox and was able to use PowerShell and the <a href="http://technet.microsoft.com/en-us/library/dd351103(v=exchg.150).aspx" target="_blank">Set-MailboxRegionalConfiguration</a> cmdlet to do this for all the relevant mailboxes. Here is a very simple script that will use a .csv as input and set the regional settings for all aliases. It can easily be modified to use some other input too:</p>
<p>[powershell]#The users.csv should contain a Alias colum, eg<br />
#Name,Alias,Email,Whatever<br />
$Users = Import-Csv .\users.csv<br />
Foreach ($User in $Users){<br />
   $Alias = $User.Alias<br />
   $Language = "en-NZ"<br />
   $DateFormat = "d/MM/yyyy"<br />
   $TimeFormat = "h:mm tt"<br />
   $TimeZone = "New Zealand Standard Time"<br />
   Set-MailboxRegionalConfiguration -Identity $Alias -Language $Language -DateFormat $DateFormat -TimeFormat $TimeFormat -TimeZone $TimeZone<br />
}[/powershell]</p>
<p>The easiest way to find your desired settings it to look at a correctly set mailbox using the <a href="http://technet.microsoft.com/en-us/library/dd335163(v=exchg.150).aspx" target="_blank">Get-MailboxRegionalConfiguration</a> cmdlet:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2013/12/image2.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="image" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2013/12/image_thumb2.png" width="672" height="232" border="0" /></a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Configure Mailbox Regional Settings&p[summary]=I recently completed a small migration for a customer using the MigrationWiz online migration tools. This wasn&rsquo;t the first time I&r...&p[url]=http://172.16.7.177:4000/2013/12/configure-mailbox-regional-settings" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/12/configure-mailbox-regional-settings&text=I recently completed a small migration for a customer using the MigrationWiz online migration tools. This wasn&rsquo;t the first time I&r...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-12-16T06:12:26-06:00" itemprop="datePublished">16 Dec, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/12/office-365-fast-track-network-analysis">Office 365 Fast Track Network Analysis</a></h2>
    </header>

    <div class="post-content">
        <p>Back in 2011 I posted about the <a href="http://www.cgoosen.com/2011/11/microsoft-online-services-internet-connection-performance-test/" target="_blank">Microsoft Online Services Internet Connection Performance Test</a> which was a tool that helped measure response times, bandwidth, and overall connection quality in preparation for consuming Microsoft Online services. The tool disappeared without warning after a while and was never replaced. A few months ago now it seems a new tool was made available, however I seem to have missed the announcement and only recently came across it. The Office 365 Fast Track Network Analysis tool is a similar web based tool that performs various connectivity tests and presents the results in a easy to read report. It looks very similar to the old speedtest.microsoftonline.com tool, but performs a few more tests:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2013/12/image.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2013/12/image_thumb.png" width="536" height="557"></a></p>
<p align="left">To access the tool, simply visit the URL appropriate to your region:</p>
<ul>
<li>For North America use: <a href="http://na1-fasttrack.cloudapp.net/">http://na1-fasttrack.cloudapp.net/</a>
<li>For Asia Pacific use: <a href="http://ap1-fasttrack.cloudapp.net">http://ap1-fasttrack.cloudapp.net</a>
<li>For Europe, Middle East and Africa use: <a href="http://em1-fasttrack.cloudapp.net/">http://em1-fasttrack.cloudapp.net/</a> </li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Office 365 Fast Track Network Analysis&p[summary]=Back in 2011 I posted about the Microsoft Online Services Internet Connection Performance Test which was a tool that helped measure respo...&p[url]=http://172.16.7.177:4000/2013/12/office-365-fast-track-network-analysis" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/12/office-365-fast-track-network-analysis&text=Back in 2011 I posted about the Microsoft Online Services Internet Connection Performance Test which was a tool that helped measure respo...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-11-08T08:18:06-06:00" itemprop="datePublished">8 Nov, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/11/migrate-legacy-public-folders-to-exchange-online-part-2">Migrate Legacy Public Folders to Exchange Online &ndash; Part 2</a></h2>
    </header>

    <div class="post-content">
        <p><a href="http://www.cgoosen.com/2013/10/migrate-legacy-public-folders-to-exchange-online-part-1/" target="_blank">In part 1 we</a> briefly looked at the architectural changes made to modern public folders in Exchange 2013 as well as some of the things to you may want to consider as you prepare to migrate you public folders to Exchange Online. In this post we will step through the actual migration process in detail.</p>
<p>Let&rsquo;s firstly take a look at the migration scripts. I typically place all these scripts in the same folder, c:\pfmigration for example. You should have the following scripts downloaded:</p>
<ul>
<li>Export-PublicFolderStatistics.ps1 - This script creates a .csv file that contains a folder name-to-folder size mapping.
<li>PublicFolderToMailboxMapGenerator.ps1 - This script uses the mapping file to create a public folder-to-mailbox mapping file which is also a .csv file.
<li>Export-MailPublicFoldersForMigration.ps1 - This script exports the mail-enabled public folder objects from the on-premises organization&rsquo;s Active Directory into a .xml file.
<li>Import-MailPublicFoldersForMigration.ps1 - This script imports the mail-enabled public folder objects into Exchange Online.</li>
</ul>
<p>Note: These scripts also have support files with a .psd1 extension, it is important that these support files are placed in the same folder.</p>
<p>Before starting the migration process, you should confirm that there are no existing public folder migration requests in Exchange Online. These would need to be removed before you can continue, but it is important to first understand why there are already there before removing them. You can easily see if there are any existing request by running the following cmdlet in Exchange Online:</p>
<blockquote><p>Get-PublicFolderMigrationRequest | Get-PublicFolderMigrationRequestStatistics -IncludeReport | Format-List</p>
</blockquote>
<p>The first step in the migration process is to ensure that mail-flow to mail-enabled public folders will continue to work. The steps required to do this will depend on your configuration. If you already have an Exchange Hybrid configured (as I do), you will most likely not need to do anything as the Hybrid Configuration Wizard will take care of this step.</p>
<p>Next it is time to start using the migration scripts. We start with the Export-PublicFolderStatistics.ps1 script to create our name-to-folder size mapping file. This script is run on the legacy public folder server:</p>
<blockquote><p>Export-PublicFolderStatistics.ps1&nbsp; <size_mapping_file_name> <legacy_server></p>
</blockquote>
<p>Once we have our size mapping file, we can run the PublicFolderToMailboxMapGenerator.ps1 script to create the public folder-to-mailbox mapping file which is used to calculate the correct number of public folder mailboxes that will be required in Exchange Online. This script is run on the legacy public folder server:</p>
<blockquote><p>PublicFolderToMailboxMapGenerator.ps1 <maximum_mailbox_size_in_bytes> <size_mapping_file_name> <mailbox_mapping_file_name></p>
</blockquote>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2013/11/image.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2013/11/image_thumb.png" width="1014" height="277"></a></p>
<p>Note: The <maximum_mailbox_size_in_bytes> parameter is used to size your public folder mailboxes in Exchange Online. In my example I have used 10 GB (or there about!) Public folders in Exchange Online can be a maximum of 50 GB, however I would recommend leaving enough room for growth. </p>
<p>I was having a discussion with a colleague of mine last week about public folder migration, more specifically how to selectively migrate only certain public folders. In the interest of full disclosure, I have not tested this (yet!), but in theory it should work. If you were to edit the size mapping file in Excel, you will notice that it contains two columns: &lsquo;FolderName&rsquo; and &lsquo;FolderSize&rsquo;. Remove all the entries for folders that you don&rsquo;t want to migrate before running the PublicFolderToMailboxMapGenerator.ps1 script and complete the rest of the process as documented. If you have tried this and have some feedback, let me know. I hope to be able to test it soon.</p>
<p>Moving on.. once we have our mapping files created, we should export our mail enabled public folders on our legacy public folder server:</p>
<blockquote><p>Export-MailPublicFoldersForMigration.ps1 <export_file_name></p>
</blockquote>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo3.png"><img title="pfeo3" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="pfeo3" src="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo3_thumb.png" width="1014" height="168"></a></p>
<p>Next, we can connect to Exchange Online and create our new public folder mailboxes. The first public folder mailbox that is created will be the primary hierarchy mailbox and it must be created in &lsquo;HoldForMigration mode&rsquo;. This public folder mailbox should also be excluded from the serving hierarchy so that the public folders won&rsquo;t be available to Exchange Online users.</p>
<blockquote><p>New-Mailbox -PublicFolder <mailbox_name> -HoldForMigration:$true -IsExcludedFromServingHierarchy:$true</p>
</blockquote>
<p>We should also import our mail enabled public folders:</p>
<blockquote><p>Import-MailPublicFoldersForMigration.ps1 <export_file_name></p>
</blockquote>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo4.png"><img title="pfeo4" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="pfeo4" src="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo4_thumb.png" width="1014" height="231"></a></p>
<p>We are now ready to submit the migration request, but before we do, let&rsquo;s gather all the required information for the New-PublicFolderMigrationRequest cmdlet:</p>
<p>First we need our Outlook Anywhere hostname and authentication method:</p>
<blockquote><p>Get-OutlookAnywhere | Format-List Identity, ExternalHostName, IISAuthenticationMethods</p>
</blockquote>
<p>We also need the LegacyExchangeDN of the administrator mailbox:</p>
<blockquote><p>Get-Mailbox <user> | Format-Table LegacyExchangeDN</p>
</blockquote>
<p>Lastly, we need the ExchangeLegacyDN of the legacy public folder server:</p>
<blockquote><p>Get-ExchangeServer &ndash;Identity <server> | Format-Table ExchangeLegacyDN</p>
</blockquote>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2013/11/Capture.png"><img title="Capture" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="Capture" src="http://www.cgoosen.com/wp-content/uploads/2013/11/Capture_thumb.png" width="1014" height="341"></a></p>
<p>Given the length of the cmdlet and parameters, I recommend using variables. Using the information we have gathered, we can easily do this:</p>
<blockquote><p>$OAHostname = <ExternalHostName_value></p>
<p>$Csv = Get-Content c:\PFMigration\pf2mbx.csv -Encoding Byte</p>
<p>$OnPremCred = Get-Credential</p>
<p>$Rmldn = <LegacyExchangeDN_value></p>
<p>$Rpfsldn = <ExchangeLegacyDN_value></p>
</blockquote>
<p>We can then run the New-PublicFolderMigrationRequest cmdlet using these variables. You&rsquo;ll know that the command started successfully when the migration request reaches a status of &lsquo;Queued&rsquo; or &lsquo;InProgress&rsquo;:</p>
<blockquote><p>New-PublicFolderMigrationRequest -OutlookAnywhereHostName $OAHostName -CSVData $Csv -RemoteCredential $OnPremCred -RemoteMailboxLegacyDN $Rmldn -RemoteMailboxServerLegacyDN $Rpfsldn -AuthenticationMethod <Basic/NTLM></p>
</blockquote>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2013/11/image1.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2013/11/image_thumb1.png" width="1014" height="341"></a></p>
<p>Once the migration request kicks off it will copy the public folder data and will continue running until it reaches 95% at which point it will auto suspend the request. We can monitor the progress using the Get-PublicFolderMigrationRequest and Get-PublicFolderMigrationRequestStatistics cmdlets:</p>
<blockquote><p>Get-PublicFolderMigrationRequest | Get-PublicFolderMigrationRequestStatistics -IncludeReport | Format-List Status, SourceServer, SourceVersion, BytesTransferred, ItemsTransferred, PercentComplete, Message</p>
</blockquote>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo7.png"><img title="pfeo7" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="pfeo7" src="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo7_thumb.png" width="1014" height="294"></a></p>
<p>In order to complete the migration request, we need to arrange downtime or a service outage as there will be period while the last bit of data is transferred where public folders will be unavailable to end users. The amount of downtime depends on how much new content has been generated since the migration was suspended. In large environments with a lot of changing content, I would recommend running the Resume-PublicFolderMigrationRequest cmdlet. This cmdlet can be run as often as required and will merely copy any new content and auto suspend at 95%, this will reduce the amount of downtime required.</p>
<p>Once we have scheduled a service outage and informed out end users, we need to lock the legacy public folder environment in order to prevent any further changes:</p>
<blockquote><p>Set-OrganizationConfig &ndash;PublicFoldersLockedForMigration $true</p>
</blockquote>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo8.png"><img title="pfeo8" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="pfeo8" src="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo8_thumb.png" width="1014" height="256"></a></p>
<p>Next we need to allow the migration request to complete, we do this by removing &lsquo;PreventCompletion&rsquo;:</p>
<blockquote><p>Get-PublicFolderMigrationRequest | Set-PublicFolderMigrationRequest -PreventCompletion $false</p>
</blockquote>
<p>We can now resume the migration request and this time it will run through to completion and not auto suspend at 95%:</p>
<blockquote><p>Get-PublicFolderMigrationRequest | Resume-PublicFolderMigrationRequest</p>
</blockquote>
<p>We monitor the request as before to verify that it has completed successfully:</p>
<blockquote><p>Get-PublicFolderMigrationRequest | Get-PublicFolderMigrationRequestStatistics -IncludeReport | Format-List Status, SourceServer, SourceVersion, BytesTransferred, ItemsTransferred, PercentComplete, Message</p>
</blockquote>
<p>Once we are happy that the migration has completed successfully, we allow the hierarchy to be served:</p>
<blockquote><p>Get-Mailbox -PublicFolder | Set-Mailbox -PublicFolder -IsExcludedFromServingHierarchy $false</p>
</blockquote>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo10.png"><img title="pfeo10" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="pfeo10" src="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo10_thumb.png" width="1014" height="295"></a></p>
<p>The final set in the process is to set the migration as complete in the legacy environment:</p>
<blockquote><p>Set-OrganizationConfig -PublicFolderMigrationComplete $true</p>
</blockquote>
<p>It is possible to roll back the migration, however I would like to mention a few really important points about rolling back:</p>
<ul>
<li>The roll back process will not copy any changed data back to the legacy environment, this should be considered when deciding to roll back. It would be a really bad idea to try and roll back a change heavy environment after 3 weeks.</li>
<li>Roll back will obviously require the original public folder databases to be online, I therefore recommend dismounting these for a period of time after the migration just in case you need them. This process is a lot more difficult if you delete the databases and then try and roll back.</li>
</ul>
<p>For more information on the migration process, see the following article on TechNet:</p>
<ul>
<li><a href="http://technet.microsoft.com/en-us/library/jj983799(v=exchg.150).aspx" target="_blank">Migrate Legacy Public Folders to Exchange Online</a></li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Migrate Legacy Public Folders to Exchange Online &ndash; Part 2&p[summary]=In part 1 we briefly looked at the architectural changes made to modern public folders in Exchange 2013 as well as some of the things to ...&p[url]=http://172.16.7.177:4000/2013/11/migrate-legacy-public-folders-to-exchange-online-part-2" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/11/migrate-legacy-public-folders-to-exchange-online-part-2&text=In part 1 we briefly looked at the architectural changes made to modern public folders in Exchange 2013 as well as some of the things to ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-10-30T09:02:59-05:00" itemprop="datePublished">30 Oct, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/10/migrate-legacy-public-folders-to-exchange-online-part-1">Migrate Legacy Public Folders to Exchange Online &ndash; Part 1</a></h2>
    </header>

    <div class="post-content">
        <p>I&rsquo;ve been meaning to get this series published for some time now. I can&rsquo;t believe it is almost 2 months since TechEd Australia 2013! <a href="http://cgoo.se/18TNT8Y" target="_blank">During my session</a>, I briefly covered modern public folders and how to migrate them to Exchange Online. My aim is to build on that session with a couple of posts that run through the entire process of migrating legacy public folders to Exchange Online. This first post will provide an overview of modern public folder architecture as well as some of the planning and preparation required prior to the migration.</p>
<p>I&rsquo;m sure by now everyone is aware that in Exchange 2013 public folders were re-engineered using mailbox infrastructure to take advantage of the existing high availability and storage technologies of the mailbox database. Public folder architecture uses specially designed mailboxes to store both the public folder hierarchy and content. This also means that there is no longer a public folder database and high availability for the public folder mailboxes is provided by a DAG. Let&rsquo;s briefly look at the new architecture:</p>
<p>The main component of public folders are the public folder mailboxes, which can reside in one or more mailbox databases. Public folder mailboxes can be either &lsquo;Primary&rsquo; or &lsquo;Secondary&rsquo;. The primary hierarchy mailbox is the 1 writable copy of the public folder hierarchy. The public folder hierarchy is copied to all other public folder mailboxes, but these secondary copies are read-only copies. The public folder hierarchy contains the folders&rsquo; properties, organizational information and tree structure. Public folder content can include email messages, posts, documents, and eForms. The content is stored in the public folder mailbox but isn&rsquo;t replicated across multiple public folders mailboxes. All users access the same public folder mailbox for the same set of content. </p>
<p>&nbsp;</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2013/10/image.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; border-top-width: 0px; margin-right: auto" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2013/10/image_thumb.png" width="690" height="483"></a></p>
<p>Because there is only 1 writable copy of the hierarchy, it is necessary to synchronize changes to other mailboxes when they are made. Hierarchy synchronization takes place as follows (as illustrated in the diagram above):</p>
<ol>
<li>Let&rsquo;s say for example a client connects to a secondary public folder mailbox to access content (Folder 5) and
<li>Then that client creates a new public folder (Folder 6 in the example)
<li>The request will be proxied to the primary public folder mailbox where it is written to public folder hierarchy
<li>Public folder hierarchy synchronisation is triggered immediately to content mailbox
<li>The public folder hierarchy is updated on all public folder mailboxes. This takes place after 15 mins for mailboxes with connected users and after 24 hrs for mailboxes with no connected users.</li>
</ol>
<p>In order to move legacy public folders to Exchange Online, you need at least Exchange 2007 SP3 RU1 or Exchange 2010 SP3 and there are a few other considerations you may want to take note of:</p>
<ul>
<li>There is no coexistence between legacy and modern public folders, the migration is a all at once &lsquo;cutover&rsquo; migration</li>
<li>All mailboxes must be on Exchange 2013 and/or Exchange Online prior to migration</li>
<li>Migrations are PowerShell based using scripts, there is no migration wizard or GUI</li>
<li>While a Exchange Hybrid Deployment is not required, it does make things easier as you do not have to manually configure message routing for mail-enabled public folders</li>
<li>Public folders are migrated using Outlook Anywhere, therefore Outlook Anywhere must be published to the internet and enabled on all legacy public folder servers</li>
<li>EWS clients such as Entourage 2008 EWS Edition and Outlook for Mac 2011 with mailboxes on Exchange 2013 will not be able to access legacy public folders</li>
<li>Public folders that include a Backslash (&ldquo;\&rdquo;) in their names are not supported</li>
</ul>
<p>You should also ensure that you have the correct permissions:</p>
<ul>
<li>In Exchange Online, you need to be a member of the &lsquo;Organization Management&rsquo; role group</li>
<li>In Exchange 2010, you need to be a member of the &lsquo;Organization Management&rsquo; or &lsquo;Server Management&rsquo; RBAC role groups.</li>
<li>In Exchange 2007, you need to be assigned the &lsquo;Exchange Organization Administrator&rsquo; role or the &lsquo;Exchange Server Administrator&lsquo; role. You should also be assigned the &lsquo;Public Folder Administrator&rsquo; role and local Administrators group for the target server.</li>
</ul>
<p>As previously mentioned, the migration is done via PowerShell. There are a few scripts that should be downloaded, these will be used during the various stages of the migration. Be sure to download the following:</p>
<ul>
<li><a href="http://www.microsoft.com/en-us/download/details.aspx?id=38407" target="_blank">Microsoft Exchange 2013 Public Folders Migration Scripts</a></li>
<li><a href="http://www.microsoft.com/en-us/download/details.aspx?id=38408" target="_blank">Microsoft Exchange 2013 Public Folders Directory Sync Support Scripts</a></li>
</ul>
<p>Finally, when preparing for a public folder migration to Exchange Online, I would highly recommend that public folders are first analyzed and classified. It is not uncommon to see public folder structures that were implemented in the early days of Exchange more than 10 years ago and are now no more than a dumping ground for old data. Often these hierarchies where designed to match an organization structure or meet business requirements that no longer exist. Exchange has come a long way since then and by taking a good look at your public folder use cases, you may find that there are better and more efficient ways to do things today.</p>
<p>In part 2 we&rsquo;ll will run through the migration process.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Migrate Legacy Public Folders to Exchange Online &ndash; Part 1&p[summary]=I&rsquo;ve been meaning to get this series published for some time now. I can&rsquo;t believe it is almost 2 months since TechEd Australi...&p[url]=http://172.16.7.177:4000/2013/10/migrate-legacy-public-folders-to-exchange-online-part-1" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/10/migrate-legacy-public-folders-to-exchange-online-part-1&text=I&rsquo;ve been meaning to get this series published for some time now. I can&rsquo;t believe it is almost 2 months since TechEd Australi...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-09-11T16:13:14-05:00" itemprop="datePublished">11 Sep, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/09/my-session-at-teched-australia-2013">My Session at TechEd Australia 2013</a></h2>
    </header>

    <div class="post-content">
        <p>In case you missed my session at TechEd Australia last week the session recording and slide deck is available on <a href="http://cgoo.se/18TNT8Y" target="_blank">Channel 9</a> or by clicking here: <a title="http://cgoo.se/18TNT8Y" href="http://cgoo.se/18TNT8Y">http://cgoo.se/18TNT8Y</a></p>
<p>I&rsquo;m currently working a series of posts about Public Folder migration to Exchange Online. I touched on it during the session, but will be publishing more details in the series so look out for it soon.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=My Session at TechEd Australia 2013&p[summary]=In case you missed my session at TechEd Australia last week the session recording and slide deck is available on Channel 9 or by clicking...&p[url]=http://172.16.7.177:4000/2013/09/my-session-at-teched-australia-2013" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/09/my-session-at-teched-australia-2013&text=In case you missed my session at TechEd Australia last week the session recording and slide deck is available on Channel 9 or by clicking...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-08-14T06:48:20-05:00" itemprop="datePublished">14 Aug, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/08/critical-security-bulletin-for-exchange-server-ms13-061">Critical Security Bulletin for Exchange Server (MS13-061)</a></h2>
    </header>

    <div class="post-content">
        <p><font color="#ff0000">##Update 30 Aug 2013##</font></p>
<p><font color="#000000">The MS13-061 security update has been re-released for Exchange Server 2013, the download links below have been updated.</font></p>
<p><font color="#ff0000">##Update 15 Aug 2013##</font></p>
<p><font color="#000000">The MS13-061 security update for Exchange Server 2013 has been pulled as it seems to cause an issue with the Content Index for mailbox databases. If you have already installed this update see </font><a href="http://support.microsoft.com/kb/2879739" target="_blank"><font color="#000000">KB2879739</font></a><font color="#000000"> for information on how to resolve this. This issue does not occur in Exchange 2010 or Exchange 2007.</font></p>
<p>A few hours ago Microsoft released a critical security update for all supported editions of Microsoft Exchange Server 2007, 2010, and 2013. This security update addresses vulnerabilities that exist in the WebReady Document Viewing and Data Loss Prevention features of Exchange that could allow remote code execution in the security context of the transcoding service on the Exchange server if a user previews a specially crafted file using Outlook Web App. For detailed information, see <a href="http://technet.microsoft.com/en-us/security/Bulletin/MS13-061" target="_blank">Microsoft Security Bulletin MS13-061</a></p>
<p>Microsoft recommends that customers apply the update immediately. The update can be downloaded at the following links:</p>
<ul>
<li><a href="http://www.microsoft.com/en-us/download/details.aspx?id=39803" target="_blank">Update Rollup 11 for Exchange Server 2007 SP3</a>
<li><a href="http://www.microsoft.com/en-us/download/details.aspx?id=39863" target="_blank">Update Rollup 7 for Exchange Server 2010 SP2</a>
<li><a href="http://www.microsoft.com/en-eg/download/details.aspx?id=39835" target="_blank">Update Rollup 2 For Exchange 2010 SP3</a>
<li><a href="http://www.microsoft.com/en-us/download/details.aspx?id=39910" target="_blank">Security Update For Exchange Server 2013 CU1</a>
<li><a href="http://www.microsoft.com/en-us/download/details.aspx?id=39904" target="_blank">Security Update For Exchange Server 2013 CU2</a></li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Critical Security Bulletin for Exchange Server (MS13-061)&p[summary]=##Update 30 Aug 2013##
The MS13-061 security update has been re-released for Exchange Server 2013, the download links below have been upd...&p[url]=http://172.16.7.177:4000/2013/08/critical-security-bulletin-for-exchange-server-ms13-061" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/08/critical-security-bulletin-for-exchange-server-ms13-061&text=##Update 30 Aug 2013##
The MS13-061 security update has been re-released for Exchange Server 2013, the download links below have been upd...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-07-30T06:52:16-05:00" itemprop="datePublished">30 Jul, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/07/how-to-access-exchange-admin-center-eac-in-exchange-2013-during-coexistence">How to access Exchange Admin Center (EAC) in Exchange 2013 during coexistence</a></h2>
    </header>

    <div class="post-content">
        <p>Perhaps you are planning your on-premises upgrade to Exchange 2013 or you&rsquo;ve just introduced the first Exchange 2013 server into your existing Exchange 2010 environment. Welcome to coexistence! Hopefully by now you already know that the Exchange Admin Center (EAC) is the web-based management console in Microsoft Exchange Server 2013 and it replaces the Exchange Management Console (EMC) and the Exchange Control Panel (ECP), which were the two interfaces used to manage Exchange Server 2010.</p>
<p>So how do you access the EAC? Well.. if you had just installed a fresh new Exchange 2013 org you would simply navigate to <a href="https://<your_exchange_server>/ecp">https://<your_exchange_server>/ecp</a> in your browser. In a coexistence scenario however, doing that would redirect you to Exchange 2010 ECP and you would probably see something like this (once logged in):</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2013/07/image.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2013/07/image_thumb.png" width="616" height="182"></a></p>
<p align="left">The reason for this is that your mailbox is probably still located on an Exchange 2010 server. You now have two options:</p>
<ol>
<li>
<div align="left">Move your mailbox to Exchange 2013 and try again, or</div>
</li>
<li>
<div align="left">Use the following URL: <a href="https://<your_exchange_server>/ecp?ExchClientVer=15">https://<your_exchange_server>/ecp<a href="https://exchange2013servername/ecp?ExchClientVer=15">?ExchClientVer=15</a></a>&nbsp;</div>
</li>
</ol>
<p align="left">You should now see the Exchange 2013 Admin Center which will look something like this:</p>
<p align="left"><a href="http://www.cgoosen.com/wp-content/uploads/2013/07/image1.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2013/07/image_thumb1.png" width="622" height="228"></a></p>
<p>You are now able to continue configuring Exchange 2013 via the EAC. </p>
<p>Read more about the <a href="http://technet.microsoft.com/en-us/library/jj150562(v=exchg.150).aspx" target="_blank">EAC here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=How to access Exchange Admin Center (EAC) in Exchange 2013 during coexistence&p[summary]=Perhaps you are planning your on-premises upgrade to Exchange 2013 or you&rsquo;ve just introduced the first Exchange 2013 server into yo...&p[url]=http://172.16.7.177:4000/2013/07/how-to-access-exchange-admin-center-eac-in-exchange-2013-during-coexistence" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/07/how-to-access-exchange-admin-center-eac-in-exchange-2013-during-coexistence&text=Perhaps you are planning your on-premises upgrade to Exchange 2013 or you&rsquo;ve just introduced the first Exchange 2013 server into yo...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>




<div class="pagination" role="navigation" aria-label="pagination">
    
        <a href="/page7/" class="previous">&larr; Previous</a>
    

    <span class="page_number">Page 8 of 24</span>

    
        <a href="/page9/" class="next">Next &rarr;</a>
    
</div>

            </main>
        </div>

        <script src="http://172.16.7.177:4000/assets/js/jquery-1.12.2.min.js"></script>
<script src="http://172.16.7.177:4000/assets/js/backtotop.js"></script>
<script src="http://172.16.7.177:4000/assets/js/lunr.min.js"></script>
<script src="http://172.16.7.177:4000/assets/js/lunr-feed.js"></script>
<script src="http://172.16.7.177:4000/assets/js/jquery.fitvids.js"></script>
<script src="http://172.16.7.177:4000/assets/js/svg4everybody.min.js"></script>
<script src="http://172.16.7.177:4000/assets/js/scripts.js"></script>


    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-XXXXXXX-2', 'auto');
        ga('send', 'pageview');
    </script>

        <style>
.lightbox {width: 100%; height: 100%; position: fixed; top: 0; left: 0; background: rgba(0,0,0,0.85); z-index: 9999999; line-height: 0; cursor: pointer;}
.lightbox .img {
	position: relative; 
	top: 50%;
	left: 50%;
	-ms-transform: translateX(-50%) translateY(-50%);
	-webkit-transform: translate(-50%,-50%);
	transform: translate(-50%,-50%);
	max-width: 100%;
	max-height: 100%;
}
.lightbox .img img {opacity: 0; pointer-events: none; width: auto;}
@media screen and (min-width: 1200px) {
    .lightbox .img {
		max-width: 1200px;
    }
}
@media screen and (min-height: 1200px) {
    .lightbox img {
		max-height: 1200px;
	}
}
.lightbox span {display: block; position: fixed; bottom: 13px; height: 1.5em; line-height: 1.4em; width: 100%; text-align: center; color: white; text-shadow:
    -1px -1px 0 #000,
    1px -1px 0 #000,
    -1px 1px 0 #000,
    1px 1px 0 #000;  
}






.lightbox .videoWrapperContainer {
	position: relative; 
	top: 50%;
	left: 50%;
	-ms-transform: translateX(-50%) translateY(-50%);
	-webkit-transform: translate(-50%,-50%);
	transform: translate(-50%,-50%);
	max-width: 900px;
	max-height: 100%;
}
.lightbox .videoWrapperContainer .videoWrapper {
	height: 0;
	line-height: 0;
	margin: 0;
	padding: 0;
	position: relative;
	padding-bottom: 56.333%; /* custom */
	background: black;
} 
.lightbox .videoWrapper iframe {
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
	border: 0;
	display: block;
}   
.lightbox #prev, .lightbox #next {height: 50px; line-height: 36px; display: none; margin-top: -25px; position: fixed; top: 50%; padding: 0 15px; cursor: pointer; text-decoration: none; z-index: 99; color: white; font-size: 60px;}
.lightbox.gallery #prev, .lightbox.gallery #next {display: block;}
.lightbox #prev {left: 0;}
.lightbox #next {right: 0;}
.lightbox #close {height: 50px; width: 50px; position: fixed; cursor: pointer; text-decoration: none; z-index: 99; right: 0; top: 0;}
.lightbox #close:after, .lightbox #close:before {position: absolute; margin-top: 22px; margin-left: 14px; content: ""; height: 3px; background: white; width: 23px;
-webkit-transform-origin: 50% 50%;
-moz-transform-origin: 50% 50%;
-o-transform-origin: 50% 50%;
transform-origin: 50% 50%;
/* Safari */
-webkit-transform: rotate(-45deg);
/* Firefox */
-moz-transform: rotate(-45deg);
/* IE */
-ms-transform: rotate(-45deg);
/* Opera */
-o-transform: rotate(-45deg);
}
.lightbox #close:after {
/* Safari */
-webkit-transform: rotate(45deg);
/* Firefox */
-moz-transform: rotate(45deg);
/* IE */
-ms-transform: rotate(45deg);
/* Opera */
-o-transform: rotate(45deg);
}
.lightbox, .lightbox * {
    -webkit-user-select: none;  
    -moz-user-select: none;    
    -ms-user-select: none;      
    user-select: none;
}
</style>
		
<script>
function is_youtubelink(url) {
  var p = /^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/;
  return (url.match(p)) ? RegExp.$1 : false;
}
function is_imagelink(url) {
	var p = /([a-z\-_0-9\/\:\.]*\.(jpg|jpeg|png|gif))/i;
	return (url.match(p)) ? true : false;
}
function is_vimeolink(url,el) {
	var id = false;
	$.ajax({
	  url: 'https://vimeo.com/api/oembed.json?url='+url,
	  async: true,
	  success: function(response) {
		if(response.video_id) {
		  id = response.video_id;
		  $(el).addClass('lightbox-vimeo').attr('data-id',id);
		}
	  }
	});
}

$(document).ready(function() {
	//add classes to links to be able to initiate lightboxes
	$("a").each(function(){
		var url = $(this).attr('href');
		if(url) {
			if(url.indexOf('vimeo') !== -1 && !$(this).hasClass('no-lightbox')) is_vimeolink(url,$(this));
			if(is_youtubelink(url) && !$(this).hasClass('no-lightbox')) $(this).addClass('lightbox-youtube').attr('data-id',is_youtubelink(url));
			if(is_imagelink(url) && !$(this).hasClass('no-lightbox')) {
				$(this).addClass('lightbox-image');
				var href = $(this).attr('href');
				var filename = href.split('/').pop();
				var split = filename.split(".");
				var name = split[0];
				$(this).attr('title',name);
			}
		}
	});
	//remove the clicked lightbox
	$("body").on("click", ".lightbox", function(event){
		if($(this).hasClass('gallery')) {
			$(this).remove();
			if($(event.target).attr('id')=='next') {
				//next item
				if($("a.gallery.current").nextAll("a.gallery:first").length) $("a.gallery.current").nextAll("a.gallery:first").click();
				else $("a.gallery.current").parent().find("a.gallery").first().click();
			}
			else if ($(event.target).attr('id')=='prev') {
				//prev item
				if($("a.gallery.current").prevAll("a.gallery:first").length) $("a.gallery.current").prevAll("a.gallery:first").click();
				else $("a.gallery.current").parent().find("a.gallery").last().click();
			}
			else {
				$("a.gallery").removeClass('gallery');
			}
		}
		else $(this).remove();
	});
	//prevent image from being draggable (for swipe)
	$("body").on('dragstart', ".lightbox img", function(event) { event.preventDefault(); });
	//add the youtube lightbox on click
	$("a.lightbox-youtube").click(function(event){
		event.preventDefault();
		$('<div class="lightbox"><a id="close"></a><a id="next">&rsaquo;</a><a id="prev">&lsaquo;</a><div class="videoWrapperContainer"><div class="videoWrapper"><iframe src="https://www.youtube.com/embed/'+$(this).attr('data-id')+'?autoplay=1&showinfo=0&rel=0"></iframe></div></div></div>').appendTo('body');
	});
	//add the image lightbox on click
	$("a.lightbox-image").click(function(event){
		event.preventDefault();
		$('<div class="lightbox"><a id="close"></a><a id="next">&rsaquo;</a><a id="prev">&lsaquo;</a><div class="img" style="background: url('+$(this).attr('href')+') center center / contain no-repeat;" title="'+$(this).attr('title')+'" ><img src="'+$(this).attr('href')+'" alt="'+$(this).attr('title')+'" /></div><span>'+$(this).attr('title')+'</span></div>').appendTo('body');
	});
	//add the vimeo lightbox on click
	$("body").on("click", "a.lightbox-vimeo", function(event){
		event.preventDefault();
		$('<div class="lightbox"><a id="close"></a><a id="next">&rsaquo;</a><a id="prev">&lsaquo;</a><div class="videoWrapperContainer"><div class="videoWrapper"><iframe src="https://player.vimeo.com/video/'+$(this).attr('data-id')+'/?autoplay=1&byline=0&title=0&portrait=0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div></div></div>').appendTo('body');
	});

	$("body").on("click", "a[class*='lightbox-']", function(){
		var link_elements = $(this).parent().find("a[class*='lightbox-']");
		$(link_elements).removeClass('current');
		for (var i=0; i<link_elements.length; i++) {
			if($(this).attr('href') == $(link_elements[i]).attr('href')) {
				$(link_elements[i]).addClass('current');
			}
		}
		if(link_elements.length>1) {
			$('.lightbox').addClass('gallery');
			$(link_elements).addClass('gallery');
		}
	});

	
});

$(document).keydown(function(e) {
    switch(e.which) {
        case 37: // left
        $("#prev").click();
        break;
        case 39: // right
        $("#next").click();
        break;
	case 27: // esc
        $("#close").click();
        break;
        default: return; // exit this handler for other keys
    }
    e.preventDefault(); // prevent the default action (scroll / move caret)
});

  /*===========================
  Swipe-it v1.4.1
  An event listener for swiping gestures with vanilla js.
  https://github.com/tri613/swipe-it#readme
 
  @Create 2016/09/22
  @Update 2017/08/11
  @Author Trina Lu
  ===========================*/
  "use strict";var _slicedToArray=function(){function n(n,t){var e=[],i=!0,o=!1,r=void 0;try{for(var u,c=n[Symbol.iterator]();!(i=(u=c.next()).done)&&(e.push(u.value),!t||e.length!==t);i=!0);}catch(n){o=!0,r=n}finally{try{!i&&c.return&&c.return()}finally{if(o)throw r}}return e}return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();!function(n,t,e){function i(n){function e(){o("touchstart",m,w),o("touchmove",d,w),o("touchend",p,w),E.mouseEvent&&o("mousedown",s,w)}function i(){y=!1,D=!1,A=!1,b=!1,a=!1}function s(n){a=this,y=n.clientX,D=n.clientY,o("mousemove",l,v),o("mouseup",h,v)}function l(n){n.preventDefault(),y&&D&&(A=n.clientX,b=n.clientY)}function h(n){r("mousemove",l,v),r("mouseup",h,v),p(n)}function m(n){a=this,y=n.touches[0].clientX,D=n.touches[0].clientY}function d(n){A=n.touches[0].clientX,b=n.touches[0].clientY}function p(n){if(y&&D&&A&&b){var t=y-A,e=D-b,o=[t,e].map(Math.abs),r=_slicedToArray(o,2),c=r[0],s=r[1],v=E.minDistance;if(c>v){var f=y<A?"swipeRight":"swipeLeft";u(f,a,{distance:t,start:y,end:A})}if(s>v){var l=D>b?"swipeUp":"swipeDown";u(l,a,{distance:e,start:D,end:b})}(c>v||s>v)&&u("swipe",a)}i()}var E=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},w=c(t.querySelectorAll(n)),y=void 0,D=void 0,A=void 0,b=void 0;E.mouseEvent=void 0===E.mouseEvent?f.mouseEvent:E.mouseEvent,E.minDistance=void 0===E.minDistance?f.minDistance:E.minDistance,i(),e(),this.on=function(n,t){return o(n,t,w),this}}function o(n,t,e){s(e).forEach(function(e){return e.addEventListener(n,t)})}function r(n,t,e){s(e).forEach(function(e){return e.removeEventListener(n,t)})}function u(n,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=t.createEvent("Event");o.initEvent(n,!0,!0),o.swipe=i,s(e).forEach(function(n){return n.dispatchEvent(o)})}function c(n){for(var t=[],e=0;e<n.length;e++)t.push(n[e]);return t}function s(n){return Array.isArray(n)?n:[n]}var a=!1,v=[n],f={mouseEvent:!0,minDistance:30};n[e]=i}(window,document,"SwipeIt");

var mySwipeIt = new SwipeIt('body');
mySwipeIt.on('swipeLeft',function(e){
	//check if lightbox is present
	if($('.lightbox').length >  0 ) {
		$("#next").click();
	}
}).on('swipeRight',function(e){
	//check if lightbox is present
	if($('.lightbox').length >  0 ) {
		$("#prev").click();
	}
});
</script>

    </body>
</html>