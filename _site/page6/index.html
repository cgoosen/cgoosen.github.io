<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title> Chris&#39;s Blog &mdash; It&#39;s called thinking...  go with it! </title>
    <meta property="og:title" content=" Chris&#39;s Blog &mdash; It&#39;s called thinking...  go with it! " />
    <meta name="twitter:title" content=" Chris&#39;s Blog &mdash; It&#39;s called thinking...  go with it! " />

    <meta name="description" content="">
    <meta name="description" property="og:description" content="" />
    <meta name="twitter:description" content="" />

    <meta name="twitter:card" content="summary_large_image" />
    
    <meta name="twitter:site" content="@chrisgoosen" />
    
    <meta property="og:url" content="http://172.16.7.177:4000/page6/" />

    <meta property="og:image" content="" />
    <meta name="twitter:image" content="" />

    <meta name="author" content="Chris's Blog" />

    <meta name="copyright" content="Copyright by Chris's Blog. All Rights Reserved." />

    <style>
        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 300;
            src: local('Roboto Light'), local('Roboto-Light'), url(https://fonts.gstatic.com/s/roboto/v15/Hgo13k-tfSpn0qi1SFdUfVtXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 400;
            src: local('Roboto'), local('Roboto-Regular'), url(https://fonts.gstatic.com/s/roboto/v15/CWB0XYA8bzo0kSThX0UTuA.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 700;
            src: local('Roboto Bold'), local('Roboto-Bold'), url(https://fonts.gstatic.com/s/roboto/v15/d-6IYplOFocCacKzxwXSOFtXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 900;
            src: local('Roboto Black'), local('Roboto-Black'), url(https://fonts.gstatic.com/s/roboto/v15/mnpfi9pxYH-Go5UiibESIltXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 300;
            src: local('Roboto Light Italic'), local('Roboto-LightItalic'), url(https://fonts.gstatic.com/s/roboto/v15/7m8l7TlFO-S3VkhHuR0at44P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 400;
            src: local('Roboto Italic'), local('Roboto-Italic'), url(https://fonts.gstatic.com/s/roboto/v15/vPcynSL0qHq_6dX7lKVByfesZW2xOQ-xsNqO47m55DA.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 700;
            src: local('Roboto Bold Italic'), local('Roboto-BoldItalic'), url(https://fonts.gstatic.com/s/roboto/v15/t6Nd4cfPRhZP44Q5QAjcC44P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 900;
            src: local('Roboto Black Italic'), local('Roboto-BlackItalic'), url(https://fonts.gstatic.com/s/roboto/v15/bmC0pGMXrhphrZJmniIZpY4P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }
    </style>
    
    <link href="/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    
    <link rel="stylesheet" href="http://172.16.7.177:4000/assets/css/main.css">

    <link rel="canonical" href="http://172.16.7.177:4000/page6/">

    <link rel="alternate" type="application/rss+xml" title="" href="http://172.16.7.177:4000/feed.xml">
</head>

    <body>
        <div class="wrapper">
            <aside class="user-profile fixed" role="complementary">
    <div class="burger">
        <input class="trigger hidden" id="toggleBurger" type="checkbox" />
        <label for="toggleBurger">
            <span>Navigation</span>
        </label>
    </div>

    <div class="compact-header">
        <a class="avatar" href="http://172.16.7.177:4000"><img alt="Avatar" src="/assets/img/headshot.jpg" /></a>
        <div class="my-info">
            <strong class="my-name">Chris's Blog</strong>
            <span class="my-job-title">It's called thinking...  go with it!</span>
        </div>
    </div>

    
        
        <div class="mainmenu">
            <a href="http://172.16.7.177:4000" >Home</a>
            
                
            
                
            
                
                    <a href="http://172.16.7.177:4000/contact/" >Contact</a>
                
            
                
                    <a href="http://172.16.7.177:4000/about/" >About</a>
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
        </div>
        
    
    
    <div>
    	<img src="/assets/img/mvp.png" style="width:181px;height:74px;">
    </div>

    <p class="about-me"> </p>
    
    <ul class="socials">
        <li><a href="https://twitter.com/chrisgoosen" target="_blank"><svg title="twitter" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li><li><a href="https://www.linkedin.com/in/ctgoosen/" target="_blank"><svg title="linkedin" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#linkedin-icon"></use></svg></a></li><li><a href="https://github.com/cgoosen" target="_blank"><svg title="github" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#github-icon"></use></svg></a></li>

        
            <li><a href="/contact" target="_blank"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#email-icon"></use></svg></a></li>
        

        
         <li><a href="http://feeds.cgoosen.com/cgoosen"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#rss-icon"></use></svg></a></li>
        
    </ul>
</aside>


            <main class="the-content" role="main">
                <div class="search" role="search">
    <div>
        <div class="show-results-count">0 Results</div>
        <div class="search-holder">
            <input type="text" id="search-input" placeholder="search for..." />
        </div>
    </div>
    <ul id="results-container" class="results-container"></ul>
</div>


                
<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2015-05-30T10:30:53-05:00" itemprop="datePublished">30 May, 2015</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2015/05/script-get-azcopygui-ps1">Script: Get-AZCopyGUI.ps1 - AZCopy GUI for PST Import</a></h2>
    </header>

    <div class="post-content">
        <p>Microsoft <a href="http://blogs.office.com/2015/05/07/making-email-archive-migration-easier-with-the-office-365-import-service/" target="_blank">recently announced the new Office 365 Import Service</a> which is currently in preview. The new service allows organizations to import legacy PST data using one of two methods:</p>
<ul>
<li>Drive shipping &ndash; you send Microsoft a hard drive with your data.</li>
<li>Network Upload &ndash; you make use of Azure storage to upload your data to Office 365.</li>
</ul>
<p>The network upload option makes use of the Microsoft Azure AZCopy tool which uploads your data to an Azure storage blob. <a href="http://www.c7solutions.com/2015/05/using-office-365-pst-ingestion-service" target="_blank">Brian Reid has a great post on his blog about using the service.</a></p>
<p>Get-AZCopyGUI.ps1 is a GUI wrapper for the Microsoft Azure AZCopy tool (AZCopy.exe) to simplify the process of importing .PSTs into Exchange Online. To use the script, you need to locate your storage account key and upload URL. You can do this by accessing the &ldquo;Import&rdquo; menu item in the Office 365 Admin Center. To access this option, you need to be assigned the Mailbox Import Export role in Exchange Online.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/06/post1.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="post1" src="http://www.cgoosen.com/wp-content/uploads/2015/06/post1_thumb.png" alt="post1" width="533" height="453" border="0" /></a></p>
<p align="left">For more information on the Office 365 Import Service, <a href="https://technet.microsoft.com/en-us/library/dn948519%28v=exchg.150%29.aspx" target="_blank">see the following TechNet documentation.</a></p>
<p><strong>Requirements:</strong></p>
<ul>
<li>The script will work natively in PowerShell 2.0+</li>
<li>The script requires the Microsoft Azure AZCopy Tool with default installation path - <a href="http://aka.ms/downloadazcopy">get it here</a></li>
</ul>
<p><strong>Usage:</strong><br />
There are no parameters or switches, simply execute the script:</p>
<p>[shell].\Get-AZCopyGUI.ps1[/shell]</p>
<p>When using the Verbose option, a log file is named AzCopyVerbose.log will be created in %LocalAppData%\Microsoft\Azure\AzCopy if no "Log Location" is specified.</p>
<p><strong>Execution Policy:<br />
</strong>The script has been digitally signed and will run just fine under a "RemoteSigned" execution policy.</p>
<p><strong>Screenshots:</strong></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/05/Capture.png"><img class="aligncenter  wp-image-1395" src="http://www.cgoosen.com/wp-content/uploads/2015/05/Capture-300x221.png" alt="Get-AzcopyGUI" width="526" height="387" /></a></p>
<p><strong>Download:<br />
</strong>I have published it to the TechNet Gallery, <a href="http://cgoo.se/1Qnxtfg" target="_blank">it can be downloaded by clicking here...</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Script: Get-AZCopyGUI.ps1 - AZCopy GUI for PST Import&p[summary]=Microsoft recently announced the new Office 365 Import Service which is currently in preview. The new service allows organizations to imp...&p[url]=http://172.16.7.177:4000/2015/05/script-get-azcopygui-ps1" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2015/05/script-get-azcopygui-ps1&text=Microsoft recently announced the new Office 365 Import Service which is currently in preview. The new service allows organizations to imp...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2015-04-29T05:50:10-05:00" itemprop="datePublished">29 Apr, 2015</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2015/04/user-powershell-to-bulk-email-your-users">Using PowerShell to bulk email your users</a></h2>
    </header>

    <div class="post-content">
        <p>I was recently working on a migration project with a customer and volunteered to help find a solution to a challenge the Organizational Change Management (OCM) team were facing. The OCM team had been communicating with the business to keep them informed about the upcoming changes and what impact these changes would have on their day to day operations. This communication had all taken place via email and they now needed to send out a new notification to several thousand users that contained specific information that would be different for each recipient. Since this was a single-use scenario and all recipients were internal users, they were not terribly interested in investing in a third-party application or service to do this so we decided to explore other options.</p>
<p><a href="http://www.ehloworld.com/175" target="_blank">Inspired by Pat Richard&rsquo;s &ldquo;New-WelcomeEmail.ps1&rdquo; script</a>, I figured it would be pretty easy to achieve this using a PowerShell script and .CSV input file, it works great! To illustrate this, I&rsquo;ll use the fictitious example of gooseLabs, Inc who are relocating to a new office building and would like to send a notification email to all their users that contains their new desk location and phone number. The first and most important step is to ensure that you have an accurate input file. For this particular scenario, the input file looks something like this:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/04/1.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="1" src="http://www.cgoosen.com/wp-content/uploads/2015/04/1_thumb.png" alt="1" width="453" height="364" border="0" /></a></p>
<p align="left">Once we have our input file created, we can use the magic of PowerShell to generate our notifications using this data. The following script imports the .CSV file and generates a simple email notification that is then sent to everyone in the list:</p>
<p>[powershell]<br />
# Function to create report email<br />
function SendNotification{<br />
 $Msg = New-Object Net.Mail.MailMessage<br />
 $Smtp = New-Object Net.Mail.SmtpClient($ExchangeServer)<br />
 $Msg.From = $FromAddress<br />
 $Msg.To.Add($ToAddress)<br />
 $Msg.Subject = "Announcement: Important information about your office relocation."<br />
 $Msg.Body = $EmailBody<br />
 $Msg.IsBodyHTML = $true<br />
 $Smtp.Send($Msg)<br />
}</p>
<p># Define local Exchange server info for message relay. Ensure that any servers running this script have permission to relay.<br />
$ExchangeServer = "yourexchange.domain.com"<br />
$FromAddress = "Office Relocation Team <relocation@domain.com>"</p>
<p># Import user list and information from .CSV file<br />
$Users = Import-Csv UserList.csv</p>
<p># Send notification to each user in the list<br />
Foreach ($User in $Users) {<br />
 $ToAddress = $User.Email<br />
 $Name = $User.FirstName<br />
 $Level = $User.Level<br />
 $DeskNum = $User.DeskNumber<br />
 $PhoneNum = $User.PhoneNumber<br />
 $EmailBody = @"<br />
 <html><br />
 <head><br />
 </head><br />
 <body></p>
<p>Dear $Name,</p>
<p>As you know we will be relocating to our new offices at 742 Evergreen Terrace, Springfield on July 1, 2015. This email contains important information to help you get settled as quickly as possible.</p>
<p>Your existing access card will grant you access to the new building and your desk location is as follows:</p>
<p><strong>Level:</strong> $Level<br />
 <strong>Desk Number:</strong> $DeskNum<br />
 <strong>Phone Number:</strong> $PhoneNum</p>
<p>Your new phone will be connected and ready for use when you arrive.</p>
<p>If you require any assistance during the move please contact the relocation helpdesk at relocation@gooselabs.net or by calling 555-555-1234</p>
<p>Regards,</p>
<p>Office Relocation Team</p>
<p> </body><br />
 </html><br />
"@<br />
 Write-Host "Sending notification to $Name ($ToAddress)" -ForegroundColor Yellow<br />
 SendNotification<br />
}<br />
[/powershell]</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/04/2.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="2" src="http://www.cgoosen.com/wp-content/uploads/2015/04/2_thumb.png" alt="2" width="500" height="369" border="0" /></a></p>
<p align="left">The resulting notification looks like this:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/04/3.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="3" src="http://www.cgoosen.com/wp-content/uploads/2015/04/3_thumb.png" alt="3" width="600" height="238" border="0" /></a></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/04/4.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="4" src="http://www.cgoosen.com/wp-content/uploads/2015/04/4_thumb.png" alt="4" width="600" height="238" border="0" /></a></p>
<p align="left">This method could also be used to distribute other information, like temporary passwords prior to a <a href="https://technet.microsoft.com/en-us/library/jj898490%28v=exchg.150%29.aspx" target="_blank">Cutover Exchange Migration.</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Using PowerShell to bulk email your users&p[summary]=I was recently working on a migration project with a customer and volunteered to help find a solution to a challenge the Organizational C...&p[url]=http://172.16.7.177:4000/2015/04/user-powershell-to-bulk-email-your-users" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2015/04/user-powershell-to-bulk-email-your-users&text=I was recently working on a migration project with a customer and volunteered to help find a solution to a challenge the Organizational C...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2015-03-31T08:47:22-05:00" itemprop="datePublished">31 Mar, 2015</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2015/03/using-azure-scheduler-to-feed-your-pets-sort-of">Using Azure Scheduler to feed your pets (sort of)</a></h2>
    </header>

    <div class="post-content">
        <p>One of the things I learned shortly after we adopted our cat Kensington is that he doesn&rsquo;t care too much about my sleeping habits, if he&rsquo;s hungry he&rsquo;ll happily let us know. I don&rsquo;t have kids and having to wake up in the early hours of the morning to feed a hungry cat was a troubling proposition so I thought I'd&nbsp;find a better way. After some thought, I decided we needed a automated pet feeder but I wasn&rsquo;t able to find a commercially available one that met my criteria so I had to make my own which ended up being a really fun project.</p>
<p>My pet feeder had the following requirements:</p>
<ul>
<li>It had to be internet enabled</li>
<li>It needed Wi-Fi connectivity so it could be more portable</li>
<li>It needed to be small and not an eyesore</li>
<li>It needed to support scheduling as well as&nbsp;manual operation</li>
</ul>
<p>I found a few ideas online (it seems my situation isn&rsquo;t unique!) but yet again none of them met my criteria. After a lot of thought, I settled on a design that I thought would be functional and give me the flexibility that I was looking for and off I went to Home Depot to get the material. I ended up with a few lengths of PVC piping of varying sizes and a polycarbonate sheet. For the electronic brain of the feeder I used the following:</p>
<ul>
<li><a href="https://store.spark.io/?product=spark-core" target="_blank">1 x Spark Core</a> (Wi-Fi development board)</li>
<li>1 x Continuous Rotation Servo</li>
<li>1 x Green LED (Feed indicator)</li>
<li>1 x Red LED (Power indicator)</li>
<li>1 x Glue stick (to create a cheap linear actuator)</li>
<li>2 x resistors, some leads and a mini breadboard</li>
</ul>
<p>The idea is that cat food is deposited in the top part of the feeder, the Spark Core drives the actuator which lowers and then raises a platform inside the main pipe chamber. Lowering the actuator exposes the opening &lsquo;elbow&rsquo; in the middle section of the feeder and the food then falls down the smaller section of pipe and is deposited in the bowl. I wanted to ensure that only&nbsp;1-2 cups of food is dispensed and was able to do this by tweaking how wide of an opening is created when the actuator is lowered and how long it is kept open for. To remove any guessing, I added some LEDs to show me what was happening at all times. The red LED is always lit when the feeder is powered on and the green LED only lights up during a feed operation. I played around with various designs for the platform that moves up and down inside the main chamber and ended up creating an angular platform.&nbsp;Here are some pictures of the feeder:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/03/DPP_0002.jpg"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="DPP_0002" src="http://www.cgoosen.com/wp-content/uploads/2015/03/DPP_0002_thumb.jpg" alt="DPP_0002" width="500" height="333" border="0" /></a></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/03/DPP_0003.jpg"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="DPP_0003" src="http://www.cgoosen.com/wp-content/uploads/2015/03/DPP_0003_thumb.jpg" alt="DPP_0003" width="500" height="333" border="0" /></a></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/03/DPP_0005.jpg"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="DPP_0005" src="http://www.cgoosen.com/wp-content/uploads/2015/03/DPP_0005_thumb.jpg" alt="DPP_0005" width="500" height="333" border="0" /></a></p>
<p align="left">Operating the feeder is done by interacting with the Spark Core via the Spark API. Before this can be done, the board first has to have the relevant operating instructions flashed to it and I put together the following to achieve this:</p>
<p>[shell]<br />
Servo myServo;&nbsp; // create servo object to control a servo<br />
int redLed = D0; // red power LED on pin D0<br />
int greenLed = D1; //green feed LED on pin D1</p>
<p>void setup()<br />
{<br />
myServo.attach(A0);&nbsp; // attaches the servo on the pin A0</p>
<p>Spark.function("feed", feedKenny);&nbsp;&nbsp; // register the function</p>
<p>pinMode(redLed, OUTPUT);<br />
pinMode(greenLed, OUTPUT);<br />
}</p>
<p>void loop()<br />
{<br />
digitalWrite(redLed, HIGH); // red LED always on<br />
}</p>
<p>int feedKenny(String command)&nbsp; //called upon a matching POST request<br />
{<br />
digitalWrite(greenLed, HIGH); // turn on green LED when feeding<br />
myServo.writeMicroseconds(1000);<br />
delay(7500);<br />
myServo.writeMicroseconds(1500);<br />
delay(2500);<br />
myServo.writeMicroseconds(2000);<br />
delay(7500);<br />
myServo.writeMicroseconds(1500);<br />
digitalWrite(greenLed, LOW); // turn off green LED<br />
return 200;<br />
}<br />
[/shell]</p>
<p>Once the Spark Core is connected to the Wi-Fi network and the application code has been flashed you can interact with it using a regular HTTP POST. For testing, you can use PowerShell and Invoke-RestMethod to do this:</p>
<p>[ps]<br />
Invoke-RestMethod -Uri 'https://api.spark.io/v1/devices/YOUR-DEVICE-ID/FUNCTION?access_token=YOUR-TOKEN' -Method Post<br />
[/ps]</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/03/pscap.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="pscap" src="http://www.cgoosen.com/wp-content/uploads/2015/03/pscap_thumb.png" alt="pscap" width="550" height="128" border="0" /></a></p>
<p align="left">PowerShell is great for testing, but not very practical for daily use, fortunately this is easily remedied with a few lines for HTML code. I created a very simple form and put it on web server on my home network. This page is not secured and is only accessible when I&rsquo;m on my home network.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/03/wp_ss_20150331_00021.jpg"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="wp_ss_20150331_0002" src="http://www.cgoosen.com/wp-content/uploads/2015/03/wp_ss_20150331_0002_thumb1.jpg" alt="wp_ss_20150331_0002" width="220" height="387" border="0" /></a></p>
<p align="left">Scheduling regular feeding times is really easy with <a href="http://azure.microsoft.com/en-us/services/scheduler/" target="_blank">Azure Scheduler.</a> Sign in to your Azure subscription and click &lsquo;Scheduler&rsquo;</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/03/sched1.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="sched1" src="http://www.cgoosen.com/wp-content/uploads/2015/03/sched1_thumb.png" alt="sched1" width="550" height="115" border="0" /></a></p>
<p align="left">Create a new Job Collection and give it a meaningful name</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2015/03/image.png"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2015/03/image_thumb.png" alt="image" width="240" height="223" border="0" /></a></p>
<p align="left">The wizard will also give you&nbsp;the option of creating your first Job. Since the Spark API requires a HTTPS POST, be sure to select that option and schedule it accordingly</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/03/sched2.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="sched2" src="http://www.cgoosen.com/wp-content/uploads/2015/03/sched2_thumb.png" alt="sched2" width="228" height="240" border="0" /></a></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/03/sched3.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="sched3" src="http://www.cgoosen.com/wp-content/uploads/2015/03/sched3_thumb.png" alt="sched3" width="240" height="230" border="0" /></a></p>
<p align="left">Once the wizard completes, you can add more Jobs to the Job Collection as appropriate:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/03/sched4.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="sched4" src="http://www.cgoosen.com/wp-content/uploads/2015/03/sched4_thumb.png" alt="sched4" width="240" height="48" border="0" /></a></p>
<p align="left">Here is a quick demonstration of how the feeder works:</p>
<p>[embed]https://www.youtube.com/watch?v=O226R01mmD0[/embed]</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Using Azure Scheduler to feed your pets (sort of)&p[summary]=One of the things I learned shortly after we adopted our cat Kensington is that he doesn&rsquo;t care too much about my sleeping habits, ...&p[url]=http://172.16.7.177:4000/2015/03/using-azure-scheduler-to-feed-your-pets-sort-of" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2015/03/using-azure-scheduler-to-feed-your-pets-sort-of&text=One of the things I learned shortly after we adopted our cat Kensington is that he doesn&rsquo;t care too much about my sleeping habits, ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2015-02-24T03:00:00-06:00" itemprop="datePublished">24 Feb, 2015</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2015/02/using-a-certificate-to-encrypt-credentials-in-automated-powershell-scripts">Using a certificate to encrypt credentials in automated PowerShell scripts</a></h2>
    </header>

    <div class="post-content">
        <p>PowerShell is a great way to help automate frequent or repetitive tasks and every now and then these tasks require some form of authentication. You could just store the service account password in the script, but I&rsquo;m really not a fan of doing that and I&rsquo;m sure you&rsquo;d agree it really isn&rsquo;t a very good way to do it. I was working on a script recently which was to be scheduled to run at various times by different service accounts on different servers so I wanted a way to ensure that a single copy of the script could be portable to any server and would still securely connect to Exchange with the correct permissions no matter which service account actually executed the script. Remotely connecting to Exchange/Exchange Online via PowerShell isn&rsquo;t difficult to do and you could just use <em>Get-Credential</em> cmdlet with <em>ConvertFrom-SecureString</em> and <em>Set-Content </em>to securely save your password to file which could then be read by your script without subsequent intervention. The trouble with this solution is that it isn&rsquo;t very portable and that password can only be ready by the user that created the file so it will work great if you used it only on your own machine, but not so well when trying to distribute it to a bunch of servers as a scheduled job. I wanted a solution that would use a particular certificate to decrypt a password stored in the script, in that way if the script was executed on a machine that did not have my certificate installed it would not be able to decrypt the password and would fail. I ended up creating an encrypted password using the public key of a certificate and storing that in the script, the only way to decrypt that password is with the private key of the same certificate. Let&rsquo;s look at this in more detail.</p>
<p>The first component of the solution is a certificate. Since I already had access to a internal Windows CA, I wanted to use a certificate signed by that CA but I also tested it with a self-signed certificate that was generated using &ldquo;makecert.exe&rdquo;. <span style="background-color: #ffffff;">PowerShell 4.0 </span>includes a <a href="https://technet.microsoft.com/en-us/library/hh848633.aspx" target="_blank"><em>New-SelfSignedCertificate</em></a> cmdlet that makes generating a self-signed certificate really easy, but for some reason I wasn&rsquo;t able to use one of those certificates for encryption (more specifically the decryption would not work) and since I planned to use a CA signed certificate anyway I didn&rsquo;t spend a whole lot of time trying to figure it out. The key thing to remember is that you need to install the certificate AND the private key, the certificate doesn&rsquo;t have to be trusted. I decided to create a new certificate template for my &ldquo;Script Authentication&rdquo; certificate by duplicating the &ldquo;Web Server&rdquo; template and making a few changes to it.</p>
<p align="left">Firstly, launch the <span style="background-color: #ffffff;">Certification Authority MMC</span><span style="background-color: #ffffff;">, loca</span>te &ldquo;Certificate Templates&rdquo;, right-click and select &ldquo;Manage&rdquo;</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture1.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture1" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture1_thumb.png" alt="Capture1" width="450" height="294" border="0" /></a></p>
<p>Next, locate the &ldquo;Web Server&rdquo; template, right-click and select &ldquo;Duplicate Template&rdquo;</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture2.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture2" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture2_thumb.png" alt="Capture2" width="450" height="169" border="0" /></a></p>
<p align="left">I called my new template &ldquo;Script Authentication&rdquo;</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture3.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture3" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture3_thumb.png" alt="Capture3" width="504" height="686" border="0" /></a></p>
<p align="left">And you need to ensure that you &ldquo;Allow private key to be exported&rdquo;. Once done, apply those changes.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture4.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture4" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture4_thumb.png" alt="Capture4" width="504" height="686" border="0" /></a></p>
<p align="left">We then need to <span style="background-color: #ffffff;">publish the new template</span> to ensure that it can be used when requesting a new certificate. <span style="background-color: #ffffff;">Right-click</span> &ldquo;Certificate Templates&rdquo;, select &ldquo;New&rdquo; and then &ldquo;Certificate Template to Issue&rdquo; and select your newly created template from the list</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture5.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture5" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture5_thumb.png" alt="Capture5" width="550" height="353" border="0" /></a></p>
<p align="left">Once done, you should be able to create and submit an advanced certificate request using the newly created template directly on your CA. You are not required to complete all the fields, but it is useful to give your certificate a descriptive name. I called mine &ldquo;PowerShell Automation&rdquo;.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture6.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture6" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture6_thumb.png" alt="Capture6" width="550" height="810" border="0" /></a></p>
<p>Once you have the installed the certificate, you can export it (don&rsquo;t forget the private key) for use on other machines.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture8.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture8" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture8_thumb.png" alt="Capture8" width="550" height="529" border="0" /></a></p>
<p>I recommend storing it in a safe place and not marking the private key as exportable when moving it around, in this way you have some control over which machines can actually decrypt the password in your script.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture9.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture9" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture9_thumb.png" alt="Capture9" width="550" height="529" border="0" /></a></p>
<p>Here&rsquo;s what my certificate looks like</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture7.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture7" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture7_thumb.png" alt="Capture7" width="500" height="622" border="0" /></a></p>
<p>I decided to store my certificate in the computer store, it probably doesn&rsquo;t matter where you store it but you would need to update the following PowerShell cmdlets appropriately. If you are going to have multiple service accounts executing your script, you need to ensure that all these accounts have permission<span style="background-color: #ffff00;"><span style="background-color: #ffffff;"> to read the private key. </span></span><span style="background-color: #ffffff;">This</span> is done by right-clicking the certificate, selecting &ldquo;All Tasks&rdquo; and then &ldquo;Manage Private Keys&rdquo;.</p>
<p>We can use the <em>Get-ChildItem</em> cmdlet to locate our certificate:</p>
<p>[powershell]Get-ChildItem Cert:\LocalMachine\My | Where-Object {$_.Subject -like "CN=PowerShell Automation*"}[/powershell]</p>
<p>Next, I need to encrypt my password. To do this, I define the password as a variable, encode it and then encrypt the encoded password using my certificate&rsquo;s public key:</p>
<p>[powershell]<br />
$Cert = Get-ChildItem Cert:\LocalMachine\My | Where-Object {$_.Subject -like "CN=PowerShell Automation*"}<br />
$Password = 'MyPassword'<br />
$EncodedPwd = [system.text.encoding]::UTF8.GetBytes($Password)<br />
$EncryptedBytes = $Cert.PublicKey.Key.Encrypt($EncodedPwd, $true)<br />
$EncryptedPwd = [System.Convert]::ToBase64String($EncryptedBytes)<br />
[/powershell]</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture10.png"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="Capture10" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture10_thumb.png" alt="Capture10" width="550" height="195" border="0" /></a></p>
<p>Now that I have the encrypted password, I can store it in my script and decode it using my certificate&rsquo;s private key each time the script is executed. To do this, I pretty much reverse the process:</p>
<p>[powershell]<br />
$EncryptedPwd = "ts32rCLLdZl3/6wINHtLD6bQO65ub&hellip;.. <shortened for simplicity>"<br />
$EncryptedBytes = [System.Convert]::FromBase64String($EncryptedPwd)<br />
$DecryptedBytes = $Cert.PrivateKey.Decrypt($EncryptedBytes, $true)<br />
$DecryptedPwd = [system.text.encoding]::UTF8.GetString($DecryptedBytes)<br />
[/powershell]</p>
<p>You can build this into any scripts you have that currently require credentials, it works great for automating Office 365/Exchange Online scripting. To illustrate this, I put together a quick (and dirty!) script that can be used to provide an automated daily &ldquo;Top Mail Recipient&rdquo; report via email. This script can be scheduled to run daily and it will connect to Exchange Online, generate a list of the top mail recipients and email that report to the address you specify. It&rsquo;s not very useful as it is, but it does show how easily you could automate things using PowerShell and serves as a great example for certificate password encryption.</p>
<p>[powershell]<br />
# Function to create report email<br />
function SendReport{<br />
 $Msg = New-Object Net.Mail.MailMessage<br />
 $Smtp = New-Object Net.Mail.SmtpClient($ExchangeServer)<br />
 $Msg.From = $FromAddress<br />
 $Msg.To.Add($ToAddress)<br />
 $Msg.Subject = "Top Mail Recipient Report for $Date"<br />
 $Msg.Body = $EmailBody<br />
 $Msg.IsBodyHTML = $true<br />
 $Smtp.Send($Msg)<br />
}</p>
<p># Define local Exchange server info for message relay. Ensure that any servers running this script have permission to relay.<br />
$ExchangeServer = "yourexchange.domain.com"<br />
$FromAddress = "Office 365 Reports <reports@yourdomain.com>"<br />
$ToAddress = "you@yourdomain.com"</p>
<p># Some basic HTML styling<br />
$Header = "<br />
<style>"<br />
$Header = $Header + "BODY{background-color:#FFFFFF}"<br />
$Header = $Header + "TABLE{border-width: 1px;border-style: solid;border-color: black;border-collapse: collapse;}"<br />
$Header = $Header + "TH{border-width: 1px;padding: 0px;border-style: solid;border-color: black;background-color:#BDBDBD}"<br />
$Header = $Header + "TD{border-width: 1px;padding: 0px;border-style: solid;border-color: black}"<br />
$Header = $Header + "</style>
<p>"</p>
<p># Connect to Exchange Online<br />
# First decrypt the password using the certificate<br />
$Cert = Get-ChildItem Cert:\LocalMachine\My | Where-Object {$_.Subject -like "CN=PowerShell Automation*"}<br />
$EncryptedPwd = "ts32rCLLdZl3/6wINHtLD6bQO65ubeQ3sHj9zXbhsaQDjihQmdyoja+iL0NGXQX0DicQdXWQRu+P8dSy96ux1tLQR9ZT8WPRq8rHsR3gNXDmipCK/4CHoc5Ki7nbMKUSReprtIrnwjlXZNBocTzurBQ+LtAHvAYipD37AXVjjpwwwqud5HCXk+E4OrJGe+yIx/87neRAunqdKvyuaxUYaxeBdx2R/hpLZhxywinjjVMx+0N2RNk7H3fBEite7uuANcAg+ElAssi4DAQYYDOviIrvbjdpKogKcevAh5xEx4Wm2WBzM5XqXmj1O9TUzB9BOiUVQhDwwqCcUpb2bTNW7g=="<br />
$EncryptedBytes = [System.Convert]::FromBase64String($EncryptedPwd)<br />
$DecryptedBytes = $Cert.PrivateKey.Decrypt($EncryptedBytes, $true)<br />
$DecryptedPwd = [system.text.encoding]::UTF8.GetString($DecryptedBytes) | ConvertTo-SecureString -AsPlainText -Force<br />
# Then define Credentials and create session<br />
$Username = "account@yourdomain.onmicrosoft.com"<br />
$Credential = New-Object System.Management.Automation.PSCredential ($Username,$DecryptedPwd)<br />
$Session = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri https://outlook.office365.com/powershell-liveid/ -Credential $Credential -Authentication Basic -AllowRedirection<br />
Import-PSSession $Session</p>
<p># Generate report data<br />
$Date = Get-Date -DisplayHint Date<br />
$EmailBody = Get-MailTrafficSummaryReport -Category TopMailRecipient | select @{expression={$_.C1};label=&rdquo;User&rdquo;}, @{expression={$_.C2};label=&rdquo;Item Count&rdquo;} | ConvertTo-HTML -head $Header -body "<H2>Top Mail Recipient Report</H2>"</p>
<p># Send report<br />
SendReport<br />
[/powershell]</p>
<p>Here is an example of what the final result looks like:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture11.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture11" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture11_thumb.png" alt="Capture11" width="600" height="448" border="0" /></a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Using a certificate to encrypt credentials in automated PowerShell scripts&p[summary]=PowerShell is a great way to help automate frequent or repetitive tasks and every now and then these tasks require some form of authentic...&p[url]=http://172.16.7.177:4000/2015/02/using-a-certificate-to-encrypt-credentials-in-automated-powershell-scripts" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2015/02/using-a-certificate-to-encrypt-credentials-in-automated-powershell-scripts&text=PowerShell is a great way to help automate frequent or repetitive tasks and every now and then these tasks require some form of authentic...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2015-01-21T04:06:49-06:00" itemprop="datePublished">21 Jan, 2015</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2015/01/mail-protection-reports-for-office-365">Mail Protection Reports for Office 365</a></h2>
    </header>

    <div class="post-content">
        <p>One of the great things about Office 365 is how flexible the service is, it caters to those organizations who are looking for a service that just works out of the box as well as those who are looking to get stuck in there and really take things to the next level. A perfect example of this is a recent experience I had with one of my customers. This particular customer was looking to do some specific email reporting and after discussing their options, I thought it would be a good idea to put together this post.</p>
<p>There are a number of options available when it comes to reporting in Office 365. Firstly, the Office 365 admin center provides a number of pre-configured reports and while these are gorgeous looking reports, they may not always provide the level of detail you are looking for. You also have the option of rolling your own with the <a href="https://msdn.microsoft.com/EN-US/library/office/jj984342(v=office.15).aspx" target="_blank">Office 365 Reporting web service</a> but this requires some coding and depending on your requirements may end up being overkill. There is however a great option that falls nicely in the middle of these in the form of an Excel based reporting workbook called <a href="http://www.microsoft.com/en-us/download/details.aspx?id=30716" target="_blank">&ldquo;Mail Protection Reports for Office 365&rdquo;.</a> This reporting workbook isn&rsquo;t new, I remember first using it in a demo for an EOP session I presented at Office 365 Ignite in Sydney, Australia in late 2013 so it has been around for a while, but I&rsquo;m surprised how little press it gets.</p>
<p>The workbook allows you to query specific date ranges and you can then filter and customize how the information is displayed. It provides spam, malware, transport rule and DLP reporting. Here are some examples:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/01/cap1.png"><img class="aligncenter size-full wp-image-1275" src="http://www.cgoosen.com/wp-content/uploads/2015/01/cap1.png" alt="cap1" width="425" height="211" /></a> <a href="http://www.cgoosen.com/wp-content/uploads/2015/01/cap2.png"><img class="aligncenter size-full wp-image-1276" src="http://www.cgoosen.com/wp-content/uploads/2015/01/cap2.png" alt="cap2" width="1191" height="555" /></a> <a href="http://www.cgoosen.com/wp-content/uploads/2015/01/cap3.png"><img class="aligncenter size-full wp-image-1277" src="http://www.cgoosen.com/wp-content/uploads/2015/01/cap3.png" alt="cap3" width="1178" height="758" /></a> <a href="http://www.cgoosen.com/wp-content/uploads/2015/01/cap4.png"><img class="aligncenter size-full wp-image-1278" src="http://www.cgoosen.com/wp-content/uploads/2015/01/cap4.png" alt="cap4" width="1133" height="816" /></a></p>
<p align="left">The reporting workbook ended up being a perfect fit for their specific scenario. It is really simple to use and doesn&rsquo;t require the use of PowerShell or any custom coding. You can download the <a href="http://www.microsoft.com/en-us/download/details.aspx?id=30716" target="_blank">Mail Protection Reports for Office 365 workbook here.</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Mail Protection Reports for Office 365&p[summary]=One of the great things about Office 365 is how flexible the service is, it caters to those organizations who are looking for a service t...&p[url]=http://172.16.7.177:4000/2015/01/mail-protection-reports-for-office-365" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2015/01/mail-protection-reports-for-office-365&text=One of the great things about Office 365 is how flexible the service is, it caters to those organizations who are looking for a service t...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2015-01-08T22:38:04-06:00" itemprop="datePublished">8 Jan, 2015</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2015/01/the-newish-outlook-for-mac-for-office-365-subscribers">The new(ish) Outlook for Mac (for Office 365 subscribers)</a></h2>
    </header>

    <div class="post-content">
        <p>I&rsquo;ve been dying to take the new Outlook for Mac (for Office 365 subscribers) for a test drive ever since <a href="http://blogs.office.com/2014/10/31/new-outlook-mac-available-office-365-customers/" target="_blank">I saw the announcement late last year</a>. Having used both Entourage and Outlook for Mac 2011 in the past, I was excited to see what improvements the new version would bring. Let&rsquo;s be honest, as good as they were, both the previous iterations were miles behind the Windows version of Outlook (which I live in daily). </p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/01/1.png"><img title="1" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="1" src="http://www.cgoosen.com/wp-content/uploads/2015/01/1_thumb.png" width="259" height="309"></a> </p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/01/2.png"><img title="2" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="2" src="http://www.cgoosen.com/wp-content/uploads/2015/01/2_thumb.png" width="428" height="370"></a> </p>
<p align="left">While I haven&rsquo;t spent an extended period of time using the new Outlook for Mac, I have to say I actually love it so far and I think it is safe to say that Outlook for Mac is no longer the poor cousin. I am really looking forward to the release of the next Office for Mac!</p>
<p>The new Outlook for Mac is currently only available to Office 365 commercial customers, Office 365 Home, Office 365 Personal and Office 365 University subscribers while the release of the next version of Office for Mac is currently planned for the second half of 2015.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=The new(ish) Outlook for Mac (for Office 365 subscribers)&p[summary]=I&rsquo;ve been dying to take the new Outlook for Mac (for Office 365 subscribers) for a test drive ever since I saw the announcement lat...&p[url]=http://172.16.7.177:4000/2015/01/the-newish-outlook-for-mac-for-office-365-subscribers" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2015/01/the-newish-outlook-for-mac-for-office-365-subscribers&text=I&rsquo;ve been dying to take the new Outlook for Mac (for Office 365 subscribers) for a test drive ever since I saw the announcement lat...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-12-09T07:54:23-06:00" itemprop="datePublished">9 Dec, 2014</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2014/12/exchange-updates-december-2014">Exchange Updates &ndash; December 2014</a></h2>
    </header>

    <div class="post-content">
        <p>Earlier today <a href="http://blogs.technet.com/b/exchange/archive/2014/12/09/exchange-releases-december-2014.aspx" target="_blank">Microsoft announced the release of Exchange 2013 CU7, Exchange 2010 SP3 RU8 and Exchange 2007 SP3 RU15.</a> In addition to fixes for customer reported issues and minor feature improvements they also include a security update to address elevation of privilege vulnerabilities in these versions of Exchange. More information about the vulnerabilities can be found in <a href="https://technet.microsoft.com/en-us/library/security/ms14-075.aspx" target="_blank">Microsoft Security Bulletin MS14-075.</a> Tony Redmond has also written a <a href="http://windowsitpro.com/blog/exchange-2013-cu7-debuts-along-security-fixes-and-updates-exchange-2010-and-exchange-2007" target="_blank">great post about Exchange 2013 CU7 here.</a></p>
<p>The updates can be downloaded at the following links:</p>
<ul>
<li><a href="http://www.microsoft.com/en-us/download/details.aspx?id=45221" target="_blank">Exchange Server 2013 Cumulative Update 7</a></li>
<li><a href="http://www.microsoft.com/en-us/download/details.aspx?id=45215" target="_blank">UM Language Packs for Cumulative Update 7</a></li>
<li><a href="http://www.microsoft.com/en-us/download/details.aspx?id=45225" target="_blank">Exchange Server 2010 SP3 Update Rollup 8</a></li>
<li><a href="http://www.microsoft.com/en-us/download/details.aspx?id=45269" target="_blank">Exchange Server 2007 SP3 Update Rollup 15</a></li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange Updates &ndash; December 2014&p[summary]=Earlier today Microsoft announced the release of Exchange 2013 CU7, Exchange 2010 SP3 RU8 and Exchange 2007 SP3 RU15. In addition to fixe...&p[url]=http://172.16.7.177:4000/2014/12/exchange-updates-december-2014" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2014/12/exchange-updates-december-2014&text=Earlier today Microsoft announced the release of Exchange 2013 CU7, Exchange 2010 SP3 RU8 and Exchange 2007 SP3 RU15. In addition to fixe...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-11-21T06:36:14-06:00" itemprop="datePublished">21 Nov, 2014</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2014/11/script-fix-proxyaddress-ps1">Script: Fix-ProxyAddress.ps1</a></h2>
    </header>

    <div class="post-content">
        <p><a href="http://www.cgoosen.com/2014/11/migrationpermanentexception-the-target-mailbox-doesnt-have-an-smtp-proxy-matching-company-mail-onmicrosoft-com/" target="_blank">I recently blogged about</a> the "<span style="color: #ff0000;"><em>MigrationPermanentException: The target mailbox doesn't have an SMTP proxy matching 'company.mail.onmicrosoft.com'.</em></span><span style="color: #000000;">" error message that occurs when attempting to perform a remote mailbox move for a user that doesn&rsquo;t have the correct SMTP proxy address. I put together a script to help simplify the process of adding the relevant SMTP proxy address to effected users.</span></p>
<p>Once launched, the script will prompt for your tenant routing domain in the format 'company.mail.onmicrosoft.com' and will search for all mailboxes in the organization that do not have an email address policy applied. A new SMTP proxy address will be added to all mailboxes without an email address policy. The proxy address will be based on the alias of the primary SMTP address and the routing domain entered, e.g if the primary SMTP address is john.smith@company.com and the routing domain entered is company.mail.onmicrosoft.com the resulting proxy address will be john.smith@company.mail.onmicrosoft.com.</p>
<p><strong>Requirements: </strong>This script has been tested and is known to work with Exchange 2010 and Exchange 2013.</p>
<p><strong>Usage:</strong> There are no parameters or switches, simply execute the script:</p>
<p>[shell].\Fix-ProxyAddress.ps1[/shell]</p>
<p><strong>Execution Policy: </strong>The script has been digitally signed and will run just fine under a "RemoteSigned" execution policy.</p>
<p><strong>Screenshots:</strong></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/11/script1.png"><img style="display: inline; border-width: 0px;" title="script1" src="http://www.cgoosen.com/wp-content/uploads/2014/11/script1_thumb.png" alt="script1" width="240" height="220" border="0" /></a></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/11/script2.png"><img style="display: inline; border-width: 0px;" title="script2" src="http://www.cgoosen.com/wp-content/uploads/2014/11/script2_thumb.png" alt="script2" width="476" height="167" border="0" /></a></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/11/script3.png"><img style="display: inline; border-width: 0px;" title="script3" src="http://www.cgoosen.com/wp-content/uploads/2014/11/script3_thumb.png" alt="script3" width="476" height="163" border="0" /></a></p>
<p><strong>Download: </strong>I have published it to the TechNet Gallery, <a href="http://cgoo.se/1xXvNCZ" target="_blank">it can be downloaded by clicking here...</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Script: Fix-ProxyAddress.ps1&p[summary]=I recently blogged about the "MigrationPermanentException: The target mailbox doesn't have an SMTP proxy matching 'company.mail.onmicroso...&p[url]=http://172.16.7.177:4000/2014/11/script-fix-proxyaddress-ps1" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2014/11/script-fix-proxyaddress-ps1&text=I recently blogged about the "MigrationPermanentException: The target mailbox doesn't have an SMTP proxy matching 'company.mail.onmicroso...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-11-21T04:59:34-06:00" itemprop="datePublished">21 Nov, 2014</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2014/11/migrationpermanentexception-the-target-mailbox-doesnt-have-an-smtp-proxy-matching-company-mail-onmicrosoft-com">MigrationPermanentException: The target mailbox doesn't have an SMTP proxy matching 'company.mail.onmicrosoft.com'.</a></h2>
    </header>

    <div class="post-content">
        <p>One of the most common error message I find when performing mailbox moves to Office 365 &ndash; Exchange Online is the &ldquo;<font color="#ff0000"><em>MigrationPermanentException: The target mailbox doesn't have an SMTP proxy matching 'company.mail.onmicrosoft.com'.</em></font><font color="#000000"><em>&rdquo; </em>error:</font></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/11/Capture41.png"><img title="Capture4" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="Capture4" src="http://www.cgoosen.com/wp-content/uploads/2014/11/Capture4_thumb1.png" width="438" height="166"></a> </p>
<p align="left">The error message is pretty descriptive and is caused when the mailbox being moved doesn&rsquo;t have a proxy address that matches the routing domain. In an Exchange hybrid deployment, the hybrid configuration wizard updates the on-premises email address policies to ensure that all mailboxes have the relevant SMTP proxy address added. This should work fine except in instances when for whatever reason a mailbox or group of mailboxes are not being updated by an email address policy. Typically because the &ldquo;Automatically update email addresses based on the email address policy applied to this recipient&rdquo; has been manually removed:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/11/script41.png"><img title="script4" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="script4" src="http://www.cgoosen.com/wp-content/uploads/2014/11/script4_thumb1.png" width="347" height="259"></a> </p>
<p align="left">There are a couple of ways to fix this, you could just enable the email address policy for those particular mailboxes, but the risk with that option is that it may have been removed for a particular reason. Email address policies are additive only, so while an email address policy will not remove or overwrite an email address, it may change the default SMTP address.</p>
<p align="left">Or, you may want to simply add the relevant SMTP proxy address for those mailboxes, this can easily be done via PowerShell. I have published a PowerShell script to simplify this process, <a href="https://gallery.technet.microsoft.com/Fix-ProxyAddressps1-7036dfa1" target="_blank">check it out on the TechNet Gallery.</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=MigrationPermanentException: The target mailbox doesn't have an SMTP proxy matching 'company.mail.onmicrosoft.com'.&p[summary]=One of the most common error message I find when performing mailbox moves to Office 365 &ndash; Exchange Online is the &ldquo;MigrationPe...&p[url]=http://172.16.7.177:4000/2014/11/migrationpermanentexception-the-target-mailbox-doesnt-have-an-smtp-proxy-matching-company-mail-onmicrosoft-com" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2014/11/migrationpermanentexception-the-target-mailbox-doesnt-have-an-smtp-proxy-matching-company-mail-onmicrosoft-com&text=One of the most common error message I find when performing mailbox moves to Office 365 &ndash; Exchange Online is the &ldquo;MigrationPe...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-10-21T17:22:15-05:00" itemprop="datePublished">21 Oct, 2014</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2014/10/my-session-at-sharepoint-conference-org-2014">My session at SharePoint Conference.ORG 2014</a></h2>
    </header>

    <div class="post-content">
        <p>I had a great time attending and presenting at SharePoint Conference.ORG yesterday. I really enjoyed the great mixture of business, user experience and technical sessions. I presented a &ldquo;Getting started with Office 365&rdquo; session and as promised I am making my slide deck available.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/10/IMG_0972.jpg"><img style="display: inline; border: 0px;" title="IMG_0972" src="http://www.cgoosen.com/wp-content/uploads/2014/10/IMG_0972_thumb.jpg" alt="IMG_0972" width="274" height="236" border="0" /></a></p>
<p align="center">[slideshare id=40574145&amp;doc=gettingstartedwithoffice365-141021225449-conversion-gate01]</p>
<p align="center">Slides <a href="http://cgoo.se/10lgfg1" target="_blank">also available on slideshare</a></p>
<p style="text-align: left;" align="center">For more information about SharePoint Conference .ORG check out <a href="http://www.sharepointconference.org/">http://www.sharepointconference.org/</a> or on twitter: @SPC_ORG</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=My session at SharePoint Conference.ORG 2014&p[summary]=I had a great time attending and presenting at SharePoint Conference.ORG yesterday. I really enjoyed the great mixture of business, user ...&p[url]=http://172.16.7.177:4000/2014/10/my-session-at-sharepoint-conference-org-2014" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2014/10/my-session-at-sharepoint-conference-org-2014&text=I had a great time attending and presenting at SharePoint Conference.ORG yesterday. I really enjoyed the great mixture of business, user ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>




<div class="pagination" role="navigation" aria-label="pagination">
    
        <a href="/page5/" class="previous">&larr; Previous</a>
    

    <span class="page_number">Page 6 of 24</span>

    
        <a href="/page7/" class="next">Next &rarr;</a>
    
</div>

            </main>
        </div>

        <script src="http://172.16.7.177:4000/assets/js/jquery-1.12.2.min.js"></script>
<script src="http://172.16.7.177:4000/assets/js/backtotop.js"></script>
<script src="http://172.16.7.177:4000/assets/js/lunr.min.js"></script>
<script src="http://172.16.7.177:4000/assets/js/lunr-feed.js"></script>
<script src="http://172.16.7.177:4000/assets/js/jquery.fitvids.js"></script>
<script src="http://172.16.7.177:4000/assets/js/svg4everybody.min.js"></script>
<script src="http://172.16.7.177:4000/assets/js/scripts.js"></script>


    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-XXXXXXX-2', 'auto');
        ga('send', 'pageview');
    </script>

        <style>
.lightbox {width: 100%; height: 100%; position: fixed; top: 0; left: 0; background: rgba(0,0,0,0.85); z-index: 9999999; line-height: 0; cursor: pointer;}
.lightbox .img {
	position: relative; 
	top: 50%;
	left: 50%;
	-ms-transform: translateX(-50%) translateY(-50%);
	-webkit-transform: translate(-50%,-50%);
	transform: translate(-50%,-50%);
	max-width: 100%;
	max-height: 100%;
}
.lightbox .img img {opacity: 0; pointer-events: none; width: auto;}
@media screen and (min-width: 1200px) {
    .lightbox .img {
		max-width: 1200px;
    }
}
@media screen and (min-height: 1200px) {
    .lightbox img {
		max-height: 1200px;
	}
}
.lightbox span {display: block; position: fixed; bottom: 13px; height: 1.5em; line-height: 1.4em; width: 100%; text-align: center; color: white; text-shadow:
    -1px -1px 0 #000,
    1px -1px 0 #000,
    -1px 1px 0 #000,
    1px 1px 0 #000;  
}






.lightbox .videoWrapperContainer {
	position: relative; 
	top: 50%;
	left: 50%;
	-ms-transform: translateX(-50%) translateY(-50%);
	-webkit-transform: translate(-50%,-50%);
	transform: translate(-50%,-50%);
	max-width: 900px;
	max-height: 100%;
}
.lightbox .videoWrapperContainer .videoWrapper {
	height: 0;
	line-height: 0;
	margin: 0;
	padding: 0;
	position: relative;
	padding-bottom: 56.333%; /* custom */
	background: black;
} 
.lightbox .videoWrapper iframe {
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
	border: 0;
	display: block;
}   
.lightbox #prev, .lightbox #next {height: 50px; line-height: 36px; display: none; margin-top: -25px; position: fixed; top: 50%; padding: 0 15px; cursor: pointer; text-decoration: none; z-index: 99; color: white; font-size: 60px;}
.lightbox.gallery #prev, .lightbox.gallery #next {display: block;}
.lightbox #prev {left: 0;}
.lightbox #next {right: 0;}
.lightbox #close {height: 50px; width: 50px; position: fixed; cursor: pointer; text-decoration: none; z-index: 99; right: 0; top: 0;}
.lightbox #close:after, .lightbox #close:before {position: absolute; margin-top: 22px; margin-left: 14px; content: ""; height: 3px; background: white; width: 23px;
-webkit-transform-origin: 50% 50%;
-moz-transform-origin: 50% 50%;
-o-transform-origin: 50% 50%;
transform-origin: 50% 50%;
/* Safari */
-webkit-transform: rotate(-45deg);
/* Firefox */
-moz-transform: rotate(-45deg);
/* IE */
-ms-transform: rotate(-45deg);
/* Opera */
-o-transform: rotate(-45deg);
}
.lightbox #close:after {
/* Safari */
-webkit-transform: rotate(45deg);
/* Firefox */
-moz-transform: rotate(45deg);
/* IE */
-ms-transform: rotate(45deg);
/* Opera */
-o-transform: rotate(45deg);
}
.lightbox, .lightbox * {
    -webkit-user-select: none;  
    -moz-user-select: none;    
    -ms-user-select: none;      
    user-select: none;
}
</style>
		
<script>
function is_youtubelink(url) {
  var p = /^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/;
  return (url.match(p)) ? RegExp.$1 : false;
}
function is_imagelink(url) {
	var p = /([a-z\-_0-9\/\:\.]*\.(jpg|jpeg|png|gif))/i;
	return (url.match(p)) ? true : false;
}
function is_vimeolink(url,el) {
	var id = false;
	$.ajax({
	  url: 'https://vimeo.com/api/oembed.json?url='+url,
	  async: true,
	  success: function(response) {
		if(response.video_id) {
		  id = response.video_id;
		  $(el).addClass('lightbox-vimeo').attr('data-id',id);
		}
	  }
	});
}

$(document).ready(function() {
	//add classes to links to be able to initiate lightboxes
	$("a").each(function(){
		var url = $(this).attr('href');
		if(url) {
			if(url.indexOf('vimeo') !== -1 && !$(this).hasClass('no-lightbox')) is_vimeolink(url,$(this));
			if(is_youtubelink(url) && !$(this).hasClass('no-lightbox')) $(this).addClass('lightbox-youtube').attr('data-id',is_youtubelink(url));
			if(is_imagelink(url) && !$(this).hasClass('no-lightbox')) {
				$(this).addClass('lightbox-image');
				var href = $(this).attr('href');
				var filename = href.split('/').pop();
				var split = filename.split(".");
				var name = split[0];
				$(this).attr('title',name);
			}
		}
	});
	//remove the clicked lightbox
	$("body").on("click", ".lightbox", function(event){
		if($(this).hasClass('gallery')) {
			$(this).remove();
			if($(event.target).attr('id')=='next') {
				//next item
				if($("a.gallery.current").nextAll("a.gallery:first").length) $("a.gallery.current").nextAll("a.gallery:first").click();
				else $("a.gallery.current").parent().find("a.gallery").first().click();
			}
			else if ($(event.target).attr('id')=='prev') {
				//prev item
				if($("a.gallery.current").prevAll("a.gallery:first").length) $("a.gallery.current").prevAll("a.gallery:first").click();
				else $("a.gallery.current").parent().find("a.gallery").last().click();
			}
			else {
				$("a.gallery").removeClass('gallery');
			}
		}
		else $(this).remove();
	});
	//prevent image from being draggable (for swipe)
	$("body").on('dragstart', ".lightbox img", function(event) { event.preventDefault(); });
	//add the youtube lightbox on click
	$("a.lightbox-youtube").click(function(event){
		event.preventDefault();
		$('<div class="lightbox"><a id="close"></a><a id="next">&rsaquo;</a><a id="prev">&lsaquo;</a><div class="videoWrapperContainer"><div class="videoWrapper"><iframe src="https://www.youtube.com/embed/'+$(this).attr('data-id')+'?autoplay=1&showinfo=0&rel=0"></iframe></div></div></div>').appendTo('body');
	});
	//add the image lightbox on click
	$("a.lightbox-image").click(function(event){
		event.preventDefault();
		$('<div class="lightbox"><a id="close"></a><a id="next">&rsaquo;</a><a id="prev">&lsaquo;</a><div class="img" style="background: url('+$(this).attr('href')+') center center / contain no-repeat;" title="'+$(this).attr('title')+'" ><img src="'+$(this).attr('href')+'" alt="'+$(this).attr('title')+'" /></div><span>'+$(this).attr('title')+'</span></div>').appendTo('body');
	});
	//add the vimeo lightbox on click
	$("body").on("click", "a.lightbox-vimeo", function(event){
		event.preventDefault();
		$('<div class="lightbox"><a id="close"></a><a id="next">&rsaquo;</a><a id="prev">&lsaquo;</a><div class="videoWrapperContainer"><div class="videoWrapper"><iframe src="https://player.vimeo.com/video/'+$(this).attr('data-id')+'/?autoplay=1&byline=0&title=0&portrait=0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div></div></div>').appendTo('body');
	});

	$("body").on("click", "a[class*='lightbox-']", function(){
		var link_elements = $(this).parent().find("a[class*='lightbox-']");
		$(link_elements).removeClass('current');
		for (var i=0; i<link_elements.length; i++) {
			if($(this).attr('href') == $(link_elements[i]).attr('href')) {
				$(link_elements[i]).addClass('current');
			}
		}
		if(link_elements.length>1) {
			$('.lightbox').addClass('gallery');
			$(link_elements).addClass('gallery');
		}
	});

	
});

$(document).keydown(function(e) {
    switch(e.which) {
        case 37: // left
        $("#prev").click();
        break;
        case 39: // right
        $("#next").click();
        break;
	case 27: // esc
        $("#close").click();
        break;
        default: return; // exit this handler for other keys
    }
    e.preventDefault(); // prevent the default action (scroll / move caret)
});

  /*===========================
  Swipe-it v1.4.1
  An event listener for swiping gestures with vanilla js.
  https://github.com/tri613/swipe-it#readme
 
  @Create 2016/09/22
  @Update 2017/08/11
  @Author Trina Lu
  ===========================*/
  "use strict";var _slicedToArray=function(){function n(n,t){var e=[],i=!0,o=!1,r=void 0;try{for(var u,c=n[Symbol.iterator]();!(i=(u=c.next()).done)&&(e.push(u.value),!t||e.length!==t);i=!0);}catch(n){o=!0,r=n}finally{try{!i&&c.return&&c.return()}finally{if(o)throw r}}return e}return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();!function(n,t,e){function i(n){function e(){o("touchstart",m,w),o("touchmove",d,w),o("touchend",p,w),E.mouseEvent&&o("mousedown",s,w)}function i(){y=!1,D=!1,A=!1,b=!1,a=!1}function s(n){a=this,y=n.clientX,D=n.clientY,o("mousemove",l,v),o("mouseup",h,v)}function l(n){n.preventDefault(),y&&D&&(A=n.clientX,b=n.clientY)}function h(n){r("mousemove",l,v),r("mouseup",h,v),p(n)}function m(n){a=this,y=n.touches[0].clientX,D=n.touches[0].clientY}function d(n){A=n.touches[0].clientX,b=n.touches[0].clientY}function p(n){if(y&&D&&A&&b){var t=y-A,e=D-b,o=[t,e].map(Math.abs),r=_slicedToArray(o,2),c=r[0],s=r[1],v=E.minDistance;if(c>v){var f=y<A?"swipeRight":"swipeLeft";u(f,a,{distance:t,start:y,end:A})}if(s>v){var l=D>b?"swipeUp":"swipeDown";u(l,a,{distance:e,start:D,end:b})}(c>v||s>v)&&u("swipe",a)}i()}var E=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},w=c(t.querySelectorAll(n)),y=void 0,D=void 0,A=void 0,b=void 0;E.mouseEvent=void 0===E.mouseEvent?f.mouseEvent:E.mouseEvent,E.minDistance=void 0===E.minDistance?f.minDistance:E.minDistance,i(),e(),this.on=function(n,t){return o(n,t,w),this}}function o(n,t,e){s(e).forEach(function(e){return e.addEventListener(n,t)})}function r(n,t,e){s(e).forEach(function(e){return e.removeEventListener(n,t)})}function u(n,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=t.createEvent("Event");o.initEvent(n,!0,!0),o.swipe=i,s(e).forEach(function(n){return n.dispatchEvent(o)})}function c(n){for(var t=[],e=0;e<n.length;e++)t.push(n[e]);return t}function s(n){return Array.isArray(n)?n:[n]}var a=!1,v=[n],f={mouseEvent:!0,minDistance:30};n[e]=i}(window,document,"SwipeIt");

var mySwipeIt = new SwipeIt('body');
mySwipeIt.on('swipeLeft',function(e){
	//check if lightbox is present
	if($('.lightbox').length >  0 ) {
		$("#next").click();
	}
}).on('swipeRight',function(e){
	//check if lightbox is present
	if($('.lightbox').length >  0 ) {
		$("#prev").click();
	}
});
</script>

    </body>
</html>