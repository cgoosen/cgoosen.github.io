<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Category: Office 365 | Chris&#39;s Blog &mdash; It&#39;s called thinking...  go with it! </title>
    <meta property="og:title" content="Category: Office 365 | Chris&#39;s Blog &mdash; It&#39;s called thinking...  go with it! " />
    <meta name="twitter:title" content="Category: Office 365 | Chris&#39;s Blog &mdash; It&#39;s called thinking...  go with it! " />

    <meta name="description" content="Category: Office 365">
    <meta name="description" property="og:description" content="Category: Office 365" />
    <meta name="twitter:description" content="Category: Office 365" />

    <meta name="twitter:card" content="summary_large_image" />
    
    <meta name="twitter:site" content="@chrisgoosen" />
    
    <meta property="og:url" content="http://172.16.7.177:4000/categories/Office%20365/" />

    <meta property="og:image" content="" />
    <meta name="twitter:image" content="" />

    <meta name="author" content="Chris's Blog" />

    <meta name="copyright" content="Copyright by Chris's Blog. All Rights Reserved." />

    <style>
        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 300;
            src: local('Roboto Light'), local('Roboto-Light'), url(https://fonts.gstatic.com/s/roboto/v15/Hgo13k-tfSpn0qi1SFdUfVtXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 400;
            src: local('Roboto'), local('Roboto-Regular'), url(https://fonts.gstatic.com/s/roboto/v15/CWB0XYA8bzo0kSThX0UTuA.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 700;
            src: local('Roboto Bold'), local('Roboto-Bold'), url(https://fonts.gstatic.com/s/roboto/v15/d-6IYplOFocCacKzxwXSOFtXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 900;
            src: local('Roboto Black'), local('Roboto-Black'), url(https://fonts.gstatic.com/s/roboto/v15/mnpfi9pxYH-Go5UiibESIltXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 300;
            src: local('Roboto Light Italic'), local('Roboto-LightItalic'), url(https://fonts.gstatic.com/s/roboto/v15/7m8l7TlFO-S3VkhHuR0at44P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 400;
            src: local('Roboto Italic'), local('Roboto-Italic'), url(https://fonts.gstatic.com/s/roboto/v15/vPcynSL0qHq_6dX7lKVByfesZW2xOQ-xsNqO47m55DA.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 700;
            src: local('Roboto Bold Italic'), local('Roboto-BoldItalic'), url(https://fonts.gstatic.com/s/roboto/v15/t6Nd4cfPRhZP44Q5QAjcC44P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 900;
            src: local('Roboto Black Italic'), local('Roboto-BlackItalic'), url(https://fonts.gstatic.com/s/roboto/v15/bmC0pGMXrhphrZJmniIZpY4P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }
    </style>
    
    <link href="/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    
    <link rel="stylesheet" href="http://172.16.7.177:4000/assets/css/main.css">

    <link rel="canonical" href="http://172.16.7.177:4000/categories/Office%20365/">

    <link rel="alternate" type="application/rss+xml" title="" href="http://172.16.7.177:4000/feed.xml">
</head>

    <body>
        <div class="wrapper">
            <aside class="user-profile fixed" role="complementary">
    <div class="burger">
        <input class="trigger hidden" id="toggleBurger" type="checkbox" />
        <label for="toggleBurger">
            <span>Navigation</span>
        </label>
    </div>

    <div class="compact-header">
        <a class="avatar" href="http://172.16.7.177:4000"><img alt="Avatar" src="/assets/img/headshot.jpg" /></a>
        <div class="my-info">
            <strong class="my-name">Chris's Blog</strong>
            <span class="my-job-title">It's called thinking...  go with it!</span>
        </div>
    </div>

    
        
        <div class="mainmenu">
            <a href="http://172.16.7.177:4000" >Home</a>
            
                
            
                
            
                
                    <a href="http://172.16.7.177:4000/contact/" >Contact</a>
                
            
                
                    <a href="http://172.16.7.177:4000/about/" >About</a>
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
        </div>
        
    
    
    <div>
    	<img src="/assets/img/mvp.png" style="width:181px;height:74px;">
    </div>

    <p class="about-me"> </p>
    
    <ul class="socials">
        <li><a href="https://twitter.com/chrisgoosen" target="_blank"><svg title="twitter" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li><li><a href="https://www.linkedin.com/in/ctgoosen/" target="_blank"><svg title="linkedin" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#linkedin-icon"></use></svg></a></li><li><a href="https://github.com/cgoosen" target="_blank"><svg title="github" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#github-icon"></use></svg></a></li>

        
            <li><a href="/contact" target="_blank"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#email-icon"></use></svg></a></li>
        

        
         <li><a href="http://feeds.cgoosen.com/cgoosen"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#rss-icon"></use></svg></a></li>
        
    </ul>
</aside>


            <main class="the-content" role="main">
                <div class="search" role="search">
    <div>
        <div class="show-results-count">0 Results</div>
        <div class="search-holder">
            <input type="text" id="search-input" placeholder="search for..." />
        </div>
    </div>
    <ul id="results-container" class="results-container"></ul>
</div>


                <h1>Posts From Category: Office 365</h1>


<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2019-02-27T08:38:26-06:00" itemprop="datePublished">27 Feb, 2019</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2019/02/connect-365-script-updates">Connect-365 Script Updates</a></h2>
    </header>

    <div class="post-content">
        <p>I'm excited to publish a new version of my Connect-365.ps1 script. The new version includes a bunch of usability improvements, the addition of Teams and Azure modules and now supports MFA.</p>
<p><a href="/assets/img/2019/02/Screen-Shot-2019-02-27-at-2.09.37-PM.png"><img src="/assets/img/2019/02/Screen-Shot-2019-02-27-at-2.09.37-PM.png" style="width:539px;height:415;"/></a></p>
<p style="text-align: left;">I have published a code-signed version to the TechNet Gallery, <a href="http://cgoo.se/1srvTiS" target="_blank" rel="noopener">it can be downloaded by clicking here&hellip;</a>&nbsp;or you can<a href="https://github.com/cgoosen/Connect-365" target="_blank" rel="noopener"> grab the code from Github here.&nbsp;</a><a href="https://www.cgoosen.com/wp-content/uploads/2019/02/Screen-Shot-2019-02-27-at-2.09.37-PM.png"><br />
</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Connect-365 Script Updates&p[summary]=I'm excited to publish a new version of my Connect-365.ps1 script. The new version includes a bunch of usability improvements, the additi...&p[url]=http://172.16.7.177:4000/2019/02/connect-365-script-updates" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2019/02/connect-365-script-updates&text=I'm excited to publish a new version of my Connect-365.ps1 script. The new version includes a bunch of usability improvements, the additi...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2019-02-11T06:08:21-06:00" itemprop="datePublished">11 Feb, 2019</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2019/02/tca-podcast-episode-22-governance-with-antonio-maio">TCA Podcast Episode 22: Governance With Antonio Maio</a></h2>
    </header>

    <div class="post-content">
        <p>Governance is a big word and is a concept that is often thrown around. It seems to confuse a lot of organizations, even those who have successfully navigated the cultural and technology changes often brought on by cloud adoption. The &lsquo;on by default&rsquo; nature of many cloud services has made it even more important for organizations to plan their governance strategy before adopting these services, so we sat down with Antonio Maio to talk about the need for governance and why it isn&rsquo;t something that should be overlooked.</p>
<p><iframe width="100%" height="300" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/571229175&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"></iframe></p>
<p>For more information on The Cloud Architects podcast, check us out on <a href="https://soundcloud.com/thecloudarchitects/" target="_blank" rel="noopener noreferrer">SoundCloud</a>. We are also available on your favorite podcast app:</p>
<ul>
<li><a href="https://itunes.apple.com/us/podcast/the-cloud-architects-podcast/id1264479296?mt=2" target="_blank" rel="noopener noreferrer">iTunes</a></li>
<li><a href="https://www.stitcher.com/podcast/the-cloud-architects/the-cloud-achitects" target="_blank" rel="noopener noreferrer">Stitcher</a></li>
<li><a href="https://tunein.com/radio/The-Cloud-Architects-Podcast-p1026315/" target="_blank" rel="noopener noreferrer">Tunein</a></li>
<li><a href="https://www.acast.com/thecloudarchitectspodcast" target="_blank" rel="noopener noreferrer">Acast</a></li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=TCA Podcast Episode 22: Governance With Antonio Maio&p[summary]=Governance is a big word and is a concept that is often thrown around. It seems to confuse a lot of organizations, even those who have su...&p[url]=http://172.16.7.177:4000/2019/02/tca-podcast-episode-22-governance-with-antonio-maio" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2019/02/tca-podcast-episode-22-governance-with-antonio-maio&text=Governance is a big word and is a concept that is often thrown around. It seems to confuse a lot of organizations, even those who have su...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2019-01-30T05:31:34-06:00" itemprop="datePublished">30 Jan, 2019</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2019/01/exchange-online-no-dkim-keys-saved-for-this-domain">Exchange Online - No DKIM keys saved for this domain</a></h2>
    </header>

    <div class="post-content">
        <p>I recently came across an interesting issue when attempting to enable DKIM for a domain in Exchange Online. When accessing the DKIM options via the Exchange Admin Center, I didn’t have the option to enable DKIM, instead saw the “No DKIM keys saved for this domain” message shown in the screenshot below:
<a href="/assets/img/2019/01/2.png"><img src="/assets/img/2019/01/2.png" style="width:300px;height:129px;" /></a>
Fortunately, we are able to manage DKIM configuration via PowerShell. Once connected to Exchange Online, you can list the DKIM cmdlets using Get-Command:
<a href="/assets/img/2019/01/3.png"><img src="/assets/img/2019/01/3.png" style="width:300px;height:155px;" /></a></p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
</pre></td><td class="code"><pre><span class="no">Get</span><span class="o">-</span><span class="no">Command</span> <span class="o">-</span><span class="no">Module</span> <span class="n">tmp_dmwhjqj3</span><span class="p">.</span><span class="nf">m1c</span> <span class="o">*</span><span class="n">dkim</span><span class="o">*</span></pre></td></tr></tbody></table></code></pre></figure>

<p>We can use New-DkimSigningConfig cmdlet to enable DKIM for a particular domain:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
</pre></td><td class="code"><pre><span class="no">New</span><span class="o">-</span><span class="no">DkimSigningConfig</span> <span class="o">-</span><span class="no">DomainName</span> <span class="n">domain</span><span class="p">.</span><span class="nf">com</span> <span class="o">-</span><span class="no">Enabled</span> <span class="vg">$True</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Once run, you’ll notice that the Exchange Admin Center will now show DKIM as enabled for the domain. If you haven’t already, you’ll also need to create the relevant DNS records to ensure that DKIM functions correctly. The following records will be required:</p>
<ul>
  <li>selector1._domainkey.domain.com = CNAME: selector1-domain-com._domainkey.tenant.onmicrosoft.com</li>
  <li>selector2._domainkey.domain.com = CNAME: selector2-domain-com._domainkey.tenant.onmicrosoft.com</li>
</ul>

<p>Fellow MVP <a href="https://twitter.com/jaapwess" target="_blank" rel="noopener">Jaap Wesselius</a> has a great post on <a href="https://jaapwesselius.com/2018/10/31/spf-dkim-and-dmarc-in-exchange-online-protection/" target="_blank" rel="noopener">SPF, DKIM and DMARC.</a></p>


        
            <p><a href="/2019/01/exchange-online-no-dkim-keys-saved-for-this-domain" role="button">Read More</a></p>
        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange Online - No DKIM keys saved for this domain&p[summary]=I recently came across an interesting issue when attempting to enable DKIM for a domain in Exchange Online. When accessing the DKIM optio...&p[url]=http://172.16.7.177:4000/2019/01/exchange-online-no-dkim-keys-saved-for-this-domain" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2019/01/exchange-online-no-dkim-keys-saved-for-this-domain&text=I recently came across an interesting issue when attempting to enable DKIM for a domain in Exchange Online. When accessing the DKIM optio...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2018-11-30T07:05:31-06:00" itemprop="datePublished">30 Nov, 2018</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2018/11/tca-podcast-episode-20-azure-active-directory-and-b2b">TCA Podcast Episode 20: Azure Active Directory and B2B</a></h2>
    </header>

    <div class="post-content">
        <p>In this episode we talk with Program Manager&nbsp;Elisabeth Olson&nbsp;and Principle Program Manager Rob Lowe. They both work with the Azure Active Directory teams at Microsoft and they give us some amazing insight into how Azure AD works.</p>
<iframe width="100%" height="300" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/537644832&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"></iframe>
<p>For more information on The Cloud Architects podcast, check us out on <a href="https://soundcloud.com/thecloudarchitects/" target="_blank" rel="noopener noreferrer">SoundCloud</a>. We are also available on your favorite podcast app:</p>
<ul>
<li><a href="https://itunes.apple.com/us/podcast/the-cloud-architects-podcast/id1264479296?mt=2" target="_blank" rel="noopener noreferrer">iTunes</a></li>
<li><a href="https://www.stitcher.com/podcast/the-cloud-architects/the-cloud-achitects" target="_blank" rel="noopener noreferrer">Stitcher</a></li>
<li><a href="https://tunein.com/radio/The-Cloud-Architects-Podcast-p1026315/" target="_blank" rel="noopener noreferrer">Tunein</a></li>
<li><a href="https://www.acast.com/thecloudarchitectspodcast" target="_blank" rel="noopener noreferrer">Acast</a></li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=TCA Podcast Episode 20: Azure Active Directory and B2B&p[summary]=In this episode we talk with Program Manager&nbsp;Elisabeth Olson&nbsp;and Principle Program Manager Rob Lowe. They both work with the Az...&p[url]=http://172.16.7.177:4000/2018/11/tca-podcast-episode-20-azure-active-directory-and-b2b" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2018/11/tca-podcast-episode-20-azure-active-directory-and-b2b&text=In this episode we talk with Program Manager&nbsp;Elisabeth Olson&nbsp;and Principle Program Manager Rob Lowe. They both work with the Az...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2018-09-08T03:00:47-05:00" itemprop="datePublished">8 Sep, 2018</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2018/09/tca-podcast-episode-16-jeff-mealiffe-and-the-awesomeness-of-exchangeahem-office-365">TCA Podcast Episode 16: Jeff Mealiffe and the Awesomeness of Exchange(Ahem, Office 365)</a></h2>
    </header>

    <div class="post-content">
        <p>In this episode, Nic and Warren have a chat to the Perf Guy himself, Principal Lead Program Manager at Microsoft,&nbsp;Jeff Mealiffe. They&nbsp;talk about the evolution of Exchange and get Jeff to spill on which version he liked best! They also talk about Office 365 connectivity and the great things Microsoft are doing internally to make your Office 365 experience better.</p>
<iframe width="100%" height="300" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/474243786&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"></iframe>
<p>For more information on The Cloud Architects podcast, check us out on <a href="https://soundcloud.com/thecloudarchitects/" target="_blank" rel="noopener noreferrer">SoundCloud</a>. We are also available on your favorite podcast app:</p>
<ul>
<li><a href="https://itunes.apple.com/us/podcast/the-cloud-architects-podcast/id1264479296?mt=2" target="_blank" rel="noopener noreferrer">iTunes</a></li>
<li><a href="https://www.stitcher.com/podcast/the-cloud-architects/the-cloud-achitects" target="_blank" rel="noopener noreferrer">Stitcher</a></li>
<li><a href="https://tunein.com/radio/The-Cloud-Architects-Podcast-p1026315/" target="_blank" rel="noopener noreferrer">Tunein</a></li>
<li><a href="https://www.acast.com/thecloudarchitectspodcast" target="_blank" rel="noopener noreferrer">Acast</a></li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=TCA Podcast Episode 16: Jeff Mealiffe and the Awesomeness of Exchange(Ahem, Office 365)&p[summary]=In this episode, Nic and Warren have a chat to the Perf Guy himself, Principal Lead Program Manager at Microsoft,&nbsp;Jeff Mealiffe. The...&p[url]=http://172.16.7.177:4000/2018/09/tca-podcast-episode-16-jeff-mealiffe-and-the-awesomeness-of-exchangeahem-office-365" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2018/09/tca-podcast-episode-16-jeff-mealiffe-and-the-awesomeness-of-exchangeahem-office-365&text=In this episode, Nic and Warren have a chat to the Perf Guy himself, Principal Lead Program Manager at Microsoft,&nbsp;Jeff Mealiffe. The...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2018-08-18T07:56:39-05:00" itemprop="datePublished">18 Aug, 2018</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2018/08/azure-ad-connect-high-cpu-usage-detected">Azure AD Connect High CPU Usage detected</a></h2>
    </header>

    <div class="post-content">
        <p>I recently started receiving a lot of emails from Azure AD Connect Health in one of my lab environments indicating that my AAD Connect server was experiencing high CPU usage:</p>
<p><a href="/assets/img/2018/08/Screen-Shot-2018-08-18-at-1.34.18-PM.png"><img src="/assets/img/2018/08/Screen-Shot-2018-08-18-at-1.34.18-PM.png" style="width:818px;height:569px;" /></a></p>
<p>I remembered seeing a tweet from fellow MVP<a href="https://twitter.com/expta" target="_blank" rel="noopener">&nbsp;Jeff Guillet</a> about this - He's been tracking this for a while and as it turns out the issue is caused by a buggy Windows update for .NET framework. You can read all about it in the following posts on his&nbsp;<a href="http://www3.expta.com/blog.html" target="_blank" rel="noopener">The EXPTA {blog}</a>:</p>
<ul>
<li><a href="http://www.expta.com/2018/07/fixed-net-framework-updates-still-cause.html" target="_blank" rel="noopener">"Fixed" .NET Framework Updates Still Cause High CPU on AAD Connect Servers</a></li>
<li><a href="http://www.expta.com/2018/07/azure-ad-connect-version-118800.html" target="_blank" rel="noopener">Azure AD Connect version 1.1.880.0 includes many updates</a></li>
</ul>
<p>Upgrading to AAD Connect&nbsp;1.1.880.0 fixed the issue for me.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Azure AD Connect High CPU Usage detected&p[summary]=I recently started receiving a lot of emails from Azure AD Connect Health in one of my lab environments indicating that my AAD Connect se...&p[url]=http://172.16.7.177:4000/2018/08/azure-ad-connect-high-cpu-usage-detected" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2018/08/azure-ad-connect-high-cpu-usage-detected&text=I recently started receiving a lot of emails from Azure AD Connect Health in one of my lab environments indicating that my AAD Connect se...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2018-05-29T02:53:02-05:00" itemprop="datePublished">29 May, 2018</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2018/05/tca-podcast-episode-14-waxing-lyrical-about-gdpr-with-tony-redmond">TCA Podcast Episode 14: Waxing lyrical about GDPR with Tony Redmond</a></h2>
    </header>

    <div class="post-content">
        <p>The General Data Protection Regulation (GDPR) has been on everyone's mind recently. GDPR became enforceable on 25 May 2018 and is a regulation in EU law on data protection and privacy for all&nbsp;individuals within the European Union. It also addresses the export of personal data outside the EU and aims primarily to give control to citizens and residents over their personal data and how that data is used. It seems a lot a organizations left their GDPR strategies to the very last minute - I received a lot of GDPR related email that week!&nbsp;What does it all mean and why should we care? We had the pleasure of talking to Tony Redmond about it recently.</p>
<iframe width="100%" height="300" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/449095935&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"></iframe>
<p>For more information on The Cloud Architects podcast, check us out on <a href="https://soundcloud.com/thecloudarchitects/" target="_blank" rel="noopener noreferrer">SoundCloud</a>. We are also available on your favorite podcast app:</p>
<ul>
<li><a href="https://itunes.apple.com/us/podcast/the-cloud-architects-podcast/id1264479296?mt=2" target="_blank" rel="noopener noreferrer">iTunes</a></li>
<li><a href="https://www.stitcher.com/podcast/the-cloud-architects/the-cloud-achitects" target="_blank" rel="noopener noreferrer">Stitcher</a></li>
<li><a href="https://tunein.com/radio/The-Cloud-Architects-Podcast-p1026315/" target="_blank" rel="noopener noreferrer">Tunein</a></li>
<li><a href="https://www.acast.com/thecloudarchitectspodcast" target="_blank" rel="noopener noreferrer">Acast</a></li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=TCA Podcast Episode 14: Waxing lyrical about GDPR with Tony Redmond&p[summary]=The General Data Protection Regulation (GDPR) has been on everyone's mind recently. GDPR became enforceable on 25 May 2018 and is a regul...&p[url]=http://172.16.7.177:4000/2018/05/tca-podcast-episode-14-waxing-lyrical-about-gdpr-with-tony-redmond" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2018/05/tca-podcast-episode-14-waxing-lyrical-about-gdpr-with-tony-redmond&text=The General Data Protection Regulation (GDPR) has been on everyone's mind recently. GDPR became enforceable on 25 May 2018 and is a regul...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2018-02-27T14:00:12-06:00" itemprop="datePublished">27 Feb, 2018</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2018/02/fun-with-azure-automation-and-table-service-rest-api">Fun with Azure Automation and Table Service REST API</a></h2>
    </header>

    <div class="post-content">
        <p>I love PowerShell and I really love to automate things! I recently started looking into leveraging Azure services for some automation tasks&nbsp;and discovered how powerful it could be. I also had a lot of fun doing it and wanted to share some of what I learned.</p>
<p>Azure&nbsp;Automation is for scheduling tasks or scripts that run on some sort of schedule and is especially useful for any automation you might be doing with Office 365. Your code is stored in a Runbook (PowerShell or Python) and executed according to a schedule. Interacting with modules is a little different to working with your local PowerShell installation, however the <a href="https://docs.microsoft.com/en-us/azure/automation/automation-runbook-gallery" target="_blank" rel="noopener noreferrer">module gallery makes it pretty simple</a>. Getting started is simple, let's assume in this example we will be automating a report in Exchange Online. First you create an Automation Account:</p>
<p><a href="/assets/img/2018/02/auto1.png"><img src="/assets/img/2018/02/auto1.png" style="width:145px;height:300px;" /></a></p>
<p><a href="/assets/img/2018/02/auto2.png"><img src="/assets/img/2018/02/auto2.png" style="width:300px;height:222px;" /></a></p>
<p>Create a credential set for your Exchange Online credentials - remember what you call it.&nbsp;"TenantCreds" in my case.</p>
<p><a href="/assets/img/2018/02/auto4.png"><img src="/assets/img/2018/02/auto4.png" style="width:300px;height:176px;" /></a></p>
<p>Then create a new Runbook:</p>
<p><a href="/assets/img/2018/02/auto3.png"><img src="/assets/img/2018/02/auto3.png" style="width:300px;height:185px;" /></a></p>
<p>Next it's time to add some PowerShell to the Runbook. Since we will be working in Exchange Online, we need to create and import that session. This is similar to working with Exchange Online sessions on your local machine, but you will notice that we don't need to include the credentials in the code and simply reference the credential set we created earlier:</p>
<p><figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="code"><pre><span class="o">&lt;</span><span class="n">br</span> <span class="sr">/&gt;
$UserCredential = Get-AutomationPSCredential -Name "TenantCreds"&lt;br /</span><span class="o">&gt;</span>
<span class="vg">$Session</span> <span class="o">=</span> <span class="no">New</span><span class="o">-</span><span class="no">PSSession</span> <span class="o">-</span><span class="no">ConfigurationName</span> <span class="no">Microsoft</span><span class="o">.</span><span class="no">Exchange</span> <span class="o">-</span><span class="no">ConnectionUri</span> <span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">outlook</span><span class="p">.</span><span class="nf">office365</span><span class="p">.</span><span class="nf">com</span><span class="o">/</span><span class="n">powershell</span><span class="o">-</span><span class="n">liveid</span><span class="o">/</span> <span class="o">-</span><span class="no">Credential</span> <span class="vg">$UserCredential</span> <span class="o">-</span><span class="no">Authentication</span> <span class="no">Basic</span> <span class="o">-</span><span class="no">AllowRedirection</span><span class="o">&lt;</span><span class="n">br</span> <span class="sr">/&gt;
$Commands = @("Get-MigrationBatch","Get-MigrationUser","Get-MigrationUserStatistics","Get-MoveRequestStatistics","Get-MoveRequest")&lt;br /</span><span class="o">&gt;</span>
<span class="no">Import</span><span class="o">-</span><span class="no">PSSession</span> <span class="o">-</span><span class="no">Session</span> <span class="vg">$Session</span> <span class="o">-</span><span class="no">Prefix</span> <span class="s2">"EXO"</span> <span class="o">-</span><span class="no">DisableNameChecking</span><span class="p">:</span><span class="vg">$true</span> <span class="o">-</span><span class="no">AllowClobber</span><span class="p">:</span><span class="vg">$true</span> <span class="o">-</span><span class="no">CommandName</span> <span class="vg">$Commands</span> <span class="o">|</span> <span class="no">Out</span><span class="o">-</span><span class="no">Null</span><span class="o">&lt;</span><span class="n">br</span> <span class="sr">/&gt;</span></pre></td></tr></tbody></table></code></pre></figure></p>
<p>I had some errors when trying to import all Exchange Online cmdlets, so I limit it&nbsp;to only the cmdlets I intend to use in the script. I also add a prefix of "EXO" to these, so these cmdlets are used as follows:</p>
<p><figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
</pre></td><td class="code"><pre><span class="o">&lt;</span><span class="n">br</span> <span class="sr">/&gt;
$MigBatch = Get-EXOMigrationBatch | Where-Object {$_.Identity -like '*MyMigration*'} | foreach {$_.BatchGuid}&lt;br /</span><span class="o">&gt;</span></pre></td></tr></tbody></table></code></pre></figure></p>
<p>Lastly, we need to create a schedule for the automation job:</p>
<p><a href="/assets/img/2018/02/schedule1.png"><img src="/assets/img/2018/02/schedule1.png" style="width:300px;height:146px;" /></a></p>
<p>Once the schedule has been created, you can link it to the Runbook:</p>
<p><a href="/assets/img/2018/02/schedule2.png"><img src="/assets/img/2018/02/schedule2.png" style="width:300px;height:142px;" /></a></p>
<p>This is great if you need to perform tasks that don't generate any output. What happens when something (e.g .CSV file) is generated? There are a couple of ways to deal with that. You could just use the temp folder to store your data and <a href="http://www.cgoosen.com/2015/04/user-powershell-to-bulk-email-your-users/" target="_blank" rel="noopener noreferrer">then email it to yourself</a> - remember, data stored in the temp folder will not persist:</p>
<p><figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
</pre></td><td class="code"><pre><span class="o">&lt;</span><span class="n">br</span> <span class="sr">/&gt;
$TmpPath = $env:TEMP&lt;br /</span><span class="o">&gt;</span></pre></td></tr></tbody></table></code></pre></figure></p>
<p>Another way to deal with this data is to write it to Azure Storage. There is a <a href="https://docs.microsoft.com/en-us/azure/storage/common/storage-powershell-guide-full" target="_blank" rel="noopener noreferrer">PowerShell module available</a> for Azure Storage that can be used with Azure Automation, but you can also use the APIs. Since&nbsp;I figured out how to use the API, it has become my go to method because it is actually much faster. I have also been able to use it in environments where it isn't possible to install modules.</p>
<p>The first thing we need to do is create a Storage Account in Azure:</p>
<p><a href="/assets/img/2018/02/storage1.png"><img src="/assets/img/2018/02/storage1.png" style="width:138px;height:300px;" /></a></p>
<p>We then create a Shared Access Signature (SAS) for that Storage Account:</p>
<p><a href="/assets/img/2018/02/storage2.png"><img src="/assets/img/2018/02/storage1.png" style="width:300px;height:218px;" /></a></p>
<p>The result should look similar to this:</p>
<p><a href="/assets/img/2018/02/storage3.png"><img src="/assets/img/2018/02/storage1.png" style="width:300px;height:142px;" /></a></p>
<p>In this example, we are going to store our script output in the Table Service, so we'll be using the&nbsp;Table Service REST API. When working with the Table Service it is <a href="https://docs.microsoft.com/en-us/rest/api/storageservices/understanding-the-table-service-data-model" target="_blank" rel="noopener noreferrer">important to understand tables, entities, system properties and other limitations</a>, but for the&nbsp;purposes of this post I'm going to simplify things a little.&nbsp;Tables store data as collections of entities - entities are similar to rows&nbsp;and have&nbsp;a primary key and a set of properties. A property is similar to a column.</p>
<p>Each entity always has the following system properties:</p>
<ul>
<li>PartitionKey</li>
<li>RowKey</li>
<li>Timestamp</li>
</ul>
<p>Timestamp is managed automatically and isn't something you can change. The&nbsp;PartitionKey and RowKey are always required and are used for scalability and indexing of the content so it is important to consider these when designing your table. <a href="https://docs.microsoft.com/en-us/rest/api/storageservices/designing-a-scalable-partitioning-strategy-for-azure-table-storage" target="_blank" rel="noopener noreferrer">Here is some really good information to read up on.</a>&nbsp;In this&nbsp;example, I'll looking up migration status of a mailbox in Exchange Online and will be inserting this data into a table. I'm going to use the "BatchID" as the&nbsp;PartitionKey and the "Status" as the&nbsp;RowKey. The table name in the example will use the "Alias" of the mailbox.</p>
<p>First, lets define the data we are going to insert. This could easily be used in a script or automation Runbook as a Foreach() loop, but to keep it simple I'm just going to manually define them in the example</p>
<p><figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="code"><pre><span class="o">&lt;</span><span class="n">br</span> <span class="sr">/&gt;
$UserTable = "ZacTurner"&lt;br /</span><span class="o">&gt;</span>
<span class="vg">$PartitionKey</span> <span class="o">=</span> <span class="s2">"Batch02"</span><span class="o">&lt;</span><span class="n">br</span> <span class="sr">/&gt;
$RowKey = "Synced"&lt;br /</span><span class="o">&gt;</span>
<span class="vg">$PrimaryEmailAddress</span> <span class="o">=</span> <span class="s2">"ZacTurner@o365testlab.com"</span><span class="o">&lt;</span><span class="n">br</span> <span class="sr">/&gt;
$MbxGuid = "e31949b2-ebc6-4f57-b9ae-0aa8ae73bb2c"&lt;br /</span><span class="o">&gt;</span>
<span class="vg">$Batch</span> <span class="o">=</span> <span class="s2">"Batch02"</span><span class="o">&lt;</span><span class="n">br</span> <span class="sr">/&gt;
$Status = "Synced"&lt;br /</span><span class="o">&gt;</span>
<span class="vg">$Skipped</span> <span class="o">=</span> <span class="s2">"4"</span><span class="o">&lt;</span><span class="n">br</span> <span class="sr">/&gt;
$LastCheck = "2/</span><span class="mi">27</span><span class="o">/</span><span class="mi">2018</span> <span class="mi">8</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mo">01</span> <span class="no">PM</span><span class="s2">"&lt;br /&gt;</span></pre></td></tr></tbody></table></code></pre></figure></p>
<p>Next we will import this information, during the import, we'll first check to see if a unique table already exists (using the Alias). If one does exist, we'll insert the data, if one doesn't exist we will create it.</p>
<p><figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class="code"><pre><span class="o">&lt;</span><span class="n">br</span> <span class="sr">/&gt;
$AzureEndpoint = 'https:/</span><span class="o">/</span><span class="n">cgblogpostdemo</span><span class="p">.</span><span class="nf">table</span><span class="p">.</span><span class="nf">core</span><span class="p">.</span><span class="nf">windows</span><span class="p">.</span><span class="nf">net</span><span class="o">/</span><span class="s1">'&lt;br /&gt;
$AzureSAS = "?sv=2017-07-29&amp;amp;ss=bfqt&amp;amp;srt=sco&amp;amp;sp=rwdlacup&amp;amp;se=2018-04-05T02:31:38Z&amp;amp;st=2018-02-27T19:31:38Z&amp;amp;spr=https&amp;amp;sig=&lt;removed&gt;"&lt;br /&gt;
$AzureRequestHeaders = @{&lt;br /&gt;
		"x-ms-date"=(Get-Date -Format r);&lt;br /&gt;
		"x-ms-version"="2016-05-31";&lt;br /&gt;
		"Accept-Charset"="UTF-8";&lt;br /&gt;
		"DataServiceVersion"="3.0;NetFx";&lt;br /&gt;
		"MaxDataServiceVersion"="3.0;NetFx";&lt;br /&gt;
		"Accept"="application/json;odata=nometadata"}&lt;/p&gt;
&lt;p&gt;$UserURI = $AzureEndpoint + $UserTable + "/" + $AzureSAS&lt;/p&gt;
&lt;p&gt;#Check if table already exists&lt;br /&gt;
$UserTableExists = Invoke-WebRequest -Method GET -Uri $UserURI -Headers $AzureRequestHeaders&lt;br /&gt;
$UserTableExists = $UserTableExists.StatusCode&lt;/p&gt;
&lt;p&gt;If ($UserTableExists -ne "200"){&lt;br /&gt;
		 $TableRequestBody = ConvertTo-Json -InputObject @{&lt;br /&gt;
							"TableName"=$UserTable}&lt;br /&gt;
		 $EncodedTableRequestBody = [System.Text.Encoding]::UTF8.GetBytes($TableRequestBody)&lt;br /&gt;
		 $TableURI = $AzureEndpoint + '</span><span class="no">Tables</span><span class="o">/</span><span class="err">'</span> <span class="o">+</span> <span class="vg">$AzureSAS</span><span class="o">&lt;</span><span class="n">br</span> <span class="sr">/&gt;
		Invoke-WebRequest -Method POST -Uri $TableURI -Headers $AzureRequestHeaders -Body $EncodedTableRequestBody -ContentType "application/</span><span class="n">json</span><span class="s2">"&lt;br /&gt;
			}&lt;/p&gt;
&lt;p&gt;#Insert data&lt;br /&gt;
$AzureRequestBody = ConvertTo-Json -InputObject @{&lt;br /&gt;
		"</span><span class="no">PartitionKey</span><span class="s2">"= "</span><span class="vg">$PartitionKey</span><span class="s2">";&lt;br /&gt;
		"</span><span class="no">RowKey</span><span class="s2">"= "</span><span class="vg">$RowKey</span><span class="s2">";&lt;br /&gt;
		"</span><span class="no">PrimaryEmailAddress</span><span class="s2">"= "</span><span class="vg">$PrimaryEmailAddress</span><span class="s2">";&lt;br /&gt;
		"</span><span class="no">MbxGuid</span><span class="s2">"= "</span><span class="vg">$MbxGuid</span><span class="s2">";&lt;br /&gt;
		"</span><span class="no">BatchName</span><span class="s2">"= "</span><span class="vg">$Batch</span><span class="s2">";&lt;br /&gt;
		"</span><span class="no">Status</span><span class="s2">"= "</span><span class="vg">$Status</span><span class="s2">";&lt;br /&gt;
		"</span><span class="no">ItemsSkipped</span><span class="s2">"= "</span><span class="vg">$Skipped</span><span class="s2">";&lt;br /&gt;
		"</span><span class="no">LastCheck</span><span class="s2">"= "</span><span class="vg">$LastCheck</span><span class="s2">"}&lt;br /&gt;
$EncodedAzureRequestBody = [System.Text.Encoding]::UTF8.GetBytes($AzureRequestBody)&lt;br /&gt;
Invoke-WebRequest -Method POST -Uri $UserURI -Headers $AzureRequestHeaders -Body $EncodedAzureRequestBody -ContentType "</span><span class="n">application</span><span class="o">/</span><span class="n">json</span><span class="s2">"&lt;br /&gt;</span></pre></td></tr></tbody></table></code></pre></figure></p>
<p>You could also use <a href="https://docs.microsoft.com/en-us/powershell/module/Microsoft.PowerShell.Utility/Invoke-RestMethod?view=powershell-5.1" target="_blank" rel="noopener noreferrer">Invoke-RestMethod</a> instead of Invoke-WebRequest. The resulting tables should look like this:</p>
<p><a href="/assets/img/2018/02/storage4-1.png"><img src="/assets/img/2018/02/storage4-1.png" style="width:300px;height:144px;" /></a></p>
<p style="text-align: left;">Credit to&nbsp;a couple of Stack Overflow posts that were really helpful&nbsp;when I was trying to figure this out:</p>
<ul>
<li style="text-align: left;"><a href="https://stackoverflow.com/questions/42792430/adding-azure-table-entity-with-powershell-with-rest-api" target="_blank" rel="noopener noreferrer">Here</a></li>
<li style="text-align: left;"><a href="https://stackoverflow.com/questions/47214227/powershell-invoke-restmethod-error-415-unsupported-media-type" target="_blank" rel="noopener noreferrer">Here</a></li>
</ul>



        
            <p><a href="/2018/02/fun-with-azure-automation-and-table-service-rest-api" role="button">Read More</a></p>
        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Fun with Azure Automation and Table Service REST API&p[summary]=I love PowerShell and I really love to automate things! I recently started looking into leveraging Azure services for some automation tas...&p[url]=http://172.16.7.177:4000/2018/02/fun-with-azure-automation-and-table-service-rest-api" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2018/02/fun-with-azure-automation-and-table-service-rest-api&text=I love PowerShell and I really love to automate things! I recently started looking into leveraging Azure services for some automation tas...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2018-01-30T09:21:49-06:00" itemprop="datePublished">30 Jan, 2018</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2018/01/my-powershell-scripts-are-now-available-on-github">My PowerShell scripts are now available on GitHub</a></h2>
    </header>

    <div class="post-content">
        <p>Ever since I first started sharing scripts on my blog, I've had a bunch of people reach out to me with stories of how they've used my code in their projects or offering to collaborate with me on future versions. My intention has always been to make my scripts easily downloadable and ready to run - one of the reasons why I sign the code with a code signing certificate, but I've come to realize that there is no reason why I couldn't do both.</p>
<p>Over time my own development and version&nbsp;control methodologies have matured and I've been very successfully using git to manage my own projects. After a recent conversation with fellow <a href="https://eightwone.com" target="_blank" rel="noopener noreferrer">MVP Michel de Rooij</a>&nbsp;about his use of GitHub as a repository for his scripts, I decided to follow suit and have&nbsp;created a public GitHub repositories for each of my scripts. You <a href="https://github.com/cgoosen" target="_blank" rel="noopener noreferrer">can find these here.</a></p>
<p>I will continue to make code signed versions of my scripts available in the TechNet gallery for those who prefer to just download and use them. Links to those are below:</p>
<ul>
<li><a href="https://gallery.technet.microsoft.com/Connect-EXOps1-Connect-to-4d694663" target="_blank" rel="noopener noreferrer">Connect-365.ps1</a></li>
<li><a href="https://gallery.technet.microsoft.com/Connect-EXOps1-Connect-to-9c3854ea" target="_blank" rel="noopener noreferrer">Connect-EXO.ps1</a></li>
<li><a href="https://gallery.technet.microsoft.com/Get-AZCopyGUIps1-AZCopy-b60d2df8" target="_blank" rel="noopener noreferrer">Get-AZCopyGUI.ps1</a></li>
<li><a href="https://gallery.technet.microsoft.com/Fix-ProxyAddressps1-7036dfa1" target="_blank" rel="noopener noreferrer">Fix-ProxyAddress.ps1</a></li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=My PowerShell scripts are now available on GitHub&p[summary]=Ever since I first started sharing scripts on my blog, I've had a bunch of people reach out to me with stories of how they've used my cod...&p[url]=http://172.16.7.177:4000/2018/01/my-powershell-scripts-are-now-available-on-github" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2018/01/my-powershell-scripts-are-now-available-on-github&text=Ever since I first started sharing scripts on my blog, I've had a bunch of people reach out to me with stories of how they've used my cod...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2018-01-05T04:48:50-06:00" itemprop="datePublished">5 Jan, 2018</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2018/01/tca-podcast-episode-9-this-is-not-your-grandfathers-sharepoint">TCA Podcast Episode 9: "This is not your Grandfathers Sharepoint!"</a></h2>
    </header>

    <div class="post-content">
        <p>In this episode, we&nbsp;talk to&nbsp;<a href="https://myignite.microsoft.com/speaker/194190" target="_blank" rel="noopener noreferrer">Patricia Hendricks</a> (<span class="username u-dir" dir="ltr"><a class="ProfileHeaderCard-screennameLink u-linkComplex js-nav" href="https://twitter.com/phndrx" target="_blank" rel="noopener noreferrer">@<b class="u-linkComplex-target">phndrx</b></a>)&nbsp;and <a href="https://myignite.microsoft.com/speaker/215876" target="_blank" rel="noopener noreferrer">Navjot Virk&nbsp;</a>(<a class="ProfileHeaderCard-screennameLink u-linkComplex js-nav" href="https://twitter.com/navjotvirk" target="_blank" rel="noopener noreferrer">@<b class="u-linkComplex-target">navjotvirk</b></a>)&nbsp;from Microsoft about</span>&nbsp;OneDrive and SharePoint.</p>
<iframe width="100%" height="300" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/372945749&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"></iframe>
<p>For more information on The Cloud Architects podcast, check us out on <a href="https://soundcloud.com/thecloudarchitects/" target="_blank" rel="noopener noreferrer">SoundCloud</a>. We are also available on your favorite podcast app:</p>
<ul>
<li><a href="https://itunes.apple.com/us/podcast/the-cloud-architects-podcast/id1264479296?mt=2" target="_blank" rel="noopener noreferrer">iTunes</a></li>
<li><a href="https://www.stitcher.com/podcast/the-cloud-architects/the-cloud-achitects" target="_blank" rel="noopener noreferrer">Stitcher</a></li>
<li><a href="https://tunein.com/radio/The-Cloud-Architects-Podcast-p1026315/" target="_blank" rel="noopener noreferrer">Tunein</a></li>
<li><a href="https://www.acast.com/thecloudarchitectspodcast" target="_blank" rel="noopener noreferrer">Acast</a></li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=TCA Podcast Episode 9: "This is not your Grandfathers Sharepoint!"&p[summary]=In this episode, we&nbsp;talk to&nbsp;Patricia Hendricks (@phndrx)&nbsp;and Navjot Virk&nbsp;(@navjotvirk)&nbsp;from Microsoft about&nbsp...&p[url]=http://172.16.7.177:4000/2018/01/tca-podcast-episode-9-this-is-not-your-grandfathers-sharepoint" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2018/01/tca-podcast-episode-9-this-is-not-your-grandfathers-sharepoint&text=In this episode, we&nbsp;talk to&nbsp;Patricia Hendricks (@phndrx)&nbsp;and Navjot Virk&nbsp;(@navjotvirk)&nbsp;from Microsoft about&nbsp...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2017-11-22T05:47:47-06:00" itemprop="datePublished">22 Nov, 2017</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2017/11/tca-podcast-episode-8-sharepoint-isnt-so-scary">TCA Podcast Episode 8: SharePoint isn&rsquo;t so scary..</a></h2>
    </header>

    <div class="post-content">
        <p>SharePoint can be intimidating, especially for those of use who don&rsquo;t work with it everyday. In this episode,&nbsp;<a href="https://twitter.com/wonderlaura" target="_blank" rel="noopener noreferrer">@WonderLaura</a> tells us why&nbsp;SharePoint isn&rsquo;t so scary and we discuss some of the SharePoint announcements at Ignite.</p>
<iframe width="100%" height="300" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/359453783&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"></iframe>
<p>For more information on The Cloud Architects podcast, check us out on <a href="https://soundcloud.com/thecloudarchitects/" target="_blank" rel="noopener noreferrer">SoundCloud</a>. We are also available on your favorite podcast app:</p>
<ul>
<li><a href="https://itunes.apple.com/us/podcast/the-cloud-architects-podcast/id1264479296?mt=2" target="_blank" rel="noopener noreferrer">iTunes</a></li>
<li><a href="https://www.stitcher.com/podcast/the-cloud-architects/the-cloud-achitects" target="_blank" rel="noopener noreferrer">Stitcher</a></li>
<li><a href="https://tunein.com/radio/The-Cloud-Architects-Podcast-p1026315/" target="_blank" rel="noopener noreferrer">Tunein</a></li>
<li><a href="https://www.acast.com/thecloudarchitectspodcast" target="_blank" rel="noopener noreferrer">Acast</a></li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=TCA Podcast Episode 8: SharePoint isn&rsquo;t so scary..&p[summary]=SharePoint can be intimidating, especially for those of use who don&rsquo;t work with it everyday. In this episode,&nbsp;@WonderLaura tel...&p[url]=http://172.16.7.177:4000/2017/11/tca-podcast-episode-8-sharepoint-isnt-so-scary" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2017/11/tca-podcast-episode-8-sharepoint-isnt-so-scary&text=SharePoint can be intimidating, especially for those of use who don&rsquo;t work with it everyday. In this episode,&nbsp;@WonderLaura tel...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2017-11-16T07:04:38-06:00" itemprop="datePublished">16 Nov, 2017</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2017/11/tca-podcast-episode-7-the-cloud-can-make-a-real-fool-of-you">TCA Podcast Episode 7: &ldquo;The cloud can make a real fool of you&rdquo;</a></h2>
    </header>

    <div class="post-content">
        <p>Change can be difficult for any organization. Changing the working culture of your user population and driving product adoption can seem overwhelming, especially when applying traditional principles and adoption practices to today's cloud world. Nic and I&nbsp;sat down with&nbsp;Patience Wootton from Dentsu Aegis Network&nbsp;at Ignite recently to understand&nbsp;what it means to be an Office 365 Product Owner and talk about&nbsp;change, driving user adoption and being an early Microsoft Teams adopter.</p>
<iframe width="100%" height="300" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/356457452&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"></iframe>
<p>For more information on The Cloud Architects podcast, check us out on <a href="https://soundcloud.com/thecloudarchitects/" target="_blank" rel="noopener noreferrer">SoundCloud</a>. We are also available on your favorite podcast app:</p>
<ul>
<li><a href="https://itunes.apple.com/us/podcast/the-cloud-architects-podcast/id1264479296?mt=2" target="_blank" rel="noopener noreferrer">iTunes</a></li>
<li><a href="https://www.stitcher.com/podcast/the-cloud-architects/the-cloud-achitects" target="_blank" rel="noopener noreferrer">Stitcher</a></li>
<li><a href="https://tunein.com/radio/The-Cloud-Architects-Podcast-p1026315/" target="_blank" rel="noopener noreferrer">Tunein</a></li>
<li><a href="https://www.acast.com/thecloudarchitectspodcast" target="_blank" rel="noopener noreferrer">Acast</a></li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=TCA Podcast Episode 7: &ldquo;The cloud can make a real fool of you&rdquo;&p[summary]=Change can be difficult for any organization. Changing the working culture of your user population and driving product adoption can seem ...&p[url]=http://172.16.7.177:4000/2017/11/tca-podcast-episode-7-the-cloud-can-make-a-real-fool-of-you" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2017/11/tca-podcast-episode-7-the-cloud-can-make-a-real-fool-of-you&text=Change can be difficult for any organization. Changing the working culture of your user population and driving product adoption can seem ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2017-11-14T05:36:14-06:00" itemprop="datePublished">14 Nov, 2017</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2017/11/tca-podcast-episode-6-i-like-onedrive-but">TCA Podcast Episode 6: "I like OneDrive, but&hellip;"</a></h2>
    </header>

    <div class="post-content">
        <p>OneDrive for Business has come a long way since it was initially launched and has earned it's place as a leader in Gartner's Magic Quadrant for Content Collaboration Platforms. Nic and I sat down with Stephen Rose from the&nbsp;SharePoint/OneDrive team&nbsp;at Ignite recently to talk about some of the exciting new things that will be coming to OneDrive soon.</p>
<iframe width="100%" height="300" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/352200965&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"></iframe>
<p>For more information on The Cloud Architects podcast, check us out on <a href="https://soundcloud.com/thecloudarchitects/" target="_blank" rel="noopener noreferrer">SoundCloud</a>. We are also available on your favorite podcast app:</p>
<ul>
<li><a href="https://itunes.apple.com/us/podcast/the-cloud-architects-podcast/id1264479296?mt=2" target="_blank" rel="noopener noreferrer">iTunes</a></li>
<li><a href="https://www.stitcher.com/podcast/the-cloud-architects/the-cloud-achitects" target="_blank" rel="noopener noreferrer">Stitcher</a></li>
<li><a href="https://tunein.com/radio/The-Cloud-Architects-Podcast-p1026315/" target="_blank" rel="noopener noreferrer">Tunein</a></li>
<li><a href="https://www.acast.com/thecloudarchitectspodcast" target="_blank" rel="noopener noreferrer">Acast</a></li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=TCA Podcast Episode 6: "I like OneDrive, but&hellip;"&p[summary]=OneDrive for Business has come a long way since it was initially launched and has earned it's place as a leader in Gartner's Magic Quadra...&p[url]=http://172.16.7.177:4000/2017/11/tca-podcast-episode-6-i-like-onedrive-but" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2017/11/tca-podcast-episode-6-i-like-onedrive-but&text=OneDrive for Business has come a long way since it was initially launched and has earned it's place as a leader in Gartner's Magic Quadra...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2017-10-10T12:53:25-05:00" itemprop="datePublished">10 Oct, 2017</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2017/10/the-cloud-architects-podcast">The Cloud Architects Podcast</a></h2>
    </header>

    <div class="post-content">
        <p>Better late than never.. I'm delighted to annouce that I'll be joining <a href="http://thearchitects.cloud" target="_blank" rel="noopener noreferrer">The Cloud Architects Podcast</a> as a co-host. Started by fellow MVPs <a href="https://twitter.com/nicolasblank" target="_blank" rel="noopener noreferrer">Nicolas Blank</a> and <a href="https://twitter.com/warrendt" target="_blank" rel="noopener noreferrer">Warren du Toit</a>, the Cloud Architects podcast is about best practice, guidance, news and cutting edge Microsoft cloud technologies - I'm really excited to be involved.</p>
<p>Microsoft&nbsp;Ignite gave us a great opportunity to connect with and talk to some really interesting people - those episodes will be published soon, but in the meantime, we recently recorded in introductory episode where we talk about some of the complexities of adopting cloud technologies at scale:</p>
<iframe width="100%" height="300" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/352195508&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"></iframe>
<p>&nbsp;</p>
<p>For more information about the podcast, <a href="http://thearchitects.cloud" target="_blank" rel="noopener noreferrer">visit us on the web</a> or <a href="https://twitter.com/theCloudArch" target="_blank" rel="noopener noreferrer">twitter</a>. We are still getting started and experimenting with show formats, etc. and would love feedback so feel free to get in touch and let us know how we are doing.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=The Cloud Architects Podcast&p[summary]=Better late than never.. I'm delighted to annouce that I'll be joining The Cloud Architects Podcast as a co-host. Started by fellow MVPs ...&p[url]=http://172.16.7.177:4000/2017/10/the-cloud-architects-podcast" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2017/10/the-cloud-architects-podcast&text=Better late than never.. I'm delighted to annouce that I'll be joining The Cloud Architects Podcast as a co-host. Started by fellow MVPs ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2017-07-06T06:28:58-05:00" itemprop="datePublished">6 Jul, 2017</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2017/07/office-servers-and-services-mvp-2017">Office Servers and Services MVP 2017!</a></h2>
    </header>

    <div class="post-content">
        <p>The last few weeks have been incredibly busy.. I spent a week in Europe and presented a <a href="http://www.cgoosen.com/2017/06/dank-je-wel-haarlem/" target="_blank">couple of sessions at Office 365 Engage</a> in The Netherlands and after a quick laundry stop at home I headed off to Washington D.C were I presented two sessions at a small technology conference for overseas schools (K-12). That&rsquo;s two conferences and four sessions in two weeks &ndash; I was pretty exhausted at the end of it all but was super excited when I received an email from the Microsoft MVP program informing me that I had been awarded my fourth Microsoft Most Valuable Professional (MVP) Award. </p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2017/07/Screen-Shot-2017-07-06-at-10.51.27-AM.png"><img width="534" height="105" title="Screen Shot 2017-07-06 at 10.51.27 AM" style="border: 0px currentcolor; border-image: none; display: inline; background-image: none;" alt="Screen Shot 2017-07-06 at 10.51.27 AM" src="http://www.cgoosen.com/wp-content/uploads/2017/07/Screen-Shot-2017-07-06-at-10.51.27-AM_thumb.png" border="0"></a></p>
<p>I&rsquo;m truly honored to be part of this great community and have some ambitious plans for the next year, so stay tuned!</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Office Servers and Services MVP 2017!&p[summary]=The last few weeks have been incredibly busy.. I spent a week in Europe and presented a couple of sessions at Office 365 Engage in The Ne...&p[url]=http://172.16.7.177:4000/2017/07/office-servers-and-services-mvp-2017" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2017/07/office-servers-and-services-mvp-2017&text=The last few weeks have been incredibly busy.. I spent a week in Europe and presented a couple of sessions at Office 365 Engage in The Ne...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2017-06-29T11:18:21-05:00" itemprop="datePublished">29 Jun, 2017</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2017/06/dank-je-wel-haarlem">Dank je wel, Haarlem!</a></h2>
    </header>

    <div class="post-content">
        <p>Last week, I was fortunate enough to speak at the inaugural <a href="https://office365engage.com/" target="_blank">Office 365 Engage conference</a> in Haarlem, Netherlands. I had been looking forward to it for months, not only because it was my first time visiting the Netherlands, but I had heard about how picturesque the city was and had been told that the conference venue, the Philharmonie, was something quite special. I can honestly say that no description could do it justice, it really is the nicest conference venue I&rsquo;ve ever seen.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2017/06/IMG_9206.jpg"><img title="IMG_9206" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="IMG_9206" src="http://www.cgoosen.com/wp-content/uploads/2017/06/IMG_9206_thumb.jpg" width="268" height="357"></a></p>
<p>The conference itself was extremely well organized and I definitely have to compliment the organizers for the level of thought that went into every detail. There were more than 40 speakers, 31 of which were Microsoft MVPs. We were encouraged to call on our real world experience and be independent voices so this was a true technical conference and not just another marketing junket. There were 6 tracks with plenty of great content to go around:</p>
<ul>
<li>Azure Infrastructure</li>
<li>Exchange Online</li>
<li>Office 365 Administration</li>
<li>Office 365 Applications</li>
<li>Office 365 Development</li>
<li>SharePoint Online</li>
</ul>
<p>My sessions on Office 365 management and mobile device management were well received and I even managed to pull off an elaborate demo using a couple of devices. A <a href="https://vanhybrid.com" target="_blank">special thanks to MVH</a> for helping me getting around the need for multiple HDMI inputs, it definitely made the demo flow more smoothly.</p>
<p>After a few great days, I can only imagine that Office 365 Engage 2018 will be even better. If you are looking to build your skills and network with some of the best in the business, I&rsquo;d definitely encourage you to check out Office 365 Engage in 2018 &ndash; I hope to see you there!</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Dank je wel, Haarlem!&p[summary]=Last week, I was fortunate enough to speak at the inaugural Office 365 Engage conference in Haarlem, Netherlands. I had been looking forw...&p[url]=http://172.16.7.177:4000/2017/06/dank-je-wel-haarlem" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2017/06/dank-je-wel-haarlem&text=Last week, I was fortunate enough to speak at the inaugural Office 365 Engage conference in Haarlem, Netherlands. I had been looking forw...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2017-05-31T10:19:28-05:00" itemprop="datePublished">31 May, 2017</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2017/05/ill-be-speaking-at-office-365-engage">I am speaking at Office 365 Engage!</a></h2>
    </header>

    <div class="post-content">
        <p>I&rsquo;m really excited to announce that I&rsquo;ll be speaking at <a href="https://office365engage.com" target="_blank" rel="noopener noreferrer">Office 365 Engage</a> in Haarlem, Netherlands 19-22 June 2017.</p>
<p style="text-align: center;"><a href="https://office365engage.com/speakers/chris-goosen/" target="_blank" rel="noopener noreferrer"><img class="aligncenter wp-image-2794 size-full" src="https://www.cgoosen.com/wp-content/uploads/2017/05/cgbanner.png" alt="" width="728" height="90" /></a></p>
<p style="text-align: center;"><a href="https://www.cgoosen.com/wp-content/uploads/2017/05/Chris-Goosen-728x90.png"><img class="aligncenter size-medium wp-image-2793" style="display: none !important;" src="https://www.cgoosen.com/wp-content/uploads/2017/05/Chris-Goosen-728x90-300x37.png" alt="" width="300" height="37" /></a></p>
<p style="text-align: center;"><a href="https://www.cgoosen.com/wp-content/uploads/2017/05/Chris-Goosen-728x90.png"><img class="aligncenter size-full wp-image-2791" style="display: none !important;" src="https://www.cgoosen.com/wp-content/uploads/2017/05/Chris-Goosen-728x90.png" alt="" width="728" height="90" /></a></p>
<p style="text-align: center;"><a href="https://www.cgoosen.com/wp-content/uploads/2017/05/ChrisGoosen728x90.png"><img class="aligncenter size-full wp-image-2786" style="display: none !important;" src="https://www.cgoosen.com/wp-content/uploads/2017/05/ChrisGoosen728x90.png" alt="" width="728" height="90" /></a></p>
<p style="text-align: center;"><a href="https://www.cgoosen.com/wp-content/uploads/2017/05/ChrisGoosen728x90.png"><img class="aligncenter wp-image-2786 size-full" style="display: none !important;" src="https://www.cgoosen.com/wp-content/uploads/2017/05/ChrisGoosen728x90.png" alt="" width="728" height="90" /></a></p>
<p><img class="aligncenter" style="display: block; float: none; margin: 5px auto;" title="" src="ChrisGoosen728x90.png" alt="" width="728" height="90" data-position="1" /></p>
<p>Office 365 Engage is Europe&rsquo;s foremost conference on Office 365 and will be hosted at the Philharmonie Theatre in the energetic picturesque city of Haarlem.</p>
<p>I am thrilled to be one of more than <a href="https://office365engage.com/speakers/" target="_blank" rel="noopener noreferrer">30 Microsoft MVPs speaking</a> at the event so if you are interested in learning all about Micrsoft Office 365, it isn&rsquo;t too late to register today!</p>
<p>Use discount code &lsquo;SPRCG378&rsquo; to receive a 20% discount when registering.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=I am speaking at Office 365 Engage!&p[summary]=I&rsquo;m really excited to announce that I&rsquo;ll be speaking at Office 365 Engage in Haarlem, Netherlands 19-22 June 2017.






Offi...&p[url]=http://172.16.7.177:4000/2017/05/ill-be-speaking-at-office-365-engage" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2017/05/ill-be-speaking-at-office-365-engage&text=I&rsquo;m really excited to announce that I&rsquo;ll be speaking at Office 365 Engage in Haarlem, Netherlands 19-22 June 2017.






Offi...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2017-03-29T01:15:11-05:00" itemprop="datePublished">29 Mar, 2017</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2017/03/script-connect-365-ps-connect-to-office-365-services-using-remote-powershell">Script: Connect-365.ps1 - Connect to Office 365 services using remote PowerShell</a></h2>
    </header>

    <div class="post-content">
        <p>I'm excited to announce the release of Connect-365! Back 2012, I put together a basic script with a GUI to simplify connecting to Exchange Online via remote PowerShell. I had never intended to make the script publicly available and it was just something I used myself. After a couple years I realized that it had been shared with so many colleagues and clients that I decided to clean it up and publish it on the TechNet gallery. Connect-EXO was born! Here's a screenshot of the original first version:</p>
<p style="text-align: center;"><a href="https://www.cgoosen.com/wp-content/uploads/2017/03/Capture1.png"><img class="aligncenter size-medium wp-image-2684" src="https://www.cgoosen.com/wp-content/uploads/2017/03/Capture1-300x281.png" alt="" width="300" height="281" /></a></p>
<p style="text-align: left;">Over time the script matured <a href="https://www.cgoosen.com/2014/10/script-connect-exo-ps1-connect-to-exchange-online-using-remote-powershell/" target="_blank" rel="noopener">into what Connect-EXO is today</a>. One of the challenges in the early version was that I used WPF for the GUI, this was problematic for older versions of PowerShell so I made the decision to port it to Windows Forms for backward compatibility. Forms is old and added a lot of bloat and since&nbsp;backwards compatibility is no longer a concern, I decided to move back to WPF. Connect-365 is essentially the next version of Connect-EXO, I renamed it so more accurately reflect it's purpose and this will allow me to continue to maintain Connect-EXO.</p>
<p style="text-align: left;">Connect-365 features a GUI that will prompt for your tenant credentials and then connect to various Office 365 services using remote PowerShell. The built-in prerequisite checker will check to ensure that the correct modules are installed and provide a download link for those that are not.</p>
<p>The current version of the script allows connectivity to:</p>
<ul>
<li>Exchange Online</li>
<li>Azure Active Directory (using v2 module)</li>
<li>Office 365 Security &amp; Compliance Center</li>
<li>Skype for Business Online</li>
<li>SharePoint Online</li>
</ul>
<p><strong>Requirements:</strong><br />
This script will work natively in PowerShell 4.0+</p>
<p><strong>Usage:</strong><br />
There are no parameters or switches, simply execute the script: <em>.\Connect-365.ps1</em></p>
<p><strong>Execution Policy:</strong><br />
This script has been digitally signed and will run just fine under a "RemoteSigned" execution policy</p>
<p><strong>Screenshots:</strong></p>
<p style="text-align: center;"><a href="https://www.cgoosen.com/wp-content/uploads/2019/02/Screen-Shot-2019-02-27-at-2.09.37-PM.png"><img class="aligncenter size-full wp-image-3707" src="https://www.cgoosen.com/wp-content/uploads/2019/02/Screen-Shot-2019-02-27-at-2.09.37-PM.png" alt="" width="539" height="415" /></a></p>
<p style="text-align: center;"><a href="https://www.cgoosen.com/wp-content/uploads/2017/03/Screen-Shot-2019-02-27-at-2.09.09-PM.png"><img class="aligncenter size-full wp-image-3710" src="https://www.cgoosen.com/wp-content/uploads/2017/03/Screen-Shot-2019-02-27-at-2.09.09-PM.png" alt="" width="539" height="415" /></a></p>
<p style="text-align: center;"><a href="https://www.cgoosen.com/wp-content/uploads/2017/03/c.png"><img class="aligncenter wp-image-2687" src="https://www.cgoosen.com/wp-content/uploads/2017/03/c.png" alt="" width="628" height="125" /></a></p>
<p><strong>Roadmap:</strong></p>
<ul>
<li><del>Support Azure AD v1 and v2</del> - Removed as v1 is depreciated</li>
<li><del>Support for Exchange Online MFA (via module)</del> - Done!</li>
<li>Derive SPO Admin URL</li>
<li>Auto-install prerequisites</li>
<li>Much more..</li>
</ul>
<p><strong>Download:<br />
</strong>I have published it to the TechNet Gallery, <a href="http://cgoo.se/1srvTiS" target="_blank" rel="noopener">it can be downloaded by clicking here&hellip;</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Script: Connect-365.ps1 - Connect to Office 365 services using remote PowerShell&p[summary]=I'm excited to announce the release of Connect-365! Back 2012, I put together a basic script with a GUI to simplify connecting to Exchang...&p[url]=http://172.16.7.177:4000/2017/03/script-connect-365-ps-connect-to-office-365-services-using-remote-powershell" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2017/03/script-connect-365-ps-connect-to-office-365-services-using-remote-powershell&text=I'm excited to announce the release of Connect-365! Back 2012, I put together a basic script with a GUI to simplify connecting to Exchang...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2017-03-15T10:49:32-05:00" itemprop="datePublished">15 Mar, 2017</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2017/03/connecting-to-exchange-online-with-remote-powershell-from-a-mac">Connecting to Exchange Online with remote PowerShell from a Mac</a></h2>
    </header>

    <div class="post-content">
        <p>Yes! it is finally possible to connect to Exchange Online from PowerShell installed on MacOS. I noticed some tweets <a href="https://mattmcnabb.github.io/O365-PowerShell-On-Linux" target="_blank" rel="noopener noreferrer">about this being possible on Linux</a> earlier in the week so I thought I&rsquo;d re-visit testing it on MacOS. PowerShell remoting has been available in the MacOs version since powershell-6.0.0-alpha.15, but it didn&rsquo;t include the ability to specify a &ldquo;ConnectionUri&rsquo; as the endpoint &ndash; it only worked with server names and IP addresses. powershell-6.0.0-alpha.17 which was recently released now includes this functionality.</p>
<p>The first thing you need to do it <a href="https://github.com/PowerShell/PowerShell" target="_blank" rel="noopener noreferrer">download and install the latest release from here</a>, you&rsquo;ll want to download at least powershell-6.0.0-alpha.17</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2017/03/Screen-Shot-2017-03-15-at-3.47.08-PM.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Screen Shot 2017-03-15 at 3.47.08 PM" src="http://www.cgoosen.com/wp-content/uploads/2017/03/Screen-Shot-2017-03-15-at-3.47.08-PM_thumb.png" alt="Screen Shot 2017-03-15 at 3.47.08 PM" width="410" height="290" border="0" /></a></p>
<p align="left">Next launch PowerShell and confirm the version:</p>
<p>[powershell]<br />
$PSVersionTable<br />
[/powershell]</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2017/03/Screen-Shot-2017-03-15-at-4.31.53-PM.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Screen Shot 2017-03-15 at 4.31.53 PM" src="http://www.cgoosen.com/wp-content/uploads/2017/03/Screen-Shot-2017-03-15-at-4.31.53-PM_thumb.png" alt="Screen Shot 2017-03-15 at 4.31.53 PM" width="410" height="263" border="0" /></a></p>
<p align="left">We are now ready to run establish our remote session. First let&rsquo;s define our credentials:</p>
<p>[powershell]<br />
$UserCredential = Get-Credential<br />
[/powershell]</p>
<p align="left">Then create the session:</p>
<p>[powershell]<br />
$Session = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri https://outlook.office365.com/powershell-liveid -Credential $UserCredential -Authentication Basic -AllowRedirection<br />
[/powershell]</p>
<p align="left">And finally, import that session:</p>
<p>[powershell]<br />
Import-PSSession $Session<br />
[/powershell]</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2017/03/Screen-Shot-2017-03-15-at-4.41.16-PM.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Screen Shot 2017-03-15 at 4.41.16 PM" src="http://www.cgoosen.com/wp-content/uploads/2017/03/Screen-Shot-2017-03-15-at-4.41.16-PM_thumb.png" alt="Screen Shot 2017-03-15 at 4.41.16 PM" width="410" height="263" border="0" /></a></p>
<p align="left">Once connected you have all the Exchange Online cmdlets available to you:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2017/03/Screen-Shot-2017-03-15-at-4.46.02-PM.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Screen Shot 2017-03-15 at 4.46.02 PM" src="http://www.cgoosen.com/wp-content/uploads/2017/03/Screen-Shot-2017-03-15-at-4.46.02-PM_thumb.png" alt="Screen Shot 2017-03-15 at 4.46.02 PM" width="410" height="263" border="0" /></a></p>
<p align="left">I haven&rsquo;t thoroughly tested it yet, but I look forward to spending some time using it soon!</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Connecting to Exchange Online with remote PowerShell from a Mac&p[summary]=Yes! it is finally possible to connect to Exchange Online from PowerShell installed on MacOS. I noticed some tweets about this being poss...&p[url]=http://172.16.7.177:4000/2017/03/connecting-to-exchange-online-with-remote-powershell-from-a-mac" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2017/03/connecting-to-exchange-online-with-remote-powershell-from-a-mac&text=Yes! it is finally possible to connect to Exchange Online from PowerShell installed on MacOS. I noticed some tweets about this being poss...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2017-02-28T12:54:52-06:00" itemprop="datePublished">28 Feb, 2017</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2017/02/single-sign-on-with-azure-ad-connect">Single Sign On with Azure AD Connect</a></h2>
    </header>

    <div class="post-content">
        <p>Ever since the launch of Office 365 (and BPOS before that) there has been a desire to make accessing these services as seamless as possible. Single Sign On (SSO) has long been high on the requirements list for many organizations and while it has been possible for some time now to provide a near seamless login experience, it has historically come at a cost in the form of additional infrastructure - usually deployed on-premises and at the very least carrying some sort of administrative burden. I&rsquo;m not against identity federation, I think it definitely has it&rsquo;s place and most of the customers I work with already have some federation solution deployed so it makes a lot of sense leveraging it for Office 365 as well, but there are always those organizations who don&rsquo;t already have a solution in place or those smaller environments where it doesn&rsquo;t make a whole lot of sense to implement a highly-available AD FS deployment.</p>
<p>Password Sync has long been the best compromise, offering a &ldquo;Same Sign On&rdquo; experience where users are able to use their existing AD credentials to access Office 365 services. The <a href="https://blogs.technet.microsoft.com/enterprisemobility/2016/12/07/introducing-azuread-pass-through-authentication-and-seamless-single-sign-on/" target="_blank">recent announcement of Pass-Through Authentication and Single Sign-on</a> means that things are about to get a whole lot better!</p>
<p>I wanted to put together a quick post and run through how easy it is to setup Single Sign On and review the user experience when it is used with Password Sync. Single Sign On can also be enabled with the new Pass-through authentication option, but that&rsquo;s a story for another post!</p>
<p>Before getting started, it is important to understand the client requirements. The client should:</p>
<ul>
<li>be using a domain-joined machine
<li>be using Windows and a supported browser (Edge is <u>not</u> supported)
<li>have direct access to a domain controller
<li>have the Kerberos end-points defined in the browser&rsquo;s Intranet zone (AD Group Policy is the easiest way to do this)
<ul>
<li>https://autologon.microsoftazuread-sso.com
<li>https://aadg.windows.net.nsatc.net</li>
</ul>
</li>
</ul>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2017/02/a.png"><img title="a" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="a" src="http://www.cgoosen.com/wp-content/uploads/2017/02/a_thumb.png" width="344" height="308"></a></p>
<p align="left">Once the client requirements have been taken care of, we need to update AAD Connect. At the time of writing, version 1.1.380.0 is the latest version. It looks like these new features were introduced in version 1.1.370.0. If we compare the the &ldquo;User sign-in&rdquo; page to that of an older build you&rsquo;ll notice the addition of a few more features:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2017/02/2a.png"><img title="2a" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="2a" src="http://www.cgoosen.com/wp-content/uploads/2017/02/2a_thumb.png" width="400" height="282"></a>&nbsp;<a href="http://www.cgoosen.com/wp-content/uploads/2017/02/7.png"><img title="7" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="7" src="http://www.cgoosen.com/wp-content/uploads/2017/02/7_thumb.png" width="400" height="282"></a></p>
<p>To upgrade AAD Connect, follow your regular upgrade procedure. If you don&rsquo;t have any customizations or special considerations, you can just let the wizard perform the upgrade for you:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2017/02/3.png"><img title="3" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="3" src="http://www.cgoosen.com/wp-content/uploads/2017/02/3_thumb.png" width="400" height="282"></a></p>
<p align="left">Once upgraded, you&rsquo;ll want to run the configuration wizard again and tick the &ldquo;Enable single sign on&rdquo; checkbox on the &ldquo;User sign-in&rdquo; page (shown above) and that is all there is to it!</p>
<p align="left">Let&rsquo;s compare the user experience before and after enabling Single Sign On. Here is the user experience before:</p>
<p align="center"><iframe height="482" src="https://player.vimeo.com/video/206158120" frameborder="0" width="640" allowfullscreen mozallowfullscreen webkitallowfullscreen></iframe></p>
<p align="left">and here is the user experience after implementing Single Sign On with AAD Connect (you&rsquo;ll notice that I do not have to re-enter my password this time):</p>
<p align="center"><iframe height="482" src="https://player.vimeo.com/video/206158265" frameborder="0" width="640" allowfullscreen mozallowfullscreen webkitallowfullscreen></iframe></p>
<p align="left">Note: In the demo videos, I have my home page set in a way that forces my custom branding before any user credentials are entered. You can do this by either creating a web redirect or setting your home page to: <a href="https://login.microsoftonline.com/login.srf?whr=your_domain.com">https://login.microsoftonline.com/login.srf?whr=your_domain.com</a> (replace your_domain.com with your actual domain name!)</p>
<p align="left">There is a lot of great documentation available about Single Sign On on the Microsoft website, I highly recommend that you check it out as well:</p>
<ul>
<li>
<div align="left"><a href="https://docs.microsoft.com/en-us/azure/active-directory/connect/active-directory-aadconnect-sso" target="_blank">What is Single Sign On (SSO)</a></div>
</li>
<li>
<div align="left"><a href="https://docs.microsoft.com/en-us/azure/active-directory/connect/active-directory-aadconnect-version-history" target="_blank">Azure AD Connect: Version release history</a></div>
</li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Single Sign On with Azure AD Connect&p[summary]=Ever since the launch of Office 365 (and BPOS before that) there has been a desire to make accessing these services as seamless as possib...&p[url]=http://172.16.7.177:4000/2017/02/single-sign-on-with-azure-ad-connect" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2017/02/single-sign-on-with-azure-ad-connect&text=Ever since the launch of Office 365 (and BPOS before that) there has been a desire to make accessing these services as seamless as possib...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2017-02-07T11:06:14-06:00" itemprop="datePublished">7 Feb, 2017</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2017/02/configuring-session-timeouts-for-outlook-on-the-web-owa-in-exchange-online">Configuring session timeouts for Outlook on the Web (OWA) in Exchange Online</a></h2>
    </header>

    <div class="post-content">
        <p>In today&rsquo;s browser first, cloud first world, many organizations look at reducing risk by imposing strict session timeout settings on their productivity tools and applications. The idea generally is that if a user is not actively using and application for 10 &ndash;15 mins, they have completed the task they were working on and have forgotten to logoff correctly. This can be especially dangerous when these applications are accessed on shared terminals or public computers. Given that email remains a vitally important business tool for many organizations, reducing the session timeout on Exchange Online (and Exchange 2016) is a fairly common request and it is really simple to do.</p>
<p>By default, session timeout is enabled for OWA (let&rsquo;s just call it that, shall we?) and it set to 6 hours. You can confirm this configuration via PowerShell using the Get-OrganizationConfig cmdlet:</p>
<p>[powershell]Get-OrganizationConfig | FL ActivityBasedAuthenticationTimeout*[/powershell]</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2017/01/cap1.png"><img class="aligncenter size-medium wp-image-2456" src="http://www.cgoosen.com/wp-content/uploads/2017/01/cap1-300x65.png" alt="" width="300" height="65" /></a></p>
<p>There are two parameters in particular worth paying attention to:</p>
<ul>
<li>ActivityBasedAuthenticationTimeoutEnabled</li>
<li>ActivityBasedAuthenticationTimeoutInterval</li>
</ul>
<p><em>ActivityBasedAuthenticationTimeoutEnabled </em>is pretty self-explanatory, you will want to keep it enabled if you intended to set the timeout interval. The&nbsp;<em>ActivityBasedAuthenticationTimeoutInterval </em>parameter&nbsp;controls the actual timeout interval in&nbsp;<em>hh</em>:<em>mm</em>:<em>ss</em>&nbsp;format where&nbsp;<em>hh</em>&nbsp;= hours,&nbsp;<em>mm</em>&nbsp;= minutes and&nbsp;<em>ss</em>&nbsp;= seconds. Note that this parameter has a range of 5 min - 8 hrs. Changes can be made using the Set-OrganizationConfig cmdlet, for example to set the timeout interval to 15 mins we'd issue the following cmd:</p>
<p>[powershell]Set-OrganizationConfig -ActivityBasedAuthenticationTimeoutInterval 00:15:00[/powershell]</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2017/02/cap2.png"><img class="aligncenter size-medium wp-image-2480" src="http://www.cgoosen.com/wp-content/uploads/2017/02/cap2-300x50.png" alt="" width="300" height="50" /></a></p>
<p>During my testing, it took a really long time (12+ hrs) for this to take effect so don't be alarmed if it doesn't work right away.</p>
<p>For more information on the <a href="https://technet.microsoft.com/en-us/library/aa997443(v=exchg.160).aspx" target="_blank">Set-OrganizationConfig parameters, see TechNet</a>.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Configuring session timeouts for Outlook on the Web (OWA) in Exchange Online&p[summary]=In today&rsquo;s browser first, cloud first world, many organizations look at reducing risk by imposing strict session timeout settings o...&p[url]=http://172.16.7.177:4000/2017/02/configuring-session-timeouts-for-outlook-on-the-web-owa-in-exchange-online" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2017/02/configuring-session-timeouts-for-outlook-on-the-web-owa-in-exchange-online&text=In today&rsquo;s browser first, cloud first world, many organizations look at reducing risk by imposing strict session timeout settings o...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2016-11-30T12:00:03-06:00" itemprop="datePublished">30 Nov, 2016</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2016/11/getting-started-with-aad-conditional-access-location-based-access-rules">Getting started with AAD conditional access - Location based access rules</a></h2>
    </header>

    <div class="post-content">
        <p>Azure Active Directory (AAD) conditional access is something I&rsquo;ve been wanting to post about for a while now. A scenario I come across fairly often is the desire to prevent access or add an additional layer of security to certain Office 365 workloads when the user is connecting from a remote, non-corporate location. In the past, this could be achieved by making use of claims rules and Active Directory Federation Services (AD FS) which meant that it wasn&rsquo;t possible for those organizations not making use of federated identities with Office 365.</p>
<p>AAD conditional access solves this problem and makes it really simple to apply access policies to AAD connected applications. Conditional access does require an AAD premium license (P1). In this post we&rsquo;ll cover a simple location based scenario where we prevent users from accessing Outlook on the web (OWA) from outside of the organization&rsquo;s network. In order to configure conditional access you will require:</p>
<ul>
<ul>
<li>Azure Active Directory premium licensing</li>
<li>Access to the Azure management portal (classic portal)</li>
</ul>
</ul>
<p>Conditional access policies are configured via the classic Azure management portal (http://manage.windowsazure.com). Locate &ldquo;Active Directory&rdquo; on the left-hand side, select your Office 365 directory and click the &ldquo;Applications&rdquo; option.</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2016/12/Screen-Shot-2016-11-30-at-3.10.34-PM.png"><img class="aligncenter size-medium wp-image-2170" src="http://www.cgoosen.com/wp-content/uploads/2016/12/Screen-Shot-2016-11-30-at-3.10.34-PM-300x178.png" alt="screen-shot-2016-11-30-at-3-10-34-pm" width="300" height="178" /></a></p>
<p>Next, select the &ldquo;Office 365 Exchange Online&rdquo; application and turn access rules &ldquo;On&rdquo; under the &ldquo;Multi-factor authentication and location based access rules&rdquo; section. You have the option of applying your rules to all users or select groups. You then select the &ldquo;Block access when not at work&rdquo; option. You also have to option to enforce MFA for an application which is useful if you would like to enable MFA only for specific applications or you could require MFA only when users are accessing the application from outside the corporate network.</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2016/12/Screen-Shot-2016-11-30-at-3.19.39-PM.png"><img class="aligncenter size-medium wp-image-2171" src="http://www.cgoosen.com/wp-content/uploads/2016/12/Screen-Shot-2016-11-30-at-3.19.39-PM-300x284.png" alt="screen-shot-2016-11-30-at-3-19-39-pm" width="300" height="284" /></a></p>
<p>It is important to ensure that you define your corporate network ranges by clicking link. All connections from locations outside the definted network ranges will be treated as remote.</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2016/12/Screen-Shot-2016-11-30-at-3.16.18-PM.png"><img class="aligncenter size-medium wp-image-2172" src="http://www.cgoosen.com/wp-content/uploads/2016/12/Screen-Shot-2016-11-30-at-3.16.18-PM-276x300.png" alt="screen-shot-2016-11-30-at-3-16-18-pm" width="276" height="300" /></a>Once configured, you will notice that users are still able to access the Office 365 portal however, once they click the mail option in the app launcher they will no longer be able to access Outlook on the web unless they are connecting from a approved location.</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2016/12/Screen-Shot-2016-11-30-at-3.22.49-PM-1.png"><img class="aligncenter size-medium wp-image-2173" src="http://www.cgoosen.com/wp-content/uploads/2016/12/Screen-Shot-2016-11-30-at-3.22.49-PM-1-300x156.png" alt="screen-shot-2016-11-30-at-3-22-49-pm" width="300" height="156" /></a></p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2016/12/Screen-Shot-2016-11-30-at-3.23.23-PM.png"><img class="aligncenter size-medium wp-image-2174" src="http://www.cgoosen.com/wp-content/uploads/2016/12/Screen-Shot-2016-11-30-at-3.23.23-PM-300x184.png" alt="screen-shot-2016-11-30-at-3-23-23-pm" width="300" height="184" /></a></p>
<p>This is a very simple example of how to use location based access rules. It is also possible to configure device based access policies which provide an incredible amount of control over which devices can access your applications. I&rsquo;ll cover device based access policies in a future post.</p>
<p>&nbsp;</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Getting started with AAD conditional access - Location based access rules&p[summary]=Azure Active Directory (AAD) conditional access is something I&rsquo;ve been wanting to post about for a while now. A scenario I come acr...&p[url]=http://172.16.7.177:4000/2016/11/getting-started-with-aad-conditional-access-location-based-access-rules" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2016/11/getting-started-with-aad-conditional-access-location-based-access-rules&text=Azure Active Directory (AAD) conditional access is something I&rsquo;ve been wanting to post about for a while now. A scenario I come acr...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2016-08-30T14:20:34-05:00" itemprop="datePublished">30 Aug, 2016</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2016/08/disabling-modern-attachments-in-outlook-2016">Disabling Modern Attachments in Outlook 2016</a></h2>
    </header>

    <div class="post-content">
        <p>The modern attachments (aka cloudy attachments) feature in Outlook 2016 makes it simple for users to share documents stored in OneDrive for Business or SharePoint with each other as links instead of actually attaching the file and emailing it around. This is a great way to reduce the number of different document versions floating around the organization and helps promote collaboration and co-authoring. Once a cloudy attachment is attached to an email, the user can grant view only or edit permissions to the recipient and Exchange will automatically take care of applying the appropriate permission to the document.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2016/08/blog1.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="blog1" src="http://www.cgoosen.com/wp-content/uploads/2016/08/blog1_thumb.png" alt="blog1" width="249" height="206" border="0" /></a></p>
<p align="left">This feature is available out of the box for Exchange Online users using Outlook 2016 and can be enabled for on-premises users with mailboxes on Exchange 2016 provided OAuth between Exchange 2016 and Office 365 has been <a href="https://technet.microsoft.com/EN-US/library/mt589761%28v=exchg.150%29.aspx" target="_blank" rel="noopener noreferrer">configured properly and the appropriate prerequisites are in place</a>, but what happens to on-premises customers who do not have Exchange 2016 deployed? The scenario is really interesting in that Outlook will still allow users to send cloudy attachments, but because the backend Exchange environment isn&rsquo;t able to apply the appropriate permission to the document the recipient will be unable to view the attachment:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2016/08/bog2.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="bog2" src="http://www.cgoosen.com/wp-content/uploads/2016/08/bog2_thumb.png" alt="bog2" width="413" height="234" border="0" /></a></p>
<p align="left">This behavior may confuse users and may not be desirable in some environments and while there is no way to specifically disable modern attachments, there is a workaround that may help achieve similar results. There are two options in Outlook that enable modern attachments:</p>
<ul>
<li>The &ldquo;Browse Web Locations&rdquo; option allows users to select files from OneDrive for Business, SharePoint sites or Groups.</li>
<li>The &ldquo;Recent items&rdquo; list provides a list of recently saved documents and when these documents are saved to OneDrive for Business or SharePoint it will automatically provide the option to attach a cloudy attachment version of the document.</li>
</ul>
<p>Disabling these two options in Outlook will effectively prevent users from being able to send cloudy attachments and change the user experience from this:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2016/08/default.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="default" src="http://www.cgoosen.com/wp-content/uploads/2016/08/default_thumb.png" alt="default" width="455" height="127" border="0" /></a></p>
<p align="left">To this:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2016/08/after.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="after" src="http://www.cgoosen.com/wp-content/uploads/2016/08/after_thumb.png" alt="after" width="366" height="122" border="0" /></a></p>
<p align="left">In order to do this, the following registry keys need to be added to the client machine for each user:</p>
<p style="text-align: center;"><a href="https://www.cgoosen.com/wp-content/uploads/2016/08/Screen-Shot-2017-08-21-at-11.43.08-AM.png"><img class="aligncenter size-full wp-image-2963" src="https://www.cgoosen.com/wp-content/uploads/2016/08/Screen-Shot-2017-08-21-at-11.43.08-AM.png" alt="" width="646" height="76" /></a></p>
<p>To simplify this, you can <a href="http://www.cgoosen.com/downloads/DisableModernAttachments.zip" target="_blank" rel="noopener noreferrer">download the registry keys here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Disabling Modern Attachments in Outlook 2016&p[summary]=The modern attachments (aka cloudy attachments) feature in Outlook 2016 makes it simple for users to share documents stored in OneDrive f...&p[url]=http://172.16.7.177:4000/2016/08/disabling-modern-attachments-in-outlook-2016" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2016/08/disabling-modern-attachments-in-outlook-2016&text=The modern attachments (aka cloudy attachments) feature in Outlook 2016 makes it simple for users to share documents stored in OneDrive f...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2016-07-26T14:23:53-05:00" itemprop="datePublished">26 Jul, 2016</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2016/07/automating-archive-folder-creation-in-exchange-online-mailboxes">Automating archive folder creation in Exchange Online mailboxes</a></h2>
    </header>

    <div class="post-content">
        <p align="left">If you are using Outlook 2016 on Windows or Mac you will have noticed the recent addition of a one-click &lsquo;Archive&rsquo; button to the ribbon. The addition of the archive button was <a href="https://blogs.office.com/2016/02/25/february-office-365-updates/" target="_blank">announced at the end of February</a>, but seems to have caught a bunch of customers by surprise and there appears to be some confusion about it&rsquo;s intended purpose. If you are unfamiliar with the one-click &lsquo;Archive&rsquo; button, here&rsquo;s what it looks like:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2016/07/a.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="a" src="http://www.cgoosen.com/wp-content/uploads/2016/07/a_thumb.png" alt="a" width="240" height="140" border="0" /></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://www.cgoosen.com/wp-content/uploads/2016/07/b.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="b" src="http://www.cgoosen.com/wp-content/uploads/2016/07/b_thumb.png" alt="b" width="206" height="120" border="0" /></a></p>
<p align="left">The archive button is intended to make archiving email a one-click operation, but this does not archive email to an Online Archive and does not require users to have an Online Archive enabled. Instead, the button will file email to an &lsquo;Archive&rsquo; folder in your existing mailbox. The intention here is that this button provides a single-click way to clean or declutter your inbox of messages that you have already read. It is important to understand the following about the archive button:</p>
<ul>
<li>
<div align="left">The archive button cannot be used to send email messages to the Online Archive.</div>
</li>
<li>
<div align="left">Since the archive folder is a folder in the root of the mailbox, moving email to it will not reduce the overall size of the mailbox.</div>
</li>
</ul>
<p align="left">If a folder called &lsquo;Archive&rsquo; does not already exist in the root of the mailbox, the user will be prompted to create one:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2016/07/1.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="1" src="http://www.cgoosen.com/wp-content/uploads/2016/07/1_thumb.png" alt="1" width="416" height="112" border="0" /></a></p>
<p align="left">Certain organizations may feel like this creates confusion amongst their user community and would therefore like to automate the create of the &lsquo;Archive&rsquo; folder in their user mailboxes. Fortunately, MVP (and fellow Aussie!) <a href="https://mvp.microsoft.com/en-us/PublicProfile/10145?fullName=Glen%20%20Scales" target="_blank">Glen Scales</a> has a <a href="http://gsexdev.blogspot.com/2015/09/ews-create-mailbox-folder-powershell.html" target="_blank">great solution for creating mailbox folders using PowerShell the EWS managed API.</a> In order to use his module, you will need to download and install the <a href="http://go.microsoft.com/fwlink/?LinkId=255472" target="_blank">EWS managed API from here.</a> Once installed, you will need to connect to <a href="http://www.cgoosen.com/2014/10/script-connect-exo-ps1-connect-to-exchange-online-using-remote-powershell/" target="_blank">Exchange Online via remote PowerShell</a> and import the module. It them becomes a matter of using the Create-Folder cmdlet included in the module. The module has few parameters and a lot of other functionality but we only need the following:</p>
<p>[powershell]<br />
Create-Folder -MailboxName user@domain.com -NewFolderName Archive<br />
[/powershell]</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2016/07/3.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="3" src="http://www.cgoosen.com/wp-content/uploads/2016/07/3_thumb.png" alt="3" width="534" height="167" border="0" /></a></p>
<p>With some minor tweaks to Glen&rsquo;s code, we can easily script this process for multiple (or all) mailboxes:</p>
<p>[powershell]<br />
function Load-EWSManagedAPI{<br />
    param(<br />
    )<br />
 	Begin<br />
	{<br />
		## Load Managed API dll<br />
		###CHECK FOR EWS MANAGED API, IF PRESENT IMPORT THE HIGHEST VERSION EWS DLL, ELSE EXIT<br />
		$EWSDLL = (($(Get-ItemProperty -ErrorAction SilentlyContinue -Path Registry::$(Get-ChildItem -ErrorAction SilentlyContinue -Path 'Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Exchange\Web Services'|Sort-Object Name -Descending| Select-Object -First 1 -ExpandProperty Name)).'Install Directory') + "Microsoft.Exchange.WebServices.dll")<br />
		if (Test-Path $EWSDLL)<br />
		    {<br />
		    Import-Module $EWSDLL<br />
		    }<br />
		else<br />
		    {<br />
		    "$(get-date -format yyyyMMddHHmmss):"<br />
		    "This script requires the EWS Managed API 1.2 or later."<br />
		    "Please download and install the current version of the EWS Managed API from"<br />
		    "http://go.microsoft.com/fwlink/?LinkId=255472"<br />
		    ""<br />
		    "Exiting Script."<br />
		    exit<br />
		    }<br />
  	}<br />
}</p>
<p>function Connect-Exchange{<br />
    param(<br />
    	[Parameter(Position=0, Mandatory=$true)] [string]$MailboxName,<br />
		[Parameter(Position=1, Mandatory=$true)] [System.Management.Automation.PSCredential]$Credentials<br />
    )<br />
 	Begin<br />
		 {<br />
		Load-EWSManagedAPI</p>
<p>		## Set Exchange Version<br />
		$ExchangeVersion = [Microsoft.Exchange.WebServices.Data.ExchangeVersion]::Exchange2010_SP1</p>
<p>		## Create Exchange Service Object<br />
		$service = New-Object Microsoft.Exchange.WebServices.Data.ExchangeService($ExchangeVersion)  </p>
<p>		#Credentials<br />
		$creds = New-Object System.Net.NetworkCredential($Credentials.UserName.ToString(),$Credentials.GetNetworkCredential().password.ToString())<br />
		$service.Credentials = $creds       </p>
<p>		#CAS URL hardcoded for Exchange Online </p>
<p>		$uri=[system.URI] "https://outlook.office365.com/EWS/Exchange.asmx"<br />
		$service.Url = $uri    </p>
<p>        if(!$service.URL){<br />
			throw "Error connecting to EWS"<br />
		}<br />
		else<br />
		{<br />
			return $service<br />
		}<br />
	}<br />
}</p>
<p>function Create-Folder{<br />
    param(<br />
    	[Parameter(Position=0, Mandatory=$true)] [string]$MailboxName,<br />
		[Parameter(Position=1, Mandatory=$true)] [System.Management.Automation.PSCredential]$Credentials,<br />
		[Parameter(Position=2, Mandatory=$true)] [String]$NewFolderName<br />
    )<br />
 	Begin<br />
	 {<br />
		$service = Connect-Exchange -MailboxName $MailboxName -Credentials $Credentials<br />
		$NewFolder = new-object Microsoft.Exchange.WebServices.Data.Folder($service)<br />
		$NewFolder.DisplayName = $NewFolderName<br />
        $NewFolder.FolderClass = "IPF.Note"</p>
<p>        # Bind to the MsgFolderRoot folder<br />
		$folderid= new-object Microsoft.Exchange.WebServices.Data.FolderId([Microsoft.Exchange.WebServices.Data.WellKnownFolderName]::MsgFolderRoot,$MailboxName)<br />
		$EWSParentFolder = [Microsoft.Exchange.WebServices.Data.Folder]::Bind($service,$folderid)</p>
<p>		#Define Folder Veiw Really only want to return one object<br />
		$fvFolderView = new-object Microsoft.Exchange.WebServices.Data.FolderView(1)<br />
		#Define a Search folder that is going to do a search based on the DisplayName of the folder<br />
		$SfSearchFilter = new-object Microsoft.Exchange.WebServices.Data.SearchFilter+IsEqualTo([Microsoft.Exchange.WebServices.Data.FolderSchema]::DisplayName,$NewFolderName)<br />
		#Do the Search<br />
		$findFolderResults = $service.FindFolders($EWSParentFolder.Id,$SfSearchFilter,$fvFolderView)<br />
		if ($findFolderResults.TotalCount -eq 0){<br />
		    Write-host ("Folder Doesn't Exist") -ForegroundColor Yellow<br />
			$NewFolder.Save($EWSParentFolder.Id)<br />
			Write-host ("Folder Created") -ForegroundColor Green<br />
		}<br />
		else{<br />
		    Write-error ("Folder already Exist with that Name")<br />
		}  </p>
<p>	 }<br />
}</p>
<p># Define tenant credentials<br />
$Credentials = Get-Credential</p>
<p># Define mailboxes that need the archive folder created<br />
# Get all mailboxes<br />
$Mailboxes = Get-Mailbox -ResultSize Unlimited | Where-Object {$_.Name -notlike "DiscoverySearchMailbox*"}</p>
<p># Or import a list of mailboxes from .txt<br />
# $Mailboxes = Get-Content C:\Temp\Mailboxes.txt</p>
<p># Create the folder<br />
ForEach ($MailboxName in $Mailboxes) {<br />
    Write-host "Processing $MailboxName" -ForegroundColor Yellow<br />
    Create-Folder -MailboxName $MailboxName.PrimarySmtpAddress -NewFolderName Archive -Credentials $Credentials<br />
    }<br />
[/powershell]</p>
<p align="left">Once the &lsquo;Archive&rsquo; folder has been created, it will become the destination for all messages that are selected when the &lsquo;Archive&rsquo; button is clicked.</p>
<p align="left">A word of caution: If you have a large number of mailboxes, you may run into throttling issues if you attempt to do this on all mailboxes at the same time so it is definitely worth considering a phased rollout in larger environments.</p>
<p align="left">Glen has some great stuff <a href="http://gsexdev.blogspot.com" target="_blank">on his blog so be sure to check it out here</a>.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Automating archive folder creation in Exchange Online mailboxes&p[summary]=If you are using Outlook 2016 on Windows or Mac you will have noticed the recent addition of a one-click &lsquo;Archive&rsquo; button to ...&p[url]=http://172.16.7.177:4000/2016/07/automating-archive-folder-creation-in-exchange-online-mailboxes" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2016/07/automating-archive-folder-creation-in-exchange-online-mailboxes&text=If you are using Outlook 2016 on Windows or Mac you will have noticed the recent addition of a one-click &lsquo;Archive&rsquo; button to ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2016-07-01T13:31:12-05:00" itemprop="datePublished">1 Jul, 2016</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2016/07/office-servers-and-services-mvp-2016">Office Servers and Services MVP 2016!</a></h2>
    </header>

    <div class="post-content">
        <p>I've been traveling this week and spent a couple of days in Washington D.C were I presented two sessions at a small technology conference for overseas schools (K-12). I had a great time presenting and interacting with attendees from all over the world - my Microsoft focussed sessions definitely stood out at a conference heavily dominated by Google.</p>
<p>The highlight of my week was the email I received this morning from the Microsoft MVP program presenting me with a 2016 MVP award. This is my third MVP award and as always I'm honored to part of the MVP community.&nbsp;I'm very fortunate to have the opportunity to interact with so many folks who I admire and respect as often as I do.</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2016/07/msmvplogo.jpg" rel="attachment wp-att-1686"><img class="aligncenter size-full wp-image-1686" src="http://www.cgoosen.com/wp-content/uploads/2016/07/msmvplogo.jpg" alt="msmvplogo" width="650" height="125" /></a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Office Servers and Services MVP 2016!&p[summary]=I've been traveling this week and spent a couple of days in Washington D.C were I presented two sessions at a small technology conference...&p[url]=http://172.16.7.177:4000/2016/07/office-servers-and-services-mvp-2016" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2016/07/office-servers-and-services-mvp-2016&text=I've been traveling this week and spent a couple of days in Washington D.C were I presented two sessions at a small technology conference...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2016-06-30T12:46:19-05:00" itemprop="datePublished">30 Jun, 2016</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2016/06/minor-update-to-my-connect-exo-ps1-script">Minor update to my Connect-EXO.ps1 script</a></h2>
    </header>

    <div class="post-content">
        <p>I've just published an updated version of my Connect-EXO.ps1 script. This version, (version 3.2) includes a very minor fix for those using German language keyboards. This update is the result of testing and feedback from the TechNet community and I wanted to thank all those involved.</p>
<p>I have been planning some big updates to this script and work on version 4.0 will begin soon - watch this space!</p>
<p>The update has been published to the TechNet Gallery,&nbsp;<a href="http://cgoo.se/1srvTiS" target="_blank">it can be downloaded by clicking here&hellip;</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Minor update to my Connect-EXO.ps1 script&p[summary]=I've just published an updated version of my Connect-EXO.ps1 script. This version, (version 3.2) includes a very minor fix for those usin...&p[url]=http://172.16.7.177:4000/2016/06/minor-update-to-my-connect-exo-ps1-script" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2016/06/minor-update-to-my-connect-exo-ps1-script&text=I've just published an updated version of my Connect-EXO.ps1 script. This version, (version 3.2) includes a very minor fix for those usin...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2016-04-12T04:31:15-05:00" itemprop="datePublished">12 Apr, 2016</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2016/04/my-connect-exo-ps1-script-has-been-updated-2">My Connect-EXO.ps1 script has been updated!</a></h2>
    </header>

    <div class="post-content">
        <p>I've just published an updated version of my Connect-EXO.ps1 script. Version 3.1 includes the ability&nbsp;to connect to the&nbsp;Office 365 Security &amp; Compliance Center. Based on the options selected it will connect to either or all&nbsp;services with Exchange Online being the only one selected by default. Here is a screenshot of the new interface:</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2014/10/cap1.png" rel="attachment wp-att-1504"><img class="aligncenter wp-image-1504" src="http://www.cgoosen.com/wp-content/uploads/2014/10/cap1.png" alt="GUI" width="454" height="298" /></a></p>
<p style="text-align: left;">The update has been published to the TechNet Gallery, <a href="http://cgoo.se/1srvTiS" target="_blank">it can be downloaded by clicking here&hellip;</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=My Connect-EXO.ps1 script has been updated!&p[summary]=I've just published an updated version of my Connect-EXO.ps1 script. Version 3.1 includes the ability&nbsp;to connect to the&nbsp;Office ...&p[url]=http://172.16.7.177:4000/2016/04/my-connect-exo-ps1-script-has-been-updated-2" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2016/04/my-connect-exo-ps1-script-has-been-updated-2&text=I've just published an updated version of my Connect-EXO.ps1 script. Version 3.1 includes the ability&nbsp;to connect to the&nbsp;Office ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2016-03-30T09:30:09-05:00" itemprop="datePublished">30 Mar, 2016</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2016/03/using-powershell-to-automate-office-365-license-assignment">Using PowerShell to automate Office 365 license assignment</a></h2>
    </header>

    <div class="post-content">
        <p>The move to Office 365 almost always requires changes to existing operational processes. One of the processes that inevitably requires an update is the provisioning process and the extent of these changes will differ from organization to organization and depend on the maturity of your identity lifecycle management process. In many environments, license assignment can be easily automated using a scheduled task and PowerShell so I wanted to put together a post that provides an outline on how this can be done.</p>
<p>Before getting into it, I just want to add a little disclaimer to this post &ndash; I love PowerShell and because I love PowerShell, I like to use it, but this doesn&rsquo;t mean it is always fit for purpose. Each environment is different so I would urge you to consider all options before implementing a full blown PowerShell provisioning process because you may already own better tools for the job (FIM/MIM, etc). These tools often take a while to implement when done properly, so PowerShell could also be a great stop-gap solution. This post is intended to provide a foundation that helps you put together your own process and should not necessarily be implemented &ldquo;as-is&rdquo;.</p>
<p>With that out of the way, there are some requirements to think of as well. The server executing the script will need the following:</p>
<ul>
<li>The ability to connect to Azure AD via remote PowerShell which requires the Azure AD Module &ndash;&nbsp; <a title="https://msdn.microsoft.com/en-us/library/jj151815.aspx" href="https://msdn.microsoft.com/en-us/library/jj151815.aspx" target="_blank">Click here for more info</a></li>
<li>Remote Server Administration Tools &ndash; RSAT</li>
<li>A certificate to encrypt and decrypt your service account passwords. This certificate can be from an internal CA &ndash; <a href="http://www.cgoosen.com/2015/02/using-a-certificate-to-encrypt-credentials-in-automated-powershell-scripts/" target="_blank">See this post for more info</a></li>
<li>Service accounts with the relevant permissions</li>
<li>Relay permission on your Exchange server &ndash; Used for send report emails</li>
</ul>
<p>The scenario I will be addressing in this post is to automate mailbox provisioning and license assignment in a hybrid deployment. All new mailboxes get provisioned as remote mailboxes directly in Office 365 and users are assigned the relevant Office 365 license. Each user account has an entry in the &lsquo;extensionAttribute1&rsquo; attribute which determines the license they will be assigned, eg. E3 or Exchange Plan 2. We make use of 2 security groups during this process so users can be created in any OU as long as that OU is being synchronized to Azure AD. These groups are:</p>
<ul>
<li>O365_Provision &ndash; Starts the provisioning process. New accounts are added to this group once they have been created in Active Directory</li>
<li>O365_License &ndash; Used by the script to keep track of users who still need to have licenses assigned</li>
</ul>
<p>At a high level the workflow looks something like this:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2016/03/FlowChart.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="FlowChart" src="http://www.cgoosen.com/wp-content/uploads/2016/03/FlowChart_thumb.png" alt="FlowChart" width="1020" height="692" border="0" /></a></p>
<p>Lets start by looking at the variables and functions we need. Here you can define you license SKUs, service account credentials, etc:</p>
<p>[powershell]<br />
# Modules<br />
Import-Module ActiveDirectory</p>
<p># Variables - Edit these<br />
#########################<br />
$ErrorActionPreference = 'Stop'<br />
$ExchangeServer = 'you_exchange_server'<br />
$FromAddress = 'Provisioning Service
<provisioning@yourdomain.com>'<br />
$ToAddress = 'you@yourdomain.com'<br />
$ADUsername = 'YourDomain\service_acc'<br />
$RoutingDomain = 'yourtenant.mail.onmicrosoft.com'<br />
$ADEncryptedPwd = ''<br />
$MSOLUsername = 'service_acc@yourtenant.onmicrosoft.com'<br />
$MSOLEncryptedPwd = ''<br />
$Cert = Get-ChildItem Cert:\LocalMachine\My | Where-Object {$_.Subject -like 'CN=Provisioning Service*'}<br />
$E3SKU = 'yourtenant:ENTERPRISEPACK'<br />
$EP2SKU = 'yourtenant:EXCHANGEENTERPRISE'</p>
<p>#Email Styling<br />
$EmailBody = @"<br />
<html><br />
<head></p>
<style>
	.table {<br />
		border:1px solid #F0F0F0;<br />
        border-collapse: collapse;<br />
		padding:10px;<br />
	}<br />
	.table th {<br />
		border:1px solid #F0F0F0;<br />
		padding:10px;<br />
		background:#F0F0F0;<br />
	}<br />
	.table td {<br />
		border:1px solid #F0F0F0;<br />
		padding:10px;<br />
	}<br />
</style>
<p></head><br />
<body></p>
<p>Hello,</p>
<p>This is an automated report from the Office 365 Provisioning Service. The following user accounts have been successfully provisioned in Office 365:</p>
<table class="table">
<thead>
<tr>
<th>Username</th>
<th>Email Address</th>
<th>License Assigned</th>
</tr>
</thead>
<tbody>
"@<br />
$EmailBodyClosure = @"</p>
<p>Regards,
<p>Provisioning Service</p>
<p> </body><br />
 </html><br />
"@<br />
###########################</p>
<p># Functions<br />
# Function to create report email<br />
function Send-Report{<br />
    $Msg = New-Object Net.Mail.MailMessage<br />
    $Smtp = New-Object Net.Mail.SmtpClient($ExchangeServer)<br />
    $Msg.From = $FromAddress<br />
    $Msg.To.Add($ToAddress)<br />
    $Msg.Subject = $EmailSubject<br />
    $Msg.Body = $EmailBody<br />
    $Msg.IsBodyHTML = $true<br />
    $Smtp.Send($Msg)<br />
    }</p>
<p># Function for Exchange Connection<br />
function Connect-Exchange{<br />
    $ADEncryptedBytes = [System.Convert]::FromBase64String($ADEncryptedPwd)<br />
    $ADDecryptedBytes = $Cert.PrivateKey.Decrypt($ADEncryptedBytes, $true)<br />
    $ADDecryptedPwd = [system.text.encoding]::UTF8.GetString($ADDecryptedBytes) | ConvertTo-SecureString -AsPlainText -Force<br />
    $ADCredentials = New-Object System.Management.Automation.PSCredential ($ADUsername,$ADDecryptedPwd)<br />
    $ExchSession = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri http://$ExchangeServer/PowerShell/ -Authentication Kerberos -Credential $ADCredentials<br />
    Import-PSSession $ExchSession<br />
    } </p>
<p># Function for MSOL Connection<br />
function Connect-MSOL{<br />
    $MSOLEncryptedBytes = [System.Convert]::FromBase64String($MSOLEncryptedPwd)<br />
    $MSOLDecryptedBytes = $Cert.PrivateKey.Decrypt($MSOLEncryptedBytes, $true)<br />
    $MSOLDecryptedPwd = [system.text.encoding]::UTF8.GetString($MSOLDecryptedBytes) | ConvertTo-SecureString -AsPlainText -Force<br />
    $MSOLCredentials = New-Object System.Management.Automation.PSCredential ($MSOLUsername,$MSOLDecryptedPwd)<br />
    Connect-MSOLService -Credential $MSOLCredentials<br />
    }<br />
[/powershell]</p>
<p>Next we have the &lsquo;licensing phase&rsquo; &ndash; This phase also generates the email report because a user is considered to be fully provisioned once they have a license assigned. We can also catch any errors and generate an error report email for those.</p>
<p>[powershell]<br />
# Licensing Phase - Check if any users need to have licenses assigned<br />
$NeedLicense = Get-AdGroupMember -Identity O365_License<br />
If ($NeedLicense) {<br />
        $HasMbxArray = @()<br />
        Connect-MSOL<br />
        Foreach ($User in $NeedLicense) {<br />
            $UserInfo = Get-ADUser $User.SamAccountName -Properties *<br />
            $Username = $UserInfo.SamAccountName<br />
            $UserEmail = $UserInfo.Mail<br />
            $UserLic = $UserInfo.extensionAttribute1<br />
            $UserLoc = $UserInfo.c<br />
            $UPN = $UserInfo.UserPrincipalName<br />
            $MsolUser = Get-MsolUser -UserPrincipalName $UPN<br />
            $HasLic = $MsolUser.IsLicensed<br />
                If ($MsolUser -and $UserLic -and $UserLoc) {<br />
                    Try {<br />
						If ($HasLic) {<br />
	                    $ExistingLic = $MsolUser.Licenses.AccountSkuId<br />
	                    Set-MsolUserLicense -UserPrincipalName $UPN -RemoveLicenses $ExistingLic<br />
	                    }<br />
	                    If ($UserLic -eq 'Exchange 2') {<br />
	                    Set-MsolUser -UserPrincipalName $UPN -UsageLocation $UserLoc<br />
	                    Set-MsolUserLicense -UserPrincipalName $UPN -AddLicenses $EP2SKU<br />
                            Remove-AdGroupMember -Identity O365_License -Members $Username -Confirm:$False<br />
	                    }<br />
	                    ElseIf ($UserLic -eq 'E3') {<br />
	                    Set-MsolUser -UserPrincipalName $UPN -UsageLocation $UserLoc<br />
	                    Set-MsolUserLicense -UserPrincipalName $UPN -AddLicenses $E3SKU<br />
                            Remove-AdGroupMember -Identity O365_License -Members $Username -Confirm:$False<br />
                       }<br />
					 }<br />
					Catch {<br />
        			$EmailSubject = 'Office 365 Provisioning Error'<br />
        			$EmailBody = @"<br />
<html><br />
<head><br />
</head><br />
<body></p>
<p>Hello,</p>
<p>This is an automated report from the Office 365 Provisioning Service. The following errors occurred when attempting to provision users in Office 365:</p>
<p><span style="color:#B22222;">$Error</span></p>
<p><strong>Additional Diagnostic Info:</strong><br />
Username: $Username<br />
Email Address: $UserEmail<br />
License Assigned: $UserLic<br />
Usage Location: $UserLoc</p>
<p>Regards,
<p>Provisioning Service</p>
<p></body><br />
</html><br />
"@<br />
			        Send-Report<br />
			        }<br />
                    $EmailBody += '<br />
<tr>'<br />
	            $EmailBody += "
<td>$Username</td>
<p>"<br />
	            $EmailBody += "
<td>$UserEmail</td>
<p>"<br />
	            $EmailBody += "
<td>$UserLic</td>
<p>"<br />
	            $EmailBody += '</tr>
<p>'<br />
                      }<br />
                     }<br />
	        $Licenses = Get-MsolAccountSku<br />
	        $E3Consumed = $Licenses[0].ConsumedUnits<br />
	        $E3Total = $Licenses[0].ActiveUnits<br />
	        $E3Remaining = $E3Total - $E3Consumed<br />
	        $ExP2Consumed = $Licenses[1].ConsumedUnits<br />
	        $ExP2Total = $Licenses[1].ActiveUnits<br />
	        $ExP2Remaining = $ExP2Total - $ExP2Consumed<br />
	        $EmailBodyLic = @"<br />
	</tbody>
</table>
<p><strong>License Summary:</strong></p>
<ul>
<li>You have consumed <strong>$E3Consumed</strong> Exchange Online (Plan 2) licenses and have <strong>$E3Remaining</strong> remaining</li>
<li>You have consumed <strong>$ExP2Consumed</strong> Office 365 Enterprise E3 licenses and have <strong>$ExP2Remaining</strong> remaining</span></li>
</ul>
<p>"@<br />
	        $EmailSubject = 'Office 365 Provisioning Report'<br />
	        $EmailBody += $EmailBodyLic<br />
	        $EmailBody += $EmailBodyClosure<br />
	        Send-Report<br />
    }<br />
[/powershell]</p>
<p>The &lsquo;mailbox enablement phase&rsquo; connects to the local Exchange server and creates a new remote mailbox. <a href="http://www.cgoosen.com/2016/01/how-to-create-a-remote-office-365-mailbox-in-a-hybrid-deployment/" target="_blank">See this post for more information</a> on this process. This phase also attempts to generate error notification emails.</p>
<p>[powershell]<br />
# Mailbox Enablement Phase - Check if any new mailboxes need to be provisioned<br />
$NeedMailbox = Get-AdGroupMember -Identity O365_Provisioning<br />
If ($NeedMailbox) {<br />
    Connect-Exchange<br />
    Foreach ($User in $NeedMailbox) {<br />
    $Username = $User.SamAccountName<br />
    $UserInfo = Get-ADUser $Username -Properties *<br />
    $UserLic = $UserInfo.extensionAttribute1<br />
    $UserLoc = $UserInfo.c<br />
    If ($UserLic -and $UserLoc){<br />
        Try {<br />
            Enable-RemoteMailbox $Username -RemoteRoutingAddress "$Username@$RoutingDomain"<br />
            Add-ADGroupMember -Identity O365_License -Members $Username<br />
            Remove-AdGroupMember -Identity O365_Provisioning -Members $Username -Confirm:$False<br />
                }<br />
        Catch {<br />
        $EmailSubject = 'Office 365 Provisioning Error'<br />
        $EmailBody = @"<br />
<html><br />
<head><br />
</head><br />
<body></p>
<p>Hello,</p>
<p>This is an automated report from the Office 365 Provisioning Service. The following errors occurred when attempting to mail-enable users:</p>
<p><span style="color:#B22222;">$Error</span></p>
<p><strong>Additional Diagnostic Info:</strong><br />
Username: $Username</p>
<p>Regards,
<p>Provisioning Service</p>
<p></body><br />
</html><br />
"@<br />
        Send-Report<br />
        }<br />
        }<br />
    Else {<br />
        $EmailSubject = 'Office 365 Provisioning Error'<br />
        $EmailBody = @"<br />
<html><br />
<head><br />
</head><br />
<body></p>
<p>Hello,</p>
<p>This is an automated report from the Office 365 Provisioning Service. The following user could not be provisioned, please check to ensure that the required license type has been correctly entered in the "Company" field and that the "Country/region" has been set:</p>
<p><span style="color:#B22222;">User: $Username</span></p>
<p>Regards,
<p>Provisioning Service</p>
<p></body><br />
</html><br />
"@<br />
        Send-Report<br />
        }<br />
    }<br />
}<br />
[/powershell]</p>
<p>Putting this all together will hopefully form be a great foundation to help you build your own workflow. Once done, you can simply schedule your script to run using task scheduler.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Using PowerShell to automate Office 365 license assignment&p[summary]=The move to Office 365 almost always requires changes to existing operational processes. One of the processes that inevitably requires an...&p[url]=http://172.16.7.177:4000/2016/03/using-powershell-to-automate-office-365-license-assignment" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2016/03/using-powershell-to-automate-office-365-license-assignment&text=The move to Office 365 almost always requires changes to existing operational processes. One of the processes that inevitably requires an...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2016-02-18T10:18:15-06:00" itemprop="datePublished">18 Feb, 2016</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2016/02/azure-ad-connect-gets-a-big-update">Azure AD Connect gets a big update!</a></h2>
    </header>

    <div class="post-content">
        <p>In case you missed it, the latest version of Azure AD Connect (version 1.1.105.0) was <a href="https://azure.microsoft.com/en-us/documentation/articles/active-directory-aadconnect-version-history/" target="_blank">recently made available for download.</a> One of the big changes and great new additions in this version is the new built-in scheduler which was separate to the sync engine in previous releases and would run as a scheduled task in Windows task scheduler:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2016/02/Capture1.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture1" src="http://www.cgoosen.com/wp-content/uploads/2016/02/Capture1_thumb.png" alt="Capture1" width="776" height="110" border="0" /></a></p>
<p>Another big change is the fact that the default synchronization frequency has been updated and is now 30 minutes which is a big change from the previous default of 3 hours. In addition, this value can now be configured which is something that was not supported previously &ndash; I know this change is going to be very well received by many organizations. The scheduler can be viewed and configured using the</p>
<p>[powershell]Get-ADSyncScheduler[/powershell]</p>
<p>and</p>
<p>[powershell]Set-ADSyncScheduler[/powershell]</p>
<p>cmdlets. You can also manually start a synchronization cycle with the</p>
<p>[powershell]Start-ADSyncSyncCycle[/powershell]</p>
<p>cmdlet</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2016/02/Capture3.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture3" src="http://www.cgoosen.com/wp-content/uploads/2016/02/Capture3_thumb.png" alt="Capture3" width="669" height="223" border="0" /></a></p>
<p>As before, the upgrade process from previous versions is very simple &ndash; The wizard will detect the previous installation and ask to if you would like to upgrade:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2016/02/Capture2.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture2" src="http://www.cgoosen.com/wp-content/uploads/2016/02/Capture2_thumb.png" alt="Capture2" width="622" height="438" border="0" /></a></p>
<p align="left">You will notice after the upgrade that the old Azure AD Sync Scheduler task no longer exists in Windows task scheduler</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2016/02/after.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="after" src="http://www.cgoosen.com/wp-content/uploads/2016/02/after_thumb.png" alt="after" width="741" height="105" border="0" /></a></p>
<p align="left">Other new features in this release are:</p>
<ul>
<li>Automatic upgrade feature for Express settings customers.</li>
<li>Support for the global admin using MFA and PIM in the installation wizard.</li>
<li>Support changing the user's sign-in method after initial install.</li>
<li>Allows Domain and OU filtering in the installation wizard.</li>
</ul>
<p align="left">For more information on these <a href="https://azure.microsoft.com/en-us/documentation/articles/active-directory-aadconnect-version-history/" target="_blank">and other new features, click here</a></p>
<p align="left">For more information about the <a href="https://azure.microsoft.com/en-us/documentation/articles/active-directory-aadconnectsync-feature-scheduler/" target="_blank">new built-in scheduler, click here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Azure AD Connect gets a big update!&p[summary]=In case you missed it, the latest version of Azure AD Connect (version 1.1.105.0) was recently made available for download. One of the bi...&p[url]=http://172.16.7.177:4000/2016/02/azure-ad-connect-gets-a-big-update" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2016/02/azure-ad-connect-gets-a-big-update&text=In case you missed it, the latest version of Azure AD Connect (version 1.1.105.0) was recently made available for download. One of the bi...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2016-01-27T09:20:39-06:00" itemprop="datePublished">27 Jan, 2016</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2016/01/how-to-create-a-remote-office-365-mailbox-in-a-hybrid-deployment">How to create a remote &ldquo;Office 365&rdquo; mailbox  in a hybrid deployment</a></h2>
    </header>

    <div class="post-content">
        <p>I&rsquo;ve recently seen the same issue pop up in a few different environments so I thought I would put together a short post that explains how to create a &ldquo;Office 365&rdquo; mailbox when using a hybrid deployment of Exchange. One of the questions I&rsquo;ve had had answer a few times recently is &ldquo;Why do newly created Exchange Online mailboxes not appear in the on-premises Exchange Admin Center as &ldquo;Office 365&rdquo; mailboxes like migrated mailboxes do?&rdquo;</p>
<p>There appears to be some confusion around provisioning of new user mailboxes once a hybrid deployment has been configured as this issue is caused when the mailbox has not be correctly provisioned in the on-premises environment.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2016/01/cap3.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="cap3" src="http://www.cgoosen.com/wp-content/uploads/2016/01/cap3_thumb.png" alt="cap3" width="725" height="314" border="0" /></a></p>
<p>While it is technically possible to create a new user account in Active Directory, wait for AAD Connect to provision that account to AAD and then assign an Exchange Online license to that user to create their mailbox, but the problem with that process is that it does not set the msExchRecipientType (and other) Exchange related attributes for that user object and that is why it will never appear in the on-premises Exchange Admin Center:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2016/01/cap2.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="cap2" src="http://www.cgoosen.com/wp-content/uploads/2016/01/cap2_thumb.png" alt="cap2" width="344" height="456" border="0" /></a></p>
<p align="left">In order to correctly popular these attributes, you either need to create the new user and mailbox via the Exchange Admin Center by clicking on the &ldquo;+&rdquo; icon and selecting &ldquo;Office 365 Mailbox&rdquo; or you need to enable a remote mailbox for a previously created user using the <em>Enable-RemoteMailbox </em>cmdlet</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2016/01/cap4.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="cap4" src="http://www.cgoosen.com/wp-content/uploads/2016/01/cap4_thumb.png" alt="cap4" width="345" height="131" border="0" /></a></p>
<p align="left">Many organizations already have automated provisioning processes in place so adjusting the mailbox enablement workflow may be the preferred method, an example of the cmdlet is shown below:</p>
<p>[powershell]<br />
#Syntax is: Enable-RemoteMailbox <user> &ndash;RemoteRoutingAddress <user@tenant.mail.onmicrosoft.com><br />
Enable-RemoteMailbox homer -RemoteRoutingAddress homer@gooselabs.mail.onmicrosoft.com<br />
[/powershell]</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2016/01/cap1.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="cap1" src="http://www.cgoosen.com/wp-content/uploads/2016/01/cap1_thumb.png" alt="cap1" width="694" height="240" border="0" /></a></p>
<p align="left">The <em>Enable-RemoteMailbox </em>cmdlet can be run immediately after creating the user account in Active Directory so there is no need to wait for the next AAD Connect synchronization cycle to complete before enabling the mailbox. Once the user account has been provisioned to AAD, the mailbox will automatically created and the appropriate license should then be assigned to the user.</p>
<p align="left">More information on the <em>Enable-RemoteMailbox</em> cmdlet can be <a href="https://technet.microsoft.com/en-us/library/ff607313%28v=exchg.160%29.aspx" target="_blank">found on TechNet here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=How to create a remote &ldquo;Office 365&rdquo; mailbox  in a hybrid deployment&p[summary]=I&rsquo;ve recently seen the same issue pop up in a few different environments so I thought I would put together a short post that explai...&p[url]=http://172.16.7.177:4000/2016/01/how-to-create-a-remote-office-365-mailbox-in-a-hybrid-deployment" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2016/01/how-to-create-a-remote-office-365-mailbox-in-a-hybrid-deployment&text=I&rsquo;ve recently seen the same issue pop up in a few different environments so I thought I would put together a short post that explai...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2015-12-31T07:16:04-06:00" itemprop="datePublished">31 Dec, 2015</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2015/12/multiple-tenant-domains-with-a-single-yammer-network">Multiple tenant domains with a single Yammer network</a></h2>
    </header>

    <div class="post-content">
        <p>I recently worked with a customer who had a large number of different business units and each one had their own domain. As part of their Office 365 enablement project they wanted to enable Yammer Enterprise for their tenant and allow users from the different business units to collaborate with each other using the same Yammer network. Yammer integration with Office 365 has come a long way over the last few years and while merging multiple networks or adding domains into the same network is possible, there are a few things to think about before initiating the process and I wanted to post some of my notes.</p>
<p>Firstly, here are some of the key points to remember:</p>
<ul>
<li>Yammer no longer requires the use of Yammer Directory Sync and can now make use of Azure AD Connect</li>
<li>Once Yammer has been activated and a Yammer Enterprise network has been created for the tenant, any user who was a valid account in the tenant will be able to log on to Yammer without any additional license assignment</li>
<li>Yammer users are created the first time they log on and will therefore not appear in the Yammer people directory prior to that</li>
<li>Office 365 supports one activated Yammer Enterprise network per tenant</li>
<li>Yammer content is not copied during the merge process</li>
</ul>
<p>Since Office 365 supports only one activated Yammer Enterprise network per tenant, it is recommended that in environments with multiple domains the home network is activated using the domain that accommodates the majority of users. Once this network has been created, adding a domain to a network is very simple.&nbsp; log into the Office 365 portal, submit a service request and once you have completed the request form (pictured below) it only takes a day or two to complete.
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/12/Capture1.png"><img title="Capture1" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="Capture1" src="http://www.cgoosen.com/wp-content/uploads/2015/12/Capture1_thumb.png" width="694" height="581"></a></p>
<p>If a domain already has a Yammer Basic network, you can choose to either upgrade that network to an Enterprise network or create a new Enterprise network and merge the old Basic one, but it is important to understand that during the merge process the old Yammer content will not be copied. This network migration process no longer requires a service request and can be performed by Yammer admins. <a href="https://support.office.com/en-us/article/Network-migration-Consolidate-multiple-Yammer-networks-a22c1b20-9231-4ce2-a916-392b1056d002?ui=en-US&amp;rs=en-US&amp;ad=US" target="_blank">There is some great documentation available here.</a>&nbsp;
<p>Some additional documentation on <a href="https://support.office.com/en-us/article/Upgrade-your-network-to-Yammer-Enterprise-9cdcf894-4a3d-4956-8a6c-6cb4d62770ea" target="_blank">upgrading your Yammer network is available here.</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Multiple tenant domains with a single Yammer network&p[summary]=I recently worked with a customer who had a large number of different business units and each one had their own domain. As part of their ...&p[url]=http://172.16.7.177:4000/2015/12/multiple-tenant-domains-with-a-single-yammer-network" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2015/12/multiple-tenant-domains-with-a-single-yammer-network&text=I recently worked with a customer who had a large number of different business units and each one had their own domain. As part of their ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2015-11-30T11:27:35-06:00" itemprop="datePublished">30 Nov, 2015</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2015/11/exchange-hybrid-deployment-and-sizing">Exchange Hybrid Deployment and Sizing</a></h2>
    </header>

    <div class="post-content">
        <p>In September, I posted about the great new Office 365 Hybrid Configuration Wizard and while there is no question that the HCW is a great help when configuring hybrid deployments, there are a few other important considerations to take into account when deploying Exchange Hybrid. I've helped many organizations deploy hybrid configurations and move mailboxes to the cloud over the last few years and often to come across the same questions and misconceptions, so I thought I'd address some of these in a blog post.</p>
<p><strong></strong>&nbsp;</p>
<p><strong>"Help!, I need to implement a hybrid server!"<br></strong>That is not necessarily true, Exchange Hybrid is a configuration state and should not be thought of as a server role. A Hybrid deployment uses existing Exchange workloads like Autodiscover and Exchange Web Services (EWS) so if you already have Exchange 2010/2013/2016 deployed according to best practices then chances are you already have everything you need to configure Exchange Hybrid. Sure, there is some additional functionality available if you use the most recent version of Exchange, but do you need that functionality? I've seen so many environments that have correctly sized and load balanced Exchange servers and then have a tiny virtual machine deployed as a "hybrid server". This type of configuration creates a single point of failure and inevitably becomes a migration bottleneck.</p>
<p>If you are looking to migrate from a legacy version of Exchange then you will need to implement additional servers in order to deploy Hybrid. For Exchange 2003 your only option for going hybrid is to deploy a correctly sized Exchange 2010 deployment. For those on Exchange 2007 it is recommended that Exchange 2013 is used instead.</p>
<p><strong></strong>&nbsp;</p>
<p><strong>"Can I virtualize my servers for Hybrid?"</strong> or <strong>"How do I size my servers for Hybrid?"</strong><br>If you are in a position where you are looking to upgrade your Exchange Organization prior to a migration to Exchange Online or you need to implement new Exchange servers because you are on a legacy version, you can definitely make use of virtualization. Virtualization in the Exchange world has long been a hot topic and isn&rsquo;t really something that I&rsquo;ll get into in this post. In my experience, incorrectly configured or undersized virtual Exchange servers are by far the most common issue I&rsquo;ve come across in the field so it is often simpler to use physical hardware which is also the recommended practice.</p>
<p>To illustrate this, here is an example of some actual performance data I gathered when working with a customer. This particular customer was migrating from Exchange 2007 and had implemented virtual Exchange 2013 servers. Everything worked great until they attempted to migrate several mailboxes at the same time and they noticed that it was taking a considerable amount of time for small mailboxes to migrate. After confirming that the issue wasn&rsquo;t bandwidth related we decided to take a closer look at the new virtual servers. These servers sized with 4 CPU cores and 32 GB of RAM but didn&rsquo;t appear to be performing correctly. Our initial performance tests indicated that the servers seemed to be CPU constrained and after a lot of testing and much discussion with their virtualization team we found that simply changing the configuration from 2 sockets with 2 cores each (4 cores total) to 1 socket with 4 cores (still 4 cores) greatly improved the performance. The same 100 mailboxes were used in both tests:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/11/CPU1.png"><img title="CPU" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="CPU" src="http://www.cgoosen.com/wp-content/uploads/2015/11/CPU_thumb1.png" width="873" height="320"></a></p>
<p align="left">If you are planning to virtualize, make sure you follow <a href="http://download.microsoft.com/download/4/a/c/4ac32fd3-220e-45dc-aa97-dbdbe19c15b2/best_practices_for_virtualizing_and_managing_exchange_2013.pdf" target="_blank">Microsoft&rsquo;s best practices for virtualizing Exchange</a> and always use the <a href="http://blogs.technet.com/b/exchange/archive/2013/05/14/released-exchange-2013-server-role-requirements-calculator.aspx" target="_blank">Exchange Server Role Requirements Calculator</a> to correctly size your deployments.</p>
<p><strong></strong>&nbsp;</p>
<p><strong>"The cloud is awesome, I plan to remove all my on-premises Exchange servers!"</strong><br>There is no denying that moving to the cloud makes sense for a lot of organizations and in many instances there is a desire to remove all on-premises workloads. I always advise my customers to be very careful when it comes to decommissioning their entire Exchange Organization. When using directory synchronization with your Office 365 tenant, your users are synchronized from your on-premises Active Directory and therefore most of the attributes associated with these users cannot be managed in Office 365 or Exchange Online and must be managed on-premises. Completely removing your on-premises Exchange Organization makes managing mailbox attributes more difficult so I would definitely recommend retaining at least one Exchange server for user object management. You don&rsquo;t need to retain all your Exchange servers though, so I many environments there will still be a significant reduction in servers.</p>
<p>Retaining an on-premises Exchange server could also be really useful in SMTP relay scenarios where you have on-premises applications and devices that need to send email.</p>
<p>Microsoft also has a lot in great resources available to help answer your Hybrid questions, here are a few:</p>
<ul>
<li><a href="http://blogs.technet.com/b/exchange/archive/2015/08/10/hybrid-deployment-best-practices.aspx" target="_blank">Hybrid Deployment Best Practices</a></li>
<li><a href="http://blogs.technet.com/b/exchange/archive/2012/12/05/decommissioning-your-exchange-2010-servers-in-a-hybrid-deployment.aspx" target="_blank">Decommissioning your Exchange 2010 servers in a Hybrid Deployment</a></li>
<li><a href="https://technet.microsoft.com/en-us/library/dn931280(v=exchg.150).aspx" target="_blank">How and when to decommission your on-premises Exchange servers in a Hybrid Deployment</a></li>
<li><a href="https://technet.microsoft.com/en-us/library/jj619301(v=exchg.160).aspx" target="_blank">Exchange 2016 Virtualization</a></li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange Hybrid Deployment and Sizing&p[summary]=In September, I posted about the great new Office 365 Hybrid Configuration Wizard and while there is no question that the HCW is a great ...&p[url]=http://172.16.7.177:4000/2015/11/exchange-hybrid-deployment-and-sizing" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2015/11/exchange-hybrid-deployment-and-sizing&text=In September, I posted about the great new Office 365 Hybrid Configuration Wizard and while there is no question that the HCW is a great ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2015-10-29T10:34:43-05:00" itemprop="datePublished">29 Oct, 2015</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2015/10/my-connect-exo-ps1-script-has-been-updated">My Connect-EXO.ps1 script has been updated!</a></h2>
    </header>

    <div class="post-content">
        <p>I recently published an updated version of my Connect-EXO.ps1 script. Version 3.0 includes the option to connect to Azure AD. Based on the options selected it will connect to either or both services, here is a screenshot of the new interface:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/10/Capture.png"><img title="Capture" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="Capture" src="http://www.cgoosen.com/wp-content/uploads/2015/10/Capture_thumb.png" width="507" height="336"></a></p>
<p>The update has been published to the TechNet Gallery, <a href="http://cgoo.se/1srvTiS">it can be downloaded by clicking here&hellip;</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=My Connect-EXO.ps1 script has been updated!&p[summary]=I recently published an updated version of my Connect-EXO.ps1 script. Version 3.0 includes the option to connect to Azure AD. Based on th...&p[url]=http://172.16.7.177:4000/2015/10/my-connect-exo-ps1-script-has-been-updated" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2015/10/my-connect-exo-ps1-script-has-been-updated&text=I recently published an updated version of my Connect-EXO.ps1 script. Version 3.0 includes the option to connect to Azure AD. Based on th...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2015-09-16T07:42:22-05:00" itemprop="datePublished">16 Sep, 2015</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2015/09/a-look-at-the-microsoft-office-365-hybrid-configuration-wizard">A look at the Microsoft Office 365 Hybrid Configuration Wizard</a></h2>
    </header>

    <div class="post-content">
        <p>In case you missed it, <a href="http://blogs.technet.com/b/exchange/archive/2015/09/04/introducing-the-microsoft-office-365-hybrid-configuration-wizard.aspx" target="_blank">Microsoft recently announced the</a> Microsoft Office 365 Hybrid Configuration Wizard (HCW). The HCW has come a long way since it was first introduced in Exchange 2010 SP2, prior to that configuring a hybrid deployment required ~50 manual steps. This is the third version of the HCW and one of the most notable changes is that it is a standalone application which decouples it from the Exchange update cycle. The HCW will download the latest version every time it is run which will ensure that the latest version is always used.</p>
<p>The new HCW is available for use with Exchange 2013 CU8 or higher, however you will need to have <a href="https://support.microsoft.com/en-us/kb/3078678" target="_blank">Exchange 2013 CU10</a> installed if you would like see the new HCW landing page (pictured below) which is accessible via the &ldquo;Hybrid&rdquo; menu item in your on-premises Exchange Admin Center:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/09/cap1.png"><img title="cap1" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="cap1" src="http://www.cgoosen.com/wp-content/uploads/2015/09/cap1_thumb.png" width="859" height="251"></a></p>
<p align="left">Those using Exchange 2013 CU8 or CU9 <a href="http://aka.ms/TAPHCW" target="_blank">can download the new HCW here</a>.</p>
<p align="left">The wizard itself with take you through a series of configuration pages very similar to the pervious version, however there are improvements to error handling and a number of changes under the covers that greatly improve performance and efficiency.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/09/cap2.png"><img title="cap2" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="cap2" src="http://www.cgoosen.com/wp-content/uploads/2015/09/cap2_thumb.png" width="560" height="518"></a></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/09/cap12.png"><img title="cap12" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="cap12" src="http://www.cgoosen.com/wp-content/uploads/2015/09/cap12_thumb.png" width="560" height="516"></a></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/09/cap13.png"><img title="cap13" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="cap13" src="http://www.cgoosen.com/wp-content/uploads/2015/09/cap13_thumb.png" width="560" height="516"></a></p>
<p align="left">It is worth noting that the log file location has changed from &ldquo;%ProgramFiles%\Microsoft\Exchange Server\V15\Logging\Update-HybridConfiguration&rdquo;&nbsp; to &ldquo;%AppData%\Microsoft\Exchange Hybrid Configuration&rdquo;</p>
<p align="left">The Exchange Team has a detailed post about all the great new features in the Microsoft Office 365 Configuration Wizard, <a href="http://blogs.technet.com/b/exchange/archive/2015/09/04/introducing-the-microsoft-office-365-hybrid-configuration-wizard.aspx" target="_blank">I'd encourage you to check it out here.</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=A look at the Microsoft Office 365 Hybrid Configuration Wizard&p[summary]=In case you missed it, Microsoft recently announced the Microsoft Office 365 Hybrid Configuration Wizard (HCW). The HCW has come a long w...&p[url]=http://172.16.7.177:4000/2015/09/a-look-at-the-microsoft-office-365-hybrid-configuration-wizard" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2015/09/a-look-at-the-microsoft-office-365-hybrid-configuration-wizard&text=In case you missed it, Microsoft recently announced the Microsoft Office 365 Hybrid Configuration Wizard (HCW). The HCW has come a long w...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2015-08-31T06:47:10-05:00" itemprop="datePublished">31 Aug, 2015</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2015/08/migrating-office-for-mac-users-to-exchange-online">Migrating Office for Mac users to Exchange Online</a></h2>
    </header>

    <div class="post-content">
        <p>I recently worked with a customer who has a workstation fleet that is almost entirely made up of Macintosh computers. Users make use of Outlook 2011 for Mac and were being migrated to Exchange Online. We found that there wasn&rsquo;t a great deal of documentation around that covers this scenario so I wanted to post some of my notes here.</p>
<p>According to the <a href="https://support.office.com/en-us/article/Office-365-system-requirements-719254C0-2671-4648-9C84-C6A3D4F3BE45?ui=en-US" target="_blank">&ldquo;Office 365 system requirements&rdquo; page on office.com,</a> Office 365 is designed to work with the following software:</p>
<blockquote><ul>
<li>The current or immediately previous version of Internet Explorer or Firefox, or the latest version of Chrome or Safari.
<li>Any version of Microsoft Office in mainstream support.</li>
</ul>
</blockquote>
<p><a href="https://support.microsoft.com/en-us/lifecycle/search?sort=PN&amp;qid=&amp;alpha=Microsoft%20Office%20for%20Mac%202011&amp;Filter=FilterNO" target="_blank">Microsoft Support Lifecycle</a> indicates that you would need at least Microsoft Office for Mac 2011 SP3 and I can confirm after some testing that anything prior to Office for Mac 2011 SP2 simply won&rsquo;t even connect. The <a href="https://www.microsoft.com/mac/downloads?pid=Mactopia_Office2011&amp;fid=6ED764CC-7EB4-4BEE-949F-B0A122BF6FC6#viewer" target="_blank">latest update currently</a> available for Microsoft Office for Mac 2011 will bring the version number to 14.5.4. There is of course also the new <a href="https://blogs.office.com/2015/07/09/office-2016-for-mac-is-here/" target="_blank">Office 2016 for Mac.</a></p>
<p>The user experience when migrating a Mac user is similar to what we experience in the Windows world, with one exception &ndash; no restart of Outlook is required. Autodiscover will detect the mailbox move and prompt the user to re-configure. Here are some examples of this prompt in Outlook for Mac 2011 and Outlook 2016 for Mac:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/08/20111.png"><img title="2011" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="2011" src="http://www.cgoosen.com/wp-content/uploads/2015/08/2011_thumb1.png" width="387" height="254"></a></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/08/20161.png"><img title="2016" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="2016" src="http://www.cgoosen.com/wp-content/uploads/2015/08/2016_thumb1.png" width="430" height="314"></a></p>
<p align="left">Not sure what version your clients have installed? You can use <a href="https://gallery.technet.microsoft.com/office/Log-Parser-Studio-cd458765" target="_blank">Log Parser Studio</a> to parse the IIS logs on your CAS servers to help determine the versions you have out there. </p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Migrating Office for Mac users to Exchange Online&p[summary]=I recently worked with a customer who has a workstation fleet that is almost entirely made up of Macintosh computers. Users make use of O...&p[url]=http://172.16.7.177:4000/2015/08/migrating-office-for-mac-users-to-exchange-online" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2015/08/migrating-office-for-mac-users-to-exchange-online&text=I recently worked with a customer who has a workstation fleet that is almost entirely made up of Macintosh computers. Users make use of O...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2015-07-31T06:26:32-05:00" itemprop="datePublished">31 Jul, 2015</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2015/07/my-get-azcopygui-ps1-script-has-been-updated">My Get-AZCopyGUI.ps1 script has been updated</a></h2>
    </header>

    <div class="post-content">
        <p><a title="Script: Get-AZCopyGUI.ps1 &ndash; AZCopy GUI for PST Import" href="http://www.cgoosen.com/2015/05/script-get-azcopygui-ps1/">At the end of May</a>, I published my Get-AZCopyGUI.ps1 script which is&nbsp;a&nbsp;simple GUI wrapper for AZCopy.exe and helps simplify the process of importing .PSTs into Exchange Online. Today I published an updated version of the script which fixes a small bug and provides some additional functionality. The GUI now includes the following new options:</p>
<ul>
<li>The ability to use /Pattern switch - It will automatically be set&nbsp;to *.PST</li>
<li>The ability to choose a custom log&nbsp;location. If &nbsp;no location is selected,&nbsp;a log file is named AzCopyVerbose.log will be created in the default location which is %LocalAppData%\Microsoft\Azure\AzCopy</li>
</ul>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2015/05/Capture.png"><img class="aligncenter wp-image-1395" src="http://www.cgoosen.com/wp-content/uploads/2015/05/Capture-300x221.png" alt="Get-AzcopyGUI" width="523" height="386" /></a></p>
<p style="text-align: left;">For more information about&nbsp;Get-AZCopyGUI.ps1, <a title="Script: Get-AZCopyGUI.ps1 &ndash; AZCopy GUI for PST Import" href="http://www.cgoosen.com/2015/05/script-get-azcopygui-ps1/" target="_blank">see this post</a>.&nbsp;I have published it to the TechNet Gallery, <a href="http://cgoo.se/1Qnxtfg" target="_blank">it can be downloaded by clicking here&hellip;</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=My Get-AZCopyGUI.ps1 script has been updated&p[summary]=At the end of May, I published my Get-AZCopyGUI.ps1 script which is&nbsp;a&nbsp;simple GUI wrapper for AZCopy.exe and helps simplify the ...&p[url]=http://172.16.7.177:4000/2015/07/my-get-azcopygui-ps1-script-has-been-updated" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2015/07/my-get-azcopygui-ps1-script-has-been-updated&text=At the end of May, I published my Get-AZCopyGUI.ps1 script which is&nbsp;a&nbsp;simple GUI wrapper for AZCopy.exe and helps simplify the ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2015-06-25T02:56:27-05:00" itemprop="datePublished">25 Jun, 2015</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2015/06/upgrading-to-azure-ad-connect">Upgrading to Azure AD Connect</a></h2>
    </header>

    <div class="post-content">
        <p>It&rsquo;s here! <a href="http://blogs.technet.com/b/ad/archive/2015/06/24/azure-ad-connect-amp-connect-health-is-now-ga.aspx" target="_blank">Yesterday, Microsoft announced</a> the general availability of Azure AD Connect (AAD Connect). Over the years the humble DirSync tool has evolved and AAD Connect is the simplest way yet to integrate on-premises AD identities with Azure Active Directory. There has been a lot of confusion out there about which tool to use for directory synchronization but Microsoft has been hard at work on one tool to rule them all and as noted on the Microsoft Azure site, this tool is AAD Connect:</p>
<blockquote><p><em>Azure AD Connect incorporates the components and functionality previously released as Dirsync and AAD Sync. These tools are no longer being released individually, and all future improvements will be included in updates to Azure AD Connect, so that you always know where to get the most current functionality.</em></p>
</blockquote>
<p>One of the great features of AAD Connect is that it will upgrade your existing deployment of DirSync or AAD Sync, it&rsquo;s a simple wizard and 5 clicks away!</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/06/22.png"><img title="2" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="2" src="http://www.cgoosen.com/wp-content/uploads/2015/06/2_thumb2.png" width="543" height="383"></a></p>
<p align="left"><a href="https://azure.microsoft.com/en-us/documentation/articles/active-directory-aadconnect/" target="_blank">Click here for more</a> Azure AD Connect information and resources.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Upgrading to Azure AD Connect&p[summary]=It&rsquo;s here! Yesterday, Microsoft announced the general availability of Azure AD Connect (AAD Connect). Over the years the humble Dir...&p[url]=http://172.16.7.177:4000/2015/06/upgrading-to-azure-ad-connect" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2015/06/upgrading-to-azure-ad-connect&text=It&rsquo;s here! Yesterday, Microsoft announced the general availability of Azure AD Connect (AAD Connect). Over the years the humble Dir...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2015-05-30T10:30:53-05:00" itemprop="datePublished">30 May, 2015</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2015/05/script-get-azcopygui-ps1">Script: Get-AZCopyGUI.ps1 - AZCopy GUI for PST Import</a></h2>
    </header>

    <div class="post-content">
        <p>Microsoft <a href="http://blogs.office.com/2015/05/07/making-email-archive-migration-easier-with-the-office-365-import-service/" target="_blank">recently announced the new Office 365 Import Service</a> which is currently in preview. The new service allows organizations to import legacy PST data using one of two methods:</p>
<ul>
<li>Drive shipping &ndash; you send Microsoft a hard drive with your data.</li>
<li>Network Upload &ndash; you make use of Azure storage to upload your data to Office 365.</li>
</ul>
<p>The network upload option makes use of the Microsoft Azure AZCopy tool which uploads your data to an Azure storage blob. <a href="http://www.c7solutions.com/2015/05/using-office-365-pst-ingestion-service" target="_blank">Brian Reid has a great post on his blog about using the service.</a></p>
<p>Get-AZCopyGUI.ps1 is a GUI wrapper for the Microsoft Azure AZCopy tool (AZCopy.exe) to simplify the process of importing .PSTs into Exchange Online. To use the script, you need to locate your storage account key and upload URL. You can do this by accessing the &ldquo;Import&rdquo; menu item in the Office 365 Admin Center. To access this option, you need to be assigned the Mailbox Import Export role in Exchange Online.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/06/post1.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="post1" src="http://www.cgoosen.com/wp-content/uploads/2015/06/post1_thumb.png" alt="post1" width="533" height="453" border="0" /></a></p>
<p align="left">For more information on the Office 365 Import Service, <a href="https://technet.microsoft.com/en-us/library/dn948519%28v=exchg.150%29.aspx" target="_blank">see the following TechNet documentation.</a></p>
<p><strong>Requirements:</strong></p>
<ul>
<li>The script will work natively in PowerShell 2.0+</li>
<li>The script requires the Microsoft Azure AZCopy Tool with default installation path - <a href="http://aka.ms/downloadazcopy">get it here</a></li>
</ul>
<p><strong>Usage:</strong><br />
There are no parameters or switches, simply execute the script:</p>
<p>[shell].\Get-AZCopyGUI.ps1[/shell]</p>
<p>When using the Verbose option, a log file is named AzCopyVerbose.log will be created in %LocalAppData%\Microsoft\Azure\AzCopy if no "Log Location" is specified.</p>
<p><strong>Execution Policy:<br />
</strong>The script has been digitally signed and will run just fine under a "RemoteSigned" execution policy.</p>
<p><strong>Screenshots:</strong></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/05/Capture.png"><img class="aligncenter  wp-image-1395" src="http://www.cgoosen.com/wp-content/uploads/2015/05/Capture-300x221.png" alt="Get-AzcopyGUI" width="526" height="387" /></a></p>
<p><strong>Download:<br />
</strong>I have published it to the TechNet Gallery, <a href="http://cgoo.se/1Qnxtfg" target="_blank">it can be downloaded by clicking here...</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Script: Get-AZCopyGUI.ps1 - AZCopy GUI for PST Import&p[summary]=Microsoft recently announced the new Office 365 Import Service which is currently in preview. The new service allows organizations to imp...&p[url]=http://172.16.7.177:4000/2015/05/script-get-azcopygui-ps1" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2015/05/script-get-azcopygui-ps1&text=Microsoft recently announced the new Office 365 Import Service which is currently in preview. The new service allows organizations to imp...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2015-04-29T05:50:10-05:00" itemprop="datePublished">29 Apr, 2015</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2015/04/user-powershell-to-bulk-email-your-users">Using PowerShell to bulk email your users</a></h2>
    </header>

    <div class="post-content">
        <p>I was recently working on a migration project with a customer and volunteered to help find a solution to a challenge the Organizational Change Management (OCM) team were facing. The OCM team had been communicating with the business to keep them informed about the upcoming changes and what impact these changes would have on their day to day operations. This communication had all taken place via email and they now needed to send out a new notification to several thousand users that contained specific information that would be different for each recipient. Since this was a single-use scenario and all recipients were internal users, they were not terribly interested in investing in a third-party application or service to do this so we decided to explore other options.</p>
<p><a href="http://www.ehloworld.com/175" target="_blank">Inspired by Pat Richard&rsquo;s &ldquo;New-WelcomeEmail.ps1&rdquo; script</a>, I figured it would be pretty easy to achieve this using a PowerShell script and .CSV input file, it works great! To illustrate this, I&rsquo;ll use the fictitious example of gooseLabs, Inc who are relocating to a new office building and would like to send a notification email to all their users that contains their new desk location and phone number. The first and most important step is to ensure that you have an accurate input file. For this particular scenario, the input file looks something like this:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/04/1.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="1" src="http://www.cgoosen.com/wp-content/uploads/2015/04/1_thumb.png" alt="1" width="453" height="364" border="0" /></a></p>
<p align="left">Once we have our input file created, we can use the magic of PowerShell to generate our notifications using this data. The following script imports the .CSV file and generates a simple email notification that is then sent to everyone in the list:</p>
<p>[powershell]<br />
# Function to create report email<br />
function SendNotification{<br />
 $Msg = New-Object Net.Mail.MailMessage<br />
 $Smtp = New-Object Net.Mail.SmtpClient($ExchangeServer)<br />
 $Msg.From = $FromAddress<br />
 $Msg.To.Add($ToAddress)<br />
 $Msg.Subject = "Announcement: Important information about your office relocation."<br />
 $Msg.Body = $EmailBody<br />
 $Msg.IsBodyHTML = $true<br />
 $Smtp.Send($Msg)<br />
}</p>
<p># Define local Exchange server info for message relay. Ensure that any servers running this script have permission to relay.<br />
$ExchangeServer = "yourexchange.domain.com"<br />
$FromAddress = "Office Relocation Team <relocation@domain.com>"</p>
<p># Import user list and information from .CSV file<br />
$Users = Import-Csv UserList.csv</p>
<p># Send notification to each user in the list<br />
Foreach ($User in $Users) {<br />
 $ToAddress = $User.Email<br />
 $Name = $User.FirstName<br />
 $Level = $User.Level<br />
 $DeskNum = $User.DeskNumber<br />
 $PhoneNum = $User.PhoneNumber<br />
 $EmailBody = @"<br />
 <html><br />
 <head><br />
 </head><br />
 <body></p>
<p>Dear $Name,</p>
<p>As you know we will be relocating to our new offices at 742 Evergreen Terrace, Springfield on July 1, 2015. This email contains important information to help you get settled as quickly as possible.</p>
<p>Your existing access card will grant you access to the new building and your desk location is as follows:</p>
<p><strong>Level:</strong> $Level<br />
 <strong>Desk Number:</strong> $DeskNum<br />
 <strong>Phone Number:</strong> $PhoneNum</p>
<p>Your new phone will be connected and ready for use when you arrive.</p>
<p>If you require any assistance during the move please contact the relocation helpdesk at relocation@gooselabs.net or by calling 555-555-1234</p>
<p>Regards,</p>
<p>Office Relocation Team</p>
<p> </body><br />
 </html><br />
"@<br />
 Write-Host "Sending notification to $Name ($ToAddress)" -ForegroundColor Yellow<br />
 SendNotification<br />
}<br />
[/powershell]</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/04/2.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="2" src="http://www.cgoosen.com/wp-content/uploads/2015/04/2_thumb.png" alt="2" width="500" height="369" border="0" /></a></p>
<p align="left">The resulting notification looks like this:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/04/3.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="3" src="http://www.cgoosen.com/wp-content/uploads/2015/04/3_thumb.png" alt="3" width="600" height="238" border="0" /></a></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/04/4.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="4" src="http://www.cgoosen.com/wp-content/uploads/2015/04/4_thumb.png" alt="4" width="600" height="238" border="0" /></a></p>
<p align="left">This method could also be used to distribute other information, like temporary passwords prior to a <a href="https://technet.microsoft.com/en-us/library/jj898490%28v=exchg.150%29.aspx" target="_blank">Cutover Exchange Migration.</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Using PowerShell to bulk email your users&p[summary]=I was recently working on a migration project with a customer and volunteered to help find a solution to a challenge the Organizational C...&p[url]=http://172.16.7.177:4000/2015/04/user-powershell-to-bulk-email-your-users" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2015/04/user-powershell-to-bulk-email-your-users&text=I was recently working on a migration project with a customer and volunteered to help find a solution to a challenge the Organizational C...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2015-02-24T03:00:00-06:00" itemprop="datePublished">24 Feb, 2015</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2015/02/using-a-certificate-to-encrypt-credentials-in-automated-powershell-scripts">Using a certificate to encrypt credentials in automated PowerShell scripts</a></h2>
    </header>

    <div class="post-content">
        <p>PowerShell is a great way to help automate frequent or repetitive tasks and every now and then these tasks require some form of authentication. You could just store the service account password in the script, but I&rsquo;m really not a fan of doing that and I&rsquo;m sure you&rsquo;d agree it really isn&rsquo;t a very good way to do it. I was working on a script recently which was to be scheduled to run at various times by different service accounts on different servers so I wanted a way to ensure that a single copy of the script could be portable to any server and would still securely connect to Exchange with the correct permissions no matter which service account actually executed the script. Remotely connecting to Exchange/Exchange Online via PowerShell isn&rsquo;t difficult to do and you could just use <em>Get-Credential</em> cmdlet with <em>ConvertFrom-SecureString</em> and <em>Set-Content </em>to securely save your password to file which could then be read by your script without subsequent intervention. The trouble with this solution is that it isn&rsquo;t very portable and that password can only be ready by the user that created the file so it will work great if you used it only on your own machine, but not so well when trying to distribute it to a bunch of servers as a scheduled job. I wanted a solution that would use a particular certificate to decrypt a password stored in the script, in that way if the script was executed on a machine that did not have my certificate installed it would not be able to decrypt the password and would fail. I ended up creating an encrypted password using the public key of a certificate and storing that in the script, the only way to decrypt that password is with the private key of the same certificate. Let&rsquo;s look at this in more detail.</p>
<p>The first component of the solution is a certificate. Since I already had access to a internal Windows CA, I wanted to use a certificate signed by that CA but I also tested it with a self-signed certificate that was generated using &ldquo;makecert.exe&rdquo;. <span style="background-color: #ffffff;">PowerShell 4.0 </span>includes a <a href="https://technet.microsoft.com/en-us/library/hh848633.aspx" target="_blank"><em>New-SelfSignedCertificate</em></a> cmdlet that makes generating a self-signed certificate really easy, but for some reason I wasn&rsquo;t able to use one of those certificates for encryption (more specifically the decryption would not work) and since I planned to use a CA signed certificate anyway I didn&rsquo;t spend a whole lot of time trying to figure it out. The key thing to remember is that you need to install the certificate AND the private key, the certificate doesn&rsquo;t have to be trusted. I decided to create a new certificate template for my &ldquo;Script Authentication&rdquo; certificate by duplicating the &ldquo;Web Server&rdquo; template and making a few changes to it.</p>
<p align="left">Firstly, launch the <span style="background-color: #ffffff;">Certification Authority MMC</span><span style="background-color: #ffffff;">, loca</span>te &ldquo;Certificate Templates&rdquo;, right-click and select &ldquo;Manage&rdquo;</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture1.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture1" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture1_thumb.png" alt="Capture1" width="450" height="294" border="0" /></a></p>
<p>Next, locate the &ldquo;Web Server&rdquo; template, right-click and select &ldquo;Duplicate Template&rdquo;</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture2.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture2" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture2_thumb.png" alt="Capture2" width="450" height="169" border="0" /></a></p>
<p align="left">I called my new template &ldquo;Script Authentication&rdquo;</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture3.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture3" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture3_thumb.png" alt="Capture3" width="504" height="686" border="0" /></a></p>
<p align="left">And you need to ensure that you &ldquo;Allow private key to be exported&rdquo;. Once done, apply those changes.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture4.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture4" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture4_thumb.png" alt="Capture4" width="504" height="686" border="0" /></a></p>
<p align="left">We then need to <span style="background-color: #ffffff;">publish the new template</span> to ensure that it can be used when requesting a new certificate. <span style="background-color: #ffffff;">Right-click</span> &ldquo;Certificate Templates&rdquo;, select &ldquo;New&rdquo; and then &ldquo;Certificate Template to Issue&rdquo; and select your newly created template from the list</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture5.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture5" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture5_thumb.png" alt="Capture5" width="550" height="353" border="0" /></a></p>
<p align="left">Once done, you should be able to create and submit an advanced certificate request using the newly created template directly on your CA. You are not required to complete all the fields, but it is useful to give your certificate a descriptive name. I called mine &ldquo;PowerShell Automation&rdquo;.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture6.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture6" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture6_thumb.png" alt="Capture6" width="550" height="810" border="0" /></a></p>
<p>Once you have the installed the certificate, you can export it (don&rsquo;t forget the private key) for use on other machines.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture8.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture8" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture8_thumb.png" alt="Capture8" width="550" height="529" border="0" /></a></p>
<p>I recommend storing it in a safe place and not marking the private key as exportable when moving it around, in this way you have some control over which machines can actually decrypt the password in your script.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture9.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture9" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture9_thumb.png" alt="Capture9" width="550" height="529" border="0" /></a></p>
<p>Here&rsquo;s what my certificate looks like</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture7.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture7" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture7_thumb.png" alt="Capture7" width="500" height="622" border="0" /></a></p>
<p>I decided to store my certificate in the computer store, it probably doesn&rsquo;t matter where you store it but you would need to update the following PowerShell cmdlets appropriately. If you are going to have multiple service accounts executing your script, you need to ensure that all these accounts have permission<span style="background-color: #ffff00;"><span style="background-color: #ffffff;"> to read the private key. </span></span><span style="background-color: #ffffff;">This</span> is done by right-clicking the certificate, selecting &ldquo;All Tasks&rdquo; and then &ldquo;Manage Private Keys&rdquo;.</p>
<p>We can use the <em>Get-ChildItem</em> cmdlet to locate our certificate:</p>
<p>[powershell]Get-ChildItem Cert:\LocalMachine\My | Where-Object {$_.Subject -like "CN=PowerShell Automation*"}[/powershell]</p>
<p>Next, I need to encrypt my password. To do this, I define the password as a variable, encode it and then encrypt the encoded password using my certificate&rsquo;s public key:</p>
<p>[powershell]<br />
$Cert = Get-ChildItem Cert:\LocalMachine\My | Where-Object {$_.Subject -like "CN=PowerShell Automation*"}<br />
$Password = 'MyPassword'<br />
$EncodedPwd = [system.text.encoding]::UTF8.GetBytes($Password)<br />
$EncryptedBytes = $Cert.PublicKey.Key.Encrypt($EncodedPwd, $true)<br />
$EncryptedPwd = [System.Convert]::ToBase64String($EncryptedBytes)<br />
[/powershell]</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture10.png"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="Capture10" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture10_thumb.png" alt="Capture10" width="550" height="195" border="0" /></a></p>
<p>Now that I have the encrypted password, I can store it in my script and decode it using my certificate&rsquo;s private key each time the script is executed. To do this, I pretty much reverse the process:</p>
<p>[powershell]<br />
$EncryptedPwd = "ts32rCLLdZl3/6wINHtLD6bQO65ub&hellip;.. <shortened for simplicity>"<br />
$EncryptedBytes = [System.Convert]::FromBase64String($EncryptedPwd)<br />
$DecryptedBytes = $Cert.PrivateKey.Decrypt($EncryptedBytes, $true)<br />
$DecryptedPwd = [system.text.encoding]::UTF8.GetString($DecryptedBytes)<br />
[/powershell]</p>
<p>You can build this into any scripts you have that currently require credentials, it works great for automating Office 365/Exchange Online scripting. To illustrate this, I put together a quick (and dirty!) script that can be used to provide an automated daily &ldquo;Top Mail Recipient&rdquo; report via email. This script can be scheduled to run daily and it will connect to Exchange Online, generate a list of the top mail recipients and email that report to the address you specify. It&rsquo;s not very useful as it is, but it does show how easily you could automate things using PowerShell and serves as a great example for certificate password encryption.</p>
<p>[powershell]<br />
# Function to create report email<br />
function SendReport{<br />
 $Msg = New-Object Net.Mail.MailMessage<br />
 $Smtp = New-Object Net.Mail.SmtpClient($ExchangeServer)<br />
 $Msg.From = $FromAddress<br />
 $Msg.To.Add($ToAddress)<br />
 $Msg.Subject = "Top Mail Recipient Report for $Date"<br />
 $Msg.Body = $EmailBody<br />
 $Msg.IsBodyHTML = $true<br />
 $Smtp.Send($Msg)<br />
}</p>
<p># Define local Exchange server info for message relay. Ensure that any servers running this script have permission to relay.<br />
$ExchangeServer = "yourexchange.domain.com"<br />
$FromAddress = "Office 365 Reports <reports@yourdomain.com>"<br />
$ToAddress = "you@yourdomain.com"</p>
<p># Some basic HTML styling<br />
$Header = "<br />
<style>"<br />
$Header = $Header + "BODY{background-color:#FFFFFF}"<br />
$Header = $Header + "TABLE{border-width: 1px;border-style: solid;border-color: black;border-collapse: collapse;}"<br />
$Header = $Header + "TH{border-width: 1px;padding: 0px;border-style: solid;border-color: black;background-color:#BDBDBD}"<br />
$Header = $Header + "TD{border-width: 1px;padding: 0px;border-style: solid;border-color: black}"<br />
$Header = $Header + "</style>
<p>"</p>
<p># Connect to Exchange Online<br />
# First decrypt the password using the certificate<br />
$Cert = Get-ChildItem Cert:\LocalMachine\My | Where-Object {$_.Subject -like "CN=PowerShell Automation*"}<br />
$EncryptedPwd = "ts32rCLLdZl3/6wINHtLD6bQO65ubeQ3sHj9zXbhsaQDjihQmdyoja+iL0NGXQX0DicQdXWQRu+P8dSy96ux1tLQR9ZT8WPRq8rHsR3gNXDmipCK/4CHoc5Ki7nbMKUSReprtIrnwjlXZNBocTzurBQ+LtAHvAYipD37AXVjjpwwwqud5HCXk+E4OrJGe+yIx/87neRAunqdKvyuaxUYaxeBdx2R/hpLZhxywinjjVMx+0N2RNk7H3fBEite7uuANcAg+ElAssi4DAQYYDOviIrvbjdpKogKcevAh5xEx4Wm2WBzM5XqXmj1O9TUzB9BOiUVQhDwwqCcUpb2bTNW7g=="<br />
$EncryptedBytes = [System.Convert]::FromBase64String($EncryptedPwd)<br />
$DecryptedBytes = $Cert.PrivateKey.Decrypt($EncryptedBytes, $true)<br />
$DecryptedPwd = [system.text.encoding]::UTF8.GetString($DecryptedBytes) | ConvertTo-SecureString -AsPlainText -Force<br />
# Then define Credentials and create session<br />
$Username = "account@yourdomain.onmicrosoft.com"<br />
$Credential = New-Object System.Management.Automation.PSCredential ($Username,$DecryptedPwd)<br />
$Session = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri https://outlook.office365.com/powershell-liveid/ -Credential $Credential -Authentication Basic -AllowRedirection<br />
Import-PSSession $Session</p>
<p># Generate report data<br />
$Date = Get-Date -DisplayHint Date<br />
$EmailBody = Get-MailTrafficSummaryReport -Category TopMailRecipient | select @{expression={$_.C1};label=&rdquo;User&rdquo;}, @{expression={$_.C2};label=&rdquo;Item Count&rdquo;} | ConvertTo-HTML -head $Header -body "<H2>Top Mail Recipient Report</H2>"</p>
<p># Send report<br />
SendReport<br />
[/powershell]</p>
<p>Here is an example of what the final result looks like:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture11.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture11" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture11_thumb.png" alt="Capture11" width="600" height="448" border="0" /></a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Using a certificate to encrypt credentials in automated PowerShell scripts&p[summary]=PowerShell is a great way to help automate frequent or repetitive tasks and every now and then these tasks require some form of authentic...&p[url]=http://172.16.7.177:4000/2015/02/using-a-certificate-to-encrypt-credentials-in-automated-powershell-scripts" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2015/02/using-a-certificate-to-encrypt-credentials-in-automated-powershell-scripts&text=PowerShell is a great way to help automate frequent or repetitive tasks and every now and then these tasks require some form of authentic...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2015-01-21T04:06:49-06:00" itemprop="datePublished">21 Jan, 2015</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2015/01/mail-protection-reports-for-office-365">Mail Protection Reports for Office 365</a></h2>
    </header>

    <div class="post-content">
        <p>One of the great things about Office 365 is how flexible the service is, it caters to those organizations who are looking for a service that just works out of the box as well as those who are looking to get stuck in there and really take things to the next level. A perfect example of this is a recent experience I had with one of my customers. This particular customer was looking to do some specific email reporting and after discussing their options, I thought it would be a good idea to put together this post.</p>
<p>There are a number of options available when it comes to reporting in Office 365. Firstly, the Office 365 admin center provides a number of pre-configured reports and while these are gorgeous looking reports, they may not always provide the level of detail you are looking for. You also have the option of rolling your own with the <a href="https://msdn.microsoft.com/EN-US/library/office/jj984342(v=office.15).aspx" target="_blank">Office 365 Reporting web service</a> but this requires some coding and depending on your requirements may end up being overkill. There is however a great option that falls nicely in the middle of these in the form of an Excel based reporting workbook called <a href="http://www.microsoft.com/en-us/download/details.aspx?id=30716" target="_blank">&ldquo;Mail Protection Reports for Office 365&rdquo;.</a> This reporting workbook isn&rsquo;t new, I remember first using it in a demo for an EOP session I presented at Office 365 Ignite in Sydney, Australia in late 2013 so it has been around for a while, but I&rsquo;m surprised how little press it gets.</p>
<p>The workbook allows you to query specific date ranges and you can then filter and customize how the information is displayed. It provides spam, malware, transport rule and DLP reporting. Here are some examples:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/01/cap1.png"><img class="aligncenter size-full wp-image-1275" src="http://www.cgoosen.com/wp-content/uploads/2015/01/cap1.png" alt="cap1" width="425" height="211" /></a> <a href="http://www.cgoosen.com/wp-content/uploads/2015/01/cap2.png"><img class="aligncenter size-full wp-image-1276" src="http://www.cgoosen.com/wp-content/uploads/2015/01/cap2.png" alt="cap2" width="1191" height="555" /></a> <a href="http://www.cgoosen.com/wp-content/uploads/2015/01/cap3.png"><img class="aligncenter size-full wp-image-1277" src="http://www.cgoosen.com/wp-content/uploads/2015/01/cap3.png" alt="cap3" width="1178" height="758" /></a> <a href="http://www.cgoosen.com/wp-content/uploads/2015/01/cap4.png"><img class="aligncenter size-full wp-image-1278" src="http://www.cgoosen.com/wp-content/uploads/2015/01/cap4.png" alt="cap4" width="1133" height="816" /></a></p>
<p align="left">The reporting workbook ended up being a perfect fit for their specific scenario. It is really simple to use and doesn&rsquo;t require the use of PowerShell or any custom coding. You can download the <a href="http://www.microsoft.com/en-us/download/details.aspx?id=30716" target="_blank">Mail Protection Reports for Office 365 workbook here.</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Mail Protection Reports for Office 365&p[summary]=One of the great things about Office 365 is how flexible the service is, it caters to those organizations who are looking for a service t...&p[url]=http://172.16.7.177:4000/2015/01/mail-protection-reports-for-office-365" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2015/01/mail-protection-reports-for-office-365&text=One of the great things about Office 365 is how flexible the service is, it caters to those organizations who are looking for a service t...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2015-01-08T22:38:04-06:00" itemprop="datePublished">8 Jan, 2015</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2015/01/the-newish-outlook-for-mac-for-office-365-subscribers">The new(ish) Outlook for Mac (for Office 365 subscribers)</a></h2>
    </header>

    <div class="post-content">
        <p>I&rsquo;ve been dying to take the new Outlook for Mac (for Office 365 subscribers) for a test drive ever since <a href="http://blogs.office.com/2014/10/31/new-outlook-mac-available-office-365-customers/" target="_blank">I saw the announcement late last year</a>. Having used both Entourage and Outlook for Mac 2011 in the past, I was excited to see what improvements the new version would bring. Let&rsquo;s be honest, as good as they were, both the previous iterations were miles behind the Windows version of Outlook (which I live in daily). </p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/01/1.png"><img title="1" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="1" src="http://www.cgoosen.com/wp-content/uploads/2015/01/1_thumb.png" width="259" height="309"></a> </p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/01/2.png"><img title="2" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="2" src="http://www.cgoosen.com/wp-content/uploads/2015/01/2_thumb.png" width="428" height="370"></a> </p>
<p align="left">While I haven&rsquo;t spent an extended period of time using the new Outlook for Mac, I have to say I actually love it so far and I think it is safe to say that Outlook for Mac is no longer the poor cousin. I am really looking forward to the release of the next Office for Mac!</p>
<p>The new Outlook for Mac is currently only available to Office 365 commercial customers, Office 365 Home, Office 365 Personal and Office 365 University subscribers while the release of the next version of Office for Mac is currently planned for the second half of 2015.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=The new(ish) Outlook for Mac (for Office 365 subscribers)&p[summary]=I&rsquo;ve been dying to take the new Outlook for Mac (for Office 365 subscribers) for a test drive ever since I saw the announcement lat...&p[url]=http://172.16.7.177:4000/2015/01/the-newish-outlook-for-mac-for-office-365-subscribers" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2015/01/the-newish-outlook-for-mac-for-office-365-subscribers&text=I&rsquo;ve been dying to take the new Outlook for Mac (for Office 365 subscribers) for a test drive ever since I saw the announcement lat...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-11-21T06:36:14-06:00" itemprop="datePublished">21 Nov, 2014</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2014/11/script-fix-proxyaddress-ps1">Script: Fix-ProxyAddress.ps1</a></h2>
    </header>

    <div class="post-content">
        <p><a href="http://www.cgoosen.com/2014/11/migrationpermanentexception-the-target-mailbox-doesnt-have-an-smtp-proxy-matching-company-mail-onmicrosoft-com/" target="_blank">I recently blogged about</a> the "<span style="color: #ff0000;"><em>MigrationPermanentException: The target mailbox doesn't have an SMTP proxy matching 'company.mail.onmicrosoft.com'.</em></span><span style="color: #000000;">" error message that occurs when attempting to perform a remote mailbox move for a user that doesn&rsquo;t have the correct SMTP proxy address. I put together a script to help simplify the process of adding the relevant SMTP proxy address to effected users.</span></p>
<p>Once launched, the script will prompt for your tenant routing domain in the format 'company.mail.onmicrosoft.com' and will search for all mailboxes in the organization that do not have an email address policy applied. A new SMTP proxy address will be added to all mailboxes without an email address policy. The proxy address will be based on the alias of the primary SMTP address and the routing domain entered, e.g if the primary SMTP address is john.smith@company.com and the routing domain entered is company.mail.onmicrosoft.com the resulting proxy address will be john.smith@company.mail.onmicrosoft.com.</p>
<p><strong>Requirements: </strong>This script has been tested and is known to work with Exchange 2010 and Exchange 2013.</p>
<p><strong>Usage:</strong> There are no parameters or switches, simply execute the script:</p>
<p>[shell].\Fix-ProxyAddress.ps1[/shell]</p>
<p><strong>Execution Policy: </strong>The script has been digitally signed and will run just fine under a "RemoteSigned" execution policy.</p>
<p><strong>Screenshots:</strong></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/11/script1.png"><img style="display: inline; border-width: 0px;" title="script1" src="http://www.cgoosen.com/wp-content/uploads/2014/11/script1_thumb.png" alt="script1" width="240" height="220" border="0" /></a></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/11/script2.png"><img style="display: inline; border-width: 0px;" title="script2" src="http://www.cgoosen.com/wp-content/uploads/2014/11/script2_thumb.png" alt="script2" width="476" height="167" border="0" /></a></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/11/script3.png"><img style="display: inline; border-width: 0px;" title="script3" src="http://www.cgoosen.com/wp-content/uploads/2014/11/script3_thumb.png" alt="script3" width="476" height="163" border="0" /></a></p>
<p><strong>Download: </strong>I have published it to the TechNet Gallery, <a href="http://cgoo.se/1xXvNCZ" target="_blank">it can be downloaded by clicking here...</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Script: Fix-ProxyAddress.ps1&p[summary]=I recently blogged about the "MigrationPermanentException: The target mailbox doesn't have an SMTP proxy matching 'company.mail.onmicroso...&p[url]=http://172.16.7.177:4000/2014/11/script-fix-proxyaddress-ps1" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2014/11/script-fix-proxyaddress-ps1&text=I recently blogged about the "MigrationPermanentException: The target mailbox doesn't have an SMTP proxy matching 'company.mail.onmicroso...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-11-21T04:59:34-06:00" itemprop="datePublished">21 Nov, 2014</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2014/11/migrationpermanentexception-the-target-mailbox-doesnt-have-an-smtp-proxy-matching-company-mail-onmicrosoft-com">MigrationPermanentException: The target mailbox doesn't have an SMTP proxy matching 'company.mail.onmicrosoft.com'.</a></h2>
    </header>

    <div class="post-content">
        <p>One of the most common error message I find when performing mailbox moves to Office 365 &ndash; Exchange Online is the &ldquo;<font color="#ff0000"><em>MigrationPermanentException: The target mailbox doesn't have an SMTP proxy matching 'company.mail.onmicrosoft.com'.</em></font><font color="#000000"><em>&rdquo; </em>error:</font></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/11/Capture41.png"><img title="Capture4" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="Capture4" src="http://www.cgoosen.com/wp-content/uploads/2014/11/Capture4_thumb1.png" width="438" height="166"></a> </p>
<p align="left">The error message is pretty descriptive and is caused when the mailbox being moved doesn&rsquo;t have a proxy address that matches the routing domain. In an Exchange hybrid deployment, the hybrid configuration wizard updates the on-premises email address policies to ensure that all mailboxes have the relevant SMTP proxy address added. This should work fine except in instances when for whatever reason a mailbox or group of mailboxes are not being updated by an email address policy. Typically because the &ldquo;Automatically update email addresses based on the email address policy applied to this recipient&rdquo; has been manually removed:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/11/script41.png"><img title="script4" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="script4" src="http://www.cgoosen.com/wp-content/uploads/2014/11/script4_thumb1.png" width="347" height="259"></a> </p>
<p align="left">There are a couple of ways to fix this, you could just enable the email address policy for those particular mailboxes, but the risk with that option is that it may have been removed for a particular reason. Email address policies are additive only, so while an email address policy will not remove or overwrite an email address, it may change the default SMTP address.</p>
<p align="left">Or, you may want to simply add the relevant SMTP proxy address for those mailboxes, this can easily be done via PowerShell. I have published a PowerShell script to simplify this process, <a href="https://gallery.technet.microsoft.com/Fix-ProxyAddressps1-7036dfa1" target="_blank">check it out on the TechNet Gallery.</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=MigrationPermanentException: The target mailbox doesn't have an SMTP proxy matching 'company.mail.onmicrosoft.com'.&p[summary]=One of the most common error message I find when performing mailbox moves to Office 365 &ndash; Exchange Online is the &ldquo;MigrationPe...&p[url]=http://172.16.7.177:4000/2014/11/migrationpermanentexception-the-target-mailbox-doesnt-have-an-smtp-proxy-matching-company-mail-onmicrosoft-com" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2014/11/migrationpermanentexception-the-target-mailbox-doesnt-have-an-smtp-proxy-matching-company-mail-onmicrosoft-com&text=One of the most common error message I find when performing mailbox moves to Office 365 &ndash; Exchange Online is the &ldquo;MigrationPe...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-10-21T17:22:15-05:00" itemprop="datePublished">21 Oct, 2014</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2014/10/my-session-at-sharepoint-conference-org-2014">My session at SharePoint Conference.ORG 2014</a></h2>
    </header>

    <div class="post-content">
        <p>I had a great time attending and presenting at SharePoint Conference.ORG yesterday. I really enjoyed the great mixture of business, user experience and technical sessions. I presented a &ldquo;Getting started with Office 365&rdquo; session and as promised I am making my slide deck available.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/10/IMG_0972.jpg"><img style="display: inline; border: 0px;" title="IMG_0972" src="http://www.cgoosen.com/wp-content/uploads/2014/10/IMG_0972_thumb.jpg" alt="IMG_0972" width="274" height="236" border="0" /></a></p>
<p align="center">[slideshare id=40574145&amp;doc=gettingstartedwithoffice365-141021225449-conversion-gate01]</p>
<p align="center">Slides <a href="http://cgoo.se/10lgfg1" target="_blank">also available on slideshare</a></p>
<p style="text-align: left;" align="center">For more information about SharePoint Conference .ORG check out <a href="http://www.sharepointconference.org/">http://www.sharepointconference.org/</a> or on twitter: @SPC_ORG</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=My session at SharePoint Conference.ORG 2014&p[summary]=I had a great time attending and presenting at SharePoint Conference.ORG yesterday. I really enjoyed the great mixture of business, user ...&p[url]=http://172.16.7.177:4000/2014/10/my-session-at-sharepoint-conference-org-2014" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2014/10/my-session-at-sharepoint-conference-org-2014&text=I had a great time attending and presenting at SharePoint Conference.ORG yesterday. I really enjoyed the great mixture of business, user ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-10-15T10:39:16-05:00" itemprop="datePublished">15 Oct, 2014</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2014/10/script-connect-exo-ps1-connect-to-exchange-online-using-remote-powershell">Script: Connect-EXO.ps1 - Connect to Exchange Online using remote PowerShell</a></h2>
    </header>

    <div class="post-content">
        <p>I recently came across an old script I wrote to simplify connecting to Exchange Online using remote PowerShell and thought I&rsquo;d polish it up a little and release it in case it could help make life easier for someone else.</p>
<p>This page will be updated whenever new features are added to the script..</p>
<p>This script features a GUI that will prompt for your tenant credentials and then connect to various Office 365 services using remote PowerShell. The current version of the script allows connectivity to:</p>
<ul>
<li>Exchange Online</li>
<li>Azure Active Directory</li>
<li>Office 365 Security &amp; Compliance Center<strong>&nbsp;</strong></li>
</ul>
<p><strong>Requirements:<br />
</strong>The script will work natively in PowerShell 2.0+</p>
<p><strong>Usage:</strong><br />
There are no parameters or switches, simply execute the script:</p>
<p>[shell].\Connect-EXO.ps1[/shell]</p>
<p><strong>Execution Policy:<br />
</strong>The script has been digitally signed and will run just fine under a "RemoteSigned" execution policy.</p>
<p><strong>Screenshots:</strong></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/10/cap1.png" rel="attachment wp-att-1504"><img class="aligncenter wp-image-1504" src="http://www.cgoosen.com/wp-content/uploads/2014/10/cap1.png" alt="GUI" width="451" height="296" /></a></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/10/cap2.png" rel="attachment wp-att-1505"><img class="aligncenter size-large wp-image-1505" src="http://www.cgoosen.com/wp-content/uploads/2014/10/cap2-1024x292.png" alt="Connected!" width="640" height="183" /></a></p>
<p><strong>Download:<br />
</strong>I have published it to the TechNet Gallery, <a href="http://cgoo.se/2mPzFJo" target="_blank">it can be downloaded by clicking here...</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Script: Connect-EXO.ps1 - Connect to Exchange Online using remote PowerShell&p[summary]=I recently came across an old script I wrote to simplify connecting to Exchange Online using remote PowerShell and thought I&rsquo;d poli...&p[url]=http://172.16.7.177:4000/2014/10/script-connect-exo-ps1-connect-to-exchange-online-using-remote-powershell" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2014/10/script-connect-exo-ps1-connect-to-exchange-online-using-remote-powershell&text=I recently came across an old script I wrote to simplify connecting to Exchange Online using remote PowerShell and thought I&rsquo;d poli...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-09-12T09:42:39-05:00" itemprop="datePublished">12 Sep, 2014</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2014/09/do-you-have-a-pre-exchange-2013-sp1-hybrid-or-are-you-using-freebusy-federation-update-your-federation-trust-on-sept-23">Do you have a pre-Exchange 2013 SP1 Hybrid or are you using free/busy federation? Update your Federation Trust on Sept 23!</a></h2>
    </header>

    <div class="post-content">
        <p>If your organization has an Exchange Hybrid deployment that is not running on Exchange 2013 SP1 or later you may want pay attention. On September 23, 2014, Microsoft will be making a certificate change to the Microsoft Federation Gateway which could affect you.</p>
<p>This change could also impact those who are sharing free/busy information between two different on-premises organizations. If you are already running Exchange 2013 SP1 then you are in luck as this task will be automated for you and you are not required to take any action. For those using older versions of Exchange, it is very important that you update your Federation Trust as failing to do so will result in loss of free/busy and mailtip functionality. <a href="http://blogs.technet.com/b/exchange/archive/2014/09/10/keep-your-federation-trust-up-to-date.aspx" target="_blank">Microsoft released the following post that provides more information as well as the recommended actions that should be taken,</a> I strongly recommend paying attention to this if you are not on the latest version of Exchange 2013.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Do you have a pre-Exchange 2013 SP1 Hybrid or are you using free/busy federation? Update your Federation Trust on Sept 23!&p[summary]=If your organization has an Exchange Hybrid deployment that is not running on Exchange 2013 SP1 or later you may want pay attention. On S...&p[url]=http://172.16.7.177:4000/2014/09/do-you-have-a-pre-exchange-2013-sp1-hybrid-or-are-you-using-freebusy-federation-update-your-federation-trust-on-sept-23" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2014/09/do-you-have-a-pre-exchange-2013-sp1-hybrid-or-are-you-using-freebusy-federation-update-your-federation-trust-on-sept-23&text=If your organization has an Exchange Hybrid deployment that is not running on Exchange 2013 SP1 or later you may want pay attention. On S...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-08-30T03:51:36-05:00" itemprop="datePublished">30 Aug, 2014</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2014/08/office-365-workstation-readiness">Office 365 Workstation Readiness</a></h2>
    </header>

    <div class="post-content">
        <p>As cloud services and Office 365 in general continue to gain popularity, I find myself talking to more and more organizations who are looking to make use of these services. One of the challenges I come up against most often is the issue of workstation readiness and how many organizations tend to overlook the importance or simply glance over that section in the enablement plan. One of the great things about Microsoft Online Services is the rapid innovation and how quickly new features and brought to market. Unfortunately this also seems to catch many organizations off-guard.</p>
<p>I&rsquo;m sure we can all agree that a workstation refresh project for even a small customer is a big undertaking and I&rsquo;ve seen many Office 365 projects stall for a very long time due to workstation readiness and/or workstation refresh projects. As always, a thorough analysis and due diligence is required to ensure that all workstations in the fleet meet the published minimum requirements in order to ensure the best possible user experience. I&rsquo;ve seen a whole lot of old and out of date information floating around so I thought I would put together a quick post to spell out the current requirements. In the past, there was a complex table that listed specific updates required by specific software versions and due dates, but thankfully Microsoft has recently simplified this list. In order to provide the best user experience, Office 365 is designed to work with:</p>
<ul>
<li>The current or immediately previous version of Internet Explorer or Firefox, or the latest version of Chrome or Safari.</li>
<li>Any version of Microsoft Office in mainstream support.</li>
</ul>
<p>The above list and <a href="http://office.microsoft.com/en-us/office365-suite-help/office-365-system-requirements-HA102817357.aspx">additional information is published here</a>. Using this guidance, the current workstation readiness requirements are:</p>
<ul>
<li>Internet Explorer 10 or 11 (The current or immediately previous version of Firefox, or the latest version of Chrome or Safari -&nbsp; I never keep track of those because they change so frequently!)</li>
<li>Microsoft Office 2010 or 2013 </li>
</ul>
<p>Still using Internet Explorer 8 or 9? How about Microsoft Office 2007? These versions are no longer officially supported by Microsoft and although Microsoft does not recommend using these older browsers and clients, the service won&rsquo;t deliberately prevent these browsers and clients from connecting, but the user experience cannot be guaranteed in the longer term. </p>
<p>I am a firm believer that projects fail because of end-user perception, if users have a degraded experience they are likely to overlook all the cool new features and functionality you are providing. No matter how quickly you can pilot, deploy and migrate to Office 365, I strongly suggest spending some time analyzing your current workstation fleet to to ensure that your users have the best possible user experience.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Office 365 Workstation Readiness&p[summary]=As cloud services and Office 365 in general continue to gain popularity, I find myself talking to more and more organizations who are loo...&p[url]=http://172.16.7.177:4000/2014/08/office-365-workstation-readiness" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2014/08/office-365-workstation-readiness&text=As cloud services and Office 365 in general continue to gain popularity, I find myself talking to more and more organizations who are loo...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-07-02T07:15:24-05:00" itemprop="datePublished">2 Jul, 2014</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2014/07/microsoft-office-365-mvp">Microsoft Office 365 MVP!</a></h2>
    </header>

    <div class="post-content">
        <p>Today was a good day! It stared out in Music City &ndash; Nashville, Tennessee, I went for an early morning run and was getting ready to kick-off my first project since relocating to the U.S a few weeks ago when, just after 8am I received an email informing me that I had been presented with a 2014 Microsoft MVP Award for my contribution to Office 365 technical communities during the past year.</p>
<p>I am extremely honoured to receive this award and join the MVP community, a community which I have long respected and admired.</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2014/07/image.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2014/07/image_thumb.png" width="586" height="115"></a></p>
<p align="left">Thanks to everyone reading my blog for all your comments and to everyone interacting on social media and in person at conferences and events. I look forward to continued contribution and to sharing my passion with you all.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Microsoft Office 365 MVP!&p[summary]=Today was a good day! It stared out in Music City &ndash; Nashville, Tennessee, I went for an early morning run and was getting ready to ...&p[url]=http://172.16.7.177:4000/2014/07/microsoft-office-365-mvp" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2014/07/microsoft-office-365-mvp&text=Today was a good day! It stared out in Music City &ndash; Nashville, Tennessee, I went for an early morning run and was getting ready to ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-06-04T19:41:06-05:00" itemprop="datePublished">4 Jun, 2014</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2014/06/online-migration-tools-comparing-migrationwiz-and-dell-on-demand-migration">Online Migration Tools - Comparing MigrationWiz and Dell On Demand Migration</a></h2>
    </header>

    <div class="post-content">
        <p>I recently needed to migrate my own personal Office 365 tenant to another Office 365 tenant and even though I only have a few fairly small mailboxes, I decided to use online migration tools to ease the migration and I thought it would be a good idea to put together a little comparison between two of the leading solutions, MigrationWiz and Dell (formerly Quest) On Demand Migration.</p>
<p>The truth is, migration tools aren&rsquo;t new and many of today&rsquo;s players in this market have been around for a some time. Cloud adoption however has driven innovation in the market and migration toolsets have changed in recent years. Online migration tools allow organizations to migrate their data between email platforms without having to install or maintain any migration software on-premises. From an IT professional perspective, the configuration is far simpler and because you are typically using a web browser to initiate and manage the migration you are now free to do it from wherever you want (the train in my case!) using whatever device you have available. At a high level, it is a fairly simple process which typically involves the configuration of source and destination connectors (with all the required permissions of course) and the solution will extract, convert and ingest your data for you. If either your source or target mail infrastructure is located on-premises, you would need to ensure that remote connectivity is correctly configured as well.</p>
<p>For this comparison, I used exactly the same source mailbox and migrated the content to two new target mailboxes (one for each tool) in a new Office 365 tenant. Both tenants (source and destination) were located in North America and the migrations did not run simultaneously. The source mailbox contained the following:</p>
<ul>
<li>Number of folders = 38</li>
<li>Number of items = 26255</li>
<li>Total mailbox size = ~1.94 GB</li>
</ul>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb.png" alt="image" width="750" height="116" border="0" /></a></p>
<p><u>Introduction and features:</u></p>
<p>MigrationWiz has been around for a few years now and was the first online migration tool I used. I have successfully used MigrationWiz several times and migrated users from Domino/Lotus Notes and Exchange to Exchange or Office 365/Exchange Online. One of the great things about MigrationWiz is the amount of supported source and target platforms.</p>
<div align="center">
<table border="0" width="674" cellspacing="0" cellpadding="2" align="center">
<tbody>
<tr>
<td valign="top" width="323">
<p align="center"><strong>Supported sources</strong></p>
</td>
<td valign="top" width="349">
<p align="center"><strong>Supported targets</strong></p>
</td>
</tr>
<tr>
<td valign="top" width="323">
<p align="left">Amazon S3<br />
Google Apps/Gmail<br />
IMAP<br />
Microsoft Exchange (2003+)<br />
Microsoft Office 365<br />
Microsoft Office 365 China<br />
Novell GroupWise<br />
POP<br />
VMware Zimbra Server<br />
IBM Lotus Notes</p>
</td>
<td valign="top" width="349">
<p align="left">Amazon S3<br />
Google Apps/Gmail<br />
IMAP​<br />
Microsoft Exchange (2007+)<br />
Microsoft Office 365<br />
Microsoft Office 365 China</p>
</td>
</tr>
</tbody>
</table>
</div>
<div align="left"><span style="background-color: #ffffff;">For more detailed information about the platforms currently <a href="https://community.bittitan.com/kb/Pages/What%20systems%20do%20you%20currently%20support.aspx" target="_blank">supported by MigrationWiz, click here.</a></span></div>
<div align="left"></div>
<div align="left">I should also mention that migrations from Domino/Lotus Notes require a small <a href="https://migrationwiz.zendesk.com/entries/21309916-How-do-I-configure-a-migration-from-Lotus-Notes-" target="_blank">&ldquo;Lotus Extractor&rdquo;</a> to be installed on-premises. The extractor should be installed on a workstation and not your Domino servers themselves. MigrationWiz are also in the process of launching a new migration portal which is currently in beta and will support a couple of new migrations, namely:</div>
<ul>
<li>Public Folder migrations</li>
<li>Storage migrations</li>
</ul>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image1.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb1.png" alt="image" width="750" height="425" border="0" /></a></p>
<p>These options look really promising, however I haven&rsquo;t personally tested them (yet!). A list of items not migrated by <a href="https://community.bittitan.com/kb/Pages/What%20items%20are%20not%20migrated.aspx" target="_blank">MigrationWiz can be found here.</a></p>
<p>Dell On Demand Migration for Email is a relative newcomer to the online migration tools market, however I&rsquo;m sure we can all agree that they (Quest Software) really set the standard for migration tools in general for a long time. I haven&rsquo;t personally used Dell On Demand for any production migrations but have been meaning to try it out for some time now. Dell On Demand supports the following platforms:</p>
<table border="0" width="674" cellspacing="0" cellpadding="2" align="center">
<tbody>
<tr>
<td valign="top" width="323">
<p align="center"><strong>Supported sources</strong></p>
</td>
<td valign="top" width="349">
<p align="center"><strong>Supported targets</strong></p>
</td>
</tr>
<tr>
<td valign="top" width="323">Google Apps<br />
IMAP​<br />
Lotus Notes<br />
Microsoft Exchange (2000+)<br />
Microsoft Office 365<br />
Novell GroupWise<br />
POP<br />
SunONE/iPlanet<br />
Windows Live Hotmail<br />
Zimbra</td>
<td valign="top" width="349">Microsoft Exchange (2010, 2013)<br />
Microsoft Office 365</td>
</tr>
</tbody>
</table>
<p><span style="background-color: #ffffff;">Dell has published a list of <a href="http://documents.software.dell.com/DOC190779" target="_blank">known issues</a> and <a href="http://documents.software.dell.com/DOC190769" target="_blank">limitations.</a></span></p>
<p><span style="background-color: #ffffff;"><u>Licensing and cost:</u></span></p>
<p>One of the great things about both these tools is that they are licensed on a consumption basis and there is no minimum purchase required. MigrationWiz offers a couple of different license options, with the difference being that a &ldquo;Premium&rdquo; license will allow you to perform multiple migration passes. I usually suggest purchasing the &ldquo;Premium&rdquo; license because this works really well with the &ldquo;seed and cutover&rdquo; type migrations I usually perform with these tools. With MigrationWiz, you purchase you license up front and each successfully migrated mailbox consumes one of those licenses. Their licensing is based on volume so the more licenses you purchase, the more you save. A basic license will cost you $9.99 (USD) while a premium license costs $11.99 (USD).</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image2.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb2.png" alt="image" width="750" height="581" border="0" /></a></p>
<p>The Dell On Demand licensing model is somewhat simpler in the sense that they only have one license type. The difference is that you add your credit card details to the portal and they will bill you monthly for the amount of licenses you consume with each successfully migrated mailbox consuming one license and getting billed accordingly. Dell also appear to add an &ldquo;Australia Tax&rdquo; as the same license costs about 20% more when you pay in AUD, I always think this is a little cheeky, $1 or $2 could really add up if you are buying thousands of licenses. One license will cost you $11.00 (USD).</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image6.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image6_thumb.png" alt="image" width="750" height="249" border="0" /></a></p>
<p align="left"><u>Configuration:</u></p>
<p align="left">To configure MigrationWiz, you first create a &ldquo;Mailbox Connector&rdquo; which defines your source and target mailboxes as well as your migration credentials. You have the ability to use administrator credentials or end-user credentials configured per mailbox. If you have neither of these available, MigrationWiz also provides the ability to request credentials from each individual user. This is done via an email with a secure link in which the end-user may provide their credentials directly to the system.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image3.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb3.png" alt="image" width="750" height="616" border="0" /></a></p>
<p align="left">Once you have created your &ldquo;Mailbox Connector&rdquo; you can import your mailbox list. If you have more than one mailbox to migrate, MigrationWiz provides a few methods of doing this.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image4.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb4.png" alt="image" width="750" height="494" border="0" /></a></p>
<p align="left">I typically use .csv import. You can download a sample import file to get started (see sample below). If you are using administrator credentials for your migration, you only need to populate the &ldquo;Source Email&rdquo; and &ldquo;Destination Email&rdquo; fields. More information about <a href="https://migrationwiz.zendesk.com/entries/489970-How-do-I-import-mailboxes-into-the-system-without-entering-them-one-at-a-time-" target="_blank">migration flags can be found here.</a> I once did a migration for a customer using end-user credentials where some of the users had commas &ldquo;,&rdquo; in their passwords and needless to say, this didn&rsquo;t work very well with .csv files so be mindful of that.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image5.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb5.png" alt="image" width="500" height="102" border="0" /></a></p>
<p align="left">Once all your mailboxes have been added, you have the ability to tweak many of the migration settings, like filtering, before beginning the migration process.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image7.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb6.png" alt="image" width="750" height="416" border="0" /></a></p>
<p align="left">You now have the ability to migrate a few or all of the mailboxes you have imported. You will also be able to monitor the migration statistics while the migration is running. The MigrationWiz documentation is really helpful as well, for example if you need more information about <a href="https://community.bittitan.com/kb/Pages/How%20do%20I%20create%20an%20administrator%20account%20for%20login.aspx" target="_blank">migration credentials, see this link</a></p>
<p>The Dell On Demand configuration process is very similar, you start by creating a &ldquo;Migration Plan&rdquo; which defines your source and target mailboxes as well as your credentials. You have the ability to use administrator credentials or end-user credentials and the tool allows you to increase the number of concurrent mailbox migrations by adding additional administrator credentials. Each administrator can migrate 10 target mailboxes concurrently.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image8.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb7.png" alt="image" width="750" height="512" border="0" /></a></p>
<p align="left">The next step is to import your mailboxes, this can be done via a .tsv file. A sample file is also provided for reference.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image9.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb8.png" alt="image" width="500" height="325" border="0" /></a></p>
<p align="left">The final configuration step allows you to tweak the migration options</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image10.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb9.png" alt="image" width="750" height="581" border="0" /></a></p>
<p align="left">You are now ready to start migrating!</p>
<p><u>Migration Velocity:</u></p>
<p>As a consultant, one of the most common questions I get asked is &ldquo;How long will my migration take?&rdquo;. Unfortunately, this is a very difficult question to answer and the reality is, even with thorough testing and analysis, it is difficult to accurately predict how long a migration will take as every environment is different and migration velocity depends on so much more than just your network speeds. About 6 months ago, I helped a customer complete a migration from Exchange 2003 in one region to Exchange 2010 in another. They had a very tight deadline and it was a hard cut-off so there was no pushing the deadline. I did I whole bunch of calculations based on their source data size, connectivity, etc and in my mind there was no way we would be able to get all the data migrated in time so we started to prepare the business for that. We decided to use MigrationWiz for the migration and we ended up completing the entire migration with 4 full days to spare. Because we were prepared for the worst possible case, the entire team looked really good when we were able to pull it off successfully. I&rsquo;m glad it didn&rsquo;t end up going the other way and it just goes to show that there is always a small unknown factor that could change the amount of time taken for a migration to complete successfully.</p>
<p>It is usually a good idea to perform some test migrations using mailboxes that accurately represent those found in your environment. Using data from those migrations will go a long way to helping you predict your migration velocity. It is really handy to use some pilot user mailboxes for this because you will be able to perform multiple passes later on and not consume any additional licenses. MigrationWiz provides some <a href="https://migrationwiz.zendesk.com/entries/489626-How-do-I-size-my-migration-" target="_blank">guidance and a basic calculator here.</a></p>
<p>The results of the test migrations performed for this post are as follows:</p>
<table border="0" width="675" cellspacing="0" cellpadding="2" align="center">
<tbody>
<tr>
<td valign="top" width="192"></td>
<td valign="top" width="233">
<p align="center"><strong>MigrationWiz</strong></p>
</td>
<td valign="top" width="248">
<p align="center"><strong>Dell On Demand</strong></p>
</td>
</tr>
<tr>
<td valign="top" width="192"><strong>Duration</strong></td>
<td valign="top" width="258">16 hrs, 23 min</td>
<td valign="top" width="295">11 hrs, 0 min</td>
</tr>
<tr>
<td valign="top" width="192"><strong>Items Processed</strong></td>
<td valign="top" width="258">26118</td>
<td valign="top" width="295">26286</td>
</tr>
<tr>
<td valign="top" width="192"><strong>Errors</strong></td>
<td valign="top" width="258">0</td>
<td valign="top" width="295">13</td>
</tr>
</tbody>
</table>
<p>The statistics above were taken from each migration tool. There are some discrepancies with the amount of items processed and the Dell tool reported some failures. Looking at the target mailbox used for the Dell On Demand migration, we see:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image11.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb10.png" alt="image" width="750" height="106" border="0" /></a></p>
<p align="left">MigrationWiz provides a whole bunch of information about the migration, including some detailed statistics:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image12.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb11.png" alt="image" width="750" height="581" border="0" /></a></p>
<p align="left">Dell On Demand provides an overview of the migration with some detailed logging:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image13.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb12.png" alt="image" width="750" height="303" border="0" /></a></p>
<p>I am perplexed by the large difference in migration duration. These migrations were run on random days of the week at roughly the same time so I&rsquo;m not sure if it is a coincidence or not. I might re-do the MigrationWiz one sometime and see if it changes the duration.</p>
<p><u>Reporting:</u></p>
<p>MigrationWiz provides some nice charts at a mailbox level as well as some .csv reports at connector level for those who like to create their own reports in Excel.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image14.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb13.png" alt="image" width="750" height="359" border="0" /></a></p>
<p align="left">Dell On Demand provides a summary and a migration details report which includes a .csv file containing all the errors that were encountered during the migration. The reports menu is &ldquo;conveniently&rdquo; hidden on the bottom right-hand side of the dashboard.</p>
<p align="left"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image15.png"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb14.png" alt="image" width="500" height="281" border="0" /></a></p>
<p><u>Documentation:</u></p>
<p>MigrationWiz has heaps of useful documentation, the knowledgebase is located here: <a title="https://migrationwiz.zendesk.com/forums" href="https://migrationwiz.zendesk.com/forums">https://migrationwiz.zendesk.com/forums</a> and it seems they are moving their content to a SharePoint based library located here: <a title="https://community.bittitan.com/kb/SitePages/Knowledge%20Base.aspx?product=MigrationWiz" href="https://community.bittitan.com/kb/SitePages/Knowledge%20Base.aspx?product=MigrationWiz">https://community.bittitan.com/kb/SitePages/Knowledge%20Base.aspx?product=MigrationWiz</a></p>
<p>Dell On Demand has a user guide which is published here: <a title="http://documents.software.dell.com/On%20Demand%20Migration%20for%20Email/1.6/User%20Guide/" href="http://documents.software.dell.com/On%20Demand%20Migration%20for%20Email/1.6/User%20Guide/">http://documents.software.dell.com/On%20Demand%20Migration%20for%20Email/1.6/User%20Guide/</a></p>
<p><u>In Summary:</u></p>
<p>I think both are excellent tools which provide a wide range of options. Dell On Demand is targeted towards those organizations who are migrating to Microsoft Exchange while MigrationWiz supports other target platforms, like the ability to archive to Amazon S3. MigrationWiz has also recently added the ability to perform Public Folder and Storage migrations. Dell On Demand appears to have outperformed MigrationWiz when it comes to migration velocity, however I do find the MigrationWiz documentation to be superior.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Online Migration Tools - Comparing MigrationWiz and Dell On Demand Migration&p[summary]=I recently needed to migrate my own personal Office 365 tenant to another Office 365 tenant and even though I only have a few fairly smal...&p[url]=http://172.16.7.177:4000/2014/06/online-migration-tools-comparing-migrationwiz-and-dell-on-demand-migration" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2014/06/online-migration-tools-comparing-migrationwiz-and-dell-on-demand-migration&text=I recently needed to migrate my own personal Office 365 tenant to another Office 365 tenant and even though I only have a few fairly smal...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-05-02T04:50:46-05:00" itemprop="datePublished">2 May, 2014</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2014/05/how-to-perform-a-manual-synchronisation-with-aadsync">How to perform a manual synchronisation with AADSync</a></h2>
    </header>

    <div class="post-content">
        <p>I recently posted about the preview (CTP) of <a href="http://www.cgoosen.com/2014/04/azure-active-directory-sync-services-kicking-the-aadsync-tyres/" target="_blank">Azure Active Directory Sync Services (AADSync)</a>. There are a number of differences between AAADSync and DirSync, one of these being that the &ldquo;DirSyncConfigShell.psc1&rdquo; shell previously used to perform a manual synchronisation is not longer available. Instead, we can now use &ldquo;DirSyncClientCmd.exe&rdquo; which is located in &ldquo;C:\Program Files (x86)\Windows Azure AD Connection&rdquo;</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2014/05/image.png"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="image" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2014/05/image_thumb.png" width="704" height="678" border="0" /></a></p>
<p>The syntax is really straightforward, you can perform either an &ldquo;initial&rsquo; or &ldquo;delta&rdquo; synchronisation, e.g:</p>
<p>[shell]DirSyncClientCmd delta[/shell]</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2014/05/image1.png"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="image" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2014/05/image_thumb1.png" width="704" height="357" border="0" /></a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=How to perform a manual synchronisation with AADSync&p[summary]=I recently posted about the preview (CTP) of Azure Active Directory Sync Services (AADSync). There are a number of differences between AA...&p[url]=http://172.16.7.177:4000/2014/05/how-to-perform-a-manual-synchronisation-with-aadsync" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2014/05/how-to-perform-a-manual-synchronisation-with-aadsync&text=I recently posted about the preview (CTP) of Azure Active Directory Sync Services (AADSync). There are a number of differences between AA...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-04-27T17:55:54-05:00" itemprop="datePublished">27 Apr, 2014</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2014/04/using-ad-fs-alternate-login-id-with-office-365">Using AD FS &ldquo;Alternate Login ID&rdquo; with Office 365</a></h2>
    </header>

    <div class="post-content">
        <p>As Office 365 adoption continues to grow and more organisations are starting to take advantage of identity federation. One of the most common issues I&rsquo;ve seen over the last couple of years when helping my clients adopt Office 365 services is the disconnect between user principal name (UPN), sAMAccountName (The user name typically used at logon) and the &lsquo;mail&rsquo; attribute in Active Directory. There are many reasons for this and I won&rsquo;t go into that in this post, but it is quite common to see one of the following scenarios:</p>
<ol>
<li>sAMAccountName = JSmith, UPN = JSmith@internal.local, Mail = John.Smith@domain.com</li>
<li>sAMAccountName = ID123456, UPN = ID123456@internal.local, Mail = John.Smith@domain.com &ndash; I&rsquo;ve seen this scenario quite often when working with .gov and .edu clients.</li>
</ol>
<p>In the past, the typical recommendation is to add the public domain to the UPN suffix list and change the UPN for each user to match their email address. This causes much less confusion for end users as you won&rsquo;t need to try and explain the different between their UPN and their email address even though they both appear to be the same.</p>
<p>*Update: I'd like to call out that implementing "Alternate Login ID" with an Exchange Hybrid deployment is not a good idea. Microsoft has the following warning posted on the <a href="http://social.technet.microsoft.com/wiki/contents/articles/24096.dirsync-using-alternate-login-ids-with-azure-active-directory.aspx" target="_blank">TechNet wiki</a>.</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2014/04/Capture.png"><img class="aligncenter  wp-image-1310" src="http://www.cgoosen.com/wp-content/uploads/2014/04/Capture-300x95.png" alt="Warning" width="395" height="125" /></a></p>
<p><a href="http://support.microsoft.com/kb/2919355" target="_blank">The April 2014 Windows Server 2012 R2 Update (KB 2919355)</a> includes a new feature called &ldquo;Alternate Login ID&rdquo; which will allow you to configure an alternate attribute to be used to identify a user object in Active Directory. In other words, you can now use a different attribute, for example &lsquo;mail&rsquo; during login instead of UPN.</p>
<p>This is great news for those organisations who use of employee ID or payroll numbers as their domain user names. As always, there are a few things to consider. In order for the authentication request to succeed, the attribute configured as the alternate login ID must satisfy the following requirements:</p>
<ul>
<li>The attribute must be indexed.</li>
<li>The attribute must be in the global catalog.</li>
<li>The attribute must be a well-formed SMTP address and conform to the <a href="http://technet.microsoft.com/en-us/library/jj943764.aspx" target="_blank">UPN rules outlined here.</a></li>
<li>The attribute must have a single value.</li>
<li>The CanonicalName attribute on the user object must be accessible to the service account that is used for AD FS.</li>
<li>The value of the alternate login ID attribute must be unique across all the forests that AD FS is configured to use when enabling this feature.</li>
</ul>
<p>The configuration process is really simple as well, for example let&rsquo;s assume we already have AD FS 3.0 implemented with Office 365. My test environment is configured as follows:</p>
<ul>
<li>Internal AD domain name: <strong>lab365.com.au</strong> &ndash; NOT configured in Office 365</li>
<li>Public (SMTP) domain name: <strong>o365testlab.com</strong> &ndash; This domain is also configured in Office 365</li>
<li>sAMAccountName = ID123456, UPN = <strong>ID123456@lab365.com.au</strong>, Mail = <strong>John.Smith@o365testlab.com</strong></li>
</ul>
<p>We would like to allow our users to log in using their email addresses (&lsquo;mail&rsquo; attribute) instead of their UPN.</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2014/04/image29.png"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/04/image29_thumb.png" alt="image" width="424" height="558" border="0" /></a></p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2014/04/image31.png"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/04/image31_thumb.png" alt="image" width="424" height="558" border="0" /></a></p>
<p>It is important to note that if you are not using a routable UPN suffix, you will most likely want to pre-configure the correct SMTP and SIP addresses for your user accounts before you synchronise them. This can be done via the &ldquo;proxyAddresses&rdquo; attribute of the user account:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/04/image15.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/04/image_thumb15.png" alt="image" width="424" height="561" border="0" /></a></p>
<p align="left">Once the user has been synchronised to Azure AD and assigned the relevant licenses in Office 365 it should look something like:</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2014/04/image16.png"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/04/image_thumb16.png" alt="image" width="504" height="433" border="0" /></a></p>
<p>To configure AD FS, the first thing to do is install the <a href="http://support.microsoft.com/kb/2919355" target="_blank">April 2014 Windows Server 2012 R2 Update (KB 2919355)</a>, this can easily be done via Windows Update:</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2014/04/image101.png"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/04/image10_thumb.png" alt="image" width="755" height="201" border="0" /></a></p>
<p><span style="color: #ff0000;">Warning:</span> There is a known issue with the April 2014 Windows Server 2012 R2 Update (KB 2919355) that may effect you if you are using Windows Server Update Services. Be sure to <a href="http://support.microsoft.com/kb/2959977" target="_blank">read KB 2959977</a> before installing this update in your environment. As always, planning and testing is very important!</p>
<p>Next, update the AD FS configuration by running the following PowerShell cmdlet on any of the federation servers in your farm, starting with the primary AD FS server in your farm, obviously you would need to adjust the &ldquo;AlternateLoginID&rdquo; and &ldquo;LookupForests&rdquo; parameters to suite your particular requirements:</p>
<p>[powershell]Set-AdfsClaimsProviderTrust -TargetIdentifier "AD AUTHORITY" -AlternateLoginID mail -LookupForests lab365.com.au[/powershell]</p>
<p>Next, we need to update one of our AD FS claims rules. We locate the &ldquo;Microsoft Office 365 Identity Platform&rdquo; relying party trust and edit issuance transform rule number 1:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/04/image17.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/04/image_thumb17.png" alt="image" width="754" height="763" border="0" /></a></p>
<p>The new rule should look like this:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/04/image18.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/04/image_thumb18.png" alt="image" width="754" height="763" border="0" /></a></p>
<p align="left">Lastly, we need to update our DirSync attribute flow to ensure the correct attribute is synchronised. Run the miisclient.exe which can be located in "C:\Program Files\Windows Azure Active Directory Sync\SYNCBUS\Synchronization Service\UIShell&rdquo;. Select the &ldquo;Management Agents&rdquo; tab, right-click to view the properties of &ldquo;Active Directory Connector&rdquo;. Under &ldquo;Configure Attribute Flow&rdquo;, expand &ldquo;Object Type: user&rdquo; and find the &ldquo;Data Source Attribute&rdquo; of &ldquo;<dn>,sAMAccountName,userPrincipalName&rdquo;. To edit it:</p>
<ol>
<li>Change the &ldquo;Mapping Type&rdquo; from &ldquo;Advanced&rdquo; to &ldquo;Direct&rdquo;</li>
<li>Select the appropriate attribute (&ldquo;mail&rdquo; in my case) as the &ldquo;Data source attribute&rdquo;.</li>
</ol>
<p>Ensure that the &ldquo;Metaverse attribute&rdquo; is set to &ldquo;userPrincipalName&rdquo; and click &ldquo;Edit&rdquo; and then &ldquo;OK&rdquo; to save your changes.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/04/image19.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/04/image_thumb19.png" alt="image" width="754" height="529" border="0" /></a></p>
<p>Once you have completed a successful synchronisation, you will be able to log into the Office 365 portal using your email address as login attribute.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/04/image20.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/04/image_thumb20.png" alt="image" width="754" height="392" border="0" /></a></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/04/image21.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/04/image_thumb21.png" alt="image" width="754" height="420" border="0" /></a></p>
<p>I&rsquo;d like to conclude this post with the following.. just because something is possible, it doesn't mean it should be done. Unless you have a very specific requirements and/or constraints, I would recommend using UPN as your login attribute even if this means having to go through the process of changing all your user UPNs. In most environments this change will have little or no effect on other systems and may be the best approach.</p>
<p>For more information on Alternate Login ID, see:</p>
<ul>
<li><a href="http://technet.microsoft.com/en-us/library/dn659436.aspx" target="_blank">Configuring Alternate Login ID</a></li>
<li><a href="http://social.technet.microsoft.com/wiki/contents/articles/24096.using-alternate-login-ids-with-azure-active-directory.aspx" target="_blank">Using Alternate Login IDs with Azure Active Directory</a></li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Using AD FS &ldquo;Alternate Login ID&rdquo; with Office 365&p[summary]=As Office 365 adoption continues to grow and more organisations are starting to take advantage of identity federation. One of the most co...&p[url]=http://172.16.7.177:4000/2014/04/using-ad-fs-alternate-login-id-with-office-365" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2014/04/using-ad-fs-alternate-login-id-with-office-365&text=As Office 365 adoption continues to grow and more organisations are starting to take advantage of identity federation. One of the most co...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-04-24T16:29:55-05:00" itemprop="datePublished">24 Apr, 2014</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2014/04/azure-active-directory-sync-services-kicking-the-aadsync-tyres">Azure Active Directory Sync Services - Kicking the &ldquo;AADSync&rdquo; tyres</a></h2>
    </header>

    <div class="post-content">
        <p>Windows Azure Active Directory Sync (DirSync) has become synonymous with Office 365 in recent years and while DirSync isn&rsquo;t a requirement, I haven&rsquo;t seen any organisations consuming Office 365 services without it. In simple terms, DirSync can be used to synchronise local Active Directory objects to a Windows Azure Active Directory instance which is in turn leveraged by Office 365. After an initial synchronisation, DirSync runs on a schedule (typically, every three hours) to synchronise changes from the on-premises directory to the cloud instance.</p>
<p>The recent addition of password synchronisation to DirSync has made it even more useful and has been one of the many improvements to the tool (initially 32bit only!) which was released a few years ago. Unfortunately, DirSync still has some limitations especially when it comes to multi-forest scenarios. To help address the complexities associated with multi-forest&nbsp; environments, Microsoft recently announced Azure Active Directory Sync Services (AADSync) which is currently in preview. AADSync is intended to significantly simplify the configuration required to synchronise multi-forest&nbsp; environments.</p>
<p>I thought I&rsquo;d take AADSync for a test drive and see what it is all about. At this point I should also mention that it is currently a preview (CTP) release and is not supported in production environments. There preview also has a few limitations:</p>
<ul>
<li>AADSync preview can only use SQL Express LocalDB.</li>
<li>PasswordSync and password write-back are not currently supported.</li>
<li>Hybrid Exchange configuration is not currently supported.</li>
</ul>
<p>The pre-requisites are really simple, you will need the following installed on Windows Server 2008, 2008 R2, 2012 or 2012 R2:</p>
<ul>
<li>.NET 3.5 and .NET 4.5.
<li>PowerShell 3.0.</li>
</ul>
<p>The installer will automatically install the Microsoft Online Services Sign-In Assistant (msoidcli_64) which is really convenient as you can now be confident you will have the correct version installed.</p>
<p>As previously mentioned, this is a preview release and therefore the installation wizard is not yet strongly signed. It is therefore important that strong name signing is turned off on the server. The AADSync tool will NOT run if you do not perform this step, instead you will receive the following &ldquo;DirectorySyncTool has stopped working&rdquo; error with &ldquo;Problem Event Name: APPCRASH&rdquo;</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2014/04/image3.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2014/04/image_thumb3.png" width="514" height="421"></a></p>
<p>To turn off strong name signing, simply use the included &ldquo;sn.exe&rdquo; utility and issue the following command:</p>
<p>[shell]sn -Vr *[/shell]</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2014/04/image4.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2014/04/image_thumb4.png" width="729" height="373"></a></p>
<p>For more information about strong name signing and the sn.exe utility, see the following links:</p>
<ul>
<li><a href="http://msdn.microsoft.com/en-us/library/wd40t7ad(v=vs.110).aspx" target="_blank">Strong-Named Assemblies</a></li>
<li><a href="http://msdn.microsoft.com/en-us/library/k5b5tt23(v=vs.110).aspx" target="_blank">Sn.exe (Strong Name Tool)</a></li>
</ul>
<p>The installation process is pretty simple as one would expect, before starting the process it is helpful to have the following information to hand:</p>
<ul>
<li>Service account in AD (default read permissions will be sufficient)</li>
<li>An Azure Active Directory tenant (Office 365 for example)</li>
<li>Service account in your Azure AD (Global Administrator role required)</li>
</ul>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2014/04/image5.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2014/04/image_thumb5.png" width="679" height="473"></a></p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2014/04/image6.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2014/04/image_thumb6.png" width="679" height="474"></a></p>
<p>You will notice the option to add multiple forests. For more information about the multi-forest scenarios supported, see <a href="http://social.technet.microsoft.com/wiki/contents/articles/24061.aadsync-scenario-overview.aspx" target="_blank">AADSync Scenario Overview</a>. If you configure AADSync to join multiple forests, the default configuration will assume the following:</p>
<ul>
<li>A user will have only one enabled user account and login information is taken from this forest.</li>
<li>A user will have only one Exchange mailbox.</li>
<li>The data quality for a user is best in the forest where Exchange is located.</li>
<li>If an Exchange mailbox is found, common user attributes are taken from this forest.</li>
</ul>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2014/04/image7.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2014/04/image_thumb7.png" width="679" height="474"></a></p>
<p>You can configure join rules which map to the supported scenarios mentioned above. In a single forest scenario, the default selection will create all users as individual objects in Azure AD and objects will not join in the metaverse. You also have the option to select the immutable attribute. It is important to note that the attribute selected must not change during the lifetime of the object, even if the object is moved between domains in a forest or between forests. If you are unsure, you are probably better off not changing the default selection.</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2014/04/image8.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2014/04/image_thumb8.png" width="679" height="474"></a></p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2014/04/image9.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2014/04/image_thumb9.png" width="679" height="474"></a></p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2014/04/image10.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2014/04/image_thumb10.png" width="679" height="474"></a></p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2014/04/image11.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2014/04/image_thumb11.png" width="679" height="474"></a></p>
<p>Once completed, it successfully synchronised the 3000 accounts in my lab AD in about 25mins. The &ldquo;DirSyncConfigShell.psc1&rdquo; shell is not longer available and seems to have been replaced by &ldquo;DirectorySyncClientCmd.exe&rdquo;. I noticed a new PowerShell module which is great. </p>
<p>[powershell]Get-Command -Module PowerShellConfig[/powershell]</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2014/04/image12.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2014/04/image_thumb12.png" width="729" height="705"></a></p>
<p>[powershell]Get-SynchronizationRule | Select Name, Direction[/powershell]</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2014/04/image13.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2014/04/image_thumb13.png" width="729" height="258"></a></p>
<p>I also noticed a new &ldquo;Synchronization Rules Editor&rdquo;</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2014/04/image14.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2014/04/image_thumb14.png" width="754" height="442"></a></p>
<p>Many of these configuration options are probably best left at their defaults unless you have a specific requirement or scenario. I expect to see more documentation become available closer to or at release, but in the meantime you can find the <a href="http://social.technet.microsoft.com/wiki/contents/articles/tags/AADSync/default.aspx" target="_blank">current official documentation here.</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Azure Active Directory Sync Services - Kicking the &ldquo;AADSync&rdquo; tyres&p[summary]=Windows Azure Active Directory Sync (DirSync) has become synonymous with Office 365 in recent years and while DirSync isn&rsquo;t a requi...&p[url]=http://172.16.7.177:4000/2014/04/azure-active-directory-sync-services-kicking-the-aadsync-tyres" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2014/04/azure-active-directory-sync-services-kicking-the-aadsync-tyres&text=Windows Azure Active Directory Sync (DirSync) has become synonymous with Office 365 in recent years and while DirSync isn&rsquo;t a requi...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-04-09T04:47:48-05:00" itemprop="datePublished">9 Apr, 2014</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2014/04/lync-for-mac-2011-lync-was-unable-to-sign-in">Lync for Mac 2011 &ndash; &ldquo;Lync was unable to sign in..&rdquo;</a></h2>
    </header>

    <div class="post-content">
        <p><span style="color: #ff0000;">##Update##</span><br />
<span style="color: #ff0000;">Since writing the post, I have been able to obtain a copy of the hotfix described in <a href="http://support.microsoft.com/kb/2926055" target="_blank">KB2926055</a> and I can confirm that it does fix this issue.</span></p>
<p>I recently came across an interesting issue when attempting to log into Lync Online using Lync for Mac 2011. This was a newly installed an updated version of Lync for Mac 2011, version 14.0.7 (131205) to be exact. At first I thought I&rsquo;d made a typo with my password but after a couple of attempts I knew something else was wrong. I tried a couple of other Lync accounts and still kept receiving the &ldquo;Lync was unable to sign in. Please verify your logon credentials and try again. If the problem continues, please contact your support team.&rdquo; error message.</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2014/04/image.png"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="image" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2014/04/image_thumb.png" width="290" height="504" border="0" /></a></p>
<p>I tried using manual server configuration as suggested in the &ldquo;<a href="http://support.microsoft.com/kb/2629861" target="_blank">Troubleshoot sign in issues with Lync for Mac 2011 in Lync Online</a>&rdquo; article, but that didn&rsquo;t make any difference either. I then tried using a different Mac with Lync for Mac version 14.0.6 and that one was able to log in without any issues. After digging into the client logs, we saw the following entry:</p>
<p><em>04/08/2014|20:48:55.286 25A:B0115000 WARN&nbsp; :: GetNewWebTicket: "Got new web ticket already expired: Current time=1396954135, expire time=0"</em></p>
<p>It seems Lync for Mac 2011 tries to use a web ticket that is expired. After a bit of searching around, we found Article ID: 2927775 <a href="http://support.microsoft.com/kb/2927775" target="_blank">&ldquo;Can't sign in or see contact pictures in Lync for Mac 2011 when system time zone is set to UTC+8 or an earlier time zone&rdquo;</a> which exactly describes the issue which occurs because Lync for Mac 2011 calculates the expiration time of a web ticket based on an incorrect time zone.&nbsp; I was able to confirm this by changing my time zone settings which resulted in my client immediately being able to log in.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/04/image1.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="image" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2014/04/image_thumb1.png" width="651" height="562" border="0" /></a></p>
<p align="left">Once you have successfully logged in, you can change your time zone back to the correct configuration and you will still be able to log in. Unfortunately, this workaround does not persist across reboots or hibernations.</p>
<p align="left">Article ID: 2926055 <a href="http://support.microsoft.com/kb/2926055" target="_blank">&ldquo;Description of the Microsoft Lync for Mac 2011 14.0.7 hotfix&rdquo;</a> describes a hotfix that should resolve this issue, unfortunately you need to contact Microsoft Customer Support Services to obtain this hotfix and I haven&rsquo;t been able to obtain it yet. I have logged the appropriate service request and will update this post once I have tested it.</p>
<p align="left">With the correct DNS configuration, I haven&rsquo;t found the need to use manual server configuration as suggested in numerous support articles. I find that the default configuration works just fine.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/04/image2.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="image" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2014/04/image_thumb2.png" width="381" height="359" border="0" /></a></p>
<p align="left">I also wanted to thank for my colleague, Lync MCM Aidan Freeman for helping me troubleshoot this issue.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Lync for Mac 2011 &ndash; &ldquo;Lync was unable to sign in..&rdquo;&p[summary]=##Update##
Since writing the post, I have been able to obtain a copy of the hotfix described in KB2926055 and I can confirm that it does ...&p[url]=http://172.16.7.177:4000/2014/04/lync-for-mac-2011-lync-was-unable-to-sign-in" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2014/04/lync-for-mac-2011-lync-was-unable-to-sign-in&text=##Update##
Since writing the post, I have been able to obtain a copy of the hotfix described in KB2926055 and I can confirm that it does ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-02-10T07:55:44-06:00" itemprop="datePublished">10 Feb, 2014</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2014/02/how-to-find-office-365-support-phone-number">How to find Office 365 Support Phone Number</a></h2>
    </header>

    <div class="post-content">
        <p>Every now and then I have a need to contact Office 365 support in order to help a customer resolve a particular issue. Logging a support request is easily done via the &ldquo;Support&rdquo; menu in the Office 365 admin portal, however it usually takes me a while to find a a contact telephone number for Office 365 support. The support engineers always have phone numbers listed in their email signatures, however these are rarely local numbers.</p>
<p>Earlier today, I was once again in a position where I needed to call Office 365 support and since I had to call from my mobile phone, an international number just wasn&rsquo;t going to work. I finally found this link buried in some support documentation and thought I would post it here in order to help someone else out and spare myself the effort next time I need it.</p>
<p><a title="http://virtualchat.support.microsoft.com/client/default.aspx?siteid=32ECF580-B446-44E5-8B4D-25F0AFE07779&amp;scope=S&amp;query=Support%20phone%20number" href="http://virtualchat.support.microsoft.com/client/default.aspx?siteid=32ECF580-B446-44E5-8B4D-25F0AFE07779&amp;scope=S&amp;query=Support%20phone%20number" target="_blank">http://virtualchat.support.microsoft.com/client/default.aspx?siteid=32ECF580-B446-44E5-8B4D-25F0AFE07779&amp;scope=S&amp;query=Support%20phone%20number</a></p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2014/02/image.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="image" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2014/02/image_thumb.png" width="916" height="566" border="0" /></a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=How to find Office 365 Support Phone Number&p[summary]=Every now and then I have a need to contact Office 365 support in order to help a customer resolve a particular issue. Logging a support ...&p[url]=http://172.16.7.177:4000/2014/02/how-to-find-office-365-support-phone-number" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2014/02/how-to-find-office-365-support-phone-number&text=Every now and then I have a need to contact Office 365 support in order to help a customer resolve a particular issue. Logging a support ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-12-16T06:12:26-06:00" itemprop="datePublished">16 Dec, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/12/office-365-fast-track-network-analysis">Office 365 Fast Track Network Analysis</a></h2>
    </header>

    <div class="post-content">
        <p>Back in 2011 I posted about the <a href="http://www.cgoosen.com/2011/11/microsoft-online-services-internet-connection-performance-test/" target="_blank">Microsoft Online Services Internet Connection Performance Test</a> which was a tool that helped measure response times, bandwidth, and overall connection quality in preparation for consuming Microsoft Online services. The tool disappeared without warning after a while and was never replaced. A few months ago now it seems a new tool was made available, however I seem to have missed the announcement and only recently came across it. The Office 365 Fast Track Network Analysis tool is a similar web based tool that performs various connectivity tests and presents the results in a easy to read report. It looks very similar to the old speedtest.microsoftonline.com tool, but performs a few more tests:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2013/12/image.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2013/12/image_thumb.png" width="536" height="557"></a></p>
<p align="left">To access the tool, simply visit the URL appropriate to your region:</p>
<ul>
<li>For North America use: <a href="http://na1-fasttrack.cloudapp.net/">http://na1-fasttrack.cloudapp.net/</a>
<li>For Asia Pacific use: <a href="http://ap1-fasttrack.cloudapp.net">http://ap1-fasttrack.cloudapp.net</a>
<li>For Europe, Middle East and Africa use: <a href="http://em1-fasttrack.cloudapp.net/">http://em1-fasttrack.cloudapp.net/</a> </li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Office 365 Fast Track Network Analysis&p[summary]=Back in 2011 I posted about the Microsoft Online Services Internet Connection Performance Test which was a tool that helped measure respo...&p[url]=http://172.16.7.177:4000/2013/12/office-365-fast-track-network-analysis" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/12/office-365-fast-track-network-analysis&text=Back in 2011 I posted about the Microsoft Online Services Internet Connection Performance Test which was a tool that helped measure respo...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-11-08T08:18:06-06:00" itemprop="datePublished">8 Nov, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/11/migrate-legacy-public-folders-to-exchange-online-part-2">Migrate Legacy Public Folders to Exchange Online &ndash; Part 2</a></h2>
    </header>

    <div class="post-content">
        <p><a href="http://www.cgoosen.com/2013/10/migrate-legacy-public-folders-to-exchange-online-part-1/" target="_blank">In part 1 we</a> briefly looked at the architectural changes made to modern public folders in Exchange 2013 as well as some of the things to you may want to consider as you prepare to migrate you public folders to Exchange Online. In this post we will step through the actual migration process in detail.</p>
<p>Let&rsquo;s firstly take a look at the migration scripts. I typically place all these scripts in the same folder, c:\pfmigration for example. You should have the following scripts downloaded:</p>
<ul>
<li>Export-PublicFolderStatistics.ps1 - This script creates a .csv file that contains a folder name-to-folder size mapping.
<li>PublicFolderToMailboxMapGenerator.ps1 - This script uses the mapping file to create a public folder-to-mailbox mapping file which is also a .csv file.
<li>Export-MailPublicFoldersForMigration.ps1 - This script exports the mail-enabled public folder objects from the on-premises organization&rsquo;s Active Directory into a .xml file.
<li>Import-MailPublicFoldersForMigration.ps1 - This script imports the mail-enabled public folder objects into Exchange Online.</li>
</ul>
<p>Note: These scripts also have support files with a .psd1 extension, it is important that these support files are placed in the same folder.</p>
<p>Before starting the migration process, you should confirm that there are no existing public folder migration requests in Exchange Online. These would need to be removed before you can continue, but it is important to first understand why there are already there before removing them. You can easily see if there are any existing request by running the following cmdlet in Exchange Online:</p>
<blockquote><p>Get-PublicFolderMigrationRequest | Get-PublicFolderMigrationRequestStatistics -IncludeReport | Format-List</p>
</blockquote>
<p>The first step in the migration process is to ensure that mail-flow to mail-enabled public folders will continue to work. The steps required to do this will depend on your configuration. If you already have an Exchange Hybrid configured (as I do), you will most likely not need to do anything as the Hybrid Configuration Wizard will take care of this step.</p>
<p>Next it is time to start using the migration scripts. We start with the Export-PublicFolderStatistics.ps1 script to create our name-to-folder size mapping file. This script is run on the legacy public folder server:</p>
<blockquote><p>Export-PublicFolderStatistics.ps1&nbsp; <size_mapping_file_name> <legacy_server></p>
</blockquote>
<p>Once we have our size mapping file, we can run the PublicFolderToMailboxMapGenerator.ps1 script to create the public folder-to-mailbox mapping file which is used to calculate the correct number of public folder mailboxes that will be required in Exchange Online. This script is run on the legacy public folder server:</p>
<blockquote><p>PublicFolderToMailboxMapGenerator.ps1 <maximum_mailbox_size_in_bytes> <size_mapping_file_name> <mailbox_mapping_file_name></p>
</blockquote>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2013/11/image.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2013/11/image_thumb.png" width="1014" height="277"></a></p>
<p>Note: The <maximum_mailbox_size_in_bytes> parameter is used to size your public folder mailboxes in Exchange Online. In my example I have used 10 GB (or there about!) Public folders in Exchange Online can be a maximum of 50 GB, however I would recommend leaving enough room for growth. </p>
<p>I was having a discussion with a colleague of mine last week about public folder migration, more specifically how to selectively migrate only certain public folders. In the interest of full disclosure, I have not tested this (yet!), but in theory it should work. If you were to edit the size mapping file in Excel, you will notice that it contains two columns: &lsquo;FolderName&rsquo; and &lsquo;FolderSize&rsquo;. Remove all the entries for folders that you don&rsquo;t want to migrate before running the PublicFolderToMailboxMapGenerator.ps1 script and complete the rest of the process as documented. If you have tried this and have some feedback, let me know. I hope to be able to test it soon.</p>
<p>Moving on.. once we have our mapping files created, we should export our mail enabled public folders on our legacy public folder server:</p>
<blockquote><p>Export-MailPublicFoldersForMigration.ps1 <export_file_name></p>
</blockquote>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo3.png"><img title="pfeo3" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="pfeo3" src="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo3_thumb.png" width="1014" height="168"></a></p>
<p>Next, we can connect to Exchange Online and create our new public folder mailboxes. The first public folder mailbox that is created will be the primary hierarchy mailbox and it must be created in &lsquo;HoldForMigration mode&rsquo;. This public folder mailbox should also be excluded from the serving hierarchy so that the public folders won&rsquo;t be available to Exchange Online users.</p>
<blockquote><p>New-Mailbox -PublicFolder <mailbox_name> -HoldForMigration:$true -IsExcludedFromServingHierarchy:$true</p>
</blockquote>
<p>We should also import our mail enabled public folders:</p>
<blockquote><p>Import-MailPublicFoldersForMigration.ps1 <export_file_name></p>
</blockquote>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo4.png"><img title="pfeo4" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="pfeo4" src="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo4_thumb.png" width="1014" height="231"></a></p>
<p>We are now ready to submit the migration request, but before we do, let&rsquo;s gather all the required information for the New-PublicFolderMigrationRequest cmdlet:</p>
<p>First we need our Outlook Anywhere hostname and authentication method:</p>
<blockquote><p>Get-OutlookAnywhere | Format-List Identity, ExternalHostName, IISAuthenticationMethods</p>
</blockquote>
<p>We also need the LegacyExchangeDN of the administrator mailbox:</p>
<blockquote><p>Get-Mailbox <user> | Format-Table LegacyExchangeDN</p>
</blockquote>
<p>Lastly, we need the ExchangeLegacyDN of the legacy public folder server:</p>
<blockquote><p>Get-ExchangeServer &ndash;Identity <server> | Format-Table ExchangeLegacyDN</p>
</blockquote>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2013/11/Capture.png"><img title="Capture" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="Capture" src="http://www.cgoosen.com/wp-content/uploads/2013/11/Capture_thumb.png" width="1014" height="341"></a></p>
<p>Given the length of the cmdlet and parameters, I recommend using variables. Using the information we have gathered, we can easily do this:</p>
<blockquote><p>$OAHostname = <ExternalHostName_value></p>
<p>$Csv = Get-Content c:\PFMigration\pf2mbx.csv -Encoding Byte</p>
<p>$OnPremCred = Get-Credential</p>
<p>$Rmldn = <LegacyExchangeDN_value></p>
<p>$Rpfsldn = <ExchangeLegacyDN_value></p>
</blockquote>
<p>We can then run the New-PublicFolderMigrationRequest cmdlet using these variables. You&rsquo;ll know that the command started successfully when the migration request reaches a status of &lsquo;Queued&rsquo; or &lsquo;InProgress&rsquo;:</p>
<blockquote><p>New-PublicFolderMigrationRequest -OutlookAnywhereHostName $OAHostName -CSVData $Csv -RemoteCredential $OnPremCred -RemoteMailboxLegacyDN $Rmldn -RemoteMailboxServerLegacyDN $Rpfsldn -AuthenticationMethod <Basic/NTLM></p>
</blockquote>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2013/11/image1.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2013/11/image_thumb1.png" width="1014" height="341"></a></p>
<p>Once the migration request kicks off it will copy the public folder data and will continue running until it reaches 95% at which point it will auto suspend the request. We can monitor the progress using the Get-PublicFolderMigrationRequest and Get-PublicFolderMigrationRequestStatistics cmdlets:</p>
<blockquote><p>Get-PublicFolderMigrationRequest | Get-PublicFolderMigrationRequestStatistics -IncludeReport | Format-List Status, SourceServer, SourceVersion, BytesTransferred, ItemsTransferred, PercentComplete, Message</p>
</blockquote>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo7.png"><img title="pfeo7" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="pfeo7" src="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo7_thumb.png" width="1014" height="294"></a></p>
<p>In order to complete the migration request, we need to arrange downtime or a service outage as there will be period while the last bit of data is transferred where public folders will be unavailable to end users. The amount of downtime depends on how much new content has been generated since the migration was suspended. In large environments with a lot of changing content, I would recommend running the Resume-PublicFolderMigrationRequest cmdlet. This cmdlet can be run as often as required and will merely copy any new content and auto suspend at 95%, this will reduce the amount of downtime required.</p>
<p>Once we have scheduled a service outage and informed out end users, we need to lock the legacy public folder environment in order to prevent any further changes:</p>
<blockquote><p>Set-OrganizationConfig &ndash;PublicFoldersLockedForMigration $true</p>
</blockquote>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo8.png"><img title="pfeo8" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="pfeo8" src="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo8_thumb.png" width="1014" height="256"></a></p>
<p>Next we need to allow the migration request to complete, we do this by removing &lsquo;PreventCompletion&rsquo;:</p>
<blockquote><p>Get-PublicFolderMigrationRequest | Set-PublicFolderMigrationRequest -PreventCompletion $false</p>
</blockquote>
<p>We can now resume the migration request and this time it will run through to completion and not auto suspend at 95%:</p>
<blockquote><p>Get-PublicFolderMigrationRequest | Resume-PublicFolderMigrationRequest</p>
</blockquote>
<p>We monitor the request as before to verify that it has completed successfully:</p>
<blockquote><p>Get-PublicFolderMigrationRequest | Get-PublicFolderMigrationRequestStatistics -IncludeReport | Format-List Status, SourceServer, SourceVersion, BytesTransferred, ItemsTransferred, PercentComplete, Message</p>
</blockquote>
<p>Once we are happy that the migration has completed successfully, we allow the hierarchy to be served:</p>
<blockquote><p>Get-Mailbox -PublicFolder | Set-Mailbox -PublicFolder -IsExcludedFromServingHierarchy $false</p>
</blockquote>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo10.png"><img title="pfeo10" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="pfeo10" src="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo10_thumb.png" width="1014" height="295"></a></p>
<p>The final set in the process is to set the migration as complete in the legacy environment:</p>
<blockquote><p>Set-OrganizationConfig -PublicFolderMigrationComplete $true</p>
</blockquote>
<p>It is possible to roll back the migration, however I would like to mention a few really important points about rolling back:</p>
<ul>
<li>The roll back process will not copy any changed data back to the legacy environment, this should be considered when deciding to roll back. It would be a really bad idea to try and roll back a change heavy environment after 3 weeks.</li>
<li>Roll back will obviously require the original public folder databases to be online, I therefore recommend dismounting these for a period of time after the migration just in case you need them. This process is a lot more difficult if you delete the databases and then try and roll back.</li>
</ul>
<p>For more information on the migration process, see the following article on TechNet:</p>
<ul>
<li><a href="http://technet.microsoft.com/en-us/library/jj983799(v=exchg.150).aspx" target="_blank">Migrate Legacy Public Folders to Exchange Online</a></li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Migrate Legacy Public Folders to Exchange Online &ndash; Part 2&p[summary]=In part 1 we briefly looked at the architectural changes made to modern public folders in Exchange 2013 as well as some of the things to ...&p[url]=http://172.16.7.177:4000/2013/11/migrate-legacy-public-folders-to-exchange-online-part-2" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/11/migrate-legacy-public-folders-to-exchange-online-part-2&text=In part 1 we briefly looked at the architectural changes made to modern public folders in Exchange 2013 as well as some of the things to ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-10-30T09:02:59-05:00" itemprop="datePublished">30 Oct, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/10/migrate-legacy-public-folders-to-exchange-online-part-1">Migrate Legacy Public Folders to Exchange Online &ndash; Part 1</a></h2>
    </header>

    <div class="post-content">
        <p>I&rsquo;ve been meaning to get this series published for some time now. I can&rsquo;t believe it is almost 2 months since TechEd Australia 2013! <a href="http://cgoo.se/18TNT8Y" target="_blank">During my session</a>, I briefly covered modern public folders and how to migrate them to Exchange Online. My aim is to build on that session with a couple of posts that run through the entire process of migrating legacy public folders to Exchange Online. This first post will provide an overview of modern public folder architecture as well as some of the planning and preparation required prior to the migration.</p>
<p>I&rsquo;m sure by now everyone is aware that in Exchange 2013 public folders were re-engineered using mailbox infrastructure to take advantage of the existing high availability and storage technologies of the mailbox database. Public folder architecture uses specially designed mailboxes to store both the public folder hierarchy and content. This also means that there is no longer a public folder database and high availability for the public folder mailboxes is provided by a DAG. Let&rsquo;s briefly look at the new architecture:</p>
<p>The main component of public folders are the public folder mailboxes, which can reside in one or more mailbox databases. Public folder mailboxes can be either &lsquo;Primary&rsquo; or &lsquo;Secondary&rsquo;. The primary hierarchy mailbox is the 1 writable copy of the public folder hierarchy. The public folder hierarchy is copied to all other public folder mailboxes, but these secondary copies are read-only copies. The public folder hierarchy contains the folders&rsquo; properties, organizational information and tree structure. Public folder content can include email messages, posts, documents, and eForms. The content is stored in the public folder mailbox but isn&rsquo;t replicated across multiple public folders mailboxes. All users access the same public folder mailbox for the same set of content. </p>
<p>&nbsp;</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2013/10/image.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; border-top-width: 0px; margin-right: auto" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2013/10/image_thumb.png" width="690" height="483"></a></p>
<p>Because there is only 1 writable copy of the hierarchy, it is necessary to synchronize changes to other mailboxes when they are made. Hierarchy synchronization takes place as follows (as illustrated in the diagram above):</p>
<ol>
<li>Let&rsquo;s say for example a client connects to a secondary public folder mailbox to access content (Folder 5) and
<li>Then that client creates a new public folder (Folder 6 in the example)
<li>The request will be proxied to the primary public folder mailbox where it is written to public folder hierarchy
<li>Public folder hierarchy synchronisation is triggered immediately to content mailbox
<li>The public folder hierarchy is updated on all public folder mailboxes. This takes place after 15 mins for mailboxes with connected users and after 24 hrs for mailboxes with no connected users.</li>
</ol>
<p>In order to move legacy public folders to Exchange Online, you need at least Exchange 2007 SP3 RU1 or Exchange 2010 SP3 and there are a few other considerations you may want to take note of:</p>
<ul>
<li>There is no coexistence between legacy and modern public folders, the migration is a all at once &lsquo;cutover&rsquo; migration</li>
<li>All mailboxes must be on Exchange 2013 and/or Exchange Online prior to migration</li>
<li>Migrations are PowerShell based using scripts, there is no migration wizard or GUI</li>
<li>While a Exchange Hybrid Deployment is not required, it does make things easier as you do not have to manually configure message routing for mail-enabled public folders</li>
<li>Public folders are migrated using Outlook Anywhere, therefore Outlook Anywhere must be published to the internet and enabled on all legacy public folder servers</li>
<li>EWS clients such as Entourage 2008 EWS Edition and Outlook for Mac 2011 with mailboxes on Exchange 2013 will not be able to access legacy public folders</li>
<li>Public folders that include a Backslash (&ldquo;\&rdquo;) in their names are not supported</li>
</ul>
<p>You should also ensure that you have the correct permissions:</p>
<ul>
<li>In Exchange Online, you need to be a member of the &lsquo;Organization Management&rsquo; role group</li>
<li>In Exchange 2010, you need to be a member of the &lsquo;Organization Management&rsquo; or &lsquo;Server Management&rsquo; RBAC role groups.</li>
<li>In Exchange 2007, you need to be assigned the &lsquo;Exchange Organization Administrator&rsquo; role or the &lsquo;Exchange Server Administrator&lsquo; role. You should also be assigned the &lsquo;Public Folder Administrator&rsquo; role and local Administrators group for the target server.</li>
</ul>
<p>As previously mentioned, the migration is done via PowerShell. There are a few scripts that should be downloaded, these will be used during the various stages of the migration. Be sure to download the following:</p>
<ul>
<li><a href="http://www.microsoft.com/en-us/download/details.aspx?id=38407" target="_blank">Microsoft Exchange 2013 Public Folders Migration Scripts</a></li>
<li><a href="http://www.microsoft.com/en-us/download/details.aspx?id=38408" target="_blank">Microsoft Exchange 2013 Public Folders Directory Sync Support Scripts</a></li>
</ul>
<p>Finally, when preparing for a public folder migration to Exchange Online, I would highly recommend that public folders are first analyzed and classified. It is not uncommon to see public folder structures that were implemented in the early days of Exchange more than 10 years ago and are now no more than a dumping ground for old data. Often these hierarchies where designed to match an organization structure or meet business requirements that no longer exist. Exchange has come a long way since then and by taking a good look at your public folder use cases, you may find that there are better and more efficient ways to do things today.</p>
<p>In part 2 we&rsquo;ll will run through the migration process.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Migrate Legacy Public Folders to Exchange Online &ndash; Part 1&p[summary]=I&rsquo;ve been meaning to get this series published for some time now. I can&rsquo;t believe it is almost 2 months since TechEd Australi...&p[url]=http://172.16.7.177:4000/2013/10/migrate-legacy-public-folders-to-exchange-online-part-1" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/10/migrate-legacy-public-folders-to-exchange-online-part-1&text=I&rsquo;ve been meaning to get this series published for some time now. I can&rsquo;t believe it is almost 2 months since TechEd Australi...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-09-11T16:13:14-05:00" itemprop="datePublished">11 Sep, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/09/my-session-at-teched-australia-2013">My Session at TechEd Australia 2013</a></h2>
    </header>

    <div class="post-content">
        <p>In case you missed my session at TechEd Australia last week the session recording and slide deck is available on <a href="http://cgoo.se/18TNT8Y" target="_blank">Channel 9</a> or by clicking here: <a title="http://cgoo.se/18TNT8Y" href="http://cgoo.se/18TNT8Y">http://cgoo.se/18TNT8Y</a></p>
<p>I&rsquo;m currently working a series of posts about Public Folder migration to Exchange Online. I touched on it during the session, but will be publishing more details in the series so look out for it soon.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=My Session at TechEd Australia 2013&p[summary]=In case you missed my session at TechEd Australia last week the session recording and slide deck is available on Channel 9 or by clicking...&p[url]=http://172.16.7.177:4000/2013/09/my-session-at-teched-australia-2013" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/09/my-session-at-teched-australia-2013&text=In case you missed my session at TechEd Australia last week the session recording and slide deck is available on Channel 9 or by clicking...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-01-22T03:43:36-06:00" itemprop="datePublished">22 Jan, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/01/lync-online-2013-remote-powershell">Lync Online 2013 Remote PowerShell</a></h2>
    </header>

    <div class="post-content">
        <p>As we are all aware, the <a href="http://www.microsoft.com/office/preview/en/office-365-enterprise" target="_blank">next wave of Office 365 is currently in preview</a> and will be available soon. One of the expected (and long awaited) new features is the ability to administer Lync Online via PowerShell, this is something that is lacking in the current release. I was recently working with a customer who are preparing for to transition several thousand users to Lync Online and this got me curious about remote PowerShell and Lync Online 2013. Since there is no documentation available yet for the upcoming release, I thought I would share my initial findings.</p>
<p>Before I go any further I should mention that at the time of writing this I am testing with a Office 365 Preview tenant and as with all things still in development, it is possible (likely even) the the final release will behave differently. I also want the mention that remote PowerShell does not work with Lync Online on an Office 365 Preview tenant (see details below) so I am sharing this information purely for those who might be interested in how it may or could work in future &ndash; I will of course update this post once the next wave of Office 365 has been released.</p>
<p>My discovery came after I installed the Lync 2013 administrative tools on my laptop, I was browsing around the modules folder when I noticed it had installed a module called &ldquo;LyncOnlineConnector&rdquo; which is not imported by default.</p>
<p>&nbsp;</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2013/01/2013-01-21-17_00_06-Modules.png"><img title="2013-01-21 17_00_06-Modules" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="2013-01-21 17_00_06-Modules" src="http://www.cgoosen.com/wp-content/uploads/2013/01/2013-01-21-17_00_06-Modules_thumb.png" width="1025" height="251"></a></p>
<p>&nbsp;</p>
<p>So as any curious geek would, I thought I would play around a little.. I imported the module and took a look at the cmdlets available.</p>
<p>&nbsp;</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2013/01/2013-01-21-17_02_46-Modules.png"><img title="2013-01-21 17_02_46-Modules" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="2013-01-21 17_02_46-Modules" src="http://www.cgoosen.com/wp-content/uploads/2013/01/2013-01-21-17_02_46-Modules_thumb.png" width="1098" height="378"></a></p>
<p>&nbsp;</p>
<p>Once imported, the &ldquo;LyncOnlineConnector&rdquo; module contains a &ldquo;New-CsOnlineSession&rdquo; cmdlet which according to the help file is used to set up a remote session to Lync Online.</p>
<p>&nbsp;</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2013/01/2013-01-21-17_03_55-Windows-PowerShell.png"><img title="2013-01-21 17_03_55-Windows PowerShell" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="2013-01-21 17_03_55-Windows PowerShell" src="http://www.cgoosen.com/wp-content/uploads/2013/01/2013-01-21-17_03_55-Windows-PowerShell_thumb.png" width="1097" height="405"></a></p>
<p align="center">&nbsp;</p>
<p align="left">If you attempt to run the cmdlet, you receive the following error: "Remote Windows PowerShell session creation is restricted by tenant Windows PowerShell policy". This leads me to believe that remote PowerShell is currently restricted on Office 365 Preview tenants. </p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Lync Online 2013 Remote PowerShell&p[summary]=As we are all aware, the next wave of Office 365 is currently in preview and will be available soon. One of the expected (and long awaite...&p[url]=http://172.16.7.177:4000/2013/01/lync-online-2013-remote-powershell" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/01/lync-online-2013-remote-powershell&text=As we are all aware, the next wave of Office 365 is currently in preview and will be available soon. One of the expected (and long awaite...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-01-15T03:26:53-06:00" itemprop="datePublished">15 Jan, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/01/how-to-check-your-office-365-tenant-version">How to check your Office 365 tenant version?</a></h2>
    </header>

    <div class="post-content">
        <p>Ever wondered what version of Exchange your tenant is provisioned on? <a href="http://michaelvh.wordpress.com/" target="_blank">Michael Van Horenbeeck</a> has written quick post on how to determine this. I think this will be really handy in the near future so I wanted to share it. </p>
<p>You can check the version by issuing the following cmd via powershell:</p>
<blockquote><p>Get-OrganizationConfig | ft AdminDisplayVersion,IsUpgradingOrganization</p>
</blockquote>
<p>Michael has some great information in his post that <a href="http://michaelvh.wordpress.com/2013/01/13/how-to-check-what-the-version-of-your-tenant-is-in-the-cloud-office-365/" target="_blank">can be found here</a> so be sure to check it out.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=How to check your Office 365 tenant version?&p[summary]=Ever wondered what version of Exchange your tenant is provisioned on? Michael Van Horenbeeck has written quick post on how to determine t...&p[url]=http://172.16.7.177:4000/2013/01/how-to-check-your-office-365-tenant-version" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/01/how-to-check-your-office-365-tenant-version&text=Ever wondered what version of Exchange your tenant is provisioned on? Michael Van Horenbeeck has written quick post on how to determine t...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2012-11-05T12:49:59-06:00" itemprop="datePublished">5 Nov, 2012</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2012/11/microsoft-lync-basic-2013">Microsoft Lync Basic 2013</a></h2>
    </header>

    <div class="post-content">
        <h6><font size="3">Microsoft recently released Lync Basic 2013, a slimmer version of the Lync client that provides all the basic functionality available in the full version of Lync 2013. Some of the notable missing features in the basic client are advanced call features such as team ring, call forwarding, simultaneous ring, voice mail, call park, call delegation, response groups, and remote call control.</font></h6>
<p>As usual for all things Lync related, my friend Greig Sheridan has a <a href="https://greiginsydney.com/a-free-basic-client-for-lync-2013/" target="_blank">full write-up on his blog</a>.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Microsoft Lync Basic 2013&p[summary]=Microsoft recently released Lync Basic 2013, a slimmer version of the Lync client that provides all the basic functionality available in ...&p[url]=http://172.16.7.177:4000/2012/11/microsoft-lync-basic-2013" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2012/11/microsoft-lync-basic-2013&text=Microsoft recently released Lync Basic 2013, a slimmer version of the Lync client that provides all the basic functionality available in ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2012-10-16T06:15:02-05:00" itemprop="datePublished">16 Oct, 2012</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2012/10/controlling-activesync-device-access-on-exchange-2010-and-exchange-online">Controlling ActiveSync device access on Exchange 2010 and Exchange Online</a></h2>
    </header>

    <div class="post-content">
        <p>I am often surprised by how few customers know about or use ActiveSync device access rules (or ABQ for short) in Exchange 2010 when everyone seems to have the requirement to some degree or another. I see a growing trend to use third party products to do what Exchange can and has been able to do natively for a while now so I thought I would put together this post to go through some of the functionality offered by ABQ.</p>
<p>Before I continue, I would like to highlight the following two things:</p>
<ol>
<li>Device access rules (ABQ) should not be confused with or is not intended to replace ActiveSync policies which are used to enforce things like device passwords, device encryption, etc. (click <a href="http://technet.microsoft.com/en-us/library/bb123484.aspx" target="_blank">here for more on ActiveSync policies</a>)</li>
<li>Everything described in this post also applies to Exchange Online</li>
</ol>
<p>Depending on your requirements, you may decide to take a restrictive approach where you only allow a small set of tested and supported devices or be more permissive and only block/quarantine problematic devices. For this post, I will create a device policy to quarantine any iPad devices. The use case for this scenario is that an organisation may for example allow users to choose whatever mobile phone they would like to use but block the use of iPads because these are not devices issued by the company. By quarantining a device, we can easily see who is attempting to use such a device, how many are out there and even decide to create a new policy specific to these devices.</p>
<p>During the connection process, Exchange will follow a logical set of rules to determine the access state of each device and will either allow, block or quarantine the device based on the outcome. The sequence of challenges includes the following steps:</p>
<ol>
<li>Is the device authenticated? If not, challenge for the correct credentials. Otherwise, go on to the next step.</li>
<li>Is Exchange ActiveSync enabled for the current user? If not, return an "access restricted" error to the device. Otherwise, go on to the next step.</li>
<li>Are the policy enforcement criteria met by the current mobile device? If not, block access. Otherwise, go on to the next step.</li>
<li>Is this device blocked by a personal exemption for the user? If so, block access. Otherwise, go on to the next step.</li>
<li>Is this device allowed by a personal exemption for the user? If so, grant full access. Otherwise, go on to the next step.</li>
<li>Is this device blocked by a device access rule? If so, block access. Otherwise, go on to the next step.</li>
<li>Is this device quarantined by a device access rule? If so, quarantine the device. Otherwise, go on to the next step.</li>
<li>Is this device allowed by a device access rule? If so, grant full access. Otherwise, go on to the next step.</li>
<li>Apply the default access state per the Exchange ActiveSync organisational settings.</li>
</ol>
<p>The device policy that I am going to create will be applied at Step 7. To create a device policy, we need to access the &ldquo;ActiveSync Access&rdquo; options under &ldquo;Phone &amp; Voice&rdquo; settings in the ECP. It should look something like this:</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2012/10/blog2.png"><img title="blog2" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="blog2" src="http://www.cgoosen.com/wp-content/uploads/2012/10/blog2_thumb.png" width="606" height="247"></a></p>
<p>Clicking the &ldquo;Edit&rdquo; button will allow you to edit various settings. As you can see, I have decided to be permissive and allow all devices unless they are managed by a rule. You can select a distribution group or administrative account that will receive quarantine notification emails. You also have the option to add any custom or organisation specific text that will be included in the email notification sent to users when their device is blocked or quarantined. </p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2012/10/blog1.png"><img title="blog1" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="blog1" src="http://www.cgoosen.com/wp-content/uploads/2012/10/blog1_thumb.png" width="458" height="487"></a></p>
<p>We then click &ldquo;New&rdquo; under &ldquo;Device Access Rules&rdquo; at the bottom of the page to define our new rule. Here we can browse a list of all the devices and device families that have recently connected to our Exchange environment. Device family is a grouping of similar devices, in our case for example if we choose a Device family of &ldquo;iPad&rdquo; we can then decide to only apply this rule to iPad2 models or &ldquo;All models&rdquo; by selecting the appropriate device type. Lastly, we select our ABQ action.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2012/10/blog3.png"><img title="blog3" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="blog3" src="http://www.cgoosen.com/wp-content/uploads/2012/10/blog3_thumb.png" width="464" height="520"></a></p>
<p align="left">Once we have clicked &ldquo;Save&rdquo; we should see the new device access rule listed under &ldquo;Device Access Rules&rdquo;</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2012/10/blog4.png"><img title="blog4" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="blog4" src="http://www.cgoosen.com/wp-content/uploads/2012/10/blog4_thumb.png" width="874" height="121"></a></p>
<p>Once we have created the access rule, if any users attempt to connect using an iPad, they will be listed under &ldquo;Quarantines Devices&rdquo;</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2012/10/blog5.png"><img title="blog5" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="blog5" src="http://www.cgoosen.com/wp-content/uploads/2012/10/blog5_thumb.png" width="690" height="119"></a></p>
<p>Users will receive a notification email similar to the following if they try to connect using an iPad. Note the custom text entered previously (red box)</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2012/10/blog6.png"><img title="blog6" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="blog6" src="http://www.cgoosen.com/wp-content/uploads/2012/10/blog6_thumb.png" width="517" height="492"></a></p>
<p align="left">One last thing to mention is that you do have the ability to make a personal exception for a specific user if needed, so for example if you have an executive who is adamant about wanting to use his/her iPad of if you decide after some time to test iPads this can be done without affecting anyone else. As always, full documentation can be found on <a href="http://technet.microsoft.com/en-us/library/ff959225.aspx" target="_blank">TechNet</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Controlling ActiveSync device access on Exchange 2010 and Exchange Online&p[summary]=I am often surprised by how few customers know about or use ActiveSync device access rules (or ABQ for short) in Exchange 2010 when every...&p[url]=http://172.16.7.177:4000/2012/10/controlling-activesync-device-access-on-exchange-2010-and-exchange-online" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2012/10/controlling-activesync-device-access-on-exchange-2010-and-exchange-online&text=I am often surprised by how few customers know about or use ActiveSync device access rules (or ABQ for short) in Exchange 2010 when every...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2012-10-12T04:56:41-05:00" itemprop="datePublished">12 Oct, 2012</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2012/10/exchange-2013-is-rtm">Exchange 2013 is RTM!</a></h2>
    </header>

    <div class="post-content">
        <p>Earlier today Exchange 2013 reached RTM status. This is a very exciting announcement and means that coding and testing is now complete. General availability is planned for the first quarter of 2013. In addition to Exchange, the new Office, SharePoint, and Lync have also reached <acronym>RTM</acronym>. For more information on the announcement, <a href="http://blogs.office.com/b/office-news/" target="_blank">click here.</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2013 is RTM!&p[summary]=Earlier today Exchange 2013 reached RTM status. This is a very exciting announcement and means that coding and testing is now complete. G...&p[url]=http://172.16.7.177:4000/2012/10/exchange-2013-is-rtm" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2012/10/exchange-2013-is-rtm&text=Earlier today Exchange 2013 reached RTM status. This is a very exciting announcement and means that coding and testing is now complete. G...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2012-06-22T09:51:37-05:00" itemprop="datePublished">22 Jun, 2012</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2012/06/exchange-hybrid-multi-namespace-autodiscover-configuration">Exchange Hybrid Multi-namespace Autodiscover Configuration</a></h2>
    </header>

    <div class="post-content">
        <p>I came across an interesting issue when using the Exchange Hybrid Configuration Wizard in a multi-namespace environment recently. Autodiscover was configured and working correctly for Outlook and EAS clients but the wizard would not complete successfully and would generate the following error: &ldquo;Federation information could not be received from the external organization&hellip;&rdquo; as seen below:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2012/06/autodiscover.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="autodiscover" src="http://www.cgoosen.com/wp-content/uploads/2012/06/autodiscover_thumb.png" alt="autodiscover" width="568" height="495" border="0" /></a></p>
<p>After some investigation, I discovered that this problem was related to Autodiscover. Typically in an on-premises Exchange 2010 deployment, there are a number of different ways to configure Autodiscover when using multiple namespaces. These are:</p>
<p><strong><span style="text-decoration: underline;">Option 1 - Single SSL Certificate that is valid for all DNS names (SAN Certificate)</span></strong><br />
<strong>Pros:</strong></p>
<ul>
<li>Requires only one certificate.</li>
<li>Requires only 1 public IP.</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>Cost of additional DNS names in the SAN certificate could be expensive.</li>
</ul>
<p><strong><span style="text-decoration: underline;">Option 2 - Single-name SSL Certificate with DNS SRV Lookup</span></strong><br />
<strong>Pros:</strong></p>
<ul>
<li>Requires only 1 public IP.</li>
<li>Requires 1 single-name SSL certificate.</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>Not all DNS hosting providers support DNS SRV records.</li>
<li>Outlook users may be prompted.</li>
<li>Outlook 2007 required client-side hotfix.</li>
</ul>
<p><strong><span style="text-decoration: underline;">Option 3 - Single-name SSL Certificate with HTTP redirect</span></strong><br />
<strong>Pros:</strong></p>
<ul>
<li>Requires 1 single-name SSL certificate.</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>Requires 2 public IPs</li>
<li>Requires a second IIS site or ISA/TMG</li>
</ul>
<p>While these will all work and have their pros and cons, I would usually always use &lsquo;option 1&rsquo; listed above unless there is a good reason not to. In this particular instance, the Autodiscover was configured using &lsquo;option 3&rsquo; and even though Autodiscover worked fine for clients, the Hybrid Configuration Wizard did not seem to like this configuration.</p>
<p>The Office 365 documentation does not go into a great amount of detail about multi-domain Autodiscover configuration and says: &ldquo;Configure the Autodiscover public DNS records for your existing SMTP domains to point to an on-premises Exchange 2010 SP2 Client Access server&rdquo; which is technically what had been done. The reason this caused a problem is because unlike Outlook or EAS clients, Office 365 does not use the Autodiscover discovery process and instead makes a direct connection to <strong>https://autodiscover.domain.com/autodiscover/autodiscover.svc/wssecurity </strong>for each domain being used and does not obey the web redirect that had previously been configured.</p>
<p>In order to solve this problem, we purchased a new SAN certificate and reconfigured Autodiscover as described in &lsquo;option 1&rsquo;. In short, this is the only way to configure Autodiscover if you plan to implement an Exchange Hybrid Deployment. Additionally, if you are not using split DNS and have an internal DNS zone that is different to your external DNS (eg. domain.local), you need to ensure that the relevant external Autodiscover records are resolvable internally as well.</p>
<p>As a side note, if you are using ISA/TMG to publish EWS/Autodiscover, you need to create a separate rule without authentication delegation for the following paths:</p>
<ul>
<li>/ews/mrsproxy.svc</li>
<li>/ews/exchange.asmx/wssecurity</li>
<li>/autodiscover/autodiscover.svc/wssecurity</li>
<li>/autodiscover/autodiscover.svc</li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange Hybrid Multi-namespace Autodiscover Configuration&p[summary]=I came across an interesting issue when using the Exchange Hybrid Configuration Wizard in a multi-namespace environment recently. Autodis...&p[url]=http://172.16.7.177:4000/2012/06/exchange-hybrid-multi-namespace-autodiscover-configuration" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2012/06/exchange-hybrid-multi-namespace-autodiscover-configuration&text=I came across an interesting issue when using the Exchange Hybrid Configuration Wizard in a multi-namespace environment recently. Autodis...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2012-05-04T08:03:32-05:00" itemprop="datePublished">4 May, 2012</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2012/05/remote-move-request-exception-has-been-thrown-by-the-target-of-invocation">Remote Move Request: Exception has been thrown by the target of invocation</a></h2>
    </header>

    <div class="post-content">
        <p>If you have a Exchange Hybrid deployment configured and attempt to create a new remote move request you may receive an &rdquo;Exception has been thrown by the target of invocation&rdquo; error similar to the one below.</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2012/05/cap.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="cap" border="0" alt="cap" src="http://www.cgoosen.com/wp-content/uploads/2012/05/cap_thumb.png" width="498" height="434" /></a></p>
<p>Here are a few things you can check in order to help troubleshoot this error:</p>
<ul>
<li>Have you enabled MRSProxy? </li>
<li>Have you correctly set the EWS &ldquo;External URL&rdquo; (WebServicesVirtualDirectory)? </li>
<li>Do you have a certificate installed that contains the DNS name used in the&#160; EWS &ldquo;External URL&rdquo;? </li>
<li>Are you entering the correct FQDN in the MRSProxy field of the new remote move request wizard? </li>
<li>Are you using TMG/ISA to publish EWS? If so, ensure that you are not using authentication delegation on the following paths:
<ul>
<li>/ews/mrsproxy.svc </li>
<li>/ews/exchange.asmx/wssecurity </li>
<li>/autodiscover/autodiscover.svc/wssecurity </li>
<li>/autodiscover/autodiscover.svc </li>
</ul>
</li>
<li>Are you seeing &ldquo;405&rdquo; errors in the IIS log on the Exchange Hybrid server? If so, <a href="http://support.microsoft.com/kb/2626696" target="_blank">see KB2626696</a> </li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Remote Move Request: Exception has been thrown by the target of invocation&p[summary]=If you have a Exchange Hybrid deployment configured and attempt to create a new remote move request you may receive an &rdquo;Exception h...&p[url]=http://172.16.7.177:4000/2012/05/remote-move-request-exception-has-been-thrown-by-the-target-of-invocation" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2012/05/remote-move-request-exception-has-been-thrown-by-the-target-of-invocation&text=If you have a Exchange Hybrid deployment configured and attempt to create a new remote move request you may receive an &rdquo;Exception h...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2012-03-27T16:15:19-05:00" itemprop="datePublished">27 Mar, 2012</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2012/03/updating-hybrid-configuration-failed-with-error-subtask-checkprereqs-execution-failed">Updating hybrid configuration failed with error 'Subtask CheckPrereqs execution failed</a></h2>
    </header>

    <div class="post-content">
        <p>I came across this error recently while running the Hybrid Configuration Wizard on Exchange 2010 SP2. It caught me out a little and as it turns out the fix is quite simple. It seems the wizard does not recognise certificates that begin with anything other than &ldquo;CN=&rdquo;. In my particular case I was being tripped up by a certificate beginning with &ldquo;E=&rdquo;. What made this even more confusing was that the certificate causing the problem was installed, but completely unrelated and not actually the one I was using to configure my Hybrid Exchange environment.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2012/03/Capture.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="Capture" border="0" alt="Capture" src="http://www.cgoosen.com/wp-content/uploads/2012/03/Capture_thumb.png" width="529" height="463" /></a></p>
<p>It seems this is a known bug and was fixed in Update Rollup 1 for Exchange Server 2010 Service Pack 2. I can confirm that after installing the update, it all worked as expected.</p>
<p>For more info and to download <a href="http://support.microsoft.com/kb/2645995" target="_blank">Update Rollup 1 for Exchange Server 2010 Service Pack 2, click here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Updating hybrid configuration failed with error 'Subtask CheckPrereqs execution failed&p[summary]=I came across this error recently while running the Hybrid Configuration Wizard on Exchange 2010 SP2. It caught me out a little and as it...&p[url]=http://172.16.7.177:4000/2012/03/updating-hybrid-configuration-failed-with-error-subtask-checkprereqs-execution-failed" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2012/03/updating-hybrid-configuration-failed-with-error-subtask-checkprereqs-execution-failed&text=I came across this error recently while running the Hybrid Configuration Wizard on Exchange 2010 SP2. It caught me out a little and as it...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2012-01-09T13:35:24-06:00" itemprop="datePublished">9 Jan, 2012</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2012/01/decoding-lyncs-client-side-error-messages">Decoding Lync&rsquo;s Client-Side Error Messages</a></h2>
    </header>

    <div class="post-content">
        <p>Some of Lync&rsquo;s Client-side error messages don&rsquo;t really explain the reason for the failure. Luckily my friend Greig Sheridan has started to compile a very handy list of these on his <a href="https://greiginsydney.com/" target="_blank">blog.</a></p>
<p>If you ever spend time troubleshooting Lync client side error messages, I would definitely recommend that you check it out. Here&rsquo;s a link: </p>
<p><a href="https://greiginsydney.com/decoding-lyncs-client-side-error-messages/" target="_blank">https://greiginsydney.com/decoding-lyncs-client-side-error-messages/</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Decoding Lync&rsquo;s Client-Side Error Messages&p[summary]=Some of Lync&rsquo;s Client-side error messages don&rsquo;t really explain the reason for the failure. Luckily my friend Greig Sheridan h...&p[url]=http://172.16.7.177:4000/2012/01/decoding-lyncs-client-side-error-messages" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2012/01/decoding-lyncs-client-side-error-messages&text=Some of Lync&rsquo;s Client-side error messages don&rsquo;t really explain the reason for the failure. Luckily my friend Greig Sheridan h...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-11-02T07:28:12-05:00" itemprop="datePublished">2 Nov, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/11/microsoft-online-services-internet-connection-performance-test">Microsoft Online Services Internet Connection Performance Test</a></h2>
    </header>

    <div class="post-content">
        <p>This handy little tool has been around for some time now but I&rsquo;ve found that it does not seem to be very well known so I thought I would write up a quick post.</p>
<blockquote><p>This performance tool tests your Internet connection to a Microsoft Online Services data center and measures the response times, bandwidth, and overall connection quality. The results can help you evaluate your network configuration for potential use with Microsoft Online Services.</p>
</blockquote>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2011/11/image.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2011/11/image_thumb.png" width="544" height="368" /></a></p>
<p>For America use <a href="http://speedtest.microsoftonline.com" target="_blank">http://speedtest.microsoftonline.com</a></p>
<p>For Asia Pacific use <a href="http://speedtest.apac.microsoftonline.com" target="_blank">http://speedtest.apac.microsoftonline.com</a></p>
<p>For Europe, Middle East and Africa use <a href="http://speedtest.emea.microsoftonline.com" target="_blank">http://speedtest.emea.microsoftonline.com</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Microsoft Online Services Internet Connection Performance Test&p[summary]=This handy little tool has been around for some time now but I&rsquo;ve found that it does not seem to be very well known so I thought I ...&p[url]=http://172.16.7.177:4000/2011/11/microsoft-online-services-internet-connection-performance-test" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/11/microsoft-online-services-internet-connection-performance-test&text=This handy little tool has been around for some time now but I&rsquo;ve found that it does not seem to be very well known so I thought I ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-10-14T14:25:26-05:00" itemprop="datePublished">14 Oct, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/10/tech-ed-australia-to-go-moving-email-from-on-premise-into-the-cloud">Tech-Ed Australia To Go: Moving Email from On Premise Into the Cloud</a></h2>
    </header>

    <div class="post-content">
        <p>Toby and I talking about our &ldquo;Microsoft Office 365: From Simple Migration to a Hybrid Environment&rdquo; session at At Tech-Ed Australia 2011.</p>
<div id="scid:5737277B-5D6D-4f48-ABFC-DD9C333F4C5D:7d607b52-f893-4cd2-b511-6cfdf46e7597" class="wlWriterEditableSmartContent" style="margin: 0px auto; width: 542px; display: block; float: none; padding: 0px;">
<div><object width="542" height="304" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"><param name="src" value="http://www.youtube.com/v/JsRlLKN7d8s?hl=en&amp;hd=1" /><embed width="542" height="304" type="application/x-shockwave-flash" src="http://www.youtube.com/v/JsRlLKN7d8s?hl=en&amp;hd=1" /></object></div>
<div style="width: 542px; clear: both; font-size: .8em;">Toby and I talking about our session at At Tech-Ed Australia 2011</div>
</div>
<p>&nbsp;</p>
<p>If you missed it, the recorded session and slides are available for download here: <a href="http://cgoo.se/ndiUkE" target="_blank">http://cgoo.se/ndiUkE</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Tech-Ed Australia To Go: Moving Email from On Premise Into the Cloud&p[summary]=Toby and I talking about our &ldquo;Microsoft Office 365: From Simple Migration to a Hybrid Environment&rdquo; session at At Tech-Ed Aust...&p[url]=http://172.16.7.177:4000/2011/10/tech-ed-australia-to-go-moving-email-from-on-premise-into-the-cloud" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/10/tech-ed-australia-to-go-moving-email-from-on-premise-into-the-cloud&text=Toby and I talking about our &ldquo;Microsoft Office 365: From Simple Migration to a Hybrid Environment&rdquo; session at At Tech-Ed Aust...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-08-25T09:32:44-05:00" itemprop="datePublished">25 Aug, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/08/exchange-2010-remote-mailbox-move-to-office-365-microsoft-exchange-critical-error">Exchange 2010 remote mailbox move to Office 365 &ldquo;Microsoft Exchange Critical Error&rdquo;</a></h2>
    </header>

    <div class="post-content">
        <p>I&rsquo;ve been having a problem with remote mailbox moves to Office 365. The move completes successfully and everything works ok, but it always generates the following error:</p>
<p>&ldquo;Could not load type 'Microsoft.Exchange.MailboxReplicationService.RequestPriority'&hellip;&rdquo;</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2011/08/image1.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; margin-left: auto; border-top: 0px; margin-right: auto; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2011/08/image_thumb1.png" width="395" height="229" /></a></p>
<p>I&rsquo;ve seen this mentioned a few times on the Office 365 community forums and some of my colleagues are also seeing this. The good news is that after installing <a href="http://www.cgoosen.com/2011/08/update-rollup-5-for-exchange-server-2010-service-pack-1/" target="_blank">Update Rollup 5 for Exchange 2010 SP1</a> this error no longer appears.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2010 remote mailbox move to Office 365 &ldquo;Microsoft Exchange Critical Error&rdquo;&p[summary]=I&rsquo;ve been having a problem with remote mailbox moves to Office 365. The move completes successfully and everything works ok, but it...&p[url]=http://172.16.7.177:4000/2011/08/exchange-2010-remote-mailbox-move-to-office-365-microsoft-exchange-critical-error" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/08/exchange-2010-remote-mailbox-move-to-office-365-microsoft-exchange-critical-error&text=I&rsquo;ve been having a problem with remote mailbox moves to Office 365. The move completes successfully and everything works ok, but it...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

            </main>
        </div>

        <script src="http://172.16.7.177:4000/assets/js/jquery-1.12.2.min.js"></script>
<script src="http://172.16.7.177:4000/assets/js/backtotop.js"></script>
<script src="http://172.16.7.177:4000/assets/js/lunr.min.js"></script>
<script src="http://172.16.7.177:4000/assets/js/lunr-feed.js"></script>
<script src="http://172.16.7.177:4000/assets/js/jquery.fitvids.js"></script>
<script src="http://172.16.7.177:4000/assets/js/svg4everybody.min.js"></script>
<script src="http://172.16.7.177:4000/assets/js/scripts.js"></script>


    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-XXXXXXX-2', 'auto');
        ga('send', 'pageview');
    </script>

        <style>
.lightbox {width: 100%; height: 100%; position: fixed; top: 0; left: 0; background: rgba(0,0,0,0.85); z-index: 9999999; line-height: 0; cursor: pointer;}
.lightbox .img {
	position: relative; 
	top: 50%;
	left: 50%;
	-ms-transform: translateX(-50%) translateY(-50%);
	-webkit-transform: translate(-50%,-50%);
	transform: translate(-50%,-50%);
	max-width: 100%;
	max-height: 100%;
}
.lightbox .img img {opacity: 0; pointer-events: none; width: auto;}
@media screen and (min-width: 1200px) {
    .lightbox .img {
		max-width: 1200px;
    }
}
@media screen and (min-height: 1200px) {
    .lightbox img {
		max-height: 1200px;
	}
}
.lightbox span {display: block; position: fixed; bottom: 13px; height: 1.5em; line-height: 1.4em; width: 100%; text-align: center; color: white; text-shadow:
    -1px -1px 0 #000,
    1px -1px 0 #000,
    -1px 1px 0 #000,
    1px 1px 0 #000;  
}






.lightbox .videoWrapperContainer {
	position: relative; 
	top: 50%;
	left: 50%;
	-ms-transform: translateX(-50%) translateY(-50%);
	-webkit-transform: translate(-50%,-50%);
	transform: translate(-50%,-50%);
	max-width: 900px;
	max-height: 100%;
}
.lightbox .videoWrapperContainer .videoWrapper {
	height: 0;
	line-height: 0;
	margin: 0;
	padding: 0;
	position: relative;
	padding-bottom: 56.333%; /* custom */
	background: black;
} 
.lightbox .videoWrapper iframe {
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
	border: 0;
	display: block;
}   
.lightbox #prev, .lightbox #next {height: 50px; line-height: 36px; display: none; margin-top: -25px; position: fixed; top: 50%; padding: 0 15px; cursor: pointer; text-decoration: none; z-index: 99; color: white; font-size: 60px;}
.lightbox.gallery #prev, .lightbox.gallery #next {display: block;}
.lightbox #prev {left: 0;}
.lightbox #next {right: 0;}
.lightbox #close {height: 50px; width: 50px; position: fixed; cursor: pointer; text-decoration: none; z-index: 99; right: 0; top: 0;}
.lightbox #close:after, .lightbox #close:before {position: absolute; margin-top: 22px; margin-left: 14px; content: ""; height: 3px; background: white; width: 23px;
-webkit-transform-origin: 50% 50%;
-moz-transform-origin: 50% 50%;
-o-transform-origin: 50% 50%;
transform-origin: 50% 50%;
/* Safari */
-webkit-transform: rotate(-45deg);
/* Firefox */
-moz-transform: rotate(-45deg);
/* IE */
-ms-transform: rotate(-45deg);
/* Opera */
-o-transform: rotate(-45deg);
}
.lightbox #close:after {
/* Safari */
-webkit-transform: rotate(45deg);
/* Firefox */
-moz-transform: rotate(45deg);
/* IE */
-ms-transform: rotate(45deg);
/* Opera */
-o-transform: rotate(45deg);
}
.lightbox, .lightbox * {
    -webkit-user-select: none;  
    -moz-user-select: none;    
    -ms-user-select: none;      
    user-select: none;
}
</style>
		
<script>
function is_youtubelink(url) {
  var p = /^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/;
  return (url.match(p)) ? RegExp.$1 : false;
}
function is_imagelink(url) {
	var p = /([a-z\-_0-9\/\:\.]*\.(jpg|jpeg|png|gif))/i;
	return (url.match(p)) ? true : false;
}
function is_vimeolink(url,el) {
	var id = false;
	$.ajax({
	  url: 'https://vimeo.com/api/oembed.json?url='+url,
	  async: true,
	  success: function(response) {
		if(response.video_id) {
		  id = response.video_id;
		  $(el).addClass('lightbox-vimeo').attr('data-id',id);
		}
	  }
	});
}

$(document).ready(function() {
	//add classes to links to be able to initiate lightboxes
	$("a").each(function(){
		var url = $(this).attr('href');
		if(url) {
			if(url.indexOf('vimeo') !== -1 && !$(this).hasClass('no-lightbox')) is_vimeolink(url,$(this));
			if(is_youtubelink(url) && !$(this).hasClass('no-lightbox')) $(this).addClass('lightbox-youtube').attr('data-id',is_youtubelink(url));
			if(is_imagelink(url) && !$(this).hasClass('no-lightbox')) {
				$(this).addClass('lightbox-image');
				var href = $(this).attr('href');
				var filename = href.split('/').pop();
				var split = filename.split(".");
				var name = split[0];
				$(this).attr('title',name);
			}
		}
	});
	//remove the clicked lightbox
	$("body").on("click", ".lightbox", function(event){
		if($(this).hasClass('gallery')) {
			$(this).remove();
			if($(event.target).attr('id')=='next') {
				//next item
				if($("a.gallery.current").nextAll("a.gallery:first").length) $("a.gallery.current").nextAll("a.gallery:first").click();
				else $("a.gallery.current").parent().find("a.gallery").first().click();
			}
			else if ($(event.target).attr('id')=='prev') {
				//prev item
				if($("a.gallery.current").prevAll("a.gallery:first").length) $("a.gallery.current").prevAll("a.gallery:first").click();
				else $("a.gallery.current").parent().find("a.gallery").last().click();
			}
			else {
				$("a.gallery").removeClass('gallery');
			}
		}
		else $(this).remove();
	});
	//prevent image from being draggable (for swipe)
	$("body").on('dragstart', ".lightbox img", function(event) { event.preventDefault(); });
	//add the youtube lightbox on click
	$("a.lightbox-youtube").click(function(event){
		event.preventDefault();
		$('<div class="lightbox"><a id="close"></a><a id="next">&rsaquo;</a><a id="prev">&lsaquo;</a><div class="videoWrapperContainer"><div class="videoWrapper"><iframe src="https://www.youtube.com/embed/'+$(this).attr('data-id')+'?autoplay=1&showinfo=0&rel=0"></iframe></div></div></div>').appendTo('body');
	});
	//add the image lightbox on click
	$("a.lightbox-image").click(function(event){
		event.preventDefault();
		$('<div class="lightbox"><a id="close"></a><a id="next">&rsaquo;</a><a id="prev">&lsaquo;</a><div class="img" style="background: url('+$(this).attr('href')+') center center / contain no-repeat;" title="'+$(this).attr('title')+'" ><img src="'+$(this).attr('href')+'" alt="'+$(this).attr('title')+'" /></div><span>'+$(this).attr('title')+'</span></div>').appendTo('body');
	});
	//add the vimeo lightbox on click
	$("body").on("click", "a.lightbox-vimeo", function(event){
		event.preventDefault();
		$('<div class="lightbox"><a id="close"></a><a id="next">&rsaquo;</a><a id="prev">&lsaquo;</a><div class="videoWrapperContainer"><div class="videoWrapper"><iframe src="https://player.vimeo.com/video/'+$(this).attr('data-id')+'/?autoplay=1&byline=0&title=0&portrait=0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div></div></div>').appendTo('body');
	});

	$("body").on("click", "a[class*='lightbox-']", function(){
		var link_elements = $(this).parent().find("a[class*='lightbox-']");
		$(link_elements).removeClass('current');
		for (var i=0; i<link_elements.length; i++) {
			if($(this).attr('href') == $(link_elements[i]).attr('href')) {
				$(link_elements[i]).addClass('current');
			}
		}
		if(link_elements.length>1) {
			$('.lightbox').addClass('gallery');
			$(link_elements).addClass('gallery');
		}
	});

	
});

$(document).keydown(function(e) {
    switch(e.which) {
        case 37: // left
        $("#prev").click();
        break;
        case 39: // right
        $("#next").click();
        break;
	case 27: // esc
        $("#close").click();
        break;
        default: return; // exit this handler for other keys
    }
    e.preventDefault(); // prevent the default action (scroll / move caret)
});

  /*===========================
  Swipe-it v1.4.1
  An event listener for swiping gestures with vanilla js.
  https://github.com/tri613/swipe-it#readme
 
  @Create 2016/09/22
  @Update 2017/08/11
  @Author Trina Lu
  ===========================*/
  "use strict";var _slicedToArray=function(){function n(n,t){var e=[],i=!0,o=!1,r=void 0;try{for(var u,c=n[Symbol.iterator]();!(i=(u=c.next()).done)&&(e.push(u.value),!t||e.length!==t);i=!0);}catch(n){o=!0,r=n}finally{try{!i&&c.return&&c.return()}finally{if(o)throw r}}return e}return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();!function(n,t,e){function i(n){function e(){o("touchstart",m,w),o("touchmove",d,w),o("touchend",p,w),E.mouseEvent&&o("mousedown",s,w)}function i(){y=!1,D=!1,A=!1,b=!1,a=!1}function s(n){a=this,y=n.clientX,D=n.clientY,o("mousemove",l,v),o("mouseup",h,v)}function l(n){n.preventDefault(),y&&D&&(A=n.clientX,b=n.clientY)}function h(n){r("mousemove",l,v),r("mouseup",h,v),p(n)}function m(n){a=this,y=n.touches[0].clientX,D=n.touches[0].clientY}function d(n){A=n.touches[0].clientX,b=n.touches[0].clientY}function p(n){if(y&&D&&A&&b){var t=y-A,e=D-b,o=[t,e].map(Math.abs),r=_slicedToArray(o,2),c=r[0],s=r[1],v=E.minDistance;if(c>v){var f=y<A?"swipeRight":"swipeLeft";u(f,a,{distance:t,start:y,end:A})}if(s>v){var l=D>b?"swipeUp":"swipeDown";u(l,a,{distance:e,start:D,end:b})}(c>v||s>v)&&u("swipe",a)}i()}var E=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},w=c(t.querySelectorAll(n)),y=void 0,D=void 0,A=void 0,b=void 0;E.mouseEvent=void 0===E.mouseEvent?f.mouseEvent:E.mouseEvent,E.minDistance=void 0===E.minDistance?f.minDistance:E.minDistance,i(),e(),this.on=function(n,t){return o(n,t,w),this}}function o(n,t,e){s(e).forEach(function(e){return e.addEventListener(n,t)})}function r(n,t,e){s(e).forEach(function(e){return e.removeEventListener(n,t)})}function u(n,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=t.createEvent("Event");o.initEvent(n,!0,!0),o.swipe=i,s(e).forEach(function(n){return n.dispatchEvent(o)})}function c(n){for(var t=[],e=0;e<n.length;e++)t.push(n[e]);return t}function s(n){return Array.isArray(n)?n:[n]}var a=!1,v=[n],f={mouseEvent:!0,minDistance:30};n[e]=i}(window,document,"SwipeIt");

var mySwipeIt = new SwipeIt('body');
mySwipeIt.on('swipeLeft',function(e){
	//check if lightbox is present
	if($('.lightbox').length >  0 ) {
		$("#next").click();
	}
}).on('swipeRight',function(e){
	//check if lightbox is present
	if($('.lightbox').length >  0 ) {
		$("#prev").click();
	}
});
</script>

    </body>
</html>