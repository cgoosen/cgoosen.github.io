<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Category: Exchange Server | Chris&#39;s Blog &mdash; It&#39;s called thinking...  go with it! </title>
    <meta property="og:title" content="Category: Exchange Server | Chris&#39;s Blog &mdash; It&#39;s called thinking...  go with it! " />
    <meta name="twitter:title" content="Category: Exchange Server | Chris&#39;s Blog &mdash; It&#39;s called thinking...  go with it! " />

    <meta name="description" content="Category: Exchange Server">
    <meta name="description" property="og:description" content="Category: Exchange Server" />
    <meta name="twitter:description" content="Category: Exchange Server" />

    <meta name="twitter:card" content="summary_large_image" />
    
    <meta name="twitter:site" content="@chrisgoosen" />
    
    <meta property="og:url" content="http://172.16.7.177:4000/categories/Exchange%20Server/" />

    <meta property="og:image" content="" />
    <meta name="twitter:image" content="" />

    <meta name="author" content="Chris's Blog" />

    <meta name="copyright" content="Copyright by Chris's Blog. All Rights Reserved." />

    <style>
        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 300;
            src: local('Roboto Light'), local('Roboto-Light'), url(https://fonts.gstatic.com/s/roboto/v15/Hgo13k-tfSpn0qi1SFdUfVtXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 400;
            src: local('Roboto'), local('Roboto-Regular'), url(https://fonts.gstatic.com/s/roboto/v15/CWB0XYA8bzo0kSThX0UTuA.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 700;
            src: local('Roboto Bold'), local('Roboto-Bold'), url(https://fonts.gstatic.com/s/roboto/v15/d-6IYplOFocCacKzxwXSOFtXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 900;
            src: local('Roboto Black'), local('Roboto-Black'), url(https://fonts.gstatic.com/s/roboto/v15/mnpfi9pxYH-Go5UiibESIltXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 300;
            src: local('Roboto Light Italic'), local('Roboto-LightItalic'), url(https://fonts.gstatic.com/s/roboto/v15/7m8l7TlFO-S3VkhHuR0at44P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 400;
            src: local('Roboto Italic'), local('Roboto-Italic'), url(https://fonts.gstatic.com/s/roboto/v15/vPcynSL0qHq_6dX7lKVByfesZW2xOQ-xsNqO47m55DA.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 700;
            src: local('Roboto Bold Italic'), local('Roboto-BoldItalic'), url(https://fonts.gstatic.com/s/roboto/v15/t6Nd4cfPRhZP44Q5QAjcC44P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 900;
            src: local('Roboto Black Italic'), local('Roboto-BlackItalic'), url(https://fonts.gstatic.com/s/roboto/v15/bmC0pGMXrhphrZJmniIZpY4P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }
    </style>
    
    <link href="/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    
    <link rel="stylesheet" href="http://172.16.7.177:4000/assets/css/main.css">

    <link rel="canonical" href="http://172.16.7.177:4000/categories/Exchange%20Server/">

    <link rel="alternate" type="application/rss+xml" title="" href="http://172.16.7.177:4000/feed.xml">
</head>

    <body>
        <div class="wrapper">
            <aside class="user-profile fixed" role="complementary">
    <div class="burger">
        <input class="trigger hidden" id="toggleBurger" type="checkbox" />
        <label for="toggleBurger">
            <span>Navigation</span>
        </label>
    </div>

    <div class="compact-header">
        <a class="avatar" href="http://172.16.7.177:4000"><img alt="Avatar" src="/assets/img/headshot.jpg" /></a>
        <div class="my-info">
            <strong class="my-name">Chris's Blog</strong>
            <span class="my-job-title">It's called thinking...  go with it!</span>
        </div>
    </div>

    
        
        <div class="mainmenu">
            <a href="http://172.16.7.177:4000" >Home</a>
            
                
            
                
            
                
                    <a href="http://172.16.7.177:4000/contact/" >Contact</a>
                
            
                
                    <a href="http://172.16.7.177:4000/about/" >About</a>
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
        </div>
        
    
    
    <div>
    	<img src="/assets/img/mvp.png" style="width:181px;height:74px;">
    </div>

    <p class="about-me"> </p>
    
    <ul class="socials">
        <li><a href="https://twitter.com/chrisgoosen" target="_blank"><svg title="twitter" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li><li><a href="https://www.linkedin.com/in/ctgoosen/" target="_blank"><svg title="linkedin" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#linkedin-icon"></use></svg></a></li><li><a href="https://github.com/cgoosen" target="_blank"><svg title="github" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#github-icon"></use></svg></a></li>

        
            <li><a href="/contact" target="_blank"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#email-icon"></use></svg></a></li>
        

        
         <li><a href="http://feeds.cgoosen.com/cgoosen"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#rss-icon"></use></svg></a></li>
        
    </ul>
</aside>


            <main class="the-content" role="main">
                <div class="search" role="search">
    <div>
        <div class="show-results-count">0 Results</div>
        <div class="search-holder">
            <input type="text" id="search-input" placeholder="search for..." />
        </div>
    </div>
    <ul id="results-container" class="results-container"></ul>
</div>


                <h1>Posts From Category: Exchange Server</h1>


<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2019-01-30T05:31:34-06:00" itemprop="datePublished">30 Jan, 2019</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2019/01/exchange-online-no-dkim-keys-saved-for-this-domain">Exchange Online - No DKIM keys saved for this domain</a></h2>
    </header>

    <div class="post-content">
        <p>I recently came across an interesting issue when attempting to enable DKIM for a domain in Exchange Online. When accessing the DKIM options via the Exchange Admin Center, I didn’t have the option to enable DKIM, instead saw the “No DKIM keys saved for this domain” message shown in the screenshot below:
<a href="/assets/img/2019/01/2.png"><img src="/assets/img/2019/01/2.png" style="width:300px;height:129px;" /></a>
Fortunately, we are able to manage DKIM configuration via PowerShell. Once connected to Exchange Online, you can list the DKIM cmdlets using Get-Command:
<a href="/assets/img/2019/01/3.png"><img src="/assets/img/2019/01/3.png" style="width:300px;height:155px;" /></a></p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
</pre></td><td class="code"><pre><span class="no">Get</span><span class="o">-</span><span class="no">Command</span> <span class="o">-</span><span class="no">Module</span> <span class="n">tmp_dmwhjqj3</span><span class="p">.</span><span class="nf">m1c</span> <span class="o">*</span><span class="n">dkim</span><span class="o">*</span></pre></td></tr></tbody></table></code></pre></figure>

<p>We can use New-DkimSigningConfig cmdlet to enable DKIM for a particular domain:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
</pre></td><td class="code"><pre><span class="no">New</span><span class="o">-</span><span class="no">DkimSigningConfig</span> <span class="o">-</span><span class="no">DomainName</span> <span class="n">domain</span><span class="p">.</span><span class="nf">com</span> <span class="o">-</span><span class="no">Enabled</span> <span class="vg">$True</span></pre></td></tr></tbody></table></code></pre></figure>

<p>Once run, you’ll notice that the Exchange Admin Center will now show DKIM as enabled for the domain. If you haven’t already, you’ll also need to create the relevant DNS records to ensure that DKIM functions correctly. The following records will be required:</p>
<ul>
  <li>selector1._domainkey.domain.com = CNAME: selector1-domain-com._domainkey.tenant.onmicrosoft.com</li>
  <li>selector2._domainkey.domain.com = CNAME: selector2-domain-com._domainkey.tenant.onmicrosoft.com</li>
</ul>

<p>Fellow MVP <a href="https://twitter.com/jaapwess" target="_blank" rel="noopener">Jaap Wesselius</a> has a great post on <a href="https://jaapwesselius.com/2018/10/31/spf-dkim-and-dmarc-in-exchange-online-protection/" target="_blank" rel="noopener">SPF, DKIM and DMARC.</a></p>


        
            <p><a href="/2019/01/exchange-online-no-dkim-keys-saved-for-this-domain" role="button">Read More</a></p>
        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange Online - No DKIM keys saved for this domain&p[summary]=I recently came across an interesting issue when attempting to enable DKIM for a domain in Exchange Online. When accessing the DKIM optio...&p[url]=http://172.16.7.177:4000/2019/01/exchange-online-no-dkim-keys-saved-for-this-domain" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2019/01/exchange-online-no-dkim-keys-saved-for-this-domain&text=I recently came across an interesting issue when attempting to enable DKIM for a domain in Exchange Online. When accessing the DKIM optio...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2018-09-08T03:00:47-05:00" itemprop="datePublished">8 Sep, 2018</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2018/09/tca-podcast-episode-16-jeff-mealiffe-and-the-awesomeness-of-exchangeahem-office-365">TCA Podcast Episode 16: Jeff Mealiffe and the Awesomeness of Exchange(Ahem, Office 365)</a></h2>
    </header>

    <div class="post-content">
        <p>In this episode, Nic and Warren have a chat to the Perf Guy himself, Principal Lead Program Manager at Microsoft,&nbsp;Jeff Mealiffe. They&nbsp;talk about the evolution of Exchange and get Jeff to spill on which version he liked best! They also talk about Office 365 connectivity and the great things Microsoft are doing internally to make your Office 365 experience better.</p>
<iframe width="100%" height="300" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/474243786&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"></iframe>
<p>For more information on The Cloud Architects podcast, check us out on <a href="https://soundcloud.com/thecloudarchitects/" target="_blank" rel="noopener noreferrer">SoundCloud</a>. We are also available on your favorite podcast app:</p>
<ul>
<li><a href="https://itunes.apple.com/us/podcast/the-cloud-architects-podcast/id1264479296?mt=2" target="_blank" rel="noopener noreferrer">iTunes</a></li>
<li><a href="https://www.stitcher.com/podcast/the-cloud-architects/the-cloud-achitects" target="_blank" rel="noopener noreferrer">Stitcher</a></li>
<li><a href="https://tunein.com/radio/The-Cloud-Architects-Podcast-p1026315/" target="_blank" rel="noopener noreferrer">Tunein</a></li>
<li><a href="https://www.acast.com/thecloudarchitectspodcast" target="_blank" rel="noopener noreferrer">Acast</a></li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=TCA Podcast Episode 16: Jeff Mealiffe and the Awesomeness of Exchange(Ahem, Office 365)&p[summary]=In this episode, Nic and Warren have a chat to the Perf Guy himself, Principal Lead Program Manager at Microsoft,&nbsp;Jeff Mealiffe. The...&p[url]=http://172.16.7.177:4000/2018/09/tca-podcast-episode-16-jeff-mealiffe-and-the-awesomeness-of-exchangeahem-office-365" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2018/09/tca-podcast-episode-16-jeff-mealiffe-and-the-awesomeness-of-exchangeahem-office-365&text=In this episode, Nic and Warren have a chat to the Perf Guy himself, Principal Lead Program Manager at Microsoft,&nbsp;Jeff Mealiffe. The...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2017-03-15T10:49:32-05:00" itemprop="datePublished">15 Mar, 2017</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2017/03/connecting-to-exchange-online-with-remote-powershell-from-a-mac">Connecting to Exchange Online with remote PowerShell from a Mac</a></h2>
    </header>

    <div class="post-content">
        <p>Yes! it is finally possible to connect to Exchange Online from PowerShell installed on MacOS. I noticed some tweets <a href="https://mattmcnabb.github.io/O365-PowerShell-On-Linux" target="_blank" rel="noopener noreferrer">about this being possible on Linux</a> earlier in the week so I thought I&rsquo;d re-visit testing it on MacOS. PowerShell remoting has been available in the MacOs version since powershell-6.0.0-alpha.15, but it didn&rsquo;t include the ability to specify a &ldquo;ConnectionUri&rsquo; as the endpoint &ndash; it only worked with server names and IP addresses. powershell-6.0.0-alpha.17 which was recently released now includes this functionality.</p>
<p>The first thing you need to do it <a href="https://github.com/PowerShell/PowerShell" target="_blank" rel="noopener noreferrer">download and install the latest release from here</a>, you&rsquo;ll want to download at least powershell-6.0.0-alpha.17</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2017/03/Screen-Shot-2017-03-15-at-3.47.08-PM.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Screen Shot 2017-03-15 at 3.47.08 PM" src="http://www.cgoosen.com/wp-content/uploads/2017/03/Screen-Shot-2017-03-15-at-3.47.08-PM_thumb.png" alt="Screen Shot 2017-03-15 at 3.47.08 PM" width="410" height="290" border="0" /></a></p>
<p align="left">Next launch PowerShell and confirm the version:</p>
<p>[powershell]<br />
$PSVersionTable<br />
[/powershell]</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2017/03/Screen-Shot-2017-03-15-at-4.31.53-PM.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Screen Shot 2017-03-15 at 4.31.53 PM" src="http://www.cgoosen.com/wp-content/uploads/2017/03/Screen-Shot-2017-03-15-at-4.31.53-PM_thumb.png" alt="Screen Shot 2017-03-15 at 4.31.53 PM" width="410" height="263" border="0" /></a></p>
<p align="left">We are now ready to run establish our remote session. First let&rsquo;s define our credentials:</p>
<p>[powershell]<br />
$UserCredential = Get-Credential<br />
[/powershell]</p>
<p align="left">Then create the session:</p>
<p>[powershell]<br />
$Session = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri https://outlook.office365.com/powershell-liveid -Credential $UserCredential -Authentication Basic -AllowRedirection<br />
[/powershell]</p>
<p align="left">And finally, import that session:</p>
<p>[powershell]<br />
Import-PSSession $Session<br />
[/powershell]</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2017/03/Screen-Shot-2017-03-15-at-4.41.16-PM.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Screen Shot 2017-03-15 at 4.41.16 PM" src="http://www.cgoosen.com/wp-content/uploads/2017/03/Screen-Shot-2017-03-15-at-4.41.16-PM_thumb.png" alt="Screen Shot 2017-03-15 at 4.41.16 PM" width="410" height="263" border="0" /></a></p>
<p align="left">Once connected you have all the Exchange Online cmdlets available to you:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2017/03/Screen-Shot-2017-03-15-at-4.46.02-PM.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Screen Shot 2017-03-15 at 4.46.02 PM" src="http://www.cgoosen.com/wp-content/uploads/2017/03/Screen-Shot-2017-03-15-at-4.46.02-PM_thumb.png" alt="Screen Shot 2017-03-15 at 4.46.02 PM" width="410" height="263" border="0" /></a></p>
<p align="left">I haven&rsquo;t thoroughly tested it yet, but I look forward to spending some time using it soon!</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Connecting to Exchange Online with remote PowerShell from a Mac&p[summary]=Yes! it is finally possible to connect to Exchange Online from PowerShell installed on MacOS. I noticed some tweets about this being poss...&p[url]=http://172.16.7.177:4000/2017/03/connecting-to-exchange-online-with-remote-powershell-from-a-mac" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2017/03/connecting-to-exchange-online-with-remote-powershell-from-a-mac&text=Yes! it is finally possible to connect to Exchange Online from PowerShell installed on MacOS. I noticed some tweets about this being poss...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2017-02-07T11:06:14-06:00" itemprop="datePublished">7 Feb, 2017</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2017/02/configuring-session-timeouts-for-outlook-on-the-web-owa-in-exchange-online">Configuring session timeouts for Outlook on the Web (OWA) in Exchange Online</a></h2>
    </header>

    <div class="post-content">
        <p>In today&rsquo;s browser first, cloud first world, many organizations look at reducing risk by imposing strict session timeout settings on their productivity tools and applications. The idea generally is that if a user is not actively using and application for 10 &ndash;15 mins, they have completed the task they were working on and have forgotten to logoff correctly. This can be especially dangerous when these applications are accessed on shared terminals or public computers. Given that email remains a vitally important business tool for many organizations, reducing the session timeout on Exchange Online (and Exchange 2016) is a fairly common request and it is really simple to do.</p>
<p>By default, session timeout is enabled for OWA (let&rsquo;s just call it that, shall we?) and it set to 6 hours. You can confirm this configuration via PowerShell using the Get-OrganizationConfig cmdlet:</p>
<p>[powershell]Get-OrganizationConfig | FL ActivityBasedAuthenticationTimeout*[/powershell]</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2017/01/cap1.png"><img class="aligncenter size-medium wp-image-2456" src="http://www.cgoosen.com/wp-content/uploads/2017/01/cap1-300x65.png" alt="" width="300" height="65" /></a></p>
<p>There are two parameters in particular worth paying attention to:</p>
<ul>
<li>ActivityBasedAuthenticationTimeoutEnabled</li>
<li>ActivityBasedAuthenticationTimeoutInterval</li>
</ul>
<p><em>ActivityBasedAuthenticationTimeoutEnabled </em>is pretty self-explanatory, you will want to keep it enabled if you intended to set the timeout interval. The&nbsp;<em>ActivityBasedAuthenticationTimeoutInterval </em>parameter&nbsp;controls the actual timeout interval in&nbsp;<em>hh</em>:<em>mm</em>:<em>ss</em>&nbsp;format where&nbsp;<em>hh</em>&nbsp;= hours,&nbsp;<em>mm</em>&nbsp;= minutes and&nbsp;<em>ss</em>&nbsp;= seconds. Note that this parameter has a range of 5 min - 8 hrs. Changes can be made using the Set-OrganizationConfig cmdlet, for example to set the timeout interval to 15 mins we'd issue the following cmd:</p>
<p>[powershell]Set-OrganizationConfig -ActivityBasedAuthenticationTimeoutInterval 00:15:00[/powershell]</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2017/02/cap2.png"><img class="aligncenter size-medium wp-image-2480" src="http://www.cgoosen.com/wp-content/uploads/2017/02/cap2-300x50.png" alt="" width="300" height="50" /></a></p>
<p>During my testing, it took a really long time (12+ hrs) for this to take effect so don't be alarmed if it doesn't work right away.</p>
<p>For more information on the <a href="https://technet.microsoft.com/en-us/library/aa997443(v=exchg.160).aspx" target="_blank">Set-OrganizationConfig parameters, see TechNet</a>.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Configuring session timeouts for Outlook on the Web (OWA) in Exchange Online&p[summary]=In today&rsquo;s browser first, cloud first world, many organizations look at reducing risk by imposing strict session timeout settings o...&p[url]=http://172.16.7.177:4000/2017/02/configuring-session-timeouts-for-outlook-on-the-web-owa-in-exchange-online" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2017/02/configuring-session-timeouts-for-outlook-on-the-web-owa-in-exchange-online&text=In today&rsquo;s browser first, cloud first world, many organizations look at reducing risk by imposing strict session timeout settings o...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2016-08-30T14:20:34-05:00" itemprop="datePublished">30 Aug, 2016</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2016/08/disabling-modern-attachments-in-outlook-2016">Disabling Modern Attachments in Outlook 2016</a></h2>
    </header>

    <div class="post-content">
        <p>The modern attachments (aka cloudy attachments) feature in Outlook 2016 makes it simple for users to share documents stored in OneDrive for Business or SharePoint with each other as links instead of actually attaching the file and emailing it around. This is a great way to reduce the number of different document versions floating around the organization and helps promote collaboration and co-authoring. Once a cloudy attachment is attached to an email, the user can grant view only or edit permissions to the recipient and Exchange will automatically take care of applying the appropriate permission to the document.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2016/08/blog1.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="blog1" src="http://www.cgoosen.com/wp-content/uploads/2016/08/blog1_thumb.png" alt="blog1" width="249" height="206" border="0" /></a></p>
<p align="left">This feature is available out of the box for Exchange Online users using Outlook 2016 and can be enabled for on-premises users with mailboxes on Exchange 2016 provided OAuth between Exchange 2016 and Office 365 has been <a href="https://technet.microsoft.com/EN-US/library/mt589761%28v=exchg.150%29.aspx" target="_blank" rel="noopener noreferrer">configured properly and the appropriate prerequisites are in place</a>, but what happens to on-premises customers who do not have Exchange 2016 deployed? The scenario is really interesting in that Outlook will still allow users to send cloudy attachments, but because the backend Exchange environment isn&rsquo;t able to apply the appropriate permission to the document the recipient will be unable to view the attachment:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2016/08/bog2.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="bog2" src="http://www.cgoosen.com/wp-content/uploads/2016/08/bog2_thumb.png" alt="bog2" width="413" height="234" border="0" /></a></p>
<p align="left">This behavior may confuse users and may not be desirable in some environments and while there is no way to specifically disable modern attachments, there is a workaround that may help achieve similar results. There are two options in Outlook that enable modern attachments:</p>
<ul>
<li>The &ldquo;Browse Web Locations&rdquo; option allows users to select files from OneDrive for Business, SharePoint sites or Groups.</li>
<li>The &ldquo;Recent items&rdquo; list provides a list of recently saved documents and when these documents are saved to OneDrive for Business or SharePoint it will automatically provide the option to attach a cloudy attachment version of the document.</li>
</ul>
<p>Disabling these two options in Outlook will effectively prevent users from being able to send cloudy attachments and change the user experience from this:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2016/08/default.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="default" src="http://www.cgoosen.com/wp-content/uploads/2016/08/default_thumb.png" alt="default" width="455" height="127" border="0" /></a></p>
<p align="left">To this:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2016/08/after.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="after" src="http://www.cgoosen.com/wp-content/uploads/2016/08/after_thumb.png" alt="after" width="366" height="122" border="0" /></a></p>
<p align="left">In order to do this, the following registry keys need to be added to the client machine for each user:</p>
<p style="text-align: center;"><a href="https://www.cgoosen.com/wp-content/uploads/2016/08/Screen-Shot-2017-08-21-at-11.43.08-AM.png"><img class="aligncenter size-full wp-image-2963" src="https://www.cgoosen.com/wp-content/uploads/2016/08/Screen-Shot-2017-08-21-at-11.43.08-AM.png" alt="" width="646" height="76" /></a></p>
<p>To simplify this, you can <a href="http://www.cgoosen.com/downloads/DisableModernAttachments.zip" target="_blank" rel="noopener noreferrer">download the registry keys here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Disabling Modern Attachments in Outlook 2016&p[summary]=The modern attachments (aka cloudy attachments) feature in Outlook 2016 makes it simple for users to share documents stored in OneDrive f...&p[url]=http://172.16.7.177:4000/2016/08/disabling-modern-attachments-in-outlook-2016" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2016/08/disabling-modern-attachments-in-outlook-2016&text=The modern attachments (aka cloudy attachments) feature in Outlook 2016 makes it simple for users to share documents stored in OneDrive f...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2016-07-26T14:23:53-05:00" itemprop="datePublished">26 Jul, 2016</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2016/07/automating-archive-folder-creation-in-exchange-online-mailboxes">Automating archive folder creation in Exchange Online mailboxes</a></h2>
    </header>

    <div class="post-content">
        <p align="left">If you are using Outlook 2016 on Windows or Mac you will have noticed the recent addition of a one-click &lsquo;Archive&rsquo; button to the ribbon. The addition of the archive button was <a href="https://blogs.office.com/2016/02/25/february-office-365-updates/" target="_blank">announced at the end of February</a>, but seems to have caught a bunch of customers by surprise and there appears to be some confusion about it&rsquo;s intended purpose. If you are unfamiliar with the one-click &lsquo;Archive&rsquo; button, here&rsquo;s what it looks like:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2016/07/a.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="a" src="http://www.cgoosen.com/wp-content/uploads/2016/07/a_thumb.png" alt="a" width="240" height="140" border="0" /></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://www.cgoosen.com/wp-content/uploads/2016/07/b.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="b" src="http://www.cgoosen.com/wp-content/uploads/2016/07/b_thumb.png" alt="b" width="206" height="120" border="0" /></a></p>
<p align="left">The archive button is intended to make archiving email a one-click operation, but this does not archive email to an Online Archive and does not require users to have an Online Archive enabled. Instead, the button will file email to an &lsquo;Archive&rsquo; folder in your existing mailbox. The intention here is that this button provides a single-click way to clean or declutter your inbox of messages that you have already read. It is important to understand the following about the archive button:</p>
<ul>
<li>
<div align="left">The archive button cannot be used to send email messages to the Online Archive.</div>
</li>
<li>
<div align="left">Since the archive folder is a folder in the root of the mailbox, moving email to it will not reduce the overall size of the mailbox.</div>
</li>
</ul>
<p align="left">If a folder called &lsquo;Archive&rsquo; does not already exist in the root of the mailbox, the user will be prompted to create one:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2016/07/1.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="1" src="http://www.cgoosen.com/wp-content/uploads/2016/07/1_thumb.png" alt="1" width="416" height="112" border="0" /></a></p>
<p align="left">Certain organizations may feel like this creates confusion amongst their user community and would therefore like to automate the create of the &lsquo;Archive&rsquo; folder in their user mailboxes. Fortunately, MVP (and fellow Aussie!) <a href="https://mvp.microsoft.com/en-us/PublicProfile/10145?fullName=Glen%20%20Scales" target="_blank">Glen Scales</a> has a <a href="http://gsexdev.blogspot.com/2015/09/ews-create-mailbox-folder-powershell.html" target="_blank">great solution for creating mailbox folders using PowerShell the EWS managed API.</a> In order to use his module, you will need to download and install the <a href="http://go.microsoft.com/fwlink/?LinkId=255472" target="_blank">EWS managed API from here.</a> Once installed, you will need to connect to <a href="http://www.cgoosen.com/2014/10/script-connect-exo-ps1-connect-to-exchange-online-using-remote-powershell/" target="_blank">Exchange Online via remote PowerShell</a> and import the module. It them becomes a matter of using the Create-Folder cmdlet included in the module. The module has few parameters and a lot of other functionality but we only need the following:</p>
<p>[powershell]<br />
Create-Folder -MailboxName user@domain.com -NewFolderName Archive<br />
[/powershell]</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2016/07/3.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="3" src="http://www.cgoosen.com/wp-content/uploads/2016/07/3_thumb.png" alt="3" width="534" height="167" border="0" /></a></p>
<p>With some minor tweaks to Glen&rsquo;s code, we can easily script this process for multiple (or all) mailboxes:</p>
<p>[powershell]<br />
function Load-EWSManagedAPI{<br />
    param(<br />
    )<br />
 	Begin<br />
	{<br />
		## Load Managed API dll<br />
		###CHECK FOR EWS MANAGED API, IF PRESENT IMPORT THE HIGHEST VERSION EWS DLL, ELSE EXIT<br />
		$EWSDLL = (($(Get-ItemProperty -ErrorAction SilentlyContinue -Path Registry::$(Get-ChildItem -ErrorAction SilentlyContinue -Path 'Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Exchange\Web Services'|Sort-Object Name -Descending| Select-Object -First 1 -ExpandProperty Name)).'Install Directory') + "Microsoft.Exchange.WebServices.dll")<br />
		if (Test-Path $EWSDLL)<br />
		    {<br />
		    Import-Module $EWSDLL<br />
		    }<br />
		else<br />
		    {<br />
		    "$(get-date -format yyyyMMddHHmmss):"<br />
		    "This script requires the EWS Managed API 1.2 or later."<br />
		    "Please download and install the current version of the EWS Managed API from"<br />
		    "http://go.microsoft.com/fwlink/?LinkId=255472"<br />
		    ""<br />
		    "Exiting Script."<br />
		    exit<br />
		    }<br />
  	}<br />
}</p>
<p>function Connect-Exchange{<br />
    param(<br />
    	[Parameter(Position=0, Mandatory=$true)] [string]$MailboxName,<br />
		[Parameter(Position=1, Mandatory=$true)] [System.Management.Automation.PSCredential]$Credentials<br />
    )<br />
 	Begin<br />
		 {<br />
		Load-EWSManagedAPI</p>
<p>		## Set Exchange Version<br />
		$ExchangeVersion = [Microsoft.Exchange.WebServices.Data.ExchangeVersion]::Exchange2010_SP1</p>
<p>		## Create Exchange Service Object<br />
		$service = New-Object Microsoft.Exchange.WebServices.Data.ExchangeService($ExchangeVersion)  </p>
<p>		#Credentials<br />
		$creds = New-Object System.Net.NetworkCredential($Credentials.UserName.ToString(),$Credentials.GetNetworkCredential().password.ToString())<br />
		$service.Credentials = $creds       </p>
<p>		#CAS URL hardcoded for Exchange Online </p>
<p>		$uri=[system.URI] "https://outlook.office365.com/EWS/Exchange.asmx"<br />
		$service.Url = $uri    </p>
<p>        if(!$service.URL){<br />
			throw "Error connecting to EWS"<br />
		}<br />
		else<br />
		{<br />
			return $service<br />
		}<br />
	}<br />
}</p>
<p>function Create-Folder{<br />
    param(<br />
    	[Parameter(Position=0, Mandatory=$true)] [string]$MailboxName,<br />
		[Parameter(Position=1, Mandatory=$true)] [System.Management.Automation.PSCredential]$Credentials,<br />
		[Parameter(Position=2, Mandatory=$true)] [String]$NewFolderName<br />
    )<br />
 	Begin<br />
	 {<br />
		$service = Connect-Exchange -MailboxName $MailboxName -Credentials $Credentials<br />
		$NewFolder = new-object Microsoft.Exchange.WebServices.Data.Folder($service)<br />
		$NewFolder.DisplayName = $NewFolderName<br />
        $NewFolder.FolderClass = "IPF.Note"</p>
<p>        # Bind to the MsgFolderRoot folder<br />
		$folderid= new-object Microsoft.Exchange.WebServices.Data.FolderId([Microsoft.Exchange.WebServices.Data.WellKnownFolderName]::MsgFolderRoot,$MailboxName)<br />
		$EWSParentFolder = [Microsoft.Exchange.WebServices.Data.Folder]::Bind($service,$folderid)</p>
<p>		#Define Folder Veiw Really only want to return one object<br />
		$fvFolderView = new-object Microsoft.Exchange.WebServices.Data.FolderView(1)<br />
		#Define a Search folder that is going to do a search based on the DisplayName of the folder<br />
		$SfSearchFilter = new-object Microsoft.Exchange.WebServices.Data.SearchFilter+IsEqualTo([Microsoft.Exchange.WebServices.Data.FolderSchema]::DisplayName,$NewFolderName)<br />
		#Do the Search<br />
		$findFolderResults = $service.FindFolders($EWSParentFolder.Id,$SfSearchFilter,$fvFolderView)<br />
		if ($findFolderResults.TotalCount -eq 0){<br />
		    Write-host ("Folder Doesn't Exist") -ForegroundColor Yellow<br />
			$NewFolder.Save($EWSParentFolder.Id)<br />
			Write-host ("Folder Created") -ForegroundColor Green<br />
		}<br />
		else{<br />
		    Write-error ("Folder already Exist with that Name")<br />
		}  </p>
<p>	 }<br />
}</p>
<p># Define tenant credentials<br />
$Credentials = Get-Credential</p>
<p># Define mailboxes that need the archive folder created<br />
# Get all mailboxes<br />
$Mailboxes = Get-Mailbox -ResultSize Unlimited | Where-Object {$_.Name -notlike "DiscoverySearchMailbox*"}</p>
<p># Or import a list of mailboxes from .txt<br />
# $Mailboxes = Get-Content C:\Temp\Mailboxes.txt</p>
<p># Create the folder<br />
ForEach ($MailboxName in $Mailboxes) {<br />
    Write-host "Processing $MailboxName" -ForegroundColor Yellow<br />
    Create-Folder -MailboxName $MailboxName.PrimarySmtpAddress -NewFolderName Archive -Credentials $Credentials<br />
    }<br />
[/powershell]</p>
<p align="left">Once the &lsquo;Archive&rsquo; folder has been created, it will become the destination for all messages that are selected when the &lsquo;Archive&rsquo; button is clicked.</p>
<p align="left">A word of caution: If you have a large number of mailboxes, you may run into throttling issues if you attempt to do this on all mailboxes at the same time so it is definitely worth considering a phased rollout in larger environments.</p>
<p align="left">Glen has some great stuff <a href="http://gsexdev.blogspot.com" target="_blank">on his blog so be sure to check it out here</a>.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Automating archive folder creation in Exchange Online mailboxes&p[summary]=If you are using Outlook 2016 on Windows or Mac you will have noticed the recent addition of a one-click &lsquo;Archive&rsquo; button to ...&p[url]=http://172.16.7.177:4000/2016/07/automating-archive-folder-creation-in-exchange-online-mailboxes" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2016/07/automating-archive-folder-creation-in-exchange-online-mailboxes&text=If you are using Outlook 2016 on Windows or Mac you will have noticed the recent addition of a one-click &lsquo;Archive&rsquo; button to ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2016-01-27T09:20:39-06:00" itemprop="datePublished">27 Jan, 2016</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2016/01/how-to-create-a-remote-office-365-mailbox-in-a-hybrid-deployment">How to create a remote &ldquo;Office 365&rdquo; mailbox  in a hybrid deployment</a></h2>
    </header>

    <div class="post-content">
        <p>I&rsquo;ve recently seen the same issue pop up in a few different environments so I thought I would put together a short post that explains how to create a &ldquo;Office 365&rdquo; mailbox when using a hybrid deployment of Exchange. One of the questions I&rsquo;ve had had answer a few times recently is &ldquo;Why do newly created Exchange Online mailboxes not appear in the on-premises Exchange Admin Center as &ldquo;Office 365&rdquo; mailboxes like migrated mailboxes do?&rdquo;</p>
<p>There appears to be some confusion around provisioning of new user mailboxes once a hybrid deployment has been configured as this issue is caused when the mailbox has not be correctly provisioned in the on-premises environment.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2016/01/cap3.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="cap3" src="http://www.cgoosen.com/wp-content/uploads/2016/01/cap3_thumb.png" alt="cap3" width="725" height="314" border="0" /></a></p>
<p>While it is technically possible to create a new user account in Active Directory, wait for AAD Connect to provision that account to AAD and then assign an Exchange Online license to that user to create their mailbox, but the problem with that process is that it does not set the msExchRecipientType (and other) Exchange related attributes for that user object and that is why it will never appear in the on-premises Exchange Admin Center:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2016/01/cap2.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="cap2" src="http://www.cgoosen.com/wp-content/uploads/2016/01/cap2_thumb.png" alt="cap2" width="344" height="456" border="0" /></a></p>
<p align="left">In order to correctly popular these attributes, you either need to create the new user and mailbox via the Exchange Admin Center by clicking on the &ldquo;+&rdquo; icon and selecting &ldquo;Office 365 Mailbox&rdquo; or you need to enable a remote mailbox for a previously created user using the <em>Enable-RemoteMailbox </em>cmdlet</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2016/01/cap4.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="cap4" src="http://www.cgoosen.com/wp-content/uploads/2016/01/cap4_thumb.png" alt="cap4" width="345" height="131" border="0" /></a></p>
<p align="left">Many organizations already have automated provisioning processes in place so adjusting the mailbox enablement workflow may be the preferred method, an example of the cmdlet is shown below:</p>
<p>[powershell]<br />
#Syntax is: Enable-RemoteMailbox <user> &ndash;RemoteRoutingAddress <user@tenant.mail.onmicrosoft.com><br />
Enable-RemoteMailbox homer -RemoteRoutingAddress homer@gooselabs.mail.onmicrosoft.com<br />
[/powershell]</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2016/01/cap1.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="cap1" src="http://www.cgoosen.com/wp-content/uploads/2016/01/cap1_thumb.png" alt="cap1" width="694" height="240" border="0" /></a></p>
<p align="left">The <em>Enable-RemoteMailbox </em>cmdlet can be run immediately after creating the user account in Active Directory so there is no need to wait for the next AAD Connect synchronization cycle to complete before enabling the mailbox. Once the user account has been provisioned to AAD, the mailbox will automatically created and the appropriate license should then be assigned to the user.</p>
<p align="left">More information on the <em>Enable-RemoteMailbox</em> cmdlet can be <a href="https://technet.microsoft.com/en-us/library/ff607313%28v=exchg.160%29.aspx" target="_blank">found on TechNet here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=How to create a remote &ldquo;Office 365&rdquo; mailbox  in a hybrid deployment&p[summary]=I&rsquo;ve recently seen the same issue pop up in a few different environments so I thought I would put together a short post that explai...&p[url]=http://172.16.7.177:4000/2016/01/how-to-create-a-remote-office-365-mailbox-in-a-hybrid-deployment" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2016/01/how-to-create-a-remote-office-365-mailbox-in-a-hybrid-deployment&text=I&rsquo;ve recently seen the same issue pop up in a few different environments so I thought I would put together a short post that explai...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2015-11-30T11:27:35-06:00" itemprop="datePublished">30 Nov, 2015</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2015/11/exchange-hybrid-deployment-and-sizing">Exchange Hybrid Deployment and Sizing</a></h2>
    </header>

    <div class="post-content">
        <p>In September, I posted about the great new Office 365 Hybrid Configuration Wizard and while there is no question that the HCW is a great help when configuring hybrid deployments, there are a few other important considerations to take into account when deploying Exchange Hybrid. I've helped many organizations deploy hybrid configurations and move mailboxes to the cloud over the last few years and often to come across the same questions and misconceptions, so I thought I'd address some of these in a blog post.</p>
<p><strong></strong>&nbsp;</p>
<p><strong>"Help!, I need to implement a hybrid server!"<br></strong>That is not necessarily true, Exchange Hybrid is a configuration state and should not be thought of as a server role. A Hybrid deployment uses existing Exchange workloads like Autodiscover and Exchange Web Services (EWS) so if you already have Exchange 2010/2013/2016 deployed according to best practices then chances are you already have everything you need to configure Exchange Hybrid. Sure, there is some additional functionality available if you use the most recent version of Exchange, but do you need that functionality? I've seen so many environments that have correctly sized and load balanced Exchange servers and then have a tiny virtual machine deployed as a "hybrid server". This type of configuration creates a single point of failure and inevitably becomes a migration bottleneck.</p>
<p>If you are looking to migrate from a legacy version of Exchange then you will need to implement additional servers in order to deploy Hybrid. For Exchange 2003 your only option for going hybrid is to deploy a correctly sized Exchange 2010 deployment. For those on Exchange 2007 it is recommended that Exchange 2013 is used instead.</p>
<p><strong></strong>&nbsp;</p>
<p><strong>"Can I virtualize my servers for Hybrid?"</strong> or <strong>"How do I size my servers for Hybrid?"</strong><br>If you are in a position where you are looking to upgrade your Exchange Organization prior to a migration to Exchange Online or you need to implement new Exchange servers because you are on a legacy version, you can definitely make use of virtualization. Virtualization in the Exchange world has long been a hot topic and isn&rsquo;t really something that I&rsquo;ll get into in this post. In my experience, incorrectly configured or undersized virtual Exchange servers are by far the most common issue I&rsquo;ve come across in the field so it is often simpler to use physical hardware which is also the recommended practice.</p>
<p>To illustrate this, here is an example of some actual performance data I gathered when working with a customer. This particular customer was migrating from Exchange 2007 and had implemented virtual Exchange 2013 servers. Everything worked great until they attempted to migrate several mailboxes at the same time and they noticed that it was taking a considerable amount of time for small mailboxes to migrate. After confirming that the issue wasn&rsquo;t bandwidth related we decided to take a closer look at the new virtual servers. These servers sized with 4 CPU cores and 32 GB of RAM but didn&rsquo;t appear to be performing correctly. Our initial performance tests indicated that the servers seemed to be CPU constrained and after a lot of testing and much discussion with their virtualization team we found that simply changing the configuration from 2 sockets with 2 cores each (4 cores total) to 1 socket with 4 cores (still 4 cores) greatly improved the performance. The same 100 mailboxes were used in both tests:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/11/CPU1.png"><img title="CPU" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="CPU" src="http://www.cgoosen.com/wp-content/uploads/2015/11/CPU_thumb1.png" width="873" height="320"></a></p>
<p align="left">If you are planning to virtualize, make sure you follow <a href="http://download.microsoft.com/download/4/a/c/4ac32fd3-220e-45dc-aa97-dbdbe19c15b2/best_practices_for_virtualizing_and_managing_exchange_2013.pdf" target="_blank">Microsoft&rsquo;s best practices for virtualizing Exchange</a> and always use the <a href="http://blogs.technet.com/b/exchange/archive/2013/05/14/released-exchange-2013-server-role-requirements-calculator.aspx" target="_blank">Exchange Server Role Requirements Calculator</a> to correctly size your deployments.</p>
<p><strong></strong>&nbsp;</p>
<p><strong>"The cloud is awesome, I plan to remove all my on-premises Exchange servers!"</strong><br>There is no denying that moving to the cloud makes sense for a lot of organizations and in many instances there is a desire to remove all on-premises workloads. I always advise my customers to be very careful when it comes to decommissioning their entire Exchange Organization. When using directory synchronization with your Office 365 tenant, your users are synchronized from your on-premises Active Directory and therefore most of the attributes associated with these users cannot be managed in Office 365 or Exchange Online and must be managed on-premises. Completely removing your on-premises Exchange Organization makes managing mailbox attributes more difficult so I would definitely recommend retaining at least one Exchange server for user object management. You don&rsquo;t need to retain all your Exchange servers though, so I many environments there will still be a significant reduction in servers.</p>
<p>Retaining an on-premises Exchange server could also be really useful in SMTP relay scenarios where you have on-premises applications and devices that need to send email.</p>
<p>Microsoft also has a lot in great resources available to help answer your Hybrid questions, here are a few:</p>
<ul>
<li><a href="http://blogs.technet.com/b/exchange/archive/2015/08/10/hybrid-deployment-best-practices.aspx" target="_blank">Hybrid Deployment Best Practices</a></li>
<li><a href="http://blogs.technet.com/b/exchange/archive/2012/12/05/decommissioning-your-exchange-2010-servers-in-a-hybrid-deployment.aspx" target="_blank">Decommissioning your Exchange 2010 servers in a Hybrid Deployment</a></li>
<li><a href="https://technet.microsoft.com/en-us/library/dn931280(v=exchg.150).aspx" target="_blank">How and when to decommission your on-premises Exchange servers in a Hybrid Deployment</a></li>
<li><a href="https://technet.microsoft.com/en-us/library/jj619301(v=exchg.160).aspx" target="_blank">Exchange 2016 Virtualization</a></li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange Hybrid Deployment and Sizing&p[summary]=In September, I posted about the great new Office 365 Hybrid Configuration Wizard and while there is no question that the HCW is a great ...&p[url]=http://172.16.7.177:4000/2015/11/exchange-hybrid-deployment-and-sizing" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2015/11/exchange-hybrid-deployment-and-sizing&text=In September, I posted about the great new Office 365 Hybrid Configuration Wizard and while there is no question that the HCW is a great ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2015-09-16T07:42:22-05:00" itemprop="datePublished">16 Sep, 2015</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2015/09/a-look-at-the-microsoft-office-365-hybrid-configuration-wizard">A look at the Microsoft Office 365 Hybrid Configuration Wizard</a></h2>
    </header>

    <div class="post-content">
        <p>In case you missed it, <a href="http://blogs.technet.com/b/exchange/archive/2015/09/04/introducing-the-microsoft-office-365-hybrid-configuration-wizard.aspx" target="_blank">Microsoft recently announced the</a> Microsoft Office 365 Hybrid Configuration Wizard (HCW). The HCW has come a long way since it was first introduced in Exchange 2010 SP2, prior to that configuring a hybrid deployment required ~50 manual steps. This is the third version of the HCW and one of the most notable changes is that it is a standalone application which decouples it from the Exchange update cycle. The HCW will download the latest version every time it is run which will ensure that the latest version is always used.</p>
<p>The new HCW is available for use with Exchange 2013 CU8 or higher, however you will need to have <a href="https://support.microsoft.com/en-us/kb/3078678" target="_blank">Exchange 2013 CU10</a> installed if you would like see the new HCW landing page (pictured below) which is accessible via the &ldquo;Hybrid&rdquo; menu item in your on-premises Exchange Admin Center:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/09/cap1.png"><img title="cap1" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="cap1" src="http://www.cgoosen.com/wp-content/uploads/2015/09/cap1_thumb.png" width="859" height="251"></a></p>
<p align="left">Those using Exchange 2013 CU8 or CU9 <a href="http://aka.ms/TAPHCW" target="_blank">can download the new HCW here</a>.</p>
<p align="left">The wizard itself with take you through a series of configuration pages very similar to the pervious version, however there are improvements to error handling and a number of changes under the covers that greatly improve performance and efficiency.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/09/cap2.png"><img title="cap2" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="cap2" src="http://www.cgoosen.com/wp-content/uploads/2015/09/cap2_thumb.png" width="560" height="518"></a></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/09/cap12.png"><img title="cap12" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="cap12" src="http://www.cgoosen.com/wp-content/uploads/2015/09/cap12_thumb.png" width="560" height="516"></a></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/09/cap13.png"><img title="cap13" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="cap13" src="http://www.cgoosen.com/wp-content/uploads/2015/09/cap13_thumb.png" width="560" height="516"></a></p>
<p align="left">It is worth noting that the log file location has changed from &ldquo;%ProgramFiles%\Microsoft\Exchange Server\V15\Logging\Update-HybridConfiguration&rdquo;&nbsp; to &ldquo;%AppData%\Microsoft\Exchange Hybrid Configuration&rdquo;</p>
<p align="left">The Exchange Team has a detailed post about all the great new features in the Microsoft Office 365 Configuration Wizard, <a href="http://blogs.technet.com/b/exchange/archive/2015/09/04/introducing-the-microsoft-office-365-hybrid-configuration-wizard.aspx" target="_blank">I'd encourage you to check it out here.</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=A look at the Microsoft Office 365 Hybrid Configuration Wizard&p[summary]=In case you missed it, Microsoft recently announced the Microsoft Office 365 Hybrid Configuration Wizard (HCW). The HCW has come a long w...&p[url]=http://172.16.7.177:4000/2015/09/a-look-at-the-microsoft-office-365-hybrid-configuration-wizard" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2015/09/a-look-at-the-microsoft-office-365-hybrid-configuration-wizard&text=In case you missed it, Microsoft recently announced the Microsoft Office 365 Hybrid Configuration Wizard (HCW). The HCW has come a long w...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2015-07-31T06:26:32-05:00" itemprop="datePublished">31 Jul, 2015</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2015/07/my-get-azcopygui-ps1-script-has-been-updated">My Get-AZCopyGUI.ps1 script has been updated</a></h2>
    </header>

    <div class="post-content">
        <p><a title="Script: Get-AZCopyGUI.ps1 &ndash; AZCopy GUI for PST Import" href="http://www.cgoosen.com/2015/05/script-get-azcopygui-ps1/">At the end of May</a>, I published my Get-AZCopyGUI.ps1 script which is&nbsp;a&nbsp;simple GUI wrapper for AZCopy.exe and helps simplify the process of importing .PSTs into Exchange Online. Today I published an updated version of the script which fixes a small bug and provides some additional functionality. The GUI now includes the following new options:</p>
<ul>
<li>The ability to use /Pattern switch - It will automatically be set&nbsp;to *.PST</li>
<li>The ability to choose a custom log&nbsp;location. If &nbsp;no location is selected,&nbsp;a log file is named AzCopyVerbose.log will be created in the default location which is %LocalAppData%\Microsoft\Azure\AzCopy</li>
</ul>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2015/05/Capture.png"><img class="aligncenter wp-image-1395" src="http://www.cgoosen.com/wp-content/uploads/2015/05/Capture-300x221.png" alt="Get-AzcopyGUI" width="523" height="386" /></a></p>
<p style="text-align: left;">For more information about&nbsp;Get-AZCopyGUI.ps1, <a title="Script: Get-AZCopyGUI.ps1 &ndash; AZCopy GUI for PST Import" href="http://www.cgoosen.com/2015/05/script-get-azcopygui-ps1/" target="_blank">see this post</a>.&nbsp;I have published it to the TechNet Gallery, <a href="http://cgoo.se/1Qnxtfg" target="_blank">it can be downloaded by clicking here&hellip;</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=My Get-AZCopyGUI.ps1 script has been updated&p[summary]=At the end of May, I published my Get-AZCopyGUI.ps1 script which is&nbsp;a&nbsp;simple GUI wrapper for AZCopy.exe and helps simplify the ...&p[url]=http://172.16.7.177:4000/2015/07/my-get-azcopygui-ps1-script-has-been-updated" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2015/07/my-get-azcopygui-ps1-script-has-been-updated&text=At the end of May, I published my Get-AZCopyGUI.ps1 script which is&nbsp;a&nbsp;simple GUI wrapper for AZCopy.exe and helps simplify the ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2015-05-30T10:30:53-05:00" itemprop="datePublished">30 May, 2015</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2015/05/script-get-azcopygui-ps1">Script: Get-AZCopyGUI.ps1 - AZCopy GUI for PST Import</a></h2>
    </header>

    <div class="post-content">
        <p>Microsoft <a href="http://blogs.office.com/2015/05/07/making-email-archive-migration-easier-with-the-office-365-import-service/" target="_blank">recently announced the new Office 365 Import Service</a> which is currently in preview. The new service allows organizations to import legacy PST data using one of two methods:</p>
<ul>
<li>Drive shipping &ndash; you send Microsoft a hard drive with your data.</li>
<li>Network Upload &ndash; you make use of Azure storage to upload your data to Office 365.</li>
</ul>
<p>The network upload option makes use of the Microsoft Azure AZCopy tool which uploads your data to an Azure storage blob. <a href="http://www.c7solutions.com/2015/05/using-office-365-pst-ingestion-service" target="_blank">Brian Reid has a great post on his blog about using the service.</a></p>
<p>Get-AZCopyGUI.ps1 is a GUI wrapper for the Microsoft Azure AZCopy tool (AZCopy.exe) to simplify the process of importing .PSTs into Exchange Online. To use the script, you need to locate your storage account key and upload URL. You can do this by accessing the &ldquo;Import&rdquo; menu item in the Office 365 Admin Center. To access this option, you need to be assigned the Mailbox Import Export role in Exchange Online.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/06/post1.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="post1" src="http://www.cgoosen.com/wp-content/uploads/2015/06/post1_thumb.png" alt="post1" width="533" height="453" border="0" /></a></p>
<p align="left">For more information on the Office 365 Import Service, <a href="https://technet.microsoft.com/en-us/library/dn948519%28v=exchg.150%29.aspx" target="_blank">see the following TechNet documentation.</a></p>
<p><strong>Requirements:</strong></p>
<ul>
<li>The script will work natively in PowerShell 2.0+</li>
<li>The script requires the Microsoft Azure AZCopy Tool with default installation path - <a href="http://aka.ms/downloadazcopy">get it here</a></li>
</ul>
<p><strong>Usage:</strong><br />
There are no parameters or switches, simply execute the script:</p>
<p>[shell].\Get-AZCopyGUI.ps1[/shell]</p>
<p>When using the Verbose option, a log file is named AzCopyVerbose.log will be created in %LocalAppData%\Microsoft\Azure\AzCopy if no "Log Location" is specified.</p>
<p><strong>Execution Policy:<br />
</strong>The script has been digitally signed and will run just fine under a "RemoteSigned" execution policy.</p>
<p><strong>Screenshots:</strong></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/05/Capture.png"><img class="aligncenter  wp-image-1395" src="http://www.cgoosen.com/wp-content/uploads/2015/05/Capture-300x221.png" alt="Get-AzcopyGUI" width="526" height="387" /></a></p>
<p><strong>Download:<br />
</strong>I have published it to the TechNet Gallery, <a href="http://cgoo.se/1Qnxtfg" target="_blank">it can be downloaded by clicking here...</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Script: Get-AZCopyGUI.ps1 - AZCopy GUI for PST Import&p[summary]=Microsoft recently announced the new Office 365 Import Service which is currently in preview. The new service allows organizations to imp...&p[url]=http://172.16.7.177:4000/2015/05/script-get-azcopygui-ps1" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2015/05/script-get-azcopygui-ps1&text=Microsoft recently announced the new Office 365 Import Service which is currently in preview. The new service allows organizations to imp...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2015-02-24T03:00:00-06:00" itemprop="datePublished">24 Feb, 2015</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2015/02/using-a-certificate-to-encrypt-credentials-in-automated-powershell-scripts">Using a certificate to encrypt credentials in automated PowerShell scripts</a></h2>
    </header>

    <div class="post-content">
        <p>PowerShell is a great way to help automate frequent or repetitive tasks and every now and then these tasks require some form of authentication. You could just store the service account password in the script, but I&rsquo;m really not a fan of doing that and I&rsquo;m sure you&rsquo;d agree it really isn&rsquo;t a very good way to do it. I was working on a script recently which was to be scheduled to run at various times by different service accounts on different servers so I wanted a way to ensure that a single copy of the script could be portable to any server and would still securely connect to Exchange with the correct permissions no matter which service account actually executed the script. Remotely connecting to Exchange/Exchange Online via PowerShell isn&rsquo;t difficult to do and you could just use <em>Get-Credential</em> cmdlet with <em>ConvertFrom-SecureString</em> and <em>Set-Content </em>to securely save your password to file which could then be read by your script without subsequent intervention. The trouble with this solution is that it isn&rsquo;t very portable and that password can only be ready by the user that created the file so it will work great if you used it only on your own machine, but not so well when trying to distribute it to a bunch of servers as a scheduled job. I wanted a solution that would use a particular certificate to decrypt a password stored in the script, in that way if the script was executed on a machine that did not have my certificate installed it would not be able to decrypt the password and would fail. I ended up creating an encrypted password using the public key of a certificate and storing that in the script, the only way to decrypt that password is with the private key of the same certificate. Let&rsquo;s look at this in more detail.</p>
<p>The first component of the solution is a certificate. Since I already had access to a internal Windows CA, I wanted to use a certificate signed by that CA but I also tested it with a self-signed certificate that was generated using &ldquo;makecert.exe&rdquo;. <span style="background-color: #ffffff;">PowerShell 4.0 </span>includes a <a href="https://technet.microsoft.com/en-us/library/hh848633.aspx" target="_blank"><em>New-SelfSignedCertificate</em></a> cmdlet that makes generating a self-signed certificate really easy, but for some reason I wasn&rsquo;t able to use one of those certificates for encryption (more specifically the decryption would not work) and since I planned to use a CA signed certificate anyway I didn&rsquo;t spend a whole lot of time trying to figure it out. The key thing to remember is that you need to install the certificate AND the private key, the certificate doesn&rsquo;t have to be trusted. I decided to create a new certificate template for my &ldquo;Script Authentication&rdquo; certificate by duplicating the &ldquo;Web Server&rdquo; template and making a few changes to it.</p>
<p align="left">Firstly, launch the <span style="background-color: #ffffff;">Certification Authority MMC</span><span style="background-color: #ffffff;">, loca</span>te &ldquo;Certificate Templates&rdquo;, right-click and select &ldquo;Manage&rdquo;</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture1.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture1" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture1_thumb.png" alt="Capture1" width="450" height="294" border="0" /></a></p>
<p>Next, locate the &ldquo;Web Server&rdquo; template, right-click and select &ldquo;Duplicate Template&rdquo;</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture2.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture2" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture2_thumb.png" alt="Capture2" width="450" height="169" border="0" /></a></p>
<p align="left">I called my new template &ldquo;Script Authentication&rdquo;</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture3.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture3" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture3_thumb.png" alt="Capture3" width="504" height="686" border="0" /></a></p>
<p align="left">And you need to ensure that you &ldquo;Allow private key to be exported&rdquo;. Once done, apply those changes.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture4.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture4" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture4_thumb.png" alt="Capture4" width="504" height="686" border="0" /></a></p>
<p align="left">We then need to <span style="background-color: #ffffff;">publish the new template</span> to ensure that it can be used when requesting a new certificate. <span style="background-color: #ffffff;">Right-click</span> &ldquo;Certificate Templates&rdquo;, select &ldquo;New&rdquo; and then &ldquo;Certificate Template to Issue&rdquo; and select your newly created template from the list</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture5.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture5" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture5_thumb.png" alt="Capture5" width="550" height="353" border="0" /></a></p>
<p align="left">Once done, you should be able to create and submit an advanced certificate request using the newly created template directly on your CA. You are not required to complete all the fields, but it is useful to give your certificate a descriptive name. I called mine &ldquo;PowerShell Automation&rdquo;.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture6.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture6" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture6_thumb.png" alt="Capture6" width="550" height="810" border="0" /></a></p>
<p>Once you have the installed the certificate, you can export it (don&rsquo;t forget the private key) for use on other machines.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture8.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture8" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture8_thumb.png" alt="Capture8" width="550" height="529" border="0" /></a></p>
<p>I recommend storing it in a safe place and not marking the private key as exportable when moving it around, in this way you have some control over which machines can actually decrypt the password in your script.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture9.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture9" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture9_thumb.png" alt="Capture9" width="550" height="529" border="0" /></a></p>
<p>Here&rsquo;s what my certificate looks like</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture7.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture7" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture7_thumb.png" alt="Capture7" width="500" height="622" border="0" /></a></p>
<p>I decided to store my certificate in the computer store, it probably doesn&rsquo;t matter where you store it but you would need to update the following PowerShell cmdlets appropriately. If you are going to have multiple service accounts executing your script, you need to ensure that all these accounts have permission<span style="background-color: #ffff00;"><span style="background-color: #ffffff;"> to read the private key. </span></span><span style="background-color: #ffffff;">This</span> is done by right-clicking the certificate, selecting &ldquo;All Tasks&rdquo; and then &ldquo;Manage Private Keys&rdquo;.</p>
<p>We can use the <em>Get-ChildItem</em> cmdlet to locate our certificate:</p>
<p>[powershell]Get-ChildItem Cert:\LocalMachine\My | Where-Object {$_.Subject -like "CN=PowerShell Automation*"}[/powershell]</p>
<p>Next, I need to encrypt my password. To do this, I define the password as a variable, encode it and then encrypt the encoded password using my certificate&rsquo;s public key:</p>
<p>[powershell]<br />
$Cert = Get-ChildItem Cert:\LocalMachine\My | Where-Object {$_.Subject -like "CN=PowerShell Automation*"}<br />
$Password = 'MyPassword'<br />
$EncodedPwd = [system.text.encoding]::UTF8.GetBytes($Password)<br />
$EncryptedBytes = $Cert.PublicKey.Key.Encrypt($EncodedPwd, $true)<br />
$EncryptedPwd = [System.Convert]::ToBase64String($EncryptedBytes)<br />
[/powershell]</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture10.png"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="Capture10" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture10_thumb.png" alt="Capture10" width="550" height="195" border="0" /></a></p>
<p>Now that I have the encrypted password, I can store it in my script and decode it using my certificate&rsquo;s private key each time the script is executed. To do this, I pretty much reverse the process:</p>
<p>[powershell]<br />
$EncryptedPwd = "ts32rCLLdZl3/6wINHtLD6bQO65ub&hellip;.. <shortened for simplicity>"<br />
$EncryptedBytes = [System.Convert]::FromBase64String($EncryptedPwd)<br />
$DecryptedBytes = $Cert.PrivateKey.Decrypt($EncryptedBytes, $true)<br />
$DecryptedPwd = [system.text.encoding]::UTF8.GetString($DecryptedBytes)<br />
[/powershell]</p>
<p>You can build this into any scripts you have that currently require credentials, it works great for automating Office 365/Exchange Online scripting. To illustrate this, I put together a quick (and dirty!) script that can be used to provide an automated daily &ldquo;Top Mail Recipient&rdquo; report via email. This script can be scheduled to run daily and it will connect to Exchange Online, generate a list of the top mail recipients and email that report to the address you specify. It&rsquo;s not very useful as it is, but it does show how easily you could automate things using PowerShell and serves as a great example for certificate password encryption.</p>
<p>[powershell]<br />
# Function to create report email<br />
function SendReport{<br />
 $Msg = New-Object Net.Mail.MailMessage<br />
 $Smtp = New-Object Net.Mail.SmtpClient($ExchangeServer)<br />
 $Msg.From = $FromAddress<br />
 $Msg.To.Add($ToAddress)<br />
 $Msg.Subject = "Top Mail Recipient Report for $Date"<br />
 $Msg.Body = $EmailBody<br />
 $Msg.IsBodyHTML = $true<br />
 $Smtp.Send($Msg)<br />
}</p>
<p># Define local Exchange server info for message relay. Ensure that any servers running this script have permission to relay.<br />
$ExchangeServer = "yourexchange.domain.com"<br />
$FromAddress = "Office 365 Reports <reports@yourdomain.com>"<br />
$ToAddress = "you@yourdomain.com"</p>
<p># Some basic HTML styling<br />
$Header = "<br />
<style>"<br />
$Header = $Header + "BODY{background-color:#FFFFFF}"<br />
$Header = $Header + "TABLE{border-width: 1px;border-style: solid;border-color: black;border-collapse: collapse;}"<br />
$Header = $Header + "TH{border-width: 1px;padding: 0px;border-style: solid;border-color: black;background-color:#BDBDBD}"<br />
$Header = $Header + "TD{border-width: 1px;padding: 0px;border-style: solid;border-color: black}"<br />
$Header = $Header + "</style>
<p>"</p>
<p># Connect to Exchange Online<br />
# First decrypt the password using the certificate<br />
$Cert = Get-ChildItem Cert:\LocalMachine\My | Where-Object {$_.Subject -like "CN=PowerShell Automation*"}<br />
$EncryptedPwd = "ts32rCLLdZl3/6wINHtLD6bQO65ubeQ3sHj9zXbhsaQDjihQmdyoja+iL0NGXQX0DicQdXWQRu+P8dSy96ux1tLQR9ZT8WPRq8rHsR3gNXDmipCK/4CHoc5Ki7nbMKUSReprtIrnwjlXZNBocTzurBQ+LtAHvAYipD37AXVjjpwwwqud5HCXk+E4OrJGe+yIx/87neRAunqdKvyuaxUYaxeBdx2R/hpLZhxywinjjVMx+0N2RNk7H3fBEite7uuANcAg+ElAssi4DAQYYDOviIrvbjdpKogKcevAh5xEx4Wm2WBzM5XqXmj1O9TUzB9BOiUVQhDwwqCcUpb2bTNW7g=="<br />
$EncryptedBytes = [System.Convert]::FromBase64String($EncryptedPwd)<br />
$DecryptedBytes = $Cert.PrivateKey.Decrypt($EncryptedBytes, $true)<br />
$DecryptedPwd = [system.text.encoding]::UTF8.GetString($DecryptedBytes) | ConvertTo-SecureString -AsPlainText -Force<br />
# Then define Credentials and create session<br />
$Username = "account@yourdomain.onmicrosoft.com"<br />
$Credential = New-Object System.Management.Automation.PSCredential ($Username,$DecryptedPwd)<br />
$Session = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri https://outlook.office365.com/powershell-liveid/ -Credential $Credential -Authentication Basic -AllowRedirection<br />
Import-PSSession $Session</p>
<p># Generate report data<br />
$Date = Get-Date -DisplayHint Date<br />
$EmailBody = Get-MailTrafficSummaryReport -Category TopMailRecipient | select @{expression={$_.C1};label=&rdquo;User&rdquo;}, @{expression={$_.C2};label=&rdquo;Item Count&rdquo;} | ConvertTo-HTML -head $Header -body "<H2>Top Mail Recipient Report</H2>"</p>
<p># Send report<br />
SendReport<br />
[/powershell]</p>
<p>Here is an example of what the final result looks like:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture11.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="Capture11" src="http://www.cgoosen.com/wp-content/uploads/2015/02/Capture11_thumb.png" alt="Capture11" width="600" height="448" border="0" /></a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Using a certificate to encrypt credentials in automated PowerShell scripts&p[summary]=PowerShell is a great way to help automate frequent or repetitive tasks and every now and then these tasks require some form of authentic...&p[url]=http://172.16.7.177:4000/2015/02/using-a-certificate-to-encrypt-credentials-in-automated-powershell-scripts" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2015/02/using-a-certificate-to-encrypt-credentials-in-automated-powershell-scripts&text=PowerShell is a great way to help automate frequent or repetitive tasks and every now and then these tasks require some form of authentic...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2015-01-21T04:06:49-06:00" itemprop="datePublished">21 Jan, 2015</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2015/01/mail-protection-reports-for-office-365">Mail Protection Reports for Office 365</a></h2>
    </header>

    <div class="post-content">
        <p>One of the great things about Office 365 is how flexible the service is, it caters to those organizations who are looking for a service that just works out of the box as well as those who are looking to get stuck in there and really take things to the next level. A perfect example of this is a recent experience I had with one of my customers. This particular customer was looking to do some specific email reporting and after discussing their options, I thought it would be a good idea to put together this post.</p>
<p>There are a number of options available when it comes to reporting in Office 365. Firstly, the Office 365 admin center provides a number of pre-configured reports and while these are gorgeous looking reports, they may not always provide the level of detail you are looking for. You also have the option of rolling your own with the <a href="https://msdn.microsoft.com/EN-US/library/office/jj984342(v=office.15).aspx" target="_blank">Office 365 Reporting web service</a> but this requires some coding and depending on your requirements may end up being overkill. There is however a great option that falls nicely in the middle of these in the form of an Excel based reporting workbook called <a href="http://www.microsoft.com/en-us/download/details.aspx?id=30716" target="_blank">&ldquo;Mail Protection Reports for Office 365&rdquo;.</a> This reporting workbook isn&rsquo;t new, I remember first using it in a demo for an EOP session I presented at Office 365 Ignite in Sydney, Australia in late 2013 so it has been around for a while, but I&rsquo;m surprised how little press it gets.</p>
<p>The workbook allows you to query specific date ranges and you can then filter and customize how the information is displayed. It provides spam, malware, transport rule and DLP reporting. Here are some examples:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/01/cap1.png"><img class="aligncenter size-full wp-image-1275" src="http://www.cgoosen.com/wp-content/uploads/2015/01/cap1.png" alt="cap1" width="425" height="211" /></a> <a href="http://www.cgoosen.com/wp-content/uploads/2015/01/cap2.png"><img class="aligncenter size-full wp-image-1276" src="http://www.cgoosen.com/wp-content/uploads/2015/01/cap2.png" alt="cap2" width="1191" height="555" /></a> <a href="http://www.cgoosen.com/wp-content/uploads/2015/01/cap3.png"><img class="aligncenter size-full wp-image-1277" src="http://www.cgoosen.com/wp-content/uploads/2015/01/cap3.png" alt="cap3" width="1178" height="758" /></a> <a href="http://www.cgoosen.com/wp-content/uploads/2015/01/cap4.png"><img class="aligncenter size-full wp-image-1278" src="http://www.cgoosen.com/wp-content/uploads/2015/01/cap4.png" alt="cap4" width="1133" height="816" /></a></p>
<p align="left">The reporting workbook ended up being a perfect fit for their specific scenario. It is really simple to use and doesn&rsquo;t require the use of PowerShell or any custom coding. You can download the <a href="http://www.microsoft.com/en-us/download/details.aspx?id=30716" target="_blank">Mail Protection Reports for Office 365 workbook here.</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Mail Protection Reports for Office 365&p[summary]=One of the great things about Office 365 is how flexible the service is, it caters to those organizations who are looking for a service t...&p[url]=http://172.16.7.177:4000/2015/01/mail-protection-reports-for-office-365" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2015/01/mail-protection-reports-for-office-365&text=One of the great things about Office 365 is how flexible the service is, it caters to those organizations who are looking for a service t...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-12-09T07:54:23-06:00" itemprop="datePublished">9 Dec, 2014</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2014/12/exchange-updates-december-2014">Exchange Updates &ndash; December 2014</a></h2>
    </header>

    <div class="post-content">
        <p>Earlier today <a href="http://blogs.technet.com/b/exchange/archive/2014/12/09/exchange-releases-december-2014.aspx" target="_blank">Microsoft announced the release of Exchange 2013 CU7, Exchange 2010 SP3 RU8 and Exchange 2007 SP3 RU15.</a> In addition to fixes for customer reported issues and minor feature improvements they also include a security update to address elevation of privilege vulnerabilities in these versions of Exchange. More information about the vulnerabilities can be found in <a href="https://technet.microsoft.com/en-us/library/security/ms14-075.aspx" target="_blank">Microsoft Security Bulletin MS14-075.</a> Tony Redmond has also written a <a href="http://windowsitpro.com/blog/exchange-2013-cu7-debuts-along-security-fixes-and-updates-exchange-2010-and-exchange-2007" target="_blank">great post about Exchange 2013 CU7 here.</a></p>
<p>The updates can be downloaded at the following links:</p>
<ul>
<li><a href="http://www.microsoft.com/en-us/download/details.aspx?id=45221" target="_blank">Exchange Server 2013 Cumulative Update 7</a></li>
<li><a href="http://www.microsoft.com/en-us/download/details.aspx?id=45215" target="_blank">UM Language Packs for Cumulative Update 7</a></li>
<li><a href="http://www.microsoft.com/en-us/download/details.aspx?id=45225" target="_blank">Exchange Server 2010 SP3 Update Rollup 8</a></li>
<li><a href="http://www.microsoft.com/en-us/download/details.aspx?id=45269" target="_blank">Exchange Server 2007 SP3 Update Rollup 15</a></li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange Updates &ndash; December 2014&p[summary]=Earlier today Microsoft announced the release of Exchange 2013 CU7, Exchange 2010 SP3 RU8 and Exchange 2007 SP3 RU15. In addition to fixe...&p[url]=http://172.16.7.177:4000/2014/12/exchange-updates-december-2014" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2014/12/exchange-updates-december-2014&text=Earlier today Microsoft announced the release of Exchange 2013 CU7, Exchange 2010 SP3 RU8 and Exchange 2007 SP3 RU15. In addition to fixe...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-11-21T06:36:14-06:00" itemprop="datePublished">21 Nov, 2014</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2014/11/script-fix-proxyaddress-ps1">Script: Fix-ProxyAddress.ps1</a></h2>
    </header>

    <div class="post-content">
        <p><a href="http://www.cgoosen.com/2014/11/migrationpermanentexception-the-target-mailbox-doesnt-have-an-smtp-proxy-matching-company-mail-onmicrosoft-com/" target="_blank">I recently blogged about</a> the "<span style="color: #ff0000;"><em>MigrationPermanentException: The target mailbox doesn't have an SMTP proxy matching 'company.mail.onmicrosoft.com'.</em></span><span style="color: #000000;">" error message that occurs when attempting to perform a remote mailbox move for a user that doesn&rsquo;t have the correct SMTP proxy address. I put together a script to help simplify the process of adding the relevant SMTP proxy address to effected users.</span></p>
<p>Once launched, the script will prompt for your tenant routing domain in the format 'company.mail.onmicrosoft.com' and will search for all mailboxes in the organization that do not have an email address policy applied. A new SMTP proxy address will be added to all mailboxes without an email address policy. The proxy address will be based on the alias of the primary SMTP address and the routing domain entered, e.g if the primary SMTP address is john.smith@company.com and the routing domain entered is company.mail.onmicrosoft.com the resulting proxy address will be john.smith@company.mail.onmicrosoft.com.</p>
<p><strong>Requirements: </strong>This script has been tested and is known to work with Exchange 2010 and Exchange 2013.</p>
<p><strong>Usage:</strong> There are no parameters or switches, simply execute the script:</p>
<p>[shell].\Fix-ProxyAddress.ps1[/shell]</p>
<p><strong>Execution Policy: </strong>The script has been digitally signed and will run just fine under a "RemoteSigned" execution policy.</p>
<p><strong>Screenshots:</strong></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/11/script1.png"><img style="display: inline; border-width: 0px;" title="script1" src="http://www.cgoosen.com/wp-content/uploads/2014/11/script1_thumb.png" alt="script1" width="240" height="220" border="0" /></a></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/11/script2.png"><img style="display: inline; border-width: 0px;" title="script2" src="http://www.cgoosen.com/wp-content/uploads/2014/11/script2_thumb.png" alt="script2" width="476" height="167" border="0" /></a></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/11/script3.png"><img style="display: inline; border-width: 0px;" title="script3" src="http://www.cgoosen.com/wp-content/uploads/2014/11/script3_thumb.png" alt="script3" width="476" height="163" border="0" /></a></p>
<p><strong>Download: </strong>I have published it to the TechNet Gallery, <a href="http://cgoo.se/1xXvNCZ" target="_blank">it can be downloaded by clicking here...</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Script: Fix-ProxyAddress.ps1&p[summary]=I recently blogged about the "MigrationPermanentException: The target mailbox doesn't have an SMTP proxy matching 'company.mail.onmicroso...&p[url]=http://172.16.7.177:4000/2014/11/script-fix-proxyaddress-ps1" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2014/11/script-fix-proxyaddress-ps1&text=I recently blogged about the "MigrationPermanentException: The target mailbox doesn't have an SMTP proxy matching 'company.mail.onmicroso...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-11-21T04:59:34-06:00" itemprop="datePublished">21 Nov, 2014</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2014/11/migrationpermanentexception-the-target-mailbox-doesnt-have-an-smtp-proxy-matching-company-mail-onmicrosoft-com">MigrationPermanentException: The target mailbox doesn't have an SMTP proxy matching 'company.mail.onmicrosoft.com'.</a></h2>
    </header>

    <div class="post-content">
        <p>One of the most common error message I find when performing mailbox moves to Office 365 &ndash; Exchange Online is the &ldquo;<font color="#ff0000"><em>MigrationPermanentException: The target mailbox doesn't have an SMTP proxy matching 'company.mail.onmicrosoft.com'.</em></font><font color="#000000"><em>&rdquo; </em>error:</font></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/11/Capture41.png"><img title="Capture4" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="Capture4" src="http://www.cgoosen.com/wp-content/uploads/2014/11/Capture4_thumb1.png" width="438" height="166"></a> </p>
<p align="left">The error message is pretty descriptive and is caused when the mailbox being moved doesn&rsquo;t have a proxy address that matches the routing domain. In an Exchange hybrid deployment, the hybrid configuration wizard updates the on-premises email address policies to ensure that all mailboxes have the relevant SMTP proxy address added. This should work fine except in instances when for whatever reason a mailbox or group of mailboxes are not being updated by an email address policy. Typically because the &ldquo;Automatically update email addresses based on the email address policy applied to this recipient&rdquo; has been manually removed:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/11/script41.png"><img title="script4" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="script4" src="http://www.cgoosen.com/wp-content/uploads/2014/11/script4_thumb1.png" width="347" height="259"></a> </p>
<p align="left">There are a couple of ways to fix this, you could just enable the email address policy for those particular mailboxes, but the risk with that option is that it may have been removed for a particular reason. Email address policies are additive only, so while an email address policy will not remove or overwrite an email address, it may change the default SMTP address.</p>
<p align="left">Or, you may want to simply add the relevant SMTP proxy address for those mailboxes, this can easily be done via PowerShell. I have published a PowerShell script to simplify this process, <a href="https://gallery.technet.microsoft.com/Fix-ProxyAddressps1-7036dfa1" target="_blank">check it out on the TechNet Gallery.</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=MigrationPermanentException: The target mailbox doesn't have an SMTP proxy matching 'company.mail.onmicrosoft.com'.&p[summary]=One of the most common error message I find when performing mailbox moves to Office 365 &ndash; Exchange Online is the &ldquo;MigrationPe...&p[url]=http://172.16.7.177:4000/2014/11/migrationpermanentexception-the-target-mailbox-doesnt-have-an-smtp-proxy-matching-company-mail-onmicrosoft-com" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2014/11/migrationpermanentexception-the-target-mailbox-doesnt-have-an-smtp-proxy-matching-company-mail-onmicrosoft-com&text=One of the most common error message I find when performing mailbox moves to Office 365 &ndash; Exchange Online is the &ldquo;MigrationPe...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-10-15T10:39:16-05:00" itemprop="datePublished">15 Oct, 2014</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2014/10/script-connect-exo-ps1-connect-to-exchange-online-using-remote-powershell">Script: Connect-EXO.ps1 - Connect to Exchange Online using remote PowerShell</a></h2>
    </header>

    <div class="post-content">
        <p>I recently came across an old script I wrote to simplify connecting to Exchange Online using remote PowerShell and thought I&rsquo;d polish it up a little and release it in case it could help make life easier for someone else.</p>
<p>This page will be updated whenever new features are added to the script..</p>
<p>This script features a GUI that will prompt for your tenant credentials and then connect to various Office 365 services using remote PowerShell. The current version of the script allows connectivity to:</p>
<ul>
<li>Exchange Online</li>
<li>Azure Active Directory</li>
<li>Office 365 Security &amp; Compliance Center<strong>&nbsp;</strong></li>
</ul>
<p><strong>Requirements:<br />
</strong>The script will work natively in PowerShell 2.0+</p>
<p><strong>Usage:</strong><br />
There are no parameters or switches, simply execute the script:</p>
<p>[shell].\Connect-EXO.ps1[/shell]</p>
<p><strong>Execution Policy:<br />
</strong>The script has been digitally signed and will run just fine under a "RemoteSigned" execution policy.</p>
<p><strong>Screenshots:</strong></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/10/cap1.png" rel="attachment wp-att-1504"><img class="aligncenter wp-image-1504" src="http://www.cgoosen.com/wp-content/uploads/2014/10/cap1.png" alt="GUI" width="451" height="296" /></a></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/10/cap2.png" rel="attachment wp-att-1505"><img class="aligncenter size-large wp-image-1505" src="http://www.cgoosen.com/wp-content/uploads/2014/10/cap2-1024x292.png" alt="Connected!" width="640" height="183" /></a></p>
<p><strong>Download:<br />
</strong>I have published it to the TechNet Gallery, <a href="http://cgoo.se/2mPzFJo" target="_blank">it can be downloaded by clicking here...</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Script: Connect-EXO.ps1 - Connect to Exchange Online using remote PowerShell&p[summary]=I recently came across an old script I wrote to simplify connecting to Exchange Online using remote PowerShell and thought I&rsquo;d poli...&p[url]=http://172.16.7.177:4000/2014/10/script-connect-exo-ps1-connect-to-exchange-online-using-remote-powershell" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2014/10/script-connect-exo-ps1-connect-to-exchange-online-using-remote-powershell&text=I recently came across an old script I wrote to simplify connecting to Exchange Online using remote PowerShell and thought I&rsquo;d poli...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-09-12T09:42:39-05:00" itemprop="datePublished">12 Sep, 2014</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2014/09/do-you-have-a-pre-exchange-2013-sp1-hybrid-or-are-you-using-freebusy-federation-update-your-federation-trust-on-sept-23">Do you have a pre-Exchange 2013 SP1 Hybrid or are you using free/busy federation? Update your Federation Trust on Sept 23!</a></h2>
    </header>

    <div class="post-content">
        <p>If your organization has an Exchange Hybrid deployment that is not running on Exchange 2013 SP1 or later you may want pay attention. On September 23, 2014, Microsoft will be making a certificate change to the Microsoft Federation Gateway which could affect you.</p>
<p>This change could also impact those who are sharing free/busy information between two different on-premises organizations. If you are already running Exchange 2013 SP1 then you are in luck as this task will be automated for you and you are not required to take any action. For those using older versions of Exchange, it is very important that you update your Federation Trust as failing to do so will result in loss of free/busy and mailtip functionality. <a href="http://blogs.technet.com/b/exchange/archive/2014/09/10/keep-your-federation-trust-up-to-date.aspx" target="_blank">Microsoft released the following post that provides more information as well as the recommended actions that should be taken,</a> I strongly recommend paying attention to this if you are not on the latest version of Exchange 2013.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Do you have a pre-Exchange 2013 SP1 Hybrid or are you using free/busy federation? Update your Federation Trust on Sept 23!&p[summary]=If your organization has an Exchange Hybrid deployment that is not running on Exchange 2013 SP1 or later you may want pay attention. On S...&p[url]=http://172.16.7.177:4000/2014/09/do-you-have-a-pre-exchange-2013-sp1-hybrid-or-are-you-using-freebusy-federation-update-your-federation-trust-on-sept-23" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2014/09/do-you-have-a-pre-exchange-2013-sp1-hybrid-or-are-you-using-freebusy-federation-update-your-federation-trust-on-sept-23&text=If your organization has an Exchange Hybrid deployment that is not running on Exchange 2013 SP1 or later you may want pay attention. On S...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-06-04T19:41:06-05:00" itemprop="datePublished">4 Jun, 2014</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2014/06/online-migration-tools-comparing-migrationwiz-and-dell-on-demand-migration">Online Migration Tools - Comparing MigrationWiz and Dell On Demand Migration</a></h2>
    </header>

    <div class="post-content">
        <p>I recently needed to migrate my own personal Office 365 tenant to another Office 365 tenant and even though I only have a few fairly small mailboxes, I decided to use online migration tools to ease the migration and I thought it would be a good idea to put together a little comparison between two of the leading solutions, MigrationWiz and Dell (formerly Quest) On Demand Migration.</p>
<p>The truth is, migration tools aren&rsquo;t new and many of today&rsquo;s players in this market have been around for a some time. Cloud adoption however has driven innovation in the market and migration toolsets have changed in recent years. Online migration tools allow organizations to migrate their data between email platforms without having to install or maintain any migration software on-premises. From an IT professional perspective, the configuration is far simpler and because you are typically using a web browser to initiate and manage the migration you are now free to do it from wherever you want (the train in my case!) using whatever device you have available. At a high level, it is a fairly simple process which typically involves the configuration of source and destination connectors (with all the required permissions of course) and the solution will extract, convert and ingest your data for you. If either your source or target mail infrastructure is located on-premises, you would need to ensure that remote connectivity is correctly configured as well.</p>
<p>For this comparison, I used exactly the same source mailbox and migrated the content to two new target mailboxes (one for each tool) in a new Office 365 tenant. Both tenants (source and destination) were located in North America and the migrations did not run simultaneously. The source mailbox contained the following:</p>
<ul>
<li>Number of folders = 38</li>
<li>Number of items = 26255</li>
<li>Total mailbox size = ~1.94 GB</li>
</ul>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb.png" alt="image" width="750" height="116" border="0" /></a></p>
<p><u>Introduction and features:</u></p>
<p>MigrationWiz has been around for a few years now and was the first online migration tool I used. I have successfully used MigrationWiz several times and migrated users from Domino/Lotus Notes and Exchange to Exchange or Office 365/Exchange Online. One of the great things about MigrationWiz is the amount of supported source and target platforms.</p>
<div align="center">
<table border="0" width="674" cellspacing="0" cellpadding="2" align="center">
<tbody>
<tr>
<td valign="top" width="323">
<p align="center"><strong>Supported sources</strong></p>
</td>
<td valign="top" width="349">
<p align="center"><strong>Supported targets</strong></p>
</td>
</tr>
<tr>
<td valign="top" width="323">
<p align="left">Amazon S3<br />
Google Apps/Gmail<br />
IMAP<br />
Microsoft Exchange (2003+)<br />
Microsoft Office 365<br />
Microsoft Office 365 China<br />
Novell GroupWise<br />
POP<br />
VMware Zimbra Server<br />
IBM Lotus Notes</p>
</td>
<td valign="top" width="349">
<p align="left">Amazon S3<br />
Google Apps/Gmail<br />
IMAP​<br />
Microsoft Exchange (2007+)<br />
Microsoft Office 365<br />
Microsoft Office 365 China</p>
</td>
</tr>
</tbody>
</table>
</div>
<div align="left"><span style="background-color: #ffffff;">For more detailed information about the platforms currently <a href="https://community.bittitan.com/kb/Pages/What%20systems%20do%20you%20currently%20support.aspx" target="_blank">supported by MigrationWiz, click here.</a></span></div>
<div align="left"></div>
<div align="left">I should also mention that migrations from Domino/Lotus Notes require a small <a href="https://migrationwiz.zendesk.com/entries/21309916-How-do-I-configure-a-migration-from-Lotus-Notes-" target="_blank">&ldquo;Lotus Extractor&rdquo;</a> to be installed on-premises. The extractor should be installed on a workstation and not your Domino servers themselves. MigrationWiz are also in the process of launching a new migration portal which is currently in beta and will support a couple of new migrations, namely:</div>
<ul>
<li>Public Folder migrations</li>
<li>Storage migrations</li>
</ul>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image1.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb1.png" alt="image" width="750" height="425" border="0" /></a></p>
<p>These options look really promising, however I haven&rsquo;t personally tested them (yet!). A list of items not migrated by <a href="https://community.bittitan.com/kb/Pages/What%20items%20are%20not%20migrated.aspx" target="_blank">MigrationWiz can be found here.</a></p>
<p>Dell On Demand Migration for Email is a relative newcomer to the online migration tools market, however I&rsquo;m sure we can all agree that they (Quest Software) really set the standard for migration tools in general for a long time. I haven&rsquo;t personally used Dell On Demand for any production migrations but have been meaning to try it out for some time now. Dell On Demand supports the following platforms:</p>
<table border="0" width="674" cellspacing="0" cellpadding="2" align="center">
<tbody>
<tr>
<td valign="top" width="323">
<p align="center"><strong>Supported sources</strong></p>
</td>
<td valign="top" width="349">
<p align="center"><strong>Supported targets</strong></p>
</td>
</tr>
<tr>
<td valign="top" width="323">Google Apps<br />
IMAP​<br />
Lotus Notes<br />
Microsoft Exchange (2000+)<br />
Microsoft Office 365<br />
Novell GroupWise<br />
POP<br />
SunONE/iPlanet<br />
Windows Live Hotmail<br />
Zimbra</td>
<td valign="top" width="349">Microsoft Exchange (2010, 2013)<br />
Microsoft Office 365</td>
</tr>
</tbody>
</table>
<p><span style="background-color: #ffffff;">Dell has published a list of <a href="http://documents.software.dell.com/DOC190779" target="_blank">known issues</a> and <a href="http://documents.software.dell.com/DOC190769" target="_blank">limitations.</a></span></p>
<p><span style="background-color: #ffffff;"><u>Licensing and cost:</u></span></p>
<p>One of the great things about both these tools is that they are licensed on a consumption basis and there is no minimum purchase required. MigrationWiz offers a couple of different license options, with the difference being that a &ldquo;Premium&rdquo; license will allow you to perform multiple migration passes. I usually suggest purchasing the &ldquo;Premium&rdquo; license because this works really well with the &ldquo;seed and cutover&rdquo; type migrations I usually perform with these tools. With MigrationWiz, you purchase you license up front and each successfully migrated mailbox consumes one of those licenses. Their licensing is based on volume so the more licenses you purchase, the more you save. A basic license will cost you $9.99 (USD) while a premium license costs $11.99 (USD).</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image2.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb2.png" alt="image" width="750" height="581" border="0" /></a></p>
<p>The Dell On Demand licensing model is somewhat simpler in the sense that they only have one license type. The difference is that you add your credit card details to the portal and they will bill you monthly for the amount of licenses you consume with each successfully migrated mailbox consuming one license and getting billed accordingly. Dell also appear to add an &ldquo;Australia Tax&rdquo; as the same license costs about 20% more when you pay in AUD, I always think this is a little cheeky, $1 or $2 could really add up if you are buying thousands of licenses. One license will cost you $11.00 (USD).</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image6.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image6_thumb.png" alt="image" width="750" height="249" border="0" /></a></p>
<p align="left"><u>Configuration:</u></p>
<p align="left">To configure MigrationWiz, you first create a &ldquo;Mailbox Connector&rdquo; which defines your source and target mailboxes as well as your migration credentials. You have the ability to use administrator credentials or end-user credentials configured per mailbox. If you have neither of these available, MigrationWiz also provides the ability to request credentials from each individual user. This is done via an email with a secure link in which the end-user may provide their credentials directly to the system.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image3.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb3.png" alt="image" width="750" height="616" border="0" /></a></p>
<p align="left">Once you have created your &ldquo;Mailbox Connector&rdquo; you can import your mailbox list. If you have more than one mailbox to migrate, MigrationWiz provides a few methods of doing this.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image4.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb4.png" alt="image" width="750" height="494" border="0" /></a></p>
<p align="left">I typically use .csv import. You can download a sample import file to get started (see sample below). If you are using administrator credentials for your migration, you only need to populate the &ldquo;Source Email&rdquo; and &ldquo;Destination Email&rdquo; fields. More information about <a href="https://migrationwiz.zendesk.com/entries/489970-How-do-I-import-mailboxes-into-the-system-without-entering-them-one-at-a-time-" target="_blank">migration flags can be found here.</a> I once did a migration for a customer using end-user credentials where some of the users had commas &ldquo;,&rdquo; in their passwords and needless to say, this didn&rsquo;t work very well with .csv files so be mindful of that.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image5.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb5.png" alt="image" width="500" height="102" border="0" /></a></p>
<p align="left">Once all your mailboxes have been added, you have the ability to tweak many of the migration settings, like filtering, before beginning the migration process.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image7.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb6.png" alt="image" width="750" height="416" border="0" /></a></p>
<p align="left">You now have the ability to migrate a few or all of the mailboxes you have imported. You will also be able to monitor the migration statistics while the migration is running. The MigrationWiz documentation is really helpful as well, for example if you need more information about <a href="https://community.bittitan.com/kb/Pages/How%20do%20I%20create%20an%20administrator%20account%20for%20login.aspx" target="_blank">migration credentials, see this link</a></p>
<p>The Dell On Demand configuration process is very similar, you start by creating a &ldquo;Migration Plan&rdquo; which defines your source and target mailboxes as well as your credentials. You have the ability to use administrator credentials or end-user credentials and the tool allows you to increase the number of concurrent mailbox migrations by adding additional administrator credentials. Each administrator can migrate 10 target mailboxes concurrently.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image8.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb7.png" alt="image" width="750" height="512" border="0" /></a></p>
<p align="left">The next step is to import your mailboxes, this can be done via a .tsv file. A sample file is also provided for reference.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image9.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb8.png" alt="image" width="500" height="325" border="0" /></a></p>
<p align="left">The final configuration step allows you to tweak the migration options</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image10.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb9.png" alt="image" width="750" height="581" border="0" /></a></p>
<p align="left">You are now ready to start migrating!</p>
<p><u>Migration Velocity:</u></p>
<p>As a consultant, one of the most common questions I get asked is &ldquo;How long will my migration take?&rdquo;. Unfortunately, this is a very difficult question to answer and the reality is, even with thorough testing and analysis, it is difficult to accurately predict how long a migration will take as every environment is different and migration velocity depends on so much more than just your network speeds. About 6 months ago, I helped a customer complete a migration from Exchange 2003 in one region to Exchange 2010 in another. They had a very tight deadline and it was a hard cut-off so there was no pushing the deadline. I did I whole bunch of calculations based on their source data size, connectivity, etc and in my mind there was no way we would be able to get all the data migrated in time so we started to prepare the business for that. We decided to use MigrationWiz for the migration and we ended up completing the entire migration with 4 full days to spare. Because we were prepared for the worst possible case, the entire team looked really good when we were able to pull it off successfully. I&rsquo;m glad it didn&rsquo;t end up going the other way and it just goes to show that there is always a small unknown factor that could change the amount of time taken for a migration to complete successfully.</p>
<p>It is usually a good idea to perform some test migrations using mailboxes that accurately represent those found in your environment. Using data from those migrations will go a long way to helping you predict your migration velocity. It is really handy to use some pilot user mailboxes for this because you will be able to perform multiple passes later on and not consume any additional licenses. MigrationWiz provides some <a href="https://migrationwiz.zendesk.com/entries/489626-How-do-I-size-my-migration-" target="_blank">guidance and a basic calculator here.</a></p>
<p>The results of the test migrations performed for this post are as follows:</p>
<table border="0" width="675" cellspacing="0" cellpadding="2" align="center">
<tbody>
<tr>
<td valign="top" width="192"></td>
<td valign="top" width="233">
<p align="center"><strong>MigrationWiz</strong></p>
</td>
<td valign="top" width="248">
<p align="center"><strong>Dell On Demand</strong></p>
</td>
</tr>
<tr>
<td valign="top" width="192"><strong>Duration</strong></td>
<td valign="top" width="258">16 hrs, 23 min</td>
<td valign="top" width="295">11 hrs, 0 min</td>
</tr>
<tr>
<td valign="top" width="192"><strong>Items Processed</strong></td>
<td valign="top" width="258">26118</td>
<td valign="top" width="295">26286</td>
</tr>
<tr>
<td valign="top" width="192"><strong>Errors</strong></td>
<td valign="top" width="258">0</td>
<td valign="top" width="295">13</td>
</tr>
</tbody>
</table>
<p>The statistics above were taken from each migration tool. There are some discrepancies with the amount of items processed and the Dell tool reported some failures. Looking at the target mailbox used for the Dell On Demand migration, we see:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image11.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb10.png" alt="image" width="750" height="106" border="0" /></a></p>
<p align="left">MigrationWiz provides a whole bunch of information about the migration, including some detailed statistics:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image12.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb11.png" alt="image" width="750" height="581" border="0" /></a></p>
<p align="left">Dell On Demand provides an overview of the migration with some detailed logging:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image13.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb12.png" alt="image" width="750" height="303" border="0" /></a></p>
<p>I am perplexed by the large difference in migration duration. These migrations were run on random days of the week at roughly the same time so I&rsquo;m not sure if it is a coincidence or not. I might re-do the MigrationWiz one sometime and see if it changes the duration.</p>
<p><u>Reporting:</u></p>
<p>MigrationWiz provides some nice charts at a mailbox level as well as some .csv reports at connector level for those who like to create their own reports in Excel.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image14.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb13.png" alt="image" width="750" height="359" border="0" /></a></p>
<p align="left">Dell On Demand provides a summary and a migration details report which includes a .csv file containing all the errors that were encountered during the migration. The reports menu is &ldquo;conveniently&rdquo; hidden on the bottom right-hand side of the dashboard.</p>
<p align="left"><a href="http://www.cgoosen.com/wp-content/uploads/2014/06/image15.png"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2014/06/image_thumb14.png" alt="image" width="500" height="281" border="0" /></a></p>
<p><u>Documentation:</u></p>
<p>MigrationWiz has heaps of useful documentation, the knowledgebase is located here: <a title="https://migrationwiz.zendesk.com/forums" href="https://migrationwiz.zendesk.com/forums">https://migrationwiz.zendesk.com/forums</a> and it seems they are moving their content to a SharePoint based library located here: <a title="https://community.bittitan.com/kb/SitePages/Knowledge%20Base.aspx?product=MigrationWiz" href="https://community.bittitan.com/kb/SitePages/Knowledge%20Base.aspx?product=MigrationWiz">https://community.bittitan.com/kb/SitePages/Knowledge%20Base.aspx?product=MigrationWiz</a></p>
<p>Dell On Demand has a user guide which is published here: <a title="http://documents.software.dell.com/On%20Demand%20Migration%20for%20Email/1.6/User%20Guide/" href="http://documents.software.dell.com/On%20Demand%20Migration%20for%20Email/1.6/User%20Guide/">http://documents.software.dell.com/On%20Demand%20Migration%20for%20Email/1.6/User%20Guide/</a></p>
<p><u>In Summary:</u></p>
<p>I think both are excellent tools which provide a wide range of options. Dell On Demand is targeted towards those organizations who are migrating to Microsoft Exchange while MigrationWiz supports other target platforms, like the ability to archive to Amazon S3. MigrationWiz has also recently added the ability to perform Public Folder and Storage migrations. Dell On Demand appears to have outperformed MigrationWiz when it comes to migration velocity, however I do find the MigrationWiz documentation to be superior.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Online Migration Tools - Comparing MigrationWiz and Dell On Demand Migration&p[summary]=I recently needed to migrate my own personal Office 365 tenant to another Office 365 tenant and even though I only have a few fairly smal...&p[url]=http://172.16.7.177:4000/2014/06/online-migration-tools-comparing-migrationwiz-and-dell-on-demand-migration" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2014/06/online-migration-tools-comparing-migrationwiz-and-dell-on-demand-migration&text=I recently needed to migrate my own personal Office 365 tenant to another Office 365 tenant and even though I only have a few fairly smal...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-03-21T12:34:12-05:00" itemprop="datePublished">21 Mar, 2014</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2014/03/warning-added-to-exchange-2013-sp1-download-page">Warning added to Exchange 2013 SP1 description page</a></h2>
    </header>

    <div class="post-content">
        <p>Yesterday <a href="http://www.cgoosen.com/2014/03/step-away-from-that-exchange-2013-sp1-update/" target="_blank">I wrote a post noting</a> the lack of any warning on the Exchange 2013 SP1 download or description page about the bug that affects environments that make use of third-party or custom-developed transport agents. Tony Redmond also <a href="http://windowsitpro.com/blog/no-warning-about-patch-required-exchange-2013-sp1" target="_blank">published a similar post on windowsitpro.com</a>. I noticed earlier today that Microsoft <a href="http://support.microsoft.com/kb/2926248" target="_blank">have updated the relevant page</a> with a note to acknowledging the bug:</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2014/03/image.png"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="image" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2014/03/image_thumb.png" width="1068" height="393" border="0" /></a></p>
<p>Thanks Tony Redmond and Microsoft for making that happen! My comments about thorough planning and testing before deploying SP1 in your production environment still apply!</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Warning added to Exchange 2013 SP1 description page&p[summary]=Yesterday I wrote a post noting the lack of any warning on the Exchange 2013 SP1 download or description page about the bug that affects ...&p[url]=http://172.16.7.177:4000/2014/03/warning-added-to-exchange-2013-sp1-download-page" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2014/03/warning-added-to-exchange-2013-sp1-download-page&text=Yesterday I wrote a post noting the lack of any warning on the Exchange 2013 SP1 download or description page about the bug that affects ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-03-20T03:36:09-05:00" itemprop="datePublished">20 Mar, 2014</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2014/03/step-away-from-that-exchange-2013-sp1-update">Step away from that Exchange 2013 SP1 update!</a></h2>
    </header>

    <div class="post-content">
        <p>The Exchange Team <a href="http://blogs.technet.com/b/exchange/archive/2014/02/25/exchange-server-2013-service-pack-1-available.aspx" target="_blank">announced the release of Exchange 2013 SP1</a> in late Feb and while SP1 introduced some great new features and functionality like Windows Server 2012 R2 support, it didn&rsquo;t take long for customers to start reporting transport issues after the update. To their credit, Microsoft responded quickly to address these issues and released <a href="http://support.microsoft.com/kb/2938053" target="_blank">KB 2938053</a>. The issue affected environments that make use of third-party or custom-developed transport agents, typically in the form of anti-virus or disclaimer software.</p>
<p>All good then? Well, yes and no.. If you were affected by the issue you can now <a href="http://www.microsoft.com/en-us/download/details.aspx?id=42065" target="_blank">download the relevant PowerShell script</a> that corrects a formatting error in the configuration files that govern the transport extensibility built into Exchange Server 2013 and issue will be resolved. If you are about to update your Exchange 2013 environment to SP1 you should note that this fix has not been included in the SP1 download and a permanent fix for this will only be delivered in Exchange Server 2013 CU5. There also doesn&rsquo;t appear to be any warning about this issue on the any of the SP1 pages on the Microsoft website so if you make use of any third-party software or custom-developed transport agents <u>you will break</u> your Exchange environment if you apple the SP1 update. </p>
<p>It is important to be aware of any applications running on your Exchange servers that may be making use of transport extensibility and as always I recommend thorough planning and testing before deploying SP1 in your production environment. </p>
<p>For more information about the issue, see <a href="http://support.microsoft.com/kb/2938053" target="_blank">KB 2938053</a></p>
<p>Tony Redmond has also written <a href="http://windowsitpro.com/blog/exchange-2013-sp1-bug-breaks-third-party-products" target="_blank">a great, in-depth article about this on windowsitpro.com</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Step away from that Exchange 2013 SP1 update!&p[summary]=The Exchange Team announced the release of Exchange 2013 SP1 in late Feb and while SP1 introduced some great new features and functionali...&p[url]=http://172.16.7.177:4000/2014/03/step-away-from-that-exchange-2013-sp1-update" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2014/03/step-away-from-that-exchange-2013-sp1-update&text=The Exchange Team announced the release of Exchange 2013 SP1 in late Feb and while SP1 introduced some great new features and functionali...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2014-01-29T05:41:28-06:00" itemprop="datePublished">29 Jan, 2014</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2014/01/ill-be-at-mec-2014-iammec">I&rsquo;ll be at MEC 2014 #IAMMEC</a></h2>
    </header>

    <div class="post-content">
        <p>Only a couple of months to go before the Microsoft Exchange Conference 2014 (MEC) in Austin (March 31 - April 2). I&rsquo;ll be attending and I am really looking forward to catching up with everyone in the community. This event truly is worth getting to - I'll prove it, I'm travelling from Australia! The first 100 sessions have already been posted <a href="http://www.iammec.com/Sessions.aspx" target="_blank">here</a>. For more info, check out <a title="http://www.iammec.com/" href="http://www.iammec.com/">http://www.iammec.com/</a></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2014/01/mec-icon.png"><img title="mec-icon" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="mec-icon" src="http://www.cgoosen.com/wp-content/uploads/2014/01/mec-icon_thumb.png" width="311" height="232"></a></p>
<p align="left">Let me know if you are also planning to attend, it would be great to catch up!</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=I&rsquo;ll be at MEC 2014 #IAMMEC&p[summary]=Only a couple of months to go before the Microsoft Exchange Conference 2014 (MEC) in Austin (March 31 - April 2). I&rsquo;ll be attending...&p[url]=http://172.16.7.177:4000/2014/01/ill-be-at-mec-2014-iammec" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2014/01/ill-be-at-mec-2014-iammec&text=Only a couple of months to go before the Microsoft Exchange Conference 2014 (MEC) in Austin (March 31 - April 2). I&rsquo;ll be attending...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-12-24T05:01:39-06:00" itemprop="datePublished">24 Dec, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/12/configure-mailbox-regional-settings">Configure Mailbox Regional Settings</a></h2>
    </header>

    <div class="post-content">
        <p>I recently completed a small migration for a customer using the <a href="https://www.migrationwiz.com/" target="_blank">MigrationWiz</a> online migration tools. This wasn&rsquo;t the first time I&rsquo;ve used these tools, but it was the first time I&rsquo;ve actually provisioned new destination mailboxes myself. I used PowerShell with a .csv file as input to automate the process of creating each mailbox, granting the correct level of access to the migration account as well as performing a few other tasks that were relevant to the particular migration.</p>
<p>Once I started the migration I was confused for a second when I received the following error message: &ldquo;Connection did not succeed. Try again later.&rdquo; The associated MigrationWiz <a href="https://migrationwiz.zendesk.com/entries/20442656" target="_blank">knowledgebase article</a> contained a few suggestions, but none of them applied to my particular situation. When trying to log into one of the test mailboxes, I noticed that it asked me to set my preferred language and time zone.. which is expected:</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2013/12/image3.png"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border-width: 0px;" title="image" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2013/12/image_thumb3.png" width="517" height="378" border="0" /></a></p>
<p>Once I had set these, I was able to connect and migrate data to that mailbox as expected. Obviously, I didn&rsquo;t want to manually configure these settings for each mailbox and was able to use PowerShell and the <a href="http://technet.microsoft.com/en-us/library/dd351103(v=exchg.150).aspx" target="_blank">Set-MailboxRegionalConfiguration</a> cmdlet to do this for all the relevant mailboxes. Here is a very simple script that will use a .csv as input and set the regional settings for all aliases. It can easily be modified to use some other input too:</p>
<p>[powershell]#The users.csv should contain a Alias colum, eg<br />
#Name,Alias,Email,Whatever<br />
$Users = Import-Csv .\users.csv<br />
Foreach ($User in $Users){<br />
   $Alias = $User.Alias<br />
   $Language = "en-NZ"<br />
   $DateFormat = "d/MM/yyyy"<br />
   $TimeFormat = "h:mm tt"<br />
   $TimeZone = "New Zealand Standard Time"<br />
   Set-MailboxRegionalConfiguration -Identity $Alias -Language $Language -DateFormat $DateFormat -TimeFormat $TimeFormat -TimeZone $TimeZone<br />
}[/powershell]</p>
<p>The easiest way to find your desired settings it to look at a correctly set mailbox using the <a href="http://technet.microsoft.com/en-us/library/dd335163(v=exchg.150).aspx" target="_blank">Get-MailboxRegionalConfiguration</a> cmdlet:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2013/12/image2.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="image" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2013/12/image_thumb2.png" width="672" height="232" border="0" /></a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Configure Mailbox Regional Settings&p[summary]=I recently completed a small migration for a customer using the MigrationWiz online migration tools. This wasn&rsquo;t the first time I&r...&p[url]=http://172.16.7.177:4000/2013/12/configure-mailbox-regional-settings" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/12/configure-mailbox-regional-settings&text=I recently completed a small migration for a customer using the MigrationWiz online migration tools. This wasn&rsquo;t the first time I&r...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-11-08T08:18:06-06:00" itemprop="datePublished">8 Nov, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/11/migrate-legacy-public-folders-to-exchange-online-part-2">Migrate Legacy Public Folders to Exchange Online &ndash; Part 2</a></h2>
    </header>

    <div class="post-content">
        <p><a href="http://www.cgoosen.com/2013/10/migrate-legacy-public-folders-to-exchange-online-part-1/" target="_blank">In part 1 we</a> briefly looked at the architectural changes made to modern public folders in Exchange 2013 as well as some of the things to you may want to consider as you prepare to migrate you public folders to Exchange Online. In this post we will step through the actual migration process in detail.</p>
<p>Let&rsquo;s firstly take a look at the migration scripts. I typically place all these scripts in the same folder, c:\pfmigration for example. You should have the following scripts downloaded:</p>
<ul>
<li>Export-PublicFolderStatistics.ps1 - This script creates a .csv file that contains a folder name-to-folder size mapping.
<li>PublicFolderToMailboxMapGenerator.ps1 - This script uses the mapping file to create a public folder-to-mailbox mapping file which is also a .csv file.
<li>Export-MailPublicFoldersForMigration.ps1 - This script exports the mail-enabled public folder objects from the on-premises organization&rsquo;s Active Directory into a .xml file.
<li>Import-MailPublicFoldersForMigration.ps1 - This script imports the mail-enabled public folder objects into Exchange Online.</li>
</ul>
<p>Note: These scripts also have support files with a .psd1 extension, it is important that these support files are placed in the same folder.</p>
<p>Before starting the migration process, you should confirm that there are no existing public folder migration requests in Exchange Online. These would need to be removed before you can continue, but it is important to first understand why there are already there before removing them. You can easily see if there are any existing request by running the following cmdlet in Exchange Online:</p>
<blockquote><p>Get-PublicFolderMigrationRequest | Get-PublicFolderMigrationRequestStatistics -IncludeReport | Format-List</p>
</blockquote>
<p>The first step in the migration process is to ensure that mail-flow to mail-enabled public folders will continue to work. The steps required to do this will depend on your configuration. If you already have an Exchange Hybrid configured (as I do), you will most likely not need to do anything as the Hybrid Configuration Wizard will take care of this step.</p>
<p>Next it is time to start using the migration scripts. We start with the Export-PublicFolderStatistics.ps1 script to create our name-to-folder size mapping file. This script is run on the legacy public folder server:</p>
<blockquote><p>Export-PublicFolderStatistics.ps1&nbsp; <size_mapping_file_name> <legacy_server></p>
</blockquote>
<p>Once we have our size mapping file, we can run the PublicFolderToMailboxMapGenerator.ps1 script to create the public folder-to-mailbox mapping file which is used to calculate the correct number of public folder mailboxes that will be required in Exchange Online. This script is run on the legacy public folder server:</p>
<blockquote><p>PublicFolderToMailboxMapGenerator.ps1 <maximum_mailbox_size_in_bytes> <size_mapping_file_name> <mailbox_mapping_file_name></p>
</blockquote>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2013/11/image.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2013/11/image_thumb.png" width="1014" height="277"></a></p>
<p>Note: The <maximum_mailbox_size_in_bytes> parameter is used to size your public folder mailboxes in Exchange Online. In my example I have used 10 GB (or there about!) Public folders in Exchange Online can be a maximum of 50 GB, however I would recommend leaving enough room for growth. </p>
<p>I was having a discussion with a colleague of mine last week about public folder migration, more specifically how to selectively migrate only certain public folders. In the interest of full disclosure, I have not tested this (yet!), but in theory it should work. If you were to edit the size mapping file in Excel, you will notice that it contains two columns: &lsquo;FolderName&rsquo; and &lsquo;FolderSize&rsquo;. Remove all the entries for folders that you don&rsquo;t want to migrate before running the PublicFolderToMailboxMapGenerator.ps1 script and complete the rest of the process as documented. If you have tried this and have some feedback, let me know. I hope to be able to test it soon.</p>
<p>Moving on.. once we have our mapping files created, we should export our mail enabled public folders on our legacy public folder server:</p>
<blockquote><p>Export-MailPublicFoldersForMigration.ps1 <export_file_name></p>
</blockquote>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo3.png"><img title="pfeo3" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="pfeo3" src="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo3_thumb.png" width="1014" height="168"></a></p>
<p>Next, we can connect to Exchange Online and create our new public folder mailboxes. The first public folder mailbox that is created will be the primary hierarchy mailbox and it must be created in &lsquo;HoldForMigration mode&rsquo;. This public folder mailbox should also be excluded from the serving hierarchy so that the public folders won&rsquo;t be available to Exchange Online users.</p>
<blockquote><p>New-Mailbox -PublicFolder <mailbox_name> -HoldForMigration:$true -IsExcludedFromServingHierarchy:$true</p>
</blockquote>
<p>We should also import our mail enabled public folders:</p>
<blockquote><p>Import-MailPublicFoldersForMigration.ps1 <export_file_name></p>
</blockquote>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo4.png"><img title="pfeo4" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="pfeo4" src="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo4_thumb.png" width="1014" height="231"></a></p>
<p>We are now ready to submit the migration request, but before we do, let&rsquo;s gather all the required information for the New-PublicFolderMigrationRequest cmdlet:</p>
<p>First we need our Outlook Anywhere hostname and authentication method:</p>
<blockquote><p>Get-OutlookAnywhere | Format-List Identity, ExternalHostName, IISAuthenticationMethods</p>
</blockquote>
<p>We also need the LegacyExchangeDN of the administrator mailbox:</p>
<blockquote><p>Get-Mailbox <user> | Format-Table LegacyExchangeDN</p>
</blockquote>
<p>Lastly, we need the ExchangeLegacyDN of the legacy public folder server:</p>
<blockquote><p>Get-ExchangeServer &ndash;Identity <server> | Format-Table ExchangeLegacyDN</p>
</blockquote>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2013/11/Capture.png"><img title="Capture" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="Capture" src="http://www.cgoosen.com/wp-content/uploads/2013/11/Capture_thumb.png" width="1014" height="341"></a></p>
<p>Given the length of the cmdlet and parameters, I recommend using variables. Using the information we have gathered, we can easily do this:</p>
<blockquote><p>$OAHostname = <ExternalHostName_value></p>
<p>$Csv = Get-Content c:\PFMigration\pf2mbx.csv -Encoding Byte</p>
<p>$OnPremCred = Get-Credential</p>
<p>$Rmldn = <LegacyExchangeDN_value></p>
<p>$Rpfsldn = <ExchangeLegacyDN_value></p>
</blockquote>
<p>We can then run the New-PublicFolderMigrationRequest cmdlet using these variables. You&rsquo;ll know that the command started successfully when the migration request reaches a status of &lsquo;Queued&rsquo; or &lsquo;InProgress&rsquo;:</p>
<blockquote><p>New-PublicFolderMigrationRequest -OutlookAnywhereHostName $OAHostName -CSVData $Csv -RemoteCredential $OnPremCred -RemoteMailboxLegacyDN $Rmldn -RemoteMailboxServerLegacyDN $Rpfsldn -AuthenticationMethod <Basic/NTLM></p>
</blockquote>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2013/11/image1.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2013/11/image_thumb1.png" width="1014" height="341"></a></p>
<p>Once the migration request kicks off it will copy the public folder data and will continue running until it reaches 95% at which point it will auto suspend the request. We can monitor the progress using the Get-PublicFolderMigrationRequest and Get-PublicFolderMigrationRequestStatistics cmdlets:</p>
<blockquote><p>Get-PublicFolderMigrationRequest | Get-PublicFolderMigrationRequestStatistics -IncludeReport | Format-List Status, SourceServer, SourceVersion, BytesTransferred, ItemsTransferred, PercentComplete, Message</p>
</blockquote>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo7.png"><img title="pfeo7" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="pfeo7" src="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo7_thumb.png" width="1014" height="294"></a></p>
<p>In order to complete the migration request, we need to arrange downtime or a service outage as there will be period while the last bit of data is transferred where public folders will be unavailable to end users. The amount of downtime depends on how much new content has been generated since the migration was suspended. In large environments with a lot of changing content, I would recommend running the Resume-PublicFolderMigrationRequest cmdlet. This cmdlet can be run as often as required and will merely copy any new content and auto suspend at 95%, this will reduce the amount of downtime required.</p>
<p>Once we have scheduled a service outage and informed out end users, we need to lock the legacy public folder environment in order to prevent any further changes:</p>
<blockquote><p>Set-OrganizationConfig &ndash;PublicFoldersLockedForMigration $true</p>
</blockquote>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo8.png"><img title="pfeo8" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="pfeo8" src="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo8_thumb.png" width="1014" height="256"></a></p>
<p>Next we need to allow the migration request to complete, we do this by removing &lsquo;PreventCompletion&rsquo;:</p>
<blockquote><p>Get-PublicFolderMigrationRequest | Set-PublicFolderMigrationRequest -PreventCompletion $false</p>
</blockquote>
<p>We can now resume the migration request and this time it will run through to completion and not auto suspend at 95%:</p>
<blockquote><p>Get-PublicFolderMigrationRequest | Resume-PublicFolderMigrationRequest</p>
</blockquote>
<p>We monitor the request as before to verify that it has completed successfully:</p>
<blockquote><p>Get-PublicFolderMigrationRequest | Get-PublicFolderMigrationRequestStatistics -IncludeReport | Format-List Status, SourceServer, SourceVersion, BytesTransferred, ItemsTransferred, PercentComplete, Message</p>
</blockquote>
<p>Once we are happy that the migration has completed successfully, we allow the hierarchy to be served:</p>
<blockquote><p>Get-Mailbox -PublicFolder | Set-Mailbox -PublicFolder -IsExcludedFromServingHierarchy $false</p>
</blockquote>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo10.png"><img title="pfeo10" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="pfeo10" src="http://www.cgoosen.com/wp-content/uploads/2013/11/pfeo10_thumb.png" width="1014" height="295"></a></p>
<p>The final set in the process is to set the migration as complete in the legacy environment:</p>
<blockquote><p>Set-OrganizationConfig -PublicFolderMigrationComplete $true</p>
</blockquote>
<p>It is possible to roll back the migration, however I would like to mention a few really important points about rolling back:</p>
<ul>
<li>The roll back process will not copy any changed data back to the legacy environment, this should be considered when deciding to roll back. It would be a really bad idea to try and roll back a change heavy environment after 3 weeks.</li>
<li>Roll back will obviously require the original public folder databases to be online, I therefore recommend dismounting these for a period of time after the migration just in case you need them. This process is a lot more difficult if you delete the databases and then try and roll back.</li>
</ul>
<p>For more information on the migration process, see the following article on TechNet:</p>
<ul>
<li><a href="http://technet.microsoft.com/en-us/library/jj983799(v=exchg.150).aspx" target="_blank">Migrate Legacy Public Folders to Exchange Online</a></li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Migrate Legacy Public Folders to Exchange Online &ndash; Part 2&p[summary]=In part 1 we briefly looked at the architectural changes made to modern public folders in Exchange 2013 as well as some of the things to ...&p[url]=http://172.16.7.177:4000/2013/11/migrate-legacy-public-folders-to-exchange-online-part-2" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/11/migrate-legacy-public-folders-to-exchange-online-part-2&text=In part 1 we briefly looked at the architectural changes made to modern public folders in Exchange 2013 as well as some of the things to ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-10-30T09:02:59-05:00" itemprop="datePublished">30 Oct, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/10/migrate-legacy-public-folders-to-exchange-online-part-1">Migrate Legacy Public Folders to Exchange Online &ndash; Part 1</a></h2>
    </header>

    <div class="post-content">
        <p>I&rsquo;ve been meaning to get this series published for some time now. I can&rsquo;t believe it is almost 2 months since TechEd Australia 2013! <a href="http://cgoo.se/18TNT8Y" target="_blank">During my session</a>, I briefly covered modern public folders and how to migrate them to Exchange Online. My aim is to build on that session with a couple of posts that run through the entire process of migrating legacy public folders to Exchange Online. This first post will provide an overview of modern public folder architecture as well as some of the planning and preparation required prior to the migration.</p>
<p>I&rsquo;m sure by now everyone is aware that in Exchange 2013 public folders were re-engineered using mailbox infrastructure to take advantage of the existing high availability and storage technologies of the mailbox database. Public folder architecture uses specially designed mailboxes to store both the public folder hierarchy and content. This also means that there is no longer a public folder database and high availability for the public folder mailboxes is provided by a DAG. Let&rsquo;s briefly look at the new architecture:</p>
<p>The main component of public folders are the public folder mailboxes, which can reside in one or more mailbox databases. Public folder mailboxes can be either &lsquo;Primary&rsquo; or &lsquo;Secondary&rsquo;. The primary hierarchy mailbox is the 1 writable copy of the public folder hierarchy. The public folder hierarchy is copied to all other public folder mailboxes, but these secondary copies are read-only copies. The public folder hierarchy contains the folders&rsquo; properties, organizational information and tree structure. Public folder content can include email messages, posts, documents, and eForms. The content is stored in the public folder mailbox but isn&rsquo;t replicated across multiple public folders mailboxes. All users access the same public folder mailbox for the same set of content. </p>
<p>&nbsp;</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2013/10/image.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; border-top-width: 0px; margin-right: auto" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2013/10/image_thumb.png" width="690" height="483"></a></p>
<p>Because there is only 1 writable copy of the hierarchy, it is necessary to synchronize changes to other mailboxes when they are made. Hierarchy synchronization takes place as follows (as illustrated in the diagram above):</p>
<ol>
<li>Let&rsquo;s say for example a client connects to a secondary public folder mailbox to access content (Folder 5) and
<li>Then that client creates a new public folder (Folder 6 in the example)
<li>The request will be proxied to the primary public folder mailbox where it is written to public folder hierarchy
<li>Public folder hierarchy synchronisation is triggered immediately to content mailbox
<li>The public folder hierarchy is updated on all public folder mailboxes. This takes place after 15 mins for mailboxes with connected users and after 24 hrs for mailboxes with no connected users.</li>
</ol>
<p>In order to move legacy public folders to Exchange Online, you need at least Exchange 2007 SP3 RU1 or Exchange 2010 SP3 and there are a few other considerations you may want to take note of:</p>
<ul>
<li>There is no coexistence between legacy and modern public folders, the migration is a all at once &lsquo;cutover&rsquo; migration</li>
<li>All mailboxes must be on Exchange 2013 and/or Exchange Online prior to migration</li>
<li>Migrations are PowerShell based using scripts, there is no migration wizard or GUI</li>
<li>While a Exchange Hybrid Deployment is not required, it does make things easier as you do not have to manually configure message routing for mail-enabled public folders</li>
<li>Public folders are migrated using Outlook Anywhere, therefore Outlook Anywhere must be published to the internet and enabled on all legacy public folder servers</li>
<li>EWS clients such as Entourage 2008 EWS Edition and Outlook for Mac 2011 with mailboxes on Exchange 2013 will not be able to access legacy public folders</li>
<li>Public folders that include a Backslash (&ldquo;\&rdquo;) in their names are not supported</li>
</ul>
<p>You should also ensure that you have the correct permissions:</p>
<ul>
<li>In Exchange Online, you need to be a member of the &lsquo;Organization Management&rsquo; role group</li>
<li>In Exchange 2010, you need to be a member of the &lsquo;Organization Management&rsquo; or &lsquo;Server Management&rsquo; RBAC role groups.</li>
<li>In Exchange 2007, you need to be assigned the &lsquo;Exchange Organization Administrator&rsquo; role or the &lsquo;Exchange Server Administrator&lsquo; role. You should also be assigned the &lsquo;Public Folder Administrator&rsquo; role and local Administrators group for the target server.</li>
</ul>
<p>As previously mentioned, the migration is done via PowerShell. There are a few scripts that should be downloaded, these will be used during the various stages of the migration. Be sure to download the following:</p>
<ul>
<li><a href="http://www.microsoft.com/en-us/download/details.aspx?id=38407" target="_blank">Microsoft Exchange 2013 Public Folders Migration Scripts</a></li>
<li><a href="http://www.microsoft.com/en-us/download/details.aspx?id=38408" target="_blank">Microsoft Exchange 2013 Public Folders Directory Sync Support Scripts</a></li>
</ul>
<p>Finally, when preparing for a public folder migration to Exchange Online, I would highly recommend that public folders are first analyzed and classified. It is not uncommon to see public folder structures that were implemented in the early days of Exchange more than 10 years ago and are now no more than a dumping ground for old data. Often these hierarchies where designed to match an organization structure or meet business requirements that no longer exist. Exchange has come a long way since then and by taking a good look at your public folder use cases, you may find that there are better and more efficient ways to do things today.</p>
<p>In part 2 we&rsquo;ll will run through the migration process.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Migrate Legacy Public Folders to Exchange Online &ndash; Part 1&p[summary]=I&rsquo;ve been meaning to get this series published for some time now. I can&rsquo;t believe it is almost 2 months since TechEd Australi...&p[url]=http://172.16.7.177:4000/2013/10/migrate-legacy-public-folders-to-exchange-online-part-1" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/10/migrate-legacy-public-folders-to-exchange-online-part-1&text=I&rsquo;ve been meaning to get this series published for some time now. I can&rsquo;t believe it is almost 2 months since TechEd Australi...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-09-11T16:13:14-05:00" itemprop="datePublished">11 Sep, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/09/my-session-at-teched-australia-2013">My Session at TechEd Australia 2013</a></h2>
    </header>

    <div class="post-content">
        <p>In case you missed my session at TechEd Australia last week the session recording and slide deck is available on <a href="http://cgoo.se/18TNT8Y" target="_blank">Channel 9</a> or by clicking here: <a title="http://cgoo.se/18TNT8Y" href="http://cgoo.se/18TNT8Y">http://cgoo.se/18TNT8Y</a></p>
<p>I&rsquo;m currently working a series of posts about Public Folder migration to Exchange Online. I touched on it during the session, but will be publishing more details in the series so look out for it soon.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=My Session at TechEd Australia 2013&p[summary]=In case you missed my session at TechEd Australia last week the session recording and slide deck is available on Channel 9 or by clicking...&p[url]=http://172.16.7.177:4000/2013/09/my-session-at-teched-australia-2013" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/09/my-session-at-teched-australia-2013&text=In case you missed my session at TechEd Australia last week the session recording and slide deck is available on Channel 9 or by clicking...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-08-14T06:48:20-05:00" itemprop="datePublished">14 Aug, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/08/critical-security-bulletin-for-exchange-server-ms13-061">Critical Security Bulletin for Exchange Server (MS13-061)</a></h2>
    </header>

    <div class="post-content">
        <p><font color="#ff0000">##Update 30 Aug 2013##</font></p>
<p><font color="#000000">The MS13-061 security update has been re-released for Exchange Server 2013, the download links below have been updated.</font></p>
<p><font color="#ff0000">##Update 15 Aug 2013##</font></p>
<p><font color="#000000">The MS13-061 security update for Exchange Server 2013 has been pulled as it seems to cause an issue with the Content Index for mailbox databases. If you have already installed this update see </font><a href="http://support.microsoft.com/kb/2879739" target="_blank"><font color="#000000">KB2879739</font></a><font color="#000000"> for information on how to resolve this. This issue does not occur in Exchange 2010 or Exchange 2007.</font></p>
<p>A few hours ago Microsoft released a critical security update for all supported editions of Microsoft Exchange Server 2007, 2010, and 2013. This security update addresses vulnerabilities that exist in the WebReady Document Viewing and Data Loss Prevention features of Exchange that could allow remote code execution in the security context of the transcoding service on the Exchange server if a user previews a specially crafted file using Outlook Web App. For detailed information, see <a href="http://technet.microsoft.com/en-us/security/Bulletin/MS13-061" target="_blank">Microsoft Security Bulletin MS13-061</a></p>
<p>Microsoft recommends that customers apply the update immediately. The update can be downloaded at the following links:</p>
<ul>
<li><a href="http://www.microsoft.com/en-us/download/details.aspx?id=39803" target="_blank">Update Rollup 11 for Exchange Server 2007 SP3</a>
<li><a href="http://www.microsoft.com/en-us/download/details.aspx?id=39863" target="_blank">Update Rollup 7 for Exchange Server 2010 SP2</a>
<li><a href="http://www.microsoft.com/en-eg/download/details.aspx?id=39835" target="_blank">Update Rollup 2 For Exchange 2010 SP3</a>
<li><a href="http://www.microsoft.com/en-us/download/details.aspx?id=39910" target="_blank">Security Update For Exchange Server 2013 CU1</a>
<li><a href="http://www.microsoft.com/en-us/download/details.aspx?id=39904" target="_blank">Security Update For Exchange Server 2013 CU2</a></li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Critical Security Bulletin for Exchange Server (MS13-061)&p[summary]=##Update 30 Aug 2013##
The MS13-061 security update has been re-released for Exchange Server 2013, the download links below have been upd...&p[url]=http://172.16.7.177:4000/2013/08/critical-security-bulletin-for-exchange-server-ms13-061" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/08/critical-security-bulletin-for-exchange-server-ms13-061&text=##Update 30 Aug 2013##
The MS13-061 security update has been re-released for Exchange Server 2013, the download links below have been upd...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-07-30T06:52:16-05:00" itemprop="datePublished">30 Jul, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/07/how-to-access-exchange-admin-center-eac-in-exchange-2013-during-coexistence">How to access Exchange Admin Center (EAC) in Exchange 2013 during coexistence</a></h2>
    </header>

    <div class="post-content">
        <p>Perhaps you are planning your on-premises upgrade to Exchange 2013 or you&rsquo;ve just introduced the first Exchange 2013 server into your existing Exchange 2010 environment. Welcome to coexistence! Hopefully by now you already know that the Exchange Admin Center (EAC) is the web-based management console in Microsoft Exchange Server 2013 and it replaces the Exchange Management Console (EMC) and the Exchange Control Panel (ECP), which were the two interfaces used to manage Exchange Server 2010.</p>
<p>So how do you access the EAC? Well.. if you had just installed a fresh new Exchange 2013 org you would simply navigate to <a href="https://<your_exchange_server>/ecp">https://<your_exchange_server>/ecp</a> in your browser. In a coexistence scenario however, doing that would redirect you to Exchange 2010 ECP and you would probably see something like this (once logged in):</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2013/07/image.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2013/07/image_thumb.png" width="616" height="182"></a></p>
<p align="left">The reason for this is that your mailbox is probably still located on an Exchange 2010 server. You now have two options:</p>
<ol>
<li>
<div align="left">Move your mailbox to Exchange 2013 and try again, or</div>
</li>
<li>
<div align="left">Use the following URL: <a href="https://<your_exchange_server>/ecp?ExchClientVer=15">https://<your_exchange_server>/ecp<a href="https://exchange2013servername/ecp?ExchClientVer=15">?ExchClientVer=15</a></a>&nbsp;</div>
</li>
</ol>
<p align="left">You should now see the Exchange 2013 Admin Center which will look something like this:</p>
<p align="left"><a href="http://www.cgoosen.com/wp-content/uploads/2013/07/image1.png"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2013/07/image_thumb1.png" width="622" height="228"></a></p>
<p>You are now able to continue configuring Exchange 2013 via the EAC. </p>
<p>Read more about the <a href="http://technet.microsoft.com/en-us/library/jj150562(v=exchg.150).aspx" target="_blank">EAC here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=How to access Exchange Admin Center (EAC) in Exchange 2013 during coexistence&p[summary]=Perhaps you are planning your on-premises upgrade to Exchange 2013 or you&rsquo;ve just introduced the first Exchange 2013 server into yo...&p[url]=http://172.16.7.177:4000/2013/07/how-to-access-exchange-admin-center-eac-in-exchange-2013-during-coexistence" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/07/how-to-access-exchange-admin-center-eac-in-exchange-2013-during-coexistence&text=Perhaps you are planning your on-premises upgrade to Exchange 2013 or you&rsquo;ve just introduced the first Exchange 2013 server into yo...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-07-26T10:43:16-05:00" itemprop="datePublished">26 Jul, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/07/ill-be-speaking-at-teched-australia-2013">I&rsquo;ll be speaking at TechEd Australia 2013</a></h2>
    </header>

    <div class="post-content">
        <p>Mario Tevanian (Microsoft) and I will be presenting a &ldquo;Exchange 2013 Hybrid Deployments&rdquo; session at TechEd Australia 2013 (3-6 September, Gold Coast) The session will provide an overview of the complete range of migration options that are available when migrating to Exchange Online and discuss the new Exchange 2013 hybrid configuration wizard. Did you know that public folders are now supported in Exchange Online? Come and learn more about modern public folders and how to migrate them. In this session we also share some notes from the field and highlight the recommended approach and best practices you should consider as you plan to migrate your existing Exchange environment to Exchange Online. </p>
<p>Room and time slot details are not available yet, but I&rsquo;ll share them as soon as I know what they are. The session code is: EXL314. See you there! </p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2013/07/SMIC1608_blogBling_speaking.jpg"><img title="SMIC1608_blogBling_speaking" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="SMIC1608_blogBling_speaking" src="http://www.cgoosen.com/wp-content/uploads/2013/07/SMIC1608_blogBling_speaking_thumb.jpg" width="216" height="216"></a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=I&rsquo;ll be speaking at TechEd Australia 2013&p[summary]=Mario Tevanian (Microsoft) and I will be presenting a &ldquo;Exchange 2013 Hybrid Deployments&rdquo; session at TechEd Australia 2013 (3-...&p[url]=http://172.16.7.177:4000/2013/07/ill-be-speaking-at-teched-australia-2013" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/07/ill-be-speaking-at-teched-australia-2013&text=Mario Tevanian (Microsoft) and I will be presenting a &ldquo;Exchange 2013 Hybrid Deployments&rdquo; session at TechEd Australia 2013 (3-...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-07-23T07:41:13-05:00" itemprop="datePublished">23 Jul, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/07/reverse-proxy-for-exchange-server-2013-using-iis-arr">Reverse Proxy for Exchange Server 2013 using IIS ARR</a></h2>
    </header>

    <div class="post-content">
        <p>Microsoft Application Request Routing (ARR) is a proxy-based routing module for IIS that forwards HTTP requests to content servers based on HTTP headers, server variables, and load balance algorithms. After my recent posts on reverse proxy servers and Exchange Server I received a few emails about using ARR as a reverse proxy for Exchange Server. The Exchange Team recently released some guidance on how to achieve this on their blog for those of you who are interested in this setup, <a href="http://blogs.technet.com/b/exchange/archive/2013/07/19/reverse-proxy-for-exchange-server-2013-using-iis-arr-part-1.aspx" target="_blank">here is a link to the post.</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Reverse Proxy for Exchange Server 2013 using IIS ARR&p[summary]=Microsoft Application Request Routing (ARR) is a proxy-based routing module for IIS that forwards HTTP requests to content servers based ...&p[url]=http://172.16.7.177:4000/2013/07/reverse-proxy-for-exchange-server-2013-using-iis-arr" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/07/reverse-proxy-for-exchange-server-2013-using-iis-arr&text=Microsoft Application Request Routing (ARR) is a proxy-based routing module for IIS that forwards HTTP requests to content servers based ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-07-19T07:09:00-05:00" itemprop="datePublished">19 Jul, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/07/exchange-server-and-the-reverse-proxy-part-2">Exchange Server and the Reverse Proxy - Part 2</a></h2>
    </header>

    <div class="post-content">
        <p>In March this year I wrote a post entitled &ldquo;<a href="http://www.cgoosen.com/2013/03/exchange-server-and-the-reverse-proxy/" target="_blank">Exchange Server and the Reverse Proxy</a>&rdquo;. I had many similar conversations with peers and customers about the topic, and at the time my intention was twofold:</p>
<ol>
<li>Question the &lsquo;old school&rsquo; notion that Exchange services published to the internet are only secure if a reverse proxy is used;
<li>Provide a high-level list of potentially suitable solutions for customers planning new deployments who felt they still needed a reverse proxy.</li>
</ol>
<p>I&rsquo;ve received many comments and emails about that post and have been planning to put together this follow-up for some time now so it was a happy coincidence when the ever entertaining (and deceptively brilliant!) Greg Taylor <a href="http://blogs.technet.com/b/exchange/archive/2013/07/17/life-in-a-post-tmg-world-is-it-as-scary-as-you-think.aspx" target="_blank">recently posted about the same topic on the Exchange Team blog</a>. I&rsquo;m sure he won&rsquo;t mind me &lsquo;borrowing&rsquo; some of this content, it is not my intention to take anything out of context so feel free to read <a href="http://blogs.technet.com/b/exchange/archive/2013/07/17/life-in-a-post-tmg-world-is-it-as-scary-as-you-think.aspx" target="_blank">this entire post here</a>. A couple of things that really stand out in his post are:</p>
<blockquote><p><em>&ldquo;Here are some interesting Exchange-related facts to help further cement the idea I&rsquo;m eventually going to get to.</em></p>
<ol>
<li><em>We do not require traffic to be authenticated prior to hitting services in front of Exchange Online.</em>
<li><em>We do not do any form of pre-authentication of services in front of our corporate, on-premises messaging deployments either.</em>
<li><em>We have spent an awfully large amount of time as a company working on securing our code, writing secure code, testing our code for security, and understanding the threats that exist to our code. This is why we feel confident enough to do #1 and #2.</em>
<li><em>We have come to learn that adding layers of security often adds little additional security, but certainly lots of complexity.</em>
<li><em>We have invested in getting our policies right and monitoring our systems.&rdquo;</em></li>
</ol>
</blockquote>
<blockquote><p><em>&ldquo;Do I think everyone should throw out that TMG box they have today and go firewall commando? No. not at all. I think they should evaluate what it does for them, and, if they need it going forward. If they do that, and decide they still want pre-auth, then find something that can do it, when the time to replace TMG comes. </em>
<p><em>You could consider it a sliding scale, of choice. Something like this perhaps;&rdquo;</em>
<p align="center"><a href="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-31-06-metablogapi/2045.TMGScale_5F00_7671E17B.jpg"><img title="TMGScale" border="0" alt="TMGScale" src="http://blogs.technet.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-31-06-metablogapi/8311.TMGScale_5F00_thumb_5F00_464A96B8.jpg" width="811" height="478"></a></p>
</blockquote>
<p>The recent release of <a href="http://www.microsoft.com/en-us/server-cloud/windows-server/windows-server-2012-r2.aspx" target="_blank">Windows Server 2012 R2</a> Preview brings with it the new <a href="http://technet.microsoft.com/en-us/library/dn280944.aspx" target="_blank">Web Application Proxy role.</a> Web Application Proxy is a new Remote Access role service in Windows Server 2012 R2 Preview that provides reverse proxy functionality for web applications inside your corporate network to allow users on any device to access them from outside the corporate network. Web Application Proxy pre-authenticates access to web applications using Active Directory Federation Services (AD FS), and also functions as an AD FS proxy. My esteemed colleague <a href="https://twitter.com/MarcTerblanche" target="_blank">Marc Terblanche</a> has put together a couple of great posts on the Kloud Solutions blog about the Web Application Proxy role, check them out here:</p>
<ul>
<li><a href="http://blog.kloud.com.au/2013/07/03/windows-2012-r2-preview-web-application-proxy-exchange-2013-publishing-tests/" target="_blank">Windows 2012 R2 Preview Web Application Proxy &ndash; Exchange 2013 Publishing Tests</a></li>
<li><a href="http://blog.kloud.com.au/2013/07/15/publish-lync-2013-with-2012-r2-preview-web-application-proxy/" target="_blank">Publish Lync 2013 with 2012 R2 Preview Web Application Proxy</a></li>
</ul>
<p>I also wanted to post an update on the Apache/mod_proxy solution I mentioned in my previous post. Free time (aka lab time) has become somewhat limited lately so I haven&rsquo;t been able iron out all the issues with the solution yet, but I recently came across an open source project that looks very promising. The guys at <a href="http://www.vultureproject.org/" target="_blank">Vulture</a> seem to have created exactly what I was trying to do in a much more elegant way. They&rsquo;ve put together a web application firewall using open source components like Apache and mod_security and have even added a configuration web gui to it. Vulture does pre-authentication using a number of authentication providers and also provides other features like load balancing. I have not tested it myself (yet!) but if this interests you, check it out here: <a href="http://www.vultureproject.org/">http://www.vultureproject.org/</a> &ndash; The documentation is in French but seems to translate reasonably well..</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange Server and the Reverse Proxy - Part 2&p[summary]=In March this year I wrote a post entitled &ldquo;Exchange Server and the Reverse Proxy&rdquo;. I had many similar conversations with pee...&p[url]=http://172.16.7.177:4000/2013/07/exchange-server-and-the-reverse-proxy-part-2" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/07/exchange-server-and-the-reverse-proxy-part-2&text=In March this year I wrote a post entitled &ldquo;Exchange Server and the Reverse Proxy&rdquo;. I had many similar conversations with pee...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-07-10T06:36:16-05:00" itemprop="datePublished">10 Jul, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/07/exchange-2013-cu2-released">Exchange 2013 CU2 Released!</a></h2>
    </header>

    <div class="post-content">
        <p>Ross Smith IV <a href="http://blogs.technet.com/b/exchange/archive/2013/07/09/released-exchange-server-2013-rtm-cumulative-update-2.aspx" target="_blank">announced the release</a> of <a href="http://www.microsoft.com/en-us/download/details.aspx?id=39609" target="_blank">Exchange Server 2013 RTM Cumulative Update 2 (CU2)</a> on the Exchange Team blog earlier today. </p>
<p>In addition to bug fixes, Exchange 2013 RTM CU2 introduces enhancements in the following areas:</p>
<ul>
<li>Per-server database support - increased from 50 to 100 databases </li>
<li>OWA Redirection - adds single sign-on when FBA is used on source and target</li>
<li>High Availability - introduces the new "DAG Management Service"</li>
<li>Improvements to Managed Availability </li>
<li>Cmdlet Help - introduces Update-ExchangeHelp cmdlet to update local Shell help </li>
<li>OWA Search Improvements </li>
<li>Malware Filter Rules - introduces the &ndash;MalwareFilterRule cmdlets</li>
</ul>
<p>He also announced that the Exchange Product Group is in the final validation stages to support Windows Azure for Witness Server placement. There has been much talk about leveraging Windows Azure for things like Witness Servers lately, so this is quite an exciting announcement for many organizations.</p>
<p>Exchange 2013 CU2 does include schema changes so I highly recommend reading the <a href="http://blogs.technet.com/b/exchange/archive/2013/07/09/released-exchange-server-2013-rtm-cumulative-update-2.aspx" target="_blank">upgrading/deploying section</a> before attempting to implement it. The download is <a href="http://www.microsoft.com/en-us/download/details.aspx?id=39609" target="_blank">available here.</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2013 CU2 Released!&p[summary]=Ross Smith IV announced the release of Exchange Server 2013 RTM Cumulative Update 2 (CU2) on the Exchange Team blog earlier today. 
In ad...&p[url]=http://172.16.7.177:4000/2013/07/exchange-2013-cu2-released" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/07/exchange-2013-cu2-released&text=Ross Smith IV announced the release of Exchange Server 2013 RTM Cumulative Update 2 (CU2) on the Exchange Team blog earlier today. 
In ad...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-06-30T12:04:00-05:00" itemprop="datePublished">30 Jun, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/06/remote-connectivity-analyzermessage-analyzer">Remote Connectivity Analyzer&ndash;Message Analyzer</a></h2>
    </header>

    <div class="post-content">
        <p>If you often use the Remote Connectivity Analyzer tool (<a title="https://www.testexchangeconnectivity.com/" href="https://www.testexchangeconnectivity.com/">https://www.testexchangeconnectivity.com/</a>) you may have noticed the &ldquo;Message Analyzer&rdquo; tab that was added recently. I noticed it a while back but never gave it much thought until I have troubleshooting&nbsp; a mail flow problem for a customer today so I thought I would write up this quick post about it.</p>
<p>SMTP message headers contain a lot of valuable information about origins of a message and how it eventually made it to the intended destination. The Message Analyzer displays SMTP message header information in a easy to read format.</p>
<p>To use the Message Analyzer, simply copy the SMTP message header from a message and paste it into the tool:</p>
<p>&nbsp;</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2013/07/11.png"><img title="1" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="1" src="http://www.cgoosen.com/wp-content/uploads/2013/07/1_thumb1.png" width="713" height="471"></a></p>
<p align="left">Once you click &ldquo;Analyze headers&rdquo; the header information will be displayed in a table</p>
<p align="center">&nbsp;</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2013/07/21.png"><img title="2" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="2" src="http://www.cgoosen.com/wp-content/uploads/2013/07/2_thumb1.png" width="925" height="603"></a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Remote Connectivity Analyzer&ndash;Message Analyzer&p[summary]=If you often use the Remote Connectivity Analyzer tool (https://www.testexchangeconnectivity.com/) you may have noticed the &ldquo;Messag...&p[url]=http://172.16.7.177:4000/2013/06/remote-connectivity-analyzermessage-analyzer" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/06/remote-connectivity-analyzermessage-analyzer&text=If you often use the Remote Connectivity Analyzer tool (https://www.testexchangeconnectivity.com/) you may have noticed the &ldquo;Messag...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-05-14T04:35:36-05:00" itemprop="datePublished">14 May, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/05/sizing-exchange-2013-deployments">Sizing Exchange 2013 Deployments</a></h2>
    </header>

    <div class="post-content">
        <p>The Exchange Team <a href="http://blogs.technet.com/b/exchange/archive/2013/05/06/ask-the-perf-guy-sizing-exchange-2013-deployments.aspx" target="_blank">recently released</a> some great guidance on how to size Exchange 2013 deployments. I think this is a really comprehensive post and as expected, the guidance is in favour of multi-role deployments. There is no &ldquo;calculator&rdquo; spread sheet out yet, however we should see one released soon. Read the <a href="http://blogs.technet.com/b/exchange/archive/2013/05/06/ask-the-perf-guy-sizing-exchange-2013-deployments.aspx" target="_blank">full post here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Sizing Exchange 2013 Deployments&p[summary]=The Exchange Team recently released some great guidance on how to size Exchange 2013 deployments. I think this is a really comprehensive ...&p[url]=http://172.16.7.177:4000/2013/05/sizing-exchange-2013-deployments" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/05/sizing-exchange-2013-deployments&text=The Exchange Team recently released some great guidance on how to size Exchange 2013 deployments. I think this is a really comprehensive ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-04-04T05:05:55-05:00" itemprop="datePublished">4 Apr, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/04/exchange-2013-cu1-released-2">Exchange 2013 CU1 Released!</a></h2>
    </header>

    <div class="post-content">
        <p>Following the <a href="http://www.cgoosen.com/2013/02/exchange-2010-sp3-released/" target="_blank">release of Exchange 2010 SP3</a> in February, the Exchange Team have <a href="http://blogs.technet.com/b/exchange/archive/2013/04/02/released-exchange-server-2013-rtm-cumulative-update-1.aspx" target="_blank">announced the release of Exchange Server 2013 Cumulative Update 1 (CU1)</a>. CU1 does include some new features, including *some* access Public Folder content through Outlook Web App but I think it is fair to say that legacy coexistence is the reason everyone has been waiting for CU1. CU1 is the minimum version of Exchange 2013 required for on-premises coexistence with supported legacy Exchange Server versions, but, before you steam ahead and install it I think it is important to understand all the caveats of coexistence so be sure to <a href="http://technet.microsoft.com/en-us/library/aa998636(v=exchg.150).aspx" target="_blank">check out the Planning and Deployment documentation</a>. Scott Schnoll put together a great <a href="http://blogs.technet.com/b/scottschnoll/archive/2013/04/02/high-availability-changes-in-exchange-server-2013-cumulative-update-1.aspx" target="_blank">post about the high availability changes in Exchange 2013 CU1</a> which is also worth reading.</p>
<p>The Exchange 2013 CU1 release notes are <a href="http://technet.microsoft.com/en-us/library/jj150489(v=exchg.150).aspx" target="_blank">available here</a> and you can <a href="http://www.microsoft.com/en-us/download/details.aspx?id=38176" target="_blank">download it here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2013 CU1 Released!&p[summary]=Following the release of Exchange 2010 SP3 in February, the Exchange Team have announced the release of Exchange Server 2013 Cumulative U...&p[url]=http://172.16.7.177:4000/2013/04/exchange-2013-cu1-released-2" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/04/exchange-2013-cu1-released-2&text=Following the release of Exchange 2010 SP3 in February, the Exchange Team have announced the release of Exchange Server 2013 Cumulative U...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-03-27T09:52:32-05:00" itemprop="datePublished">27 Mar, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/03/exchange-server-and-the-reverse-proxy">Exchange Server and the Reverse Proxy</a></h2>
    </header>

    <div class="post-content">
        <p>Ever since <a href="http://blogs.technet.com/b/server-cloud/archive/2012/09/12/important-changes-to-forefront-product-roadmaps.aspx" target="_blank">Microsoft announced</a> that Forefront Threat Management Gateway (TMG) 2010 will be discontinued, I have had many customers ask me &ldquo;What should we use as a reverse proxy for Exchange?&rdquo;. This question has sparked many heated debates among colleagues and customers alike. To be fair, this announcement may have come as a huge shock to many people, but I think deep down many of us expected it to happen sooner or later.. TMG was a great product and really became the de facto standard for reverse proxying Exchange (and Lync, etc) and thinking back to all the Exchange deployments I have been involved with over the years, it is fair to say that most of them made use of ISA/TMG as a reverse proxy in some way. It worked well, but sadly all good things come to an end.</p>
<p>So, lets get back to the question.. &ldquo;What should we use as a reverse proxy for Exchange?&rdquo; I&rsquo;ve been thinking about this for a while and I don&rsquo;t believe there is a magical silver bullet solution that will work for everyone and I urge my customers to think it through and make an informed decision. Do you even need a reverse proxy for Exchange? This is where things get heated.. but hear me out.. there are those who have been talking about the death of the DMZ for some time now. I remember attending a Tech-Ed session back in 2008 where <a href="http://channel9.msdn.com/Events/TechEd/Europe/2008/SEC309" target="_blank">Steve Riley talked about this</a> and Deb Shinder has also <a href="http://www.windowsecurity.com/articles-tutorials/misc_network_security/Has-Day-Death-DMZ-Finally-Arrived.html" target="_blank">blogged about this topic in the past.</a> I&rsquo;m not saying get rid of your firewall, but what I am saying is that perhaps you no longer need to use a reverse proxy to secure connections to your Exchange servers and this is something that should be thought about. My first response to the &ldquo;What should we use as a reverse proxy for Exchange?&rdquo; question is &ldquo;Do you still need a reverse proxy?&rdquo; and 99% of the time the answer I get back is &ldquo;Yes, because it is insecure not to&rdquo;. Perhaps it used to be, but is that statement still true? Every environment is different and every organisation has different needs and requirements. My intention with this post is to help you ask the right questions and make an informed decision.</p>
<p>One of the great things about being a consultant is that I get to work with many different types of customers and see many different types of environments and typically the decision to implement a reverse proxy is driven by one or both of the following factors:</p>
<ol>
<li><strong>Application Hardening</strong> - The concept of application hardening has been around for some time now and there is a lot of information floating around about it. The question we need to ask is: does Exchange (the CAS role in particular) need to be hardened? The reality is that times have changed and both Windows Server and Exchange have matured and are hardened by default. Exchange CAS was designed to be internet facing so there really is no need for a reverse proxy in order to secure it anymore. Sure, using a reverse proxy is useful if you wish to implement third party two factor authentication or have other very specific requirements, but will your Exchange implementation be less secure without one? probably not.
<li><strong>Security Policy - </strong>Security policy is much more complex and as you would expect, these policies come in many flavours! One thing most of them have in common is that they restrict traffic from passing through an entire zone or prevent services on the internal network from being accessed directly from the internet, i.e traffic cannot pass directly through the DMZ to the internal network, and must first terminate in the DMZ. In the past, the solution was to implement ISA/TMG as a reverse proxy in the DMZ. We already know that Exchange does not need any further hardening, so technically there is no need for this, but while technology matures relatively quickly security policies rarely keep up so it is fairly common to have this type of out-dated policy that dictates the use of a reverse proxy. Sometimes the remnants of this type of security policy are still visible long after the policy has evolved &ndash; I did some work with a customer recently who had a policy like this in the past and over time as their network grew they made decisions based on this policy that have resulted in a few technical constraints that are now causing some headaches. Typically, these security policies are similar to the diagram below:</li>
</ol>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2013/03/Blog-Diagrams.png"><img title="Blog Diagrams" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="Blog Diagrams" src="http://www.cgoosen.com/wp-content/uploads/2013/03/Blog-Diagrams_thumb.png" width="742" height="346"></a></p>
<p>There is something else to consider and that is performance. Often due to the mission critical nature of DMZ infrastructure and its various dependencies, this infrastructure is not upgraded or refreshed as regularly as other infrastructure so you end up building on infrastructure that was never intended to deal with the load that is now being placed on it. A classic example of this is an environment I saw a while back &ndash; this particular organisation was in the process of refreshing their messaging platform and had just made a significant investment in a highly available Exchange environment only to go and use the ageing 32-bit only ISA 2006 infrastructure in their DMZ as a reverse proxy because connections to Exchange needed to be &ldquo;secured&rdquo;.</p>
<p>So what&rsquo;s answer then? Well.. I think it is important to first understand what your requirements are. Are you currently using TMG? why change? Mainstream support for TMG will <a href="http://support.microsoft.com/lifecycle/search/default.aspx?sort=PN&amp;alpha=Forefront+Threat+Management+Gateway+2010&amp;Filter=FilterNO" target="_blank">continue into 2015 with extended support through 2020</a>. Are you looking to implement a reverse proxy because you think it will make Exchange more secure? If so, perhaps you need to rethink your approach. Are you looking for a TMG replacement because your security policy dictates the use of a proxy server and you really have no choice in the matter? Here are three options:</p>
<ol>
<li><strong>F5 BIG-IP Access Policy Manager (APM)</strong>&nbsp; - Many organisations have already invested in BIG-IP LTM devices to load balance Exchange. It makes sense to leverage this infrastructure, you&rsquo;ll have the added benefit of infrastructure consolidation if you move the reverse proxy functionality to your BIG-IP devices. <a href="http://www.f5.com/products/big-ip/big-ip-access-policy-manager/overview/" target="_blank">More info here</a>
<li><strong>KEMP LoadMaster Edge Security Pack (ESP) - </strong>I have always been a big fan of the KEMP LoadMaster devices and KEMP is currently working on their Edge Security Pack which will help provide some TMG functionality and compliment their already excellent offering. These devices already provide excellent value for money and my understanding is that the ESP will be a free upgrade for most customers. ESP is not publically available yet but I think it is worth looking at. <a href="http://www.kemptechnologies.com/en/tmg-edge-security-authentication.html" target="_blank">More info here</a>
<li><strong>Apache HTTP Server with mod_proxy - </strong>No, your eyes are not deceiving you, it is possible to use apache as a reverse proxy. I am not making any claims about the supportability of the solution or saying that it is an enterprise ready option, and just because it is possible to do it does not mean you should. I have seen many attempts at this solution in the past so I am currently working on a post that will provide a guide on how to go about setting it all up as well as explain the limitations and pitfalls of the solution. I hope to post more about it soon.</li>
</ol>
<p>I&rsquo;m sure there are many other equally suitable solutions, but my intention was to mention some of the ones I have worked with or tested. Each of these also have different pricing and scalability options so they will appeal to a wide range of different organisations.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange Server and the Reverse Proxy&p[summary]=Ever since Microsoft announced that Forefront Threat Management Gateway (TMG) 2010 will be discontinued, I have had many customers ask me...&p[url]=http://172.16.7.177:4000/2013/03/exchange-server-and-the-reverse-proxy" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/03/exchange-server-and-the-reverse-proxy&text=Ever since Microsoft announced that Forefront Threat Management Gateway (TMG) 2010 will be discontinued, I have had many customers ask me...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-02-20T03:45:18-06:00" itemprop="datePublished">20 Feb, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/02/ios-6-1-2-software-update-fixes-exchange-calendar-bug">iOS 6.1.2 Software Update - Fixes Exchange calendar bug</a></h2>
    </header>

    <div class="post-content">
        <p>Looks like <a href="http://support.apple.com/kb/DL1639" target="_blank">Apple finally released</a> an update to fit the <a href="http://www.cgoosen.com/2013/02/apple-ios-6-1-devices-causing-increased-resource-consumption-in-exchange-server-2010/" target="_blank">exchange calendar bug</a></p>
<p>&nbsp;</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2013/02/photo.png"><img title="photo" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="photo" src="http://www.cgoosen.com/wp-content/uploads/2013/02/photo_thumb.png" width="453" height="677"></a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=iOS 6.1.2 Software Update - Fixes Exchange calendar bug&p[summary]=Looks like Apple finally released an update to fit the exchange calendar bug
&nbsp;

&p[url]=http://172.16.7.177:4000/2013/02/ios-6-1-2-software-update-fixes-exchange-calendar-bug" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/02/ios-6-1-2-software-update-fixes-exchange-calendar-bug&text=Looks like Apple finally released an update to fit the exchange calendar bug
&nbsp;

&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-02-14T03:54:21-06:00" itemprop="datePublished">14 Feb, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/02/apple-ios-6-1-devices-causing-increased-resource-consumption-in-exchange-server-2010">Apple iOS 6.1 devices causing increased resource consumption in Exchange Server 2010</a></h2>
    </header>

    <div class="post-content">
        <p><span style="color: #ff0000;">Update:</span> <a title="iOS 6.1.2 Software Update &ndash; Fixes Exchange calendar bug" href="http://www.cgoosen.com/2013/02/ios-6-1-2-software-update-fixes-exchange-calendar-bug/">iOS 6.1.2 resolves this problem</a></p>
<p>I have see a lot of reports lately about the Apple iOS 6.1 bug effecting organisations using Exchange 2010. The problem appears to occur when a user using a Apple device (iPad, iPhone, etc) with iOS 6.1 responds to or edits a single instance of a recurring calendar event, this causes excessive log growth and a significant increase in memory and CPU resource consumption in turn causing server performance to be affected. Both <a href="http://support.microsoft.com/kb/2814847" target="_blank">Microsoft</a> and <a href="http://support.apple.com/kb/TS4532" target="_blank">Apple</a> have released support articles for this bug, but at the time of writing it has not been fixed.</p>
<p>If you do currently have a large iOS device fleet, I would suggest advising your users against upgrading their devices until this is resolved. If you are already experiencing resource problems on your Exchange servers, I strongly suggest using either a custom throttling policy for iOS 6.1 users or blocking iOS 6.1 users completely. For more information on these workarounds, see the <a href="http://support.microsoft.com/kb/2814847" target="_blank">following Microsoft support article.</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Apple iOS 6.1 devices causing increased resource consumption in Exchange Server 2010&p[summary]=Update: iOS 6.1.2 resolves this problem
I have see a lot of reports lately about the Apple iOS 6.1 bug effecting organisations using Exch...&p[url]=http://172.16.7.177:4000/2013/02/apple-ios-6-1-devices-causing-increased-resource-consumption-in-exchange-server-2010" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/02/apple-ios-6-1-devices-causing-increased-resource-consumption-in-exchange-server-2010&text=Update: iOS 6.1.2 resolves this problem
I have see a lot of reports lately about the Apple iOS 6.1 bug effecting organisations using Exch...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-02-13T03:48:22-06:00" itemprop="datePublished">13 Feb, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/02/exchange-2010-sp3-released">Exchange 2010 SP3 Released!</a></h2>
    </header>

    <div class="post-content">
        <p>A few moments ago the <a href="http://blogs.technet.com/b/exchange/archive/2013/02/12/released-exchange-server-2010-sp3.aspx" target="_blank">Microsoft Exchange Team</a> announced the availability of Exchange 2010 SP3. I can&rsquo;t remember any other service pack that has been as eagerly anticipated as this one, mostly because SP3 will allow coexistence with Exchange 2013 which was <a href="http://www.cgoosen.com/2012/10/exchange-2013-is-rtm/" target="_blank">released late last year</a>. Unfortunately, it appears that customers wanting to introduce Exchange Server 2013 into their existing Exchange 2010 environment will have to wait just a little longer for the release of Exchange 2013 CU1, or at least that is how I interpret the following release note on the Exchange Team Blog:</p>
<blockquote><p><strong>NOTE</strong>: Exchange 2010 SP3 allows Exchange 2010 servers to coexist with Exchange 2013 CU1, which is also scheduled to be released in Q1 2013. Customers can test and validate this update in a representative lab environment prior to rolling out in their production environments as an important coexistence preparatory step before introducing Exchange Server 2013 CU1.</p>
</blockquote>
<p>This service pack also resolves numerous issues, a list of these <a href="http://blogs.technet.com/b/exchange/archive/2013/02/12/released-exchange-server-2010-sp3.aspx" target="_blank">can be found here</a>.</p>
<p>To download Exchange 2010 SP3, <a href="http://www.microsoft.com/en-us/download/details.aspx?id=36768" target="_blank">click here.</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2010 SP3 Released!&p[summary]=A few moments ago the Microsoft Exchange Team announced the availability of Exchange 2010 SP3. I can&rsquo;t remember any other service p...&p[url]=http://172.16.7.177:4000/2013/02/exchange-2010-sp3-released" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/02/exchange-2010-sp3-released&text=A few moments ago the Microsoft Exchange Team announced the availability of Exchange 2010 SP3. I can&rsquo;t remember any other service p...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2013-01-24T04:42:56-06:00" itemprop="datePublished">24 Jan, 2013</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2013/01/exchange-2013-server-role-architecture">Exchange 2013 Server Role Architecture</a></h2>
    </header>

    <div class="post-content">
        <p>In case you missed it, the evolution of hardware has caused an architectural change in Exchange 2013.. gone are the 5 Exchange server roles that we have all come to know and love since Exchange 2007. In Exchange 2013 things are a lot more simple with only two server roles, namely, the Client Access server role and the Mailbox server role. Don&rsquo;t let the familiar names fool you though, there is nothing familiar about these roles. In Exchange Server 2013 there are two basic building blocks &ndash; the Client Access array and the Database Availability Group (DAG). Each provides a unit of high availability and fault tolerance that are decoupled from one another. Client Access servers make up the CAS array, while Mailbox servers comprise the DAG.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2013/01/1300.2013_6E0D4D921.png"><img title="1300.2013_6E0D4D92" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="1300.2013_6E0D4D92" src="http://www.cgoosen.com/wp-content/uploads/2013/01/1300.2013_6E0D4D92_thumb1.png" width="783" height="379"></a></p>
<p>Ross Smith did a great job (obviously!) of introducing the new Exchange 2013 role architecture during the technical keynote at MEC 2012 last year.. if you have not already seen it, I highly <a href="http://www.iammec.com/video" target="_blank">recommend you watch it here</a>. He also recently publish the following post of the Exchange team <a href="http://blogs.technet.com/b/exchange/archive/2013/01/23/exchange-2013-server-role-architecture.aspx" target="_blank">blog that covers the same topic.</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2013 Server Role Architecture&p[summary]=In case you missed it, the evolution of hardware has caused an architectural change in Exchange 2013.. gone are the 5 Exchange server rol...&p[url]=http://172.16.7.177:4000/2013/01/exchange-2013-server-role-architecture" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2013/01/exchange-2013-server-role-architecture&text=In case you missed it, the evolution of hardware has caused an architectural change in Exchange 2013.. gone are the 5 Exchange server rol...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2012-12-15T10:48:08-06:00" itemprop="datePublished">15 Dec, 2012</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2012/12/exchange-2007-2010-problems-after-installing-kb2506146-or-kb2506143">Exchange 2007 & 2010 problems after installing KB2506146 or KB2506143</a></h2>
    </header>

    <div class="post-content">
        <p>Microsoft recently released&nbsp;<a href="http://support.microsoft.com/kb/2506146" target="_blank">KB2506146</a>&nbsp;and&nbsp;<a href="http://support.microsoft.com/kb/2506143" target="_blank">KB2506143</a>&nbsp;as optional updates depending on your which server version you are running (2008 SP2 or 2008 R2 SP1)</p>
<p>The update includes&nbsp;Windows Management Framework 3.0 and more specifically PowerShell 3.0 which is not supported on either Exchange 2007 or Exchange 2010. There have <a href="http://blogs.technet.com/b/exchange/archive/2012/12/14/windows-management-framework-3-0-on-exchange-2007-and-exchange-2010.aspx" target="_blank">been reports</a> of it causing issues with the installation of rollups&nbsp;resulting in an error code of &ldquo;1603&rdquo; appearing in the event log.</p>
<p>It is recommended that&nbsp;Windows Management Framework 3.0 should not be installed on servers running either Exchange 2007 or Exchange 2010. Uninstalling&nbsp;Windows Management Framework 3.0 reportedly fixes the issues.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2007 & 2010 problems after installing KB2506146 or KB2506143&p[summary]=Microsoft recently released&nbsp;KB2506146&nbsp;and&nbsp;KB2506143&nbsp;as optional updates depending on your which server version you ar...&p[url]=http://172.16.7.177:4000/2012/12/exchange-2007-2010-problems-after-installing-kb2506146-or-kb2506143" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2012/12/exchange-2007-2010-problems-after-installing-kb2506146-or-kb2506143&text=Microsoft recently released&nbsp;KB2506146&nbsp;and&nbsp;KB2506143&nbsp;as optional updates depending on your which server version you ar...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2012-11-06T10:34:10-06:00" itemprop="datePublished">6 Nov, 2012</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2012/11/controlling-activesync-device-access-on-exchange-2013">Controlling ActiveSync device access on Exchange 2013</a></h2>
    </header>

    <div class="post-content">
        <p>I previously blogged about <a href="http://www.cgoosen.com/2012/10/controlling-activesync-device-access-on-exchange-2010-and-exchange-online/" target="_blank">controlling ActiveSync device access on Exchange 2010 and Exchange Online</a> and thought I would follow-up with quick post on how to accomplish the same results on Exchange 2013. For this post, I will create the same policy as before..&nbsp; a device policy to quarantine any iPad devices. The use case for this scenario is that an organisation may for example allow users to choose whatever mobile phone they would like to use but block the use of iPads because these are not devices issued by the company. By quarantining a device, we can easily see who is attempting to use such a device, how many are out there and even decide to create a new policy specific to these devices.</p>
<p>To create a device policy, we need to access the &ldquo;Mobile Device Access&rdquo; option under the &ldquo;Mobile&rdquo; menu item in EAC. It should look something like this:</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2012/11/blog1.png"><img title="blog1" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="blog1" src="http://www.cgoosen.com/wp-content/uploads/2012/11/blog1_thumb.png" width="588" height="259"></a></p>
<p>Clicking the &ldquo;Edit&rdquo; button will allow you to edit various settings. As you can see, I have decided to be permissive and allow all devices unless they are managed by a rule. You can select a distribution group or administrative account that will receive quarantine notification emails. You also have the option to add any custom or organisation specific text that will be included in the email notification sent to users when their device is blocked or quarantined.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2012/11/blog2.png"><img title="blog2" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="blog2" src="http://www.cgoosen.com/wp-content/uploads/2012/11/blog2_thumb.png" width="446" height="482"></a></p>
<p>We then click &ldquo;+&rdquo; under &ldquo;Device Access Rules&rdquo; at the bottom of the page to define our new rule. Here we can browse a list of all the devices and device families that have recently connected to our Exchange environment. Device family is a grouping of similar devices, in our case for example if we choose a Device family of &ldquo;iPad&rdquo; we can then decide to only apply this rule to iPad2 models or &ldquo;All models&rdquo; by selecting the appropriate device type. Lastly, we select our ABQ action:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2012/11/blog3.png"><img title="blog3" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="blog3" src="http://www.cgoosen.com/wp-content/uploads/2012/11/blog3_thumb.png" width="357" height="410"></a></p>
<p>Once we have clicked &ldquo;Save&rdquo; we should see the new device access rule listed under &ldquo;Device Access Rules&rdquo;</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2012/11/blog4.png"><img title="blog4" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="blog4" src="http://www.cgoosen.com/wp-content/uploads/2012/11/blog4_thumb.png" width="764" height="118"></a></p>
<p>Once we have created the access rule, if any users attempt to connect using an iPad, they will be listed under &ldquo;Quarantines Devices&rdquo;</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2012/11/blog5.png"><img title="blog5" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="blog5" src="http://www.cgoosen.com/wp-content/uploads/2012/11/blog5_thumb.png" width="655" height="107"></a></p>
<p>Users will receive a notification email similar to the following if they try to connect using an iPad:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2012/11/photo.png"><img title="photo" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="photo" src="http://www.cgoosen.com/wp-content/uploads/2012/11/photo_thumb.png" width="482" height="456"></a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Controlling ActiveSync device access on Exchange 2013&p[summary]=I previously blogged about controlling ActiveSync device access on Exchange 2010 and Exchange Online and thought I would follow-up with q...&p[url]=http://172.16.7.177:4000/2012/11/controlling-activesync-device-access-on-exchange-2013" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2012/11/controlling-activesync-device-access-on-exchange-2013&text=I previously blogged about controlling ActiveSync device access on Exchange 2010 and Exchange Online and thought I would follow-up with q...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2012-10-16T06:15:02-05:00" itemprop="datePublished">16 Oct, 2012</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2012/10/controlling-activesync-device-access-on-exchange-2010-and-exchange-online">Controlling ActiveSync device access on Exchange 2010 and Exchange Online</a></h2>
    </header>

    <div class="post-content">
        <p>I am often surprised by how few customers know about or use ActiveSync device access rules (or ABQ for short) in Exchange 2010 when everyone seems to have the requirement to some degree or another. I see a growing trend to use third party products to do what Exchange can and has been able to do natively for a while now so I thought I would put together this post to go through some of the functionality offered by ABQ.</p>
<p>Before I continue, I would like to highlight the following two things:</p>
<ol>
<li>Device access rules (ABQ) should not be confused with or is not intended to replace ActiveSync policies which are used to enforce things like device passwords, device encryption, etc. (click <a href="http://technet.microsoft.com/en-us/library/bb123484.aspx" target="_blank">here for more on ActiveSync policies</a>)</li>
<li>Everything described in this post also applies to Exchange Online</li>
</ol>
<p>Depending on your requirements, you may decide to take a restrictive approach where you only allow a small set of tested and supported devices or be more permissive and only block/quarantine problematic devices. For this post, I will create a device policy to quarantine any iPad devices. The use case for this scenario is that an organisation may for example allow users to choose whatever mobile phone they would like to use but block the use of iPads because these are not devices issued by the company. By quarantining a device, we can easily see who is attempting to use such a device, how many are out there and even decide to create a new policy specific to these devices.</p>
<p>During the connection process, Exchange will follow a logical set of rules to determine the access state of each device and will either allow, block or quarantine the device based on the outcome. The sequence of challenges includes the following steps:</p>
<ol>
<li>Is the device authenticated? If not, challenge for the correct credentials. Otherwise, go on to the next step.</li>
<li>Is Exchange ActiveSync enabled for the current user? If not, return an "access restricted" error to the device. Otherwise, go on to the next step.</li>
<li>Are the policy enforcement criteria met by the current mobile device? If not, block access. Otherwise, go on to the next step.</li>
<li>Is this device blocked by a personal exemption for the user? If so, block access. Otherwise, go on to the next step.</li>
<li>Is this device allowed by a personal exemption for the user? If so, grant full access. Otherwise, go on to the next step.</li>
<li>Is this device blocked by a device access rule? If so, block access. Otherwise, go on to the next step.</li>
<li>Is this device quarantined by a device access rule? If so, quarantine the device. Otherwise, go on to the next step.</li>
<li>Is this device allowed by a device access rule? If so, grant full access. Otherwise, go on to the next step.</li>
<li>Apply the default access state per the Exchange ActiveSync organisational settings.</li>
</ol>
<p>The device policy that I am going to create will be applied at Step 7. To create a device policy, we need to access the &ldquo;ActiveSync Access&rdquo; options under &ldquo;Phone &amp; Voice&rdquo; settings in the ECP. It should look something like this:</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2012/10/blog2.png"><img title="blog2" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; border-left: 0px; display: block; padding-right: 0px; margin-right: auto" border="0" alt="blog2" src="http://www.cgoosen.com/wp-content/uploads/2012/10/blog2_thumb.png" width="606" height="247"></a></p>
<p>Clicking the &ldquo;Edit&rdquo; button will allow you to edit various settings. As you can see, I have decided to be permissive and allow all devices unless they are managed by a rule. You can select a distribution group or administrative account that will receive quarantine notification emails. You also have the option to add any custom or organisation specific text that will be included in the email notification sent to users when their device is blocked or quarantined. </p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2012/10/blog1.png"><img title="blog1" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="blog1" src="http://www.cgoosen.com/wp-content/uploads/2012/10/blog1_thumb.png" width="458" height="487"></a></p>
<p>We then click &ldquo;New&rdquo; under &ldquo;Device Access Rules&rdquo; at the bottom of the page to define our new rule. Here we can browse a list of all the devices and device families that have recently connected to our Exchange environment. Device family is a grouping of similar devices, in our case for example if we choose a Device family of &ldquo;iPad&rdquo; we can then decide to only apply this rule to iPad2 models or &ldquo;All models&rdquo; by selecting the appropriate device type. Lastly, we select our ABQ action.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2012/10/blog3.png"><img title="blog3" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="blog3" src="http://www.cgoosen.com/wp-content/uploads/2012/10/blog3_thumb.png" width="464" height="520"></a></p>
<p align="left">Once we have clicked &ldquo;Save&rdquo; we should see the new device access rule listed under &ldquo;Device Access Rules&rdquo;</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2012/10/blog4.png"><img title="blog4" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="blog4" src="http://www.cgoosen.com/wp-content/uploads/2012/10/blog4_thumb.png" width="874" height="121"></a></p>
<p>Once we have created the access rule, if any users attempt to connect using an iPad, they will be listed under &ldquo;Quarantines Devices&rdquo;</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2012/10/blog5.png"><img title="blog5" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="blog5" src="http://www.cgoosen.com/wp-content/uploads/2012/10/blog5_thumb.png" width="690" height="119"></a></p>
<p>Users will receive a notification email similar to the following if they try to connect using an iPad. Note the custom text entered previously (red box)</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2012/10/blog6.png"><img title="blog6" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="blog6" src="http://www.cgoosen.com/wp-content/uploads/2012/10/blog6_thumb.png" width="517" height="492"></a></p>
<p align="left">One last thing to mention is that you do have the ability to make a personal exception for a specific user if needed, so for example if you have an executive who is adamant about wanting to use his/her iPad of if you decide after some time to test iPads this can be done without affecting anyone else. As always, full documentation can be found on <a href="http://technet.microsoft.com/en-us/library/ff959225.aspx" target="_blank">TechNet</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Controlling ActiveSync device access on Exchange 2010 and Exchange Online&p[summary]=I am often surprised by how few customers know about or use ActiveSync device access rules (or ABQ for short) in Exchange 2010 when every...&p[url]=http://172.16.7.177:4000/2012/10/controlling-activesync-device-access-on-exchange-2010-and-exchange-online" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2012/10/controlling-activesync-device-access-on-exchange-2010-and-exchange-online&text=I am often surprised by how few customers know about or use ActiveSync device access rules (or ABQ for short) in Exchange 2010 when every...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2012-10-12T04:56:41-05:00" itemprop="datePublished">12 Oct, 2012</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2012/10/exchange-2013-is-rtm">Exchange 2013 is RTM!</a></h2>
    </header>

    <div class="post-content">
        <p>Earlier today Exchange 2013 reached RTM status. This is a very exciting announcement and means that coding and testing is now complete. General availability is planned for the first quarter of 2013. In addition to Exchange, the new Office, SharePoint, and Lync have also reached <acronym>RTM</acronym>. For more information on the announcement, <a href="http://blogs.office.com/b/office-news/" target="_blank">click here.</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2013 is RTM!&p[summary]=Earlier today Exchange 2013 reached RTM status. This is a very exciting announcement and means that coding and testing is now complete. G...&p[url]=http://172.16.7.177:4000/2012/10/exchange-2013-is-rtm" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2012/10/exchange-2013-is-rtm&text=Earlier today Exchange 2013 reached RTM status. This is a very exciting announcement and means that coding and testing is now complete. G...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2012-09-11T17:01:17-05:00" itemprop="datePublished">11 Sep, 2012</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2012/09/exchange-2013-introducing-the-exchange-administration-center">Exchange 2013 - Introducing The Exchange Administration Center</a></h2>
    </header>

    <div class="post-content">
        <p>If you&rsquo;ve decided to get you hands dirty with the Exchange 2013 Preview, the first thing you probably noticed when clicking on the start menu after installation is this:</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2012/09/image.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2012/09/image_thumb.png" width="189" height="76"></a>&nbsp; </p>
<p>Your eyes are not deceiving you, there is no shortcut to for the Exchange Management Console (EMC)&hellip; the reason for this is simple, it&rsquo;s not there! Exchange 2013 bids farewell to the EMC that we have come to love since Exchange 2007 and introduces a new management interface called the Exchange Administration Center (EAC). EAC is the new web-based management console in Microsoft Exchange Server 2013 and it allows administrators to manage on-premises, online, or hybrid Exchange deployments. As one would expect, EAC makes use of roles based access control to ensure that specialist or support users are able to perform only the specific tasks which are assigned to them.</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2012/09/image1.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; border-top-width: 0px; margin-right: auto" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2012/09/image_thumb1.png" width="680" height="379"></a></p>
<p>oh, before I forget, I should mention that all names in the screenshot are randomly generated fakes!</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2013 - Introducing The Exchange Administration Center&p[summary]=If you&rsquo;ve decided to get you hands dirty with the Exchange 2013 Preview, the first thing you probably noticed when clicking on the ...&p[url]=http://172.16.7.177:4000/2012/09/exchange-2013-introducing-the-exchange-administration-center" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2012/09/exchange-2013-introducing-the-exchange-administration-center&text=If you&rsquo;ve decided to get you hands dirty with the Exchange 2013 Preview, the first thing you probably noticed when clicking on the ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2012-09-09T17:37:42-05:00" itemprop="datePublished">9 Sep, 2012</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2012/09/mec-2012-the-lost-conference">MEC 2012 - The lost conference!</a></h2>
    </header>

    <div class="post-content">
        <p>I can&rsquo;t believe how quickly this year has gone, it is almost time for me to start packing my bags for another trip..&nbsp; I'll be attending the Microsoft Exchange Conference 2012 (MEC) in Orlando, September 24th-26th. I am really looking forward to this great opportunity to learn about the product from the engineers who built it. There will be more than 100 sessions, some of the topics that will be covered in breakout sessions, keynotes and hands-on labs include:</p>
<ul>
<li>Exchange Server 2013 Architecture</li>
<li>Security and Protection in the new Exchange</li>
<li>Configuring built-in Anti-Malware/Anti-Spam protection</li>
<li>Setting up Data Loss Prevention policies</li>
<li>Compliance, eDiscovery and Archiving in the new Exchange</li>
<li>Exchange Server 2013 Manage Availability and Monitoring</li>
<li>Unified Messaging in Exchange Server 2013</li>
<li>Exchange Server 2013 Deployment and Exchange Server 2010 Coexistence</li>
<li>Moving to the cloud with Exchange Online and Office365</li>
</ul>
<p>Let me know if you are also planning to attend, it would be great to catch up!</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2012/09/MEC12_Sig_IllBeAt.jpg"><img title="MEC12_Sig_IllBeAt" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="MEC12_Sig_IllBeAt" src="http://www.cgoosen.com/wp-content/uploads/2012/09/MEC12_Sig_IllBeAt_thumb.jpg" width="244" height="100"></a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=MEC 2012 - The lost conference!&p[summary]=I can&rsquo;t believe how quickly this year has gone, it is almost time for me to start packing my bags for another trip..&nbsp; I'll be ...&p[url]=http://172.16.7.177:4000/2012/09/mec-2012-the-lost-conference" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2012/09/mec-2012-the-lost-conference&text=I can&rsquo;t believe how quickly this year has gone, it is almost time for me to start packing my bags for another trip..&nbsp; I'll be ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2012-07-17T08:20:21-05:00" itemprop="datePublished">17 Jul, 2012</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2012/07/say-ehlo-to-exchange-2013">Say EHLO to Exchange 2013!</a></h2>
    </header>

    <div class="post-content">
        <p>I am very excited to let you all know that Microsoft has made the preview release of Exchange 2013 available <a href="http://technet.microsoft.com/en-us/evalcenter/hh973395" target="_blank">for download.</a></p>
<p>This release has been highly anticipated, for more information about the Exchange 2013 preview, <a href="http://www.microsoft.com/exchange/en-us/exchange-preview.aspx" target="_blank">click here.</a> In addition, the <a href="http://technet.microsoft.com/en-us/office/fp160948.aspx" target="_blank">Office 2013 preview was also announced.</a> Exchange 2013 preview documentation has also been updated on <a href="http://technet.microsoft.com/en-us/library/bb124558(v=exchg.150)" target="_blank">TechNet.</a></p>
<p>Watch this space for news and information about what you can expect to see in Exchange 2013!</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2012/07/Capture.png"><img title="Capture" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="Capture" src="http://www.cgoosen.com/wp-content/uploads/2012/07/Capture_thumb.png" width="615" height="238" /></a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Say EHLO to Exchange 2013!&p[summary]=I am very excited to let you all know that Microsoft has made the preview release of Exchange 2013 available for download.
This release h...&p[url]=http://172.16.7.177:4000/2012/07/say-ehlo-to-exchange-2013" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2012/07/say-ehlo-to-exchange-2013&text=I am very excited to let you all know that Microsoft has made the preview release of Exchange 2013 available for download.
This release h...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2012-06-22T09:51:37-05:00" itemprop="datePublished">22 Jun, 2012</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2012/06/exchange-hybrid-multi-namespace-autodiscover-configuration">Exchange Hybrid Multi-namespace Autodiscover Configuration</a></h2>
    </header>

    <div class="post-content">
        <p>I came across an interesting issue when using the Exchange Hybrid Configuration Wizard in a multi-namespace environment recently. Autodiscover was configured and working correctly for Outlook and EAS clients but the wizard would not complete successfully and would generate the following error: &ldquo;Federation information could not be received from the external organization&hellip;&rdquo; as seen below:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2012/06/autodiscover.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="autodiscover" src="http://www.cgoosen.com/wp-content/uploads/2012/06/autodiscover_thumb.png" alt="autodiscover" width="568" height="495" border="0" /></a></p>
<p>After some investigation, I discovered that this problem was related to Autodiscover. Typically in an on-premises Exchange 2010 deployment, there are a number of different ways to configure Autodiscover when using multiple namespaces. These are:</p>
<p><strong><span style="text-decoration: underline;">Option 1 - Single SSL Certificate that is valid for all DNS names (SAN Certificate)</span></strong><br />
<strong>Pros:</strong></p>
<ul>
<li>Requires only one certificate.</li>
<li>Requires only 1 public IP.</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>Cost of additional DNS names in the SAN certificate could be expensive.</li>
</ul>
<p><strong><span style="text-decoration: underline;">Option 2 - Single-name SSL Certificate with DNS SRV Lookup</span></strong><br />
<strong>Pros:</strong></p>
<ul>
<li>Requires only 1 public IP.</li>
<li>Requires 1 single-name SSL certificate.</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>Not all DNS hosting providers support DNS SRV records.</li>
<li>Outlook users may be prompted.</li>
<li>Outlook 2007 required client-side hotfix.</li>
</ul>
<p><strong><span style="text-decoration: underline;">Option 3 - Single-name SSL Certificate with HTTP redirect</span></strong><br />
<strong>Pros:</strong></p>
<ul>
<li>Requires 1 single-name SSL certificate.</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>Requires 2 public IPs</li>
<li>Requires a second IIS site or ISA/TMG</li>
</ul>
<p>While these will all work and have their pros and cons, I would usually always use &lsquo;option 1&rsquo; listed above unless there is a good reason not to. In this particular instance, the Autodiscover was configured using &lsquo;option 3&rsquo; and even though Autodiscover worked fine for clients, the Hybrid Configuration Wizard did not seem to like this configuration.</p>
<p>The Office 365 documentation does not go into a great amount of detail about multi-domain Autodiscover configuration and says: &ldquo;Configure the Autodiscover public DNS records for your existing SMTP domains to point to an on-premises Exchange 2010 SP2 Client Access server&rdquo; which is technically what had been done. The reason this caused a problem is because unlike Outlook or EAS clients, Office 365 does not use the Autodiscover discovery process and instead makes a direct connection to <strong>https://autodiscover.domain.com/autodiscover/autodiscover.svc/wssecurity </strong>for each domain being used and does not obey the web redirect that had previously been configured.</p>
<p>In order to solve this problem, we purchased a new SAN certificate and reconfigured Autodiscover as described in &lsquo;option 1&rsquo;. In short, this is the only way to configure Autodiscover if you plan to implement an Exchange Hybrid Deployment. Additionally, if you are not using split DNS and have an internal DNS zone that is different to your external DNS (eg. domain.local), you need to ensure that the relevant external Autodiscover records are resolvable internally as well.</p>
<p>As a side note, if you are using ISA/TMG to publish EWS/Autodiscover, you need to create a separate rule without authentication delegation for the following paths:</p>
<ul>
<li>/ews/mrsproxy.svc</li>
<li>/ews/exchange.asmx/wssecurity</li>
<li>/autodiscover/autodiscover.svc/wssecurity</li>
<li>/autodiscover/autodiscover.svc</li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange Hybrid Multi-namespace Autodiscover Configuration&p[summary]=I came across an interesting issue when using the Exchange Hybrid Configuration Wizard in a multi-namespace environment recently. Autodis...&p[url]=http://172.16.7.177:4000/2012/06/exchange-hybrid-multi-namespace-autodiscover-configuration" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2012/06/exchange-hybrid-multi-namespace-autodiscover-configuration&text=I came across an interesting issue when using the Exchange Hybrid Configuration Wizard in a multi-namespace environment recently. Autodis...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2012-05-04T08:03:32-05:00" itemprop="datePublished">4 May, 2012</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2012/05/remote-move-request-exception-has-been-thrown-by-the-target-of-invocation">Remote Move Request: Exception has been thrown by the target of invocation</a></h2>
    </header>

    <div class="post-content">
        <p>If you have a Exchange Hybrid deployment configured and attempt to create a new remote move request you may receive an &rdquo;Exception has been thrown by the target of invocation&rdquo; error similar to the one below.</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2012/05/cap.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="cap" border="0" alt="cap" src="http://www.cgoosen.com/wp-content/uploads/2012/05/cap_thumb.png" width="498" height="434" /></a></p>
<p>Here are a few things you can check in order to help troubleshoot this error:</p>
<ul>
<li>Have you enabled MRSProxy? </li>
<li>Have you correctly set the EWS &ldquo;External URL&rdquo; (WebServicesVirtualDirectory)? </li>
<li>Do you have a certificate installed that contains the DNS name used in the&#160; EWS &ldquo;External URL&rdquo;? </li>
<li>Are you entering the correct FQDN in the MRSProxy field of the new remote move request wizard? </li>
<li>Are you using TMG/ISA to publish EWS? If so, ensure that you are not using authentication delegation on the following paths:
<ul>
<li>/ews/mrsproxy.svc </li>
<li>/ews/exchange.asmx/wssecurity </li>
<li>/autodiscover/autodiscover.svc/wssecurity </li>
<li>/autodiscover/autodiscover.svc </li>
</ul>
</li>
<li>Are you seeing &ldquo;405&rdquo; errors in the IIS log on the Exchange Hybrid server? If so, <a href="http://support.microsoft.com/kb/2626696" target="_blank">see KB2626696</a> </li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Remote Move Request: Exception has been thrown by the target of invocation&p[summary]=If you have a Exchange Hybrid deployment configured and attempt to create a new remote move request you may receive an &rdquo;Exception h...&p[url]=http://172.16.7.177:4000/2012/05/remote-move-request-exception-has-been-thrown-by-the-target-of-invocation" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2012/05/remote-move-request-exception-has-been-thrown-by-the-target-of-invocation&text=If you have a Exchange Hybrid deployment configured and attempt to create a new remote move request you may receive an &rdquo;Exception h...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2012-04-03T20:13:51-05:00" itemprop="datePublished">3 Apr, 2012</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2012/04/exchange-2010-voicemail-preview-for-en-au-and-other-languages">Exchange 2010 Voicemail Preview for en-AU (and other languages)</a></h2>
    </header>

    <div class="post-content">
        <p>One of the downsides of using Exchange 2010 voicemail is that if you live in an English speaking country other than the United States (en-US) you have to set your Exchange language pack to en-US if you would like to make use of the Exchange voice mail preview feature. This has been a source of constant debate around our office as we have quite a multinational team. There are a few of us who don&rsquo;t actually mind the American sounding prompts/greetings/etc.. but then there are those who do. In a attempt to keep everyone happy my friend and colleague Greig Sheridan decided to investigate and found quite a neat workaround.</p>
<p>Basically, what he has done is set the Default language of the Dial Plan to en-US, and then changed EVERY other reference to the language back to en-AU. The end result is that the only time you hear a greeting in the American accent is when you dial the Subscriber Access number, before you&rsquo;ve logged-in. Read all about it on <a href="https://greiginsydney.com" target="_blank">his blog.</a> For a direct link to the post, <a href="https://greiginsydney.com/enabling-exchanges-voicemail-preview-for-en-au-and-other-languages/" target="_blank">click here.</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2010 Voicemail Preview for en-AU (and other languages)&p[summary]=One of the downsides of using Exchange 2010 voicemail is that if you live in an English speaking country other than the United States (en...&p[url]=http://172.16.7.177:4000/2012/04/exchange-2010-voicemail-preview-for-en-au-and-other-languages" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2012/04/exchange-2010-voicemail-preview-for-en-au-and-other-languages&text=One of the downsides of using Exchange 2010 voicemail is that if you live in an English speaking country other than the United States (en...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2012-03-27T16:15:19-05:00" itemprop="datePublished">27 Mar, 2012</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2012/03/updating-hybrid-configuration-failed-with-error-subtask-checkprereqs-execution-failed">Updating hybrid configuration failed with error 'Subtask CheckPrereqs execution failed</a></h2>
    </header>

    <div class="post-content">
        <p>I came across this error recently while running the Hybrid Configuration Wizard on Exchange 2010 SP2. It caught me out a little and as it turns out the fix is quite simple. It seems the wizard does not recognise certificates that begin with anything other than &ldquo;CN=&rdquo;. In my particular case I was being tripped up by a certificate beginning with &ldquo;E=&rdquo;. What made this even more confusing was that the certificate causing the problem was installed, but completely unrelated and not actually the one I was using to configure my Hybrid Exchange environment.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2012/03/Capture.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="Capture" border="0" alt="Capture" src="http://www.cgoosen.com/wp-content/uploads/2012/03/Capture_thumb.png" width="529" height="463" /></a></p>
<p>It seems this is a known bug and was fixed in Update Rollup 1 for Exchange Server 2010 Service Pack 2. I can confirm that after installing the update, it all worked as expected.</p>
<p>For more info and to download <a href="http://support.microsoft.com/kb/2645995" target="_blank">Update Rollup 1 for Exchange Server 2010 Service Pack 2, click here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Updating hybrid configuration failed with error 'Subtask CheckPrereqs execution failed&p[summary]=I came across this error recently while running the Hybrid Configuration Wizard on Exchange 2010 SP2. It caught me out a little and as it...&p[url]=http://172.16.7.177:4000/2012/03/updating-hybrid-configuration-failed-with-error-subtask-checkprereqs-execution-failed" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2012/03/updating-hybrid-configuration-failed-with-error-subtask-checkprereqs-execution-failed&text=I came across this error recently while running the Hybrid Configuration Wizard on Exchange 2010 SP2. It caught me out a little and as it...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2012-02-09T05:05:30-06:00" itemprop="datePublished">9 Feb, 2012</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2012/02/discover-and-import-pst-files-into-exchange-server-or-exchange-online">Discover and import .pst files into Exchange Server or Exchange Online</a></h2>
    </header>

    <div class="post-content">
        <p align="left">The Microsoft Exchange team recently released Microsoft Exchange PST Capture which allows you to search for .pst files on computers in your organization and then import those files to mailboxes in both on-premises Exchange servers and Exchange Online.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2012/02/image.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2012/02/image_thumb.png" width="317" height="220" /></a></p>
<p>PST Capture was initially developed by <acronym>ISV </acronym>partner, <a href="http://www.red-gate.com" target="_blank">Red Gate</a>, and was recently acquired by Microsoft. After some further development and testing, it can now be <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=f6006c4b-a6a9-4e83-81b3-e770d37f63ff" target="_blank">downloaded for free here.</a> PST Capture is comprised of the following components:</p>
<ul>
<li><strong>PST Capture Central Service: </strong>The Central Service maintains the list of all PST files found in your organization and manages the data as it&rsquo;s moved to the Exchange servers or Exchange Online. </li>
<li><strong>PST Capture Agent:</strong> Discovery of the PST files is performed by PST Capture agents that are installed on computers in your organization. The agents also send the PST files they find to the host computer when an import operation is started on the PST Capture Console. </li>
<li><strong>PST Capture Console:</strong> The PST Capture Console is the interface you use to configure PST searches, specify the target mailboxes for PST files, and track the status of PST import operations and reports. You can also use the console to import PST files stored on network attached storage (NAS) devices, on which you can&rsquo;t install PST agents. </li>
</ul>
<p>&#160;</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2012/02/image1.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto; padding-top: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2012/02/image_thumb1.png" width="590" height="295" /></a></p>
<p>For more information on Microsoft Exchange PST Capture see <a href="http://technet.microsoft.com/en-us/library/hh781036.aspx" target="_blank">this TechNet article</a></p>
<p>To download Microsoft Exchange PST Capture <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=f6006c4b-a6a9-4e83-81b3-e770d37f63ff" target="_blank">click here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Discover and import .pst files into Exchange Server or Exchange Online&p[summary]=The Microsoft Exchange team recently released Microsoft Exchange PST Capture which allows you to search for .pst files on computers in yo...&p[url]=http://172.16.7.177:4000/2012/02/discover-and-import-pst-files-into-exchange-server-or-exchange-online" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2012/02/discover-and-import-pst-files-into-exchange-server-or-exchange-online&text=The Microsoft Exchange team recently released Microsoft Exchange PST Capture which allows you to search for .pst files on computers in yo...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2012-01-04T08:42:53-06:00" itemprop="datePublished">4 Jan, 2012</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2012/01/exchange-2010-anonymous-relay-receive-connector">Exchange 2010 &ldquo;Anonymous Relay&rdquo; Receive Connector</a></h2>
    </header>

    <div class="post-content">
        <p>In almost every environment I have ever seen there are usually some devices and/or systems that need to send email and typically these will require some SMTP server to relay these messages. More often than not these also do not have the ability to authenticate to the relaying host.</p>
<p>How do we deal with these in Exchange? I have seen some pretty silly solutions and the default answer seems to be &ldquo;Just allow anonymous users on the default connector&rdquo;. This is not true and is actually quite a dangerous thing to do, so my advice is DON&rsquo;T. In fact, I would go so far as to say, don&rsquo;t ever touch the default connector. The correct way is to create a new receive connector and allow relay from only the devices that are required to use this connector.</p>
<p>Allowing anonymous relay is serious and requires thought and planning. If could be exploited by spammers and IMHO should not be configured on internet-facing servers.</p>
<p>So lets say that we have three devices that need to relay anonymously, their IPs are 10.0.0.30, 10.0.0.31 and 10.0.0.32. First we need to create a new receive connector:</p>
<blockquote><p><span style="font-family: 'Courier New';">New-ReceiveConnector -Name "Anonymous Relay Connector" -Usage Custom -PermissionGroups AnonymousUsers -Bindings 10.0.0.20:25 -RemoteIpRanges 10.0.0.30-10.0.0.32 &ndash;Banner "220 Anonymous Relay Connector"</span></p></blockquote>
<p>Next we need to to grant relay permission to anonymous connections on the new Receive connector:</p>
<blockquote><p><span style="font-family: 'Courier New';">Get-ReceiveConnector -Identity "Anonymous Relay Connector" | Add-ADPermission -User "NT AUTHORITY\ANONYMOUS LOGON" -ExtendedRights "Ms-Exch-SMTP-Accept-Any-Recipient"</span></p></blockquote>
<p>What happens if you have multiple servers and would like to duplicate your receive connector settings. Say for example you have two Exchange servers and you have a receive connector on a server called EXHUB01 that allows 100 devices to relay. You would now like to create the same connector on EXHUB02. Instead of manually adding each address, you could do this:</p>
<blockquote><p><span style="font-family: 'Courier New';">New-ReceiveConnector "Anonymous Relay Connector" -Server EXHUB02 -Usage Custom -PermissionGroups AnonymousUsers -Bindings 10.0.0.21:25 -RemoteIPRanges ( Get-ReceiveConnector "EXHUB01\Anonymous Relay Connector" ).RemoteIPRanges -Banner "220 Anonymous Relay Connector"</span></p></blockquote>
<p>Don&rsquo;t forget to grant relay permission to anonymous connections on the new Receive connector:</p>
<blockquote><p><span style="font-family: 'Courier New';">Get-ReceiveConnector -Identity "EXHUB02\Anonymous Relay Connector" | Add-ADPermission -User "NT AUTHORITY\ANONYMOUS LOGON" -ExtendedRights "Ms-Exch-SMTP-Accept-Any-Recipient"</span></p></blockquote>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2010 &ldquo;Anonymous Relay&rdquo; Receive Connector&p[summary]=In almost every environment I have ever seen there are usually some devices and/or systems that need to send email and typically these wi...&p[url]=http://172.16.7.177:4000/2012/01/exchange-2010-anonymous-relay-receive-connector" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2012/01/exchange-2010-anonymous-relay-receive-connector&text=In almost every environment I have ever seen there are usually some devices and/or systems that need to send email and typically these wi...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-12-23T12:56:12-06:00" itemprop="datePublished">23 Dec, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/12/exchange-2010-service-pack-2-sp2">Exchange 2010 Service Pack 2 (SP2)</a></h2>
    </header>

    <div class="post-content">
        <p>Just in case you missed it, Exchange 2010 SP2 was released earlier this month. The following features and functionality has changed since Service Pack 1 for Exchange 2010:</p>
<ul>
<li>Hybrid Configuration Wizard </li>
<li>Address Book Policies </li>
<li>Cross-Site Silent Redirection for Outlook Web App </li>
<li>Mini Version of Outlook Web App </li>
<li>Mailbox Replication Service </li>
<li>Mailbox Auto-Mapping </li>
<li>Multi-Valued Custom Attributes </li>
<li>Litigation Hold</li>
</ul>
<p>I wanted to call out a couple of these that I have been eagerly awaiting:</p>
<p><strong>Hybrid Configuration Wizard     <br /></strong>Exchange 2010 SP2 introduces the Hybrid Configuration Wizard which provides you with a streamlined process to configure a hybrid deployment between on-premises and Office 365 Exchange organizations. Hybrid deployments provide the seamless look and feel of a single Exchange organization and offer administrators the ability to extend the feature-rich experience and administrative control of an on-premises organization to the cloud.</p>
<p><strong>Cross-Site Silent Redirection for Outlook Web App</strong>    <br />In Exchange 2010 SP1, there was three types of redirection for OWA in Exchange 2010 on-premises:</p>
<ul>
<li>Manual Redirection </li>
<li>Temporary Manual Redirection </li>
<li>Legacy Silent Redirection (for Exchange 2003/2007)</li>
</ul>
<p>With Exchange 2010 SP2, you can enable a silent redirection when a Client Access server receives a client request that is better serviced by a Client Access server located in another Active Directory site. This silent redirection can also provide a single sign-on experience when forms-based authentication is enabled on each Client Access server.</p>
<p>For more information about what&rsquo;s new in Exchange 2010 SP2, <a href="http://technet.microsoft.com/en-us/library/hh529924.aspx" target="_blank">click here</a></p>
<p>To download Exchange 2010 SP2, <a href="http://www.microsoft.com/download/en/details.aspx?displaylang=en&amp;id=28190" target="_blank">click here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2010 Service Pack 2 (SP2)&p[summary]=Just in case you missed it, Exchange 2010 SP2 was released earlier this month. The following features and functionality has changed since...&p[url]=http://172.16.7.177:4000/2011/12/exchange-2010-service-pack-2-sp2" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/12/exchange-2010-service-pack-2-sp2&text=Just in case you missed it, Exchange 2010 SP2 was released earlier this month. The following features and functionality has changed since...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-10-28T11:06:23-05:00" itemprop="datePublished">28 Oct, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/10/jetstress-error-the-msexchange-database-or-msexchange-database-instrances-performance-counter-category-isnt-registered">Jetstress Error: The MSExchange Database or MSExchange Database ==> Instrances performance counter category isn't registered</a></h2>
    </header>

    <div class="post-content">
        <p>I recently came across this error while using Jetstress to test and validate the performance of their Exchange storage. I was running the tool on Windows Server 2008 R2 and I don&rsquo;t recall ever seeing this before. After finding what is actually an easy fix, I thought I would&#160; write up this post just in case this has anyone else baffled. The entire error was:</p>
<blockquote><p>Ensure that you&rsquo;re running the application as a member of built-in Administrators security group.</p>
<p>The MSExchange Database or MSExchange Database ==> Instrances performance counter category isn't registered.</p>
</blockquote>
<p><font style="background-color: #eef8ff"><a href="http://www.cgoosen.com/wp-content/uploads/2011/10/jetstress1.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; margin-left: auto; border-top: 0px; margin-right: auto; border-right: 0px; padding-top: 0px" title="jetstress1" border="0" alt="jetstress1" src="http://www.cgoosen.com/wp-content/uploads/2011/10/jetstress1_thumb.png" width="596" height="345" /></a></font></p>
<p>The admin account I was using is a member of the domain admins security group so I assumed I had the correct permissions but went away and checked just to be sure. I also checked to make sure that the domain admins group was a member of the local built-in Administrators security group, which it was. After spending a few minutes thinking about it, I thought I would try running Jetstress &ldquo;as an administrator&rdquo; (right-click the shortcut and select &ldquo;Run as administrator&rdquo;</p>
<p>That solved the problem.</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2011/10/jetstress2.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; margin-left: auto; border-top: 0px; margin-right: auto; border-right: 0px; padding-top: 0px" title="jetstress2" border="0" alt="jetstress2" src="http://www.cgoosen.com/wp-content/uploads/2011/10/jetstress2_thumb.png" width="603" height="329" /></a></p>
<p>I have since checked the Jetstress installation in my Exchange 2010 Lab which also runs on Windows Server 2008 R2 and this step is not required there, it works fine by just clicking the Jetstress shortcut (no right-click required). Not really worth spending time investigating the cause as it may just be a once-off occurrence, but at least it is now documented.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Jetstress Error: The MSExchange Database or MSExchange Database ==> Instrances performance counter category isn't registered&p[summary]=I recently came across this error while using Jetstress to test and validate the performance of their Exchange storage. I was running the...&p[url]=http://172.16.7.177:4000/2011/10/jetstress-error-the-msexchange-database-or-msexchange-database-instrances-performance-counter-category-isnt-registered" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/10/jetstress-error-the-msexchange-database-or-msexchange-database-instrances-performance-counter-category-isnt-registered&text=I recently came across this error while using Jetstress to test and validate the performance of their Exchange storage. I was running the...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-10-14T14:25:26-05:00" itemprop="datePublished">14 Oct, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/10/tech-ed-australia-to-go-moving-email-from-on-premise-into-the-cloud">Tech-Ed Australia To Go: Moving Email from On Premise Into the Cloud</a></h2>
    </header>

    <div class="post-content">
        <p>Toby and I talking about our &ldquo;Microsoft Office 365: From Simple Migration to a Hybrid Environment&rdquo; session at At Tech-Ed Australia 2011.</p>
<div id="scid:5737277B-5D6D-4f48-ABFC-DD9C333F4C5D:7d607b52-f893-4cd2-b511-6cfdf46e7597" class="wlWriterEditableSmartContent" style="margin: 0px auto; width: 542px; display: block; float: none; padding: 0px;">
<div><object width="542" height="304" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"><param name="src" value="http://www.youtube.com/v/JsRlLKN7d8s?hl=en&amp;hd=1" /><embed width="542" height="304" type="application/x-shockwave-flash" src="http://www.youtube.com/v/JsRlLKN7d8s?hl=en&amp;hd=1" /></object></div>
<div style="width: 542px; clear: both; font-size: .8em;">Toby and I talking about our session at At Tech-Ed Australia 2011</div>
</div>
<p>&nbsp;</p>
<p>If you missed it, the recorded session and slides are available for download here: <a href="http://cgoo.se/ndiUkE" target="_blank">http://cgoo.se/ndiUkE</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Tech-Ed Australia To Go: Moving Email from On Premise Into the Cloud&p[summary]=Toby and I talking about our &ldquo;Microsoft Office 365: From Simple Migration to a Hybrid Environment&rdquo; session at At Tech-Ed Aust...&p[url]=http://172.16.7.177:4000/2011/10/tech-ed-australia-to-go-moving-email-from-on-premise-into-the-cloud" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/10/tech-ed-australia-to-go-moving-email-from-on-premise-into-the-cloud&text=Toby and I talking about our &ldquo;Microsoft Office 365: From Simple Migration to a Hybrid Environment&rdquo; session at At Tech-Ed Aust...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-09-06T12:33:45-05:00" itemprop="datePublished">6 Sep, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/09/microsoft-future-of-productivity">Microsoft "Future of productivity"</a></h2>
    </header>

    <div class="post-content">
        <p>I recently saw this at Tech-Ed Australia and finally managed <a href="http://cloudthemind.com/2011/03/23/productivity-vision-looking-back-to-get-a-sense-of-today/" target="_blank">to track it down</a> so I could share it. I think it&rsquo;s such a great video and just excites me about the "future of productivity".</p>
<div style="padding-bottom: 0px; padding-left: 0px; width: 554px; padding-right: 0px; display: block; float: none; margin-left: auto; margin-right: auto; padding-top: 0px" id="scid:5737277B-5D6D-4f48-ABFC-DD9C333F4C5D:7e992584-a640-42d8-a110-905625d709d3" class="wlWriterEditableSmartContent">
<div><object width="554" height="310"><param name="movie" value="http://www.youtube.com/v/BU-TGk5JBT4?hl=en&amp;hd=1"></param><embed src="http://www.youtube.com/v/BU-TGk5JBT4?hl=en&amp;hd=1" type="application/x-shockwave-flash" width="554" height="310"></embed></object></div>
</div>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Microsoft "Future of productivity"&p[summary]=I recently saw this at Tech-Ed Australia and finally managed to track it down so I could share it. I think it&rsquo;s such a great video ...&p[url]=http://172.16.7.177:4000/2011/09/microsoft-future-of-productivity" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/09/microsoft-future-of-productivity&text=I recently saw this at Tech-Ed Australia and finally managed to track it down so I could share it. I think it&rsquo;s such a great video ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-08-30T16:57:38-05:00" itemprop="datePublished">30 Aug, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/08/tech-ed-australia-2011-must-see-sessions">Tech-Ed Australia 2011 &ndash; Must see sessions</a></h2>
    </header>

    <div class="post-content">
        <p>After an interesting and somewhat different keynote, Tech-Ed 2011 has officially kicked off. While everyone is enjoying a few cold ones, I thought I would take the time to tell you about some of the sessions I am excited about attending this year.</p>
<p>There are many great speakers at Tech-Ed this year, these are just some of the sessions I plan to attend.</p>
<ul>
<li>EXL310: "Upgrading to Exchange 2010: Notes from Field" with Colin Lee and Sofiane Behraoui</li>
<li>EXL309: "Microsoft Lync 2010: How to go big with voice" with Brendan Carius and Selvan Loganathan</li>
<li>OFS-OFC309: "From Zero to Productivity with Office 365" with Ben Walters, Chris Oconnor and Lee Hickin</li>
<li>EXL303: "Exchange Server 2010: High Availability Concepts" with Scott Schnoll</li>
<li>EXL304: "Load Balancing with Microsoft Exchange Server 2010" with Andrew Ehrensing</li>
</ul>
<p>Then of course there is my session with Toby Knight, EXL-OFC311: &ldquo;Microsoft Office 365: From Simple Migration to a Hybrid Environment&rdquo; we will be in Arena 1B at 5 PM tomorrow&hellip; we&rsquo;ve got some great schwag so make sure you stop by!</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Tech-Ed Australia 2011 &ndash; Must see sessions&p[summary]=After an interesting and somewhat different keynote, Tech-Ed 2011 has officially kicked off. While everyone is enjoying a few cold ones, ...&p[url]=http://172.16.7.177:4000/2011/08/tech-ed-australia-2011-must-see-sessions" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/08/tech-ed-australia-2011-must-see-sessions&text=After an interesting and somewhat different keynote, Tech-Ed 2011 has officially kicked off. While everyone is enjoying a few cold ones, ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-08-25T09:51:17-05:00" itemprop="datePublished">25 Aug, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/08/exchange-2010-you-must-close-all-dialog-boxes-before-you-can-close-exchange-management-console">Exchange 2010 &ldquo;You must close all dialog boxes before you can close Exchange Management Console&rdquo;</a></h2>
    </header>

    <div class="post-content">
        <p>I&rsquo;ve seen this error around a few times over the last while but have never really paid too much attention to it:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2011/08/image2.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2011/08/image_thumb2.png" width="350" height="131" /></a></p>
<p>It seems it only occurs in the management console if you have IE9 installed on your Exchange 2010 SP1 server. Previously the recommendation was to uninstall IE9 or just live with it. I recently installed <a href="http://www.cgoosen.com/2011/08/update-rollup-5-for-exchange-server-2010-service-pack-1/" target="_blank">Update Rollup 5 for Exchange 2010 SP1</a> in my lab environment and it seems to have fixed this error. </p>
<p>Obviously I would recommend thorough testing before deploying any updates in production, but I thought it would be worth mentioning that it does seem to fix this error as well.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2010 &ldquo;You must close all dialog boxes before you can close Exchange Management Console&rdquo;&p[summary]=I&rsquo;ve seen this error around a few times over the last while but have never really paid too much attention to it:

It seems it only ...&p[url]=http://172.16.7.177:4000/2011/08/exchange-2010-you-must-close-all-dialog-boxes-before-you-can-close-exchange-management-console" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/08/exchange-2010-you-must-close-all-dialog-boxes-before-you-can-close-exchange-management-console&text=I&rsquo;ve seen this error around a few times over the last while but have never really paid too much attention to it:

It seems it only ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-08-25T09:32:44-05:00" itemprop="datePublished">25 Aug, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/08/exchange-2010-remote-mailbox-move-to-office-365-microsoft-exchange-critical-error">Exchange 2010 remote mailbox move to Office 365 &ldquo;Microsoft Exchange Critical Error&rdquo;</a></h2>
    </header>

    <div class="post-content">
        <p>I&rsquo;ve been having a problem with remote mailbox moves to Office 365. The move completes successfully and everything works ok, but it always generates the following error:</p>
<p>&ldquo;Could not load type 'Microsoft.Exchange.MailboxReplicationService.RequestPriority'&hellip;&rdquo;</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2011/08/image1.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; margin-left: auto; border-top: 0px; margin-right: auto; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2011/08/image_thumb1.png" width="395" height="229" /></a></p>
<p>I&rsquo;ve seen this mentioned a few times on the Office 365 community forums and some of my colleagues are also seeing this. The good news is that after installing <a href="http://www.cgoosen.com/2011/08/update-rollup-5-for-exchange-server-2010-service-pack-1/" target="_blank">Update Rollup 5 for Exchange 2010 SP1</a> this error no longer appears.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2010 remote mailbox move to Office 365 &ldquo;Microsoft Exchange Critical Error&rdquo;&p[summary]=I&rsquo;ve been having a problem with remote mailbox moves to Office 365. The move completes successfully and everything works ok, but it...&p[url]=http://172.16.7.177:4000/2011/08/exchange-2010-remote-mailbox-move-to-office-365-microsoft-exchange-critical-error" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/08/exchange-2010-remote-mailbox-move-to-office-365-microsoft-exchange-critical-error&text=I&rsquo;ve been having a problem with remote mailbox moves to Office 365. The move completes successfully and everything works ok, but it...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-08-24T12:23:36-05:00" itemprop="datePublished">24 Aug, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/08/update-rollup-5-for-exchange-server-2010-service-pack-1">Update Rollup 5 for Exchange Server 2010 Service Pack 1</a></h2>
    </header>

    <div class="post-content">
        <p>Earlier today the Exchange team <a href="http://blogs.technet.com/b/exchange/archive/2011/08/23/released-update-rollup-5-for-exchange-2010-sp1.aspx" target="_blank">announced the release</a> of Update Rollup 5 for Exchange Server 2010 Service Pack 1. Update Rollup 5 for Exchange Server 2010 SP1 resolves the issues that are described in the following Microsoft Knowledge Base articles:</p>
<ul>
<li><a href="http://support.microsoft.com/kb/2275156" target="_blank">2275156</a> - The inline contents disposition is removed when you send a "Content-Disposition: inline" email message by using EWS in an Exchange Server 2010 environment</li>
<li><a href="http://support.microsoft.com/kb/2499044" target="_blank">2499044</a> - You cannot save attachments in an email message by using OWA if the subject line contains special characters in an Exchange Server 2010 environment</li>
<li><a href="http://support.microsoft.com/kb/2509306" target="_blank">2509306</a> - Journal reports are expired or lost when the Microsoft Exchange Transport service is restarted in an Exchange Server 2010 environment </li>
<li><a href="http://support.microsoft.com/kb/2514766" target="_blank">2514766</a> - A RBAC role assignee can unexpectedly run the Add-ADPermission command on an Exchange Server 2010 server that is outside the role assignment scope </li>
<li><a href="http://support.microsoft.com/kb/2529715" target="_blank">2529715</a> - Slow network or replication issues after you change the number of virus scanning API threads in Microsoft Exchange Server 2010</li>
<li><a href="http://support.microsoft.com/kb/2536704" target="_blank">2536704</a> - Mailbox users who are migrated by using ILM 2007 cannot use the Options menu in OWA in an Exchange Server 2010 environment</li>
<li><a href="http://support.microsoft.com/kb/2537094" target="_blank">2537094</a> - French translation errors occur when you edit a response to a meeting request by using OWA in an Exchange Server 2010 SP1 environment</li>
<li><a href="http://support.microsoft.com/kb/2554604" target="_blank">2554604</a> - A RBAC role assignee can unexpectedly manage certificates that are outside the role assignment scope in an Exchange Server 2010 environment</li>
<li><a href="http://support.microsoft.com/kb/2555800" target="_blank">2555800</a> - You cannot use the GetItem operation in EWS to retrieve properties of an email message in an Exchange Server 2010 environment </li>
<li><a href="http://support.microsoft.com/kb/2555850" target="_blank">2555850</a> - You cannot delete a mailbox folder that starts with a special character in its name by using Outlook in an Exchange Server 2010 environment </li>
<li><a href="http://support.microsoft.com/kb/2556096" target="_blank">2556096</a> - The columns in the .csv logging file are not lined up correctly when you perform a discovery search on a mailbox in an Exchange Server 2010 environment</li>
<li><a href="http://support.microsoft.com/kb/2556107" target="_blank">2556107</a> - The columns in the .csv logging file are not lined up correctly when you perform a discovery search on a mailbox in an Exchange Server 2010 environment </li>
<li><a href="http://support.microsoft.com/kb/2556133" target="_blank">2556133</a> - A device that uses Exchange ActiveSync cannot access mailboxes in an Exchange Server 2010 environment </li>
<li><a href="http://support.microsoft.com/kb/2556156" target="_blank">2556156</a> - Extra.exe crashes when it performs RPC activity checks against an Exchange Server 2010 server </li>
<li><a href="http://support.microsoft.com/kb/2556352" target="_blank">2556352</a> - "ChangeKey is required for this operation" error message in Outlook for Mac 2011 in an Exchange Server 2010 environment</li>
<li><a href="http://support.microsoft.com/kb/2556407" target="_blank">2556407</a> - Certain client-only message rules do not take effect on email messages that are saved as drafts in an Exchange Server 2010 environment</li>
<li><a href="http://support.microsoft.com/kb/2559926" target="_blank">2559926</a> - "There are no items to show in this view." error message when you try to view a folder by using Outlook in an Exchange Server 2010 environment</li>
<li><a href="http://support.microsoft.com/kb/2572958" target="_blank">2572958</a> - The "Test-OutlookConnectivity -Protocol HTTP" command fails with an HTTP 401 error in an Exchange Server 2010 environment</li>
</ul>
<p>For more information, <a href="http://support.microsoft.com/kb/2582113" target="_blank">click here</a></p>
<p>To Download, <a href="http://www.microsoft.com/download/en/details.aspx?displaylang=en&amp;id=27193" target="_blank">click here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Update Rollup 5 for Exchange Server 2010 Service Pack 1&p[summary]=Earlier today the Exchange team announced the release of Update Rollup 5 for Exchange Server 2010 Service Pack 1. Update Rollup 5 for Exc...&p[url]=http://172.16.7.177:4000/2011/08/update-rollup-5-for-exchange-server-2010-service-pack-1" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/08/update-rollup-5-for-exchange-server-2010-service-pack-1&text=Earlier today the Exchange team announced the release of Update Rollup 5 for Exchange Server 2010 Service Pack 1. Update Rollup 5 for Exc...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-08-10T10:42:08-05:00" itemprop="datePublished">10 Aug, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/08/exchange-server-version-and-update-rollup-build-numbers">Exchange Server Version and Update Rollup Build Numbers</a></h2>
    </header>

    <div class="post-content">
        <p>Have you ever had to figure out what version of Exchange a build number is referring to or vice versa? There is a <a href="http://technet.microsoft.com/en-us/library/hh135098.aspx" target="_blank">very handy TechNet article</a> that lists every build number and release date since Exchange 4.0.837 (Exchange Server 4.0 Standard Edition, June 11 1996)</p>
<p><a href="http://blogs.technet.com/bshukla" target="_blank">Bhargav Shukla</a> also has <a href="http://cid-14adc5cf1e0cbccf.skydrive.live.com/self.aspx/.Public/Blog-Bhargavs/Exchange/Get-ExchangeUpdateRollups.ps1" target="_blank">a great script</a> that can be used to find Exchange 2007 and Exchange 2010 build numbers in your environment.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange Server Version and Update Rollup Build Numbers&p[summary]=Have you ever had to figure out what version of Exchange a build number is referring to or vice versa? There is a very handy TechNet arti...&p[url]=http://172.16.7.177:4000/2011/08/exchange-server-version-and-update-rollup-build-numbers" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/08/exchange-server-version-and-update-rollup-build-numbers&text=Have you ever had to figure out what version of Exchange a build number is referring to or vice versa? There is a very handy TechNet arti...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-08-05T11:04:07-05:00" itemprop="datePublished">5 Aug, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/08/microsoft-tech-ed-australia-2011">Microsoft Tech-Ed Australia 2011</a></h2>
    </header>

    <div class="post-content">
        <p align="center"><a href="http://australia.msteched.com/topic/details/EXL311#showdetails" target="_blank"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; margin-left: auto; border-top: 0px; margin-right: auto; border-right: 0px; padding-top: 0px" title="teched_emailsig_02" border="0" alt="teched_emailsig_02" src="http://www.cgoosen.com/wp-content/uploads/2011/08/teched_emailsig_02.gif" width="244" height="90" /></a></p>
<p>It&rsquo;s almost time to head to the Gold Coast for Tech-Ed 2011. I will be tweeting and blogging from the conference as usual. I will also be speaking this year so if you are attending, be sure to come over and say hi. </p>
<p>Microsoft&rsquo;s Toby Knight and I will be presenting session EXL311 entitled &ldquo;Microsoft Exchange and Microsoft Office 365: From Simple Migration to a Hybrid Environment&rdquo;. Whether you&rsquo;re looking to migrate all of your mailboxes to the cloud or planning to run a hybrid environment, this is the session for you. We will cover how and when to take advantage of the Simple Exchange Migration which supports migrating existing Exchange on-premise customers who want to move all of their mailboxes to the cloud with full data fidelity. You will also learn how rolling out an Exchange 2010 server in your current Exchange environment prepares you for seamless integration with Exchange Online. Whether you are piloting a few users or moving a large part of your workforce to the cloud, we give you the technical details on Exchange-to-cloud integration that you need to be successful.</p>
<p>The session is currently scheduled for Wed, 31 Aug at 5 PM. See you there!</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Microsoft Tech-Ed Australia 2011&p[summary]=
It&rsquo;s almost time to head to the Gold Coast for Tech-Ed 2011. I will be tweeting and blogging from the conference as usual. I will ...&p[url]=http://172.16.7.177:4000/2011/08/microsoft-tech-ed-australia-2011" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/08/microsoft-tech-ed-australia-2011&text=
It&rsquo;s almost time to head to the Gold Coast for Tech-Ed 2011. I will be tweeting and blogging from the conference as usual. I will ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-08-03T17:07:34-05:00" itemprop="datePublished">3 Aug, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/08/microsoft-certified-master-exchange-server-2010">Microsoft Certified Master | Exchange Server 2010</a></h2>
    </header>

    <div class="post-content">
        <p><a href="http://www.cgoosen.com/wp-content/uploads/2011/08/image.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: left; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" align="left" src="http://www.cgoosen.com/wp-content/uploads/2011/08/image_thumb.png" width="159" height="89" /></a>During the month of June I was fortunate enough to attend the Microsoft Certified Master rotation at Microsoft in Redmond, Washington. </p>
<p>I am delighted to announce that after a very long month of waiting for the results of the final &ldquo;qual lab&rdquo;, I passed and have earned the Microsoft Certified Master | Exchange Server 2010 certification.</p>
<p>The MCM program differentiates itself through expert-led training. The curriculum is    <br />developed in conjunction with Microsoft product engineering teams and delivered by industry-renowned instructors and practiced experts within their fields of discipline. Instructors use their numerous years of experience to ensure that students receive authoritative information on the successes and challenges of applying course concepts to real-world customer situations. I knew it would be challenging, but when day 1 ended up being 17 hours long we all knew we would be in for more than we could have ever imagined.</p>
<p>In order to successfully pass and be able to call yourself an MCM you need to get through 3 very difficult theory exams and then face the beast, otherwise known as the &ldquo;qual lab&rdquo;. Without going into it in too much detail, it is a very intense 3 weeks. How intense? read <a href="http://borntolearn.mslearn.net/careerfactor/b/bojan/archive/2011/01/17/mastering-the-aspirations.aspx" target="_blank">Bojan Nenadic&rsquo;s Blog</a></p>
<p>I have to say thanks to all my rock star instructors and classmates.. I am humbled and truly grateful to have shared this experience with you all.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Microsoft Certified Master | Exchange Server 2010&p[summary]=During the month of June I was fortunate enough to attend the Microsoft Certified Master rotation at Microsoft in Redmond, Washington. 
I...&p[url]=http://172.16.7.177:4000/2011/08/microsoft-certified-master-exchange-server-2010" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/08/microsoft-certified-master-exchange-server-2010&text=During the month of June I was fortunate enough to attend the Microsoft Certified Master rotation at Microsoft in Redmond, Washington. 
I...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-07-01T07:52:04-05:00" itemprop="datePublished">1 Jul, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/07/moving-from-bpos-to-office365-550-5-4-1-relay-access-denied">Moving from BPOS to Office365 &ndash; &ldquo;550 5.4.1 Relay Access Denied&rdquo;</a></h2>
    </header>

    <div class="post-content">
        <p>With the recent launch of <a href="http://www.microsoft.com/en-au/office365/online-software.aspx" target="_blank">Office365</a> I was very excited at the thought of moving my existing BPOS account to a new Office365 tenant. I signed up, removed my &ldquo;cgoosen.com&rdquo; domain from my BPOS account and went through the process of adding it to Office365. I thought the whole process was going really well until I tested it by sending myself an email from another external account. I immediately received a &ldquo;550 5.4.1 Relay Access Denied&rdquo; error which seemed a little strange. After some research on the Office365 Community forums I realised that this seems to be a common issue with people moving a domain from BPOS to Office365.</p>
<p>I ended up calling Microsoft Customer Support and after some trial and error here is how I fixed it.</p>
<p>The first thing you need to do is use PowerShell to connect to your Office365 tenant, make sure you have the correct versions of Windows PowerShell and Windows Remote Management (WinRM) installed and configured on your computer. If you are running Windows 7 or Windows Server 2008 R2, you don't have to install anything. If you are running anything else, see the link at the bottom of the post. By default, PowerShell&rsquo;s execution policy is set to &ldquo;Restricted&rdquo; that means that scripts won&rsquo;t run so before we try to connect, we need to change that. Open PowerShell and execute the following cmdlets:</p>
<p><em>Get-ExecutionPolicy &ndash; </em>verify that it is set to &ldquo;Restricted&rdquo;</p>
<p>Lets change it to &ldquo;RemoteSigned&rdquo;. PowerShell will now run any scripts that you write yourself and scripts downloaded from the Internet only if those scripts have been signed by a trusted publisher:</p>
<p><em>Set-ExecutionPolicy RemoteSigned</em></p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2011/07/image.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2011/07/image_thumb.png" width="625" height="139" /></a></p>
<p>Now we are ready to connect to our Office365 tenant. Execute the following cmdlets:</p>
<p><em>$LiveCred = Get-Credential</em></p>
<p>Enter your Office365 admin credentials in the dialog</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2011/07/image1.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2011/07/image_thumb1.png" width="244" height="194" /></a></p>
<p><em>$Session = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri </em><em>https://ps.outlook.com/powershell/</em><em> -Credential $LiveCred -Authentication Basic -AllowRedirection</em></p>
<p><em>Import-PSSession $Session</em></p>
<p>Once connected you, execute the following cmdlets:</p>
<p><em>Set-AcceptedDomain -Identity "yourdomain.com" -OutboundOnly $True</em></p>
<p><em>Set-AcceptedDomain -Identity "yourdomain.com" -OutboundOnly $False</em></p>
<p>You may need to allow around 40mins for replication, after that you should be able to receive mail again without the &ldquo;550 5.4.1 Relay Access Denied&rdquo; error.</p>
<p>If you are using running anything other than Windows 7 or Windows Server 2008 R2, <a href="http://technet.microsoft.com/en-us/library/cc952756%28EXCHSRVCS.149%29.aspx" target="_blank">see this link for information</a> on Install and Configure Windows PowerShell.</p>
<p>For more information about connecting to Office365 via PowerShell, <a href="http://technet.microsoft.com/en-us/library/cc952755%28EXCHSRVCS.149%29.aspx" target="_blank">click here</a>.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Moving from BPOS to Office365 &ndash; &ldquo;550 5.4.1 Relay Access Denied&rdquo;&p[summary]=With the recent launch of Office365 I was very excited at the thought of moving my existing BPOS account to a new Office365 tenant. I sig...&p[url]=http://172.16.7.177:4000/2011/07/moving-from-bpos-to-office365-550-5-4-1-relay-access-denied" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/07/moving-from-bpos-to-office365-550-5-4-1-relay-access-denied&text=With the recent launch of Office365 I was very excited at the thought of moving my existing BPOS account to a new Office365 tenant. I sig...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-06-12T23:38:34-05:00" itemprop="datePublished">12 Jun, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/06/exchange-server-deployment-assistant-update">Exchange Server Deployment Assistant Update</a></h2>
    </header>

    <div class="post-content">
        <p>One of my favourite tools is the Exchange Server Deployment Assistant. The Deployment Assistant asks you some questions about your particular Exchange environment and, based on your answers, it provides a checklist with instructions that are designed to help you deploy Exchange 2010 quickly and easily. Each step has a huge amount of valuable information to guide you through your deployment.</p>
<p>The Exchange Team <a href="http://blogs.technet.com/b/exchange/archive/2011/06/10/exchange-server-deployment-assistant-update-for-exchange-2010-and-office-365-coexistence.aspx" target="_blank">recently announced</a> that they have updated the Deployment Assistant to include a rich coexistence scenario for organizations interested in maintaining some users on-premises with Exchange 2010 and some users hosted in the cloud by Microsoft Office 365 for enterprises. This information is only available in English at this time and requires Exchange Server 2010 Service Pack 1 (SP1).</p>
<p>The Exchange Server Deployment Assistant can be <a href="http://technet.microsoft.com/en-us/exdeploy2010/default.aspx" target="_blank">found here</a>.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2011/06/image.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: left; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" align="left" src="http://www.cgoosen.com/wp-content/uploads/2011/06/image_thumb.png" width="615" height="131" /></a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange Server Deployment Assistant Update&p[summary]=One of my favourite tools is the Exchange Server Deployment Assistant. The Deployment Assistant asks you some questions about your partic...&p[url]=http://172.16.7.177:4000/2011/06/exchange-server-deployment-assistant-update" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/06/exchange-server-deployment-assistant-update&text=One of my favourite tools is the Exchange Server Deployment Assistant. The Deployment Assistant asks you some questions about your partic...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-05-10T10:04:06-05:00" itemprop="datePublished">10 May, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/05/do-you-still-use-public-folders">Do you still use Public Folders?</a></h2>
    </header>

    <div class="post-content">
        <p>The Exchange Team are looking to learn a bit more about your public folder topologies and usage scenarios. They have created an anonymous survey that asks about things like usage scenarios, folder management habits or thought process around public folder data organization.</p>
<p>If you have 15 minutes to spare, I&rsquo;m sure they will appreciate it! The survey can be <a href="http://mymfe.microsoft.com/Exchange 2010/Feedback.aspx?formID=636" target="_blank">found here</a>.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Do you still use Public Folders?&p[summary]=The Exchange Team are looking to learn a bit more about your public folder topologies and usage scenarios. They have created an anonymous...&p[url]=http://172.16.7.177:4000/2011/05/do-you-still-use-public-folders" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/05/do-you-still-use-public-folders&text=The Exchange Team are looking to learn a bit more about your public folder topologies and usage scenarios. They have created an anonymous...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-03-31T20:00:00-05:00" itemprop="datePublished">31 Mar, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/03/exchange-2007-service-pack-3-update-rollup-3-re-released">Exchange 2007 Service Pack 3 Update Rollup 3 re-released!</a></h2>
    </header>

    <div class="post-content">
        <p>I <a href="http://www.cgoosen.com/2011/03/potential-for-database-corruption-after-installing-exchange-2007-sp3-ru3/" target="_blank">recently posted</a> about an issue with Exchange 2007 SP3 RU3 that could result in database corruption. The Exchange Servicing team has fixed the reported issue with RU3 and is making new version of RU3 available to customers, version 08.03.159.002, (<a href="http://support.microsoft.com/kb/2530488">KB2530488</a>). They strongly advise that all customers install this newly released version of <a href="http://www.microsoft.com/downloads/en/details.aspx?FamilyID=17615f50-8a56-428c-bc1a-629795692da1&amp;displaylang=en">Microsoft Exchange Server 2007 SP3 Update Rollup 3</a> and to discard any prior version of RU3 (<a href="http://support.microsoft.com/kb/2492691">KB2492691</a>) which they may have.</p>
<p><em>Update Rollup 3 Installation Guidance:</em></p>
<p><b>Customers with RU3 already installed within your Exchange environment</b></p>
<p>It is not necessary for you to uninstall the existing RU3 within your environment. The new RU3 package can be installed over the top of the existing package installed on your servers.</p>
<p><b>Customers with previous SP3 RU&rsquo;s installed within your Exchange environment</b></p>
<p>You can simply install the new version of the RU3 package.</p>
<p><em>General RU Installation Guidance:</em></p>
<p><b>Note for deployments that leverage Forefront Security for Exchange:</b> For those of you running Forefront Security for Exchange perform these important steps from the command line in the Forefront directory before and after this rollup's installation. Without these steps, Exchange services for Information Store and Transport will not start back up. You will need to disable Forefront via "fscutility /disable" before installing the patch and then re-enable after the patch by running "fscutility /enable" to start it up again post installation.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2007 Service Pack 3 Update Rollup 3 re-released!&p[summary]=I recently posted about an issue with Exchange 2007 SP3 RU3 that could result in database corruption. The Exchange Servicing team has fix...&p[url]=http://172.16.7.177:4000/2011/03/exchange-2007-service-pack-3-update-rollup-3-re-released" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/03/exchange-2007-service-pack-3-update-rollup-3-re-released&text=I recently posted about an issue with Exchange 2007 SP3 RU3 that could result in database corruption. The Exchange Servicing team has fix...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-03-30T06:24:26-05:00" itemprop="datePublished">30 Mar, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/03/potential-for-database-corruption-after-installing-exchange-2007-sp3-ru3">Potential for database corruption after installing Exchange 2007 SP3 RU3</a></h2>
    </header>

    <div class="post-content">
        <p>I <a href="http://www.cgoosen.com/2011/03/update-rollup-3-for-exchange-2007-sp3-and-exchange-2010-sp1/">recently posted</a> about the availability of Update Rollup 3 for Exchange 2007 SP3 and Exchange 2010 SP1 and then followed up by <a href="http://www.cgoosen.com/2011/03/update-rollup-3-for-exchange-2010-download-disabled/">posting about</a> an issue impacting some customers which have RIM BlackBerry devices connecting to Exchange 2010 SP1 with RU3.</p>
<p><a href="http://blogs.technet.com/b/exchange/archive/2011/03/29/potential-for-database-corruption-as-a-result-of-installing-exchange-2007-sp3-ru3.aspx">Over the weekend</a>, the Exchange Product Group was made aware of an issue which may lead to database corruption if you are running Exchange 2007 Service Pack 3 with Update Rollup 3. </p>
<p>The issue was introduced in Exchange 2007 SP3 RU3 by a change in how the database is grown during transaction log replay when new data is written to the database file and there are no available free pages to be consumed and is of specific concern in two scenarios: </p>
<ol>
<li>When transaction log replay is performed by the Replication Service as part of ensuring the passive database copy is up-to-date and/or </li>
<li>When a database is not cleanly shut down and recovery occurs. </li>
</ol>
<p>When this issue occurs, the following similar events are logged in the Application Event log of the Mailbox server:</p>
<blockquote><ul>
<li>Event Type: Error        <br />Event Source: ESE         <br />Event Category: Logging/Recovery         <br />Event ID: 454         <br />Description: Microsoft.Exchange.Cluster.ReplayService (12716) Recovery E20 SG1\DB1: Database recovery/restore failed with unexpected error -4001. </li>
<li>Event Type: Error        <br />Event Source: MSExchangeRepl         <br />Event Category: Service         <br />Event ID: 2097         <br />Description: The Microsoft Exchange Replication Service encountered an unexpected Extensible Storage Engine (ESE) exception in storage group 'SG1\DB1'. The ESE exception is a read was issued to a location beyond EOF (writes will expand the file) (-4001) (). </li>
<li>Event Type: Error        <br />Event Source: MSExchangeRepl         <br />Event Category: Service         <br />Event ID: 2095         <br />Description: Log file D:\logs\SG1\E200006AFAE.log in SG1\DB1 could not be replayed. Re-seeding the passive node is now required. Use the Update-StorageGroupCopy cmdlet in the Exchange Management Shell to perform a re-seed operation </li>
</ul>
</blockquote>
<p><font color="#ff0000">While only a small number of customers have been affected to date, the Product Group believe the risk is significant enough that they are recommending all customers to uninstall Exchange 2007 SP3 RU3 on all Mailbox Servers and Transport servers. Uninstalling the rollup will revert the system back to the previously installed version. They have also removed the Exchange 2007 SP3 RU3 download from the Microsoft Download Center and from Microsoft Update until we are able to produce a new version of the rollup.</font></p>
<p>It is strongly recommended that the below actions are taken to ensure that no data loss or outage is experienced.</p>
<p><strong>For environments leveraging CCR and/or Standby Continuous Replication (SCR) </strong></p>
<p>If you note the listed events in your environment the following steps must be taken in order to restore your high-availability configuration: </p>
<ol>
<li>Rollback the CCR Mailbox server hosting the passive database copies and any SCR target Mailbox servers to the previously installed version (e.g., Exchange 2007 SP3 RU2) by uninstalling RU3. </li>
<li>Re-seed all database copies on the CCR Mailbox server and any SCR target Mailbox servers hosting the passive database copies. </li>
<li>Verify the database copy status is healthy for all passive copies. </li>
<li>Perform a switchover and rollback the remaining CCR Mailbox server to the previously installed version (e.g., Exchange 2007 SP3 RU2). </li>
</ol>
<p>If you are not seeing these events in your continuous replication enabled environment, we recommend the following steps: </p>
<ol>
<li>Rollback the CCR Mailbox server hosting the passive database copies and any SCR target Mailbox servers to the previously installed version (e.g., Exchange 2007 SP3 RU2) by uninstalling RU3. </li>
<li>Perform a switchover and rollback the remaining CCR Mailbox server to the previously installed version (e.g., Exchange 2007 SP3 RU2). </li>
</ol>
<p><strong>For environments leveraging Single Copy Clusters (SCC) </strong></p>
<ol>
<li>Rollback passive nodes within the SCC environment to the previously installed version (e.g., Exchange 2007 SP3 RU2) by uninstalling RU3. </li>
<li>Perform a switchover and rollback the remaining SCC Mailbox server nodes to the previously installed version (e.g., Exchange 2007 SP3 RU2). </li>
<li>Restore and recover any damaged databases leveraging a last known good backup. </li>
</ol>
<p><strong>For environments leveraging standalone Mailbox servers </strong></p>
<ol>
<li>Rollback the standalone Mailbox servers to the previously installed version (e.g., Exchange 2007 SP3 RU2) by uninstalling RU3. </li>
<li>Restore and recovery any damaged databases leveraging a last known good backup. </li>
</ol>
<p><strong>For Hub Transport and Edge Transport servers </strong></p>
<ol>
<li>Rollback the standalone transport servers to the previously installed version (e.g., Exchange 2007 SP3 RU2) by uninstalling RU3. </li>
<li>Recover damaged mail.que databases by following the steps in <a href="http://technet.microsoft.com/en-us/library/bb124343(EXCHG.80).aspx">Working with the Queue Database on Transport Servers</a>. </li>
</ol>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Potential for database corruption after installing Exchange 2007 SP3 RU3&p[summary]=I recently posted about the availability of Update Rollup 3 for Exchange 2007 SP3 and Exchange 2010 SP1 and then followed up by posting a...&p[url]=http://172.16.7.177:4000/2011/03/potential-for-database-corruption-after-installing-exchange-2007-sp3-ru3" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/03/potential-for-database-corruption-after-installing-exchange-2007-sp3-ru3&text=I recently posted about the availability of Update Rollup 3 for Exchange 2007 SP3 and Exchange 2010 SP1 and then followed up by posting a...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-03-17T05:36:19-05:00" itemprop="datePublished">17 Mar, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/03/bposoffice-365-and-blackberry">BPOS/Office 365 and BlackBerry</a></h2>
    </header>

    <div class="post-content">
        <p>Microsoft <a href="http://community.office365.com/enus/office365/b/microsoft_office_365_blog/archive/2011/03/16/office-365-and-blackberry.aspx" target="_blank">recently announced</a> that they are in the process of updating pricing for the Hosted BlackBerry Service for Exchange Online to make it available free of charge. From the 16th of March 2011, BlackBerry mobile e-mail for new Exchange Online customers is now free through the Business Productivity Online Suite (BPOS).&#160; For existing customers, a further announcement is expected later this month on how to take advantage of this change.</p>
<p>In addition, Hosted BlackBerry service will be available for free with Office 365 after it launches later this year.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=BPOS/Office 365 and BlackBerry&p[summary]=Microsoft recently announced that they are in the process of updating pricing for the Hosted BlackBerry Service for Exchange Online to ma...&p[url]=http://172.16.7.177:4000/2011/03/bposoffice-365-and-blackberry" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/03/bposoffice-365-and-blackberry&text=Microsoft recently announced that they are in the process of updating pricing for the Hosted BlackBerry Service for Exchange Online to ma...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-03-17T04:03:32-05:00" itemprop="datePublished">17 Mar, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/03/update-rollup-3-for-exchange-2010-download-disabled">Update Rollup 3 for Exchange 2010 &ndash; Download disabled</a></h2>
    </header>

    <div class="post-content">
        <p>There have been reports of an issue impacting some customers which have RIM BlackBerry devices connecting to Exchange 2010 SP1 with RU3. The product team are working with RIM to identify the exact scenarios, narrow down the root cause of the problem and identify a suitable resolution for it. During this time the download page for Update Rollup 3 has been disabled.</p>
<p>If you are seeing duplicate messages being delivered when an email is sent from a BlackBerry device and you have RU3 installed within your Exchange 2010 environment, contact <a href="http://technet.microsoft.com/en-us/exchange/2010/ff396001.aspx">Microsoft Support</a> for assistance in troubleshooting the issue you&rsquo;re experiencing.</p>
<p>It is recommended at this time that everyone hold off deploying RU3 until they have identified and resolved the issues. If you have already deployed RU3 and you are not seeing any issues within your environment, leave RU3 in place at this time.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Update Rollup 3 for Exchange 2010 &ndash; Download disabled&p[summary]=There have been reports of an issue impacting some customers which have RIM BlackBerry devices connecting to Exchange 2010 SP1 with RU3. ...&p[url]=http://172.16.7.177:4000/2011/03/update-rollup-3-for-exchange-2010-download-disabled" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/03/update-rollup-3-for-exchange-2010-download-disabled&text=There have been reports of an issue impacting some customers which have RIM BlackBerry devices connecting to Exchange 2010 SP1 with RU3. ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-03-09T05:34:19-06:00" itemprop="datePublished">9 Mar, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/03/update-rollup-3-for-exchange-2007-sp3-and-exchange-2010-sp1">Update Rollup 3 for Exchange 2007 SP3 and Exchange 2010 SP1</a></h2>
    </header>

    <div class="post-content">
        <p>The Exchange CXP team <a href="http://msexchangeteam.com/archive/2011/03/08/458566.aspx" target="_blank">recently released</a> Update Rollup 3 for Exchange Server 2007 SP3 and Exchange Server 2010 SP1 to the Download Center. Release via Microsoft Update will occur on March 22nd 2011.</p>
<p>These updates contain a number of customer reported and internally found issues since the release of RU2. Both updates resolve a number of issues, in particular for Exchange 2010 it resolves more than 40 issues.</p>
<p>For a detailed list of these issues, visit the following links:</p>
<ul>
<li><a href="http://support.microsoft.com/?kbid=2492691" target="_blank">Update Rollup 3 for Exchange 2007 SP3</a></li>
<li><a href="http://support.microsoft.com/?kbid=2492690" target="_blank">Update Rollup 3 for Exchange 2010 SP1</a></li>
</ul>
<p>Update Rollup 4 for Exchange Server 2007 SP3 and Exchange Server 2010 SP1&#160; is currently scheduled to release in May 2011.</p>
<p>As always, those of you running Forefront, be sure you perform these important steps from the command line in the Forefront directory before and after this rollup's installation process. Without these steps, Exchange services for Information Store and Transport will not start back up. You will need to disable ForeFront via <em><strong>"fscutility /disable"</strong></em> before installing the patch and then re-enable after the patch by running <em><strong>"fscutility /enable"</strong></em> to start it up again post installation.</p>
<p>To download these updates, visit the following links:</p>
<ul>
<li><a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=17615f50-8a56-428c-bc1a-629795692da1" target="_blank">Update Rollup 3 for Exchange 2007 SP3</a></li>
<li><a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=413b8979-76b8-4be4-a18b-015d025eb368" target="_blank">Update Rollup 3 for Exchange 2010 SP1</a></li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Update Rollup 3 for Exchange 2007 SP3 and Exchange 2010 SP1&p[summary]=The Exchange CXP team recently released Update Rollup 3 for Exchange Server 2007 SP3 and Exchange Server 2010 SP1 to the Download Center....&p[url]=http://172.16.7.177:4000/2011/03/update-rollup-3-for-exchange-2007-sp3-and-exchange-2010-sp1" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/03/update-rollup-3-for-exchange-2007-sp3-and-exchange-2010-sp1&text=The Exchange CXP team recently released Update Rollup 3 for Exchange Server 2007 SP3 and Exchange Server 2010 SP1 to the Download Center....&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-02-14T03:05:12-06:00" itemprop="datePublished">14 Feb, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/02/exchange-support-for-windows-server-2008-r2-sp1">Exchange support for Windows Server 2008 R2 SP1</a></h2>
    </header>

    <div class="post-content">
        <p>Last week the Windows Server team <a href="http://blogs.technet.com/b/windowsserver/archive/2011/02/09/windows-server-2008-r2-and-windows-7-sp1-releases-to-manufacturing-today.aspx" target="_blank">announced</a> the Release to Manufacturing (RTM) of Windows Server 2008 R2 Service Pack 1 (SP1), along with Windows 7 SP1. On February 16, both will be available to current customers of the Windows Volume Licensing program, as well as subscribers to Microsoft Developer Network (MSDN) and TechNet. On February 22, both will be available to all customers through Windows Update and will also come preinstalled on new servers ordered.</p>
<p>"Is Exchange supported running on Windows Server 2008 R2 SP1?" The Exchange team have <a href=""Is Exchange supported running on Windows Server 2008 R2 SP1?" " target="_blank">confirmed</a> that the following versions of Exchange are supported to run on Windows 2008 R2 SP1 (the RTM version of SP1): </p>
<ul>
<li>Exchange 2010 SP1</li>
<li>Exchange 2010 RTM</li>
<li>Exchange 2007 SP3</li>
</ul>
<p>There are a couple of things to note:</p>
<ul>
<li> Exchange 2007 was not supported to run on Windows 2008 R2 at all before Exchange 2007 SP3.</li>
<li>Windows 2008 R2 SP1 includes all the hotfixes required to install Exchange 2010 SP1 so if you're installing Exchange 2010 SP1 on a server running Windows 2008 R2 SP1, you don't need to install these hotfixes separately.</li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange support for Windows Server 2008 R2 SP1&p[summary]=Last week the Windows Server team announced the Release to Manufacturing (RTM) of Windows Server 2008 R2 Service Pack 1 (SP1), along with...&p[url]=http://172.16.7.177:4000/2011/02/exchange-support-for-windows-server-2008-r2-sp1" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/02/exchange-support-for-windows-server-2008-r2-sp1&text=Last week the Windows Server team announced the Release to Manufacturing (RTM) of Windows Server 2008 R2 Service Pack 1 (SP1), along with...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-01-06T07:52:24-06:00" itemprop="datePublished">6 Jan, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/01/exchange-2010-sp1-ipd-released">Exchange 2010 SP1 IPD released</a></h2>
    </header>

    <div class="post-content">
        <p>The solution accelerators team has released a new Infrastructure Planning and Design (IPD) guide for Microsoft Exchange Server 2010 with SP1.</p>
<p>This guide provides actionable guidance for designing an Exchange Server 2010 infrastructure. The guide&rsquo;s step-by-step process gives a straightforward explanation of the key steps required for a successful implementation. It can help you reduce planning time and costs, and ensure a successful rollout of Exchange Server 2010. The Exchange Server 2010 Guide includes the following content: </p>
<ul>
<li>Step 1: Define the Business and Technical Requirements</li>
<li>Step 2: Define the Instances of Exchange Server 2010</li>
<li>Step 3: Design the Mailbox Server Infrastructure</li>
<li>Step 4: Design the Client Access Server Infrastructure</li>
<li>Step 5: Design the Hub Transport Server Infrastructure</li>
<li>Step 6: Design the Edge Transport Server Infrastructure</li>
<li>Step 7: Design the Unified Messaging Server Infrastructure</li>
<li>Step 8: Define the Active Directory Domain Services Requirements</li>
</ul>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2011/01/image.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2011/01/image_thumb.png" width="549" height="455" /></a> </p>
<p align="left">For more information and to download the Exchange 2010 SP1 IPD, <a href="http://technet.microsoft.com/en-us/library/gg317461.aspx" target="_blank">click here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2010 SP1 IPD released&p[summary]=The solution accelerators team has released a new Infrastructure Planning and Design (IPD) guide for Microsoft Exchange Server 2010 with ...&p[url]=http://172.16.7.177:4000/2011/01/exchange-2010-sp1-ipd-released" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/01/exchange-2010-sp1-ipd-released&text=The solution accelerators team has released a new Infrastructure Planning and Design (IPD) guide for Microsoft Exchange Server 2010 with ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-12-24T04:52:52-06:00" itemprop="datePublished">24 Dec, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/12/exchange-2010-online-archive-support-in-outlook-2007">Exchange 2010 Online Archive support in Outlook 2007</a></h2>
    </header>

    <div class="post-content">
        <p>It&rsquo;s been a long time coming.. <a href="http://www.cgoosen.com/2010/04/first-look-at-exchange-2010-sp1/" target="_blank">Earlier this year</a> it was announced that Exchange 2010 online archive support for Outlook 2007 would be coming. The good news is that it is finally here!</p>
<p>The <a href="http://support.microsoft.com/kb/2479671" target="_blank">December 2010 Cumulative Update for Office 2007</a> will allow users with Outlook 2007 to access their Exchange 2010 online archives. Organizations with Outlook 2007 deployed can now benefit from Exchange 2010 archiving and retention. There are a few BUT&rsquo;s though.. the following functionality is not supported in Outlook 2007:</p>
<ul>
<li>Search across primary and archive mailboxes: When a user searches the primary mailbox, and selects All Mailbox Items, Outlook does not search the archive mailbox. Similarly, when the user searches the archive mailbox, the primary mailbox is not searched. </li>
<li>Archive policies: In Outlook 2007, users can't use personal tags (also known as archive policies) to move items to the archive mailbox. Any default archive policies for the mailbox continue to be applied. Users can use Outlook Web App to see or apply archive policies. Archive policies are retention policy tags with the Move to Archive action. Organizations can use the Default Archive and Retention Policy, or apply custom retention policies to a mailbox. The policies can include a default policy tag (DPT) to move items from the primary mailbox to the archive mailbox, and personal tags which users can apply to messages or folders to move them to archive.</li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2010 Online Archive support in Outlook 2007&p[summary]=It&rsquo;s been a long time coming.. Earlier this year it was announced that Exchange 2010 online archive support for Outlook 2007 would ...&p[url]=http://172.16.7.177:4000/2010/12/exchange-2010-online-archive-support-in-outlook-2007" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/12/exchange-2010-online-archive-support-in-outlook-2007&text=It&rsquo;s been a long time coming.. Earlier this year it was announced that Exchange 2010 online archive support for Outlook 2007 would ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-12-22T04:50:49-06:00" itemprop="datePublished">22 Dec, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/12/scott-schnoll-on-backup-strategy-in-exchange-2010">Scott Schnoll on Backup Strategy in Exchange 2010</a></h2>
    </header>

    <div class="post-content">
        <p>This is a slightly old interview with Microsoft&rsquo;s Scott Schnoll where he talks about backup strategy in Exchange 2010. While some customers may find this to be an outrageous concept, he talks about how Exchange 2010 database replication can address most, if not all of the reasons you would traditionally backup Exchange using legacy backup technologies.</p>
<pre></pre>
<p><object classid="clsid:6bf52a52-394a-11d3-b153-00c04f79faa6" width="640" height="360" codebase="http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=5,1,52,701"><param name="Filename" value="http://content3.catalog.video.msn.com/e2/ds/alt-en-us/ALTENUS_TECHNET/ALTENUS_TECHNET/47d0a68b-f93d-49da-878a-38d1a8395a6e.wmv" /><param name="AutoStart" value="false" /><param name="ShowControls" value="true" /><param name="BufferingTime" value="2" /><param name="ShowStatusBar" value="true" /><param name="AutoSize" value="true" /><param name="InvokeURLs" value="false" /><param name="url" value="http://content3.catalog.video.msn.com/e2/ds/alt-en-us/ALTENUS_TECHNET/ALTENUS_TECHNET/47d0a68b-f93d-49da-878a-38d1a8395a6e.wmv" /><embed type="application/x-mplayer2" width="640" height="360" src="http://content3.catalog.video.msn.com/e2/ds/alt-en-us/ALTENUS_TECHNET/ALTENUS_TECHNET/47d0a68b-f93d-49da-878a-38d1a8395a6e.wmv" invokeurls="false" autosize="true" showstatusbar="true" bufferingtime="2" showcontrols="true" filename="http://content3.catalog.video.msn.com/e2/ds/alt-en-us/ALTENUS_TECHNET/ALTENUS_TECHNET/47d0a68b-f93d-49da-878a-38d1a8395a6e.wmv"></embed></object></p>
<p>Every organisation has different requirements, the challenge is balancing these requirements while we embrace new technologies and evolve the way we think about things.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Scott Schnoll on Backup Strategy in Exchange 2010&p[summary]=This is a slightly old interview with Microsoft&rsquo;s Scott Schnoll where he talks about backup strategy in Exchange 2010. While some c...&p[url]=http://172.16.7.177:4000/2010/12/scott-schnoll-on-backup-strategy-in-exchange-2010" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/12/scott-schnoll-on-backup-strategy-in-exchange-2010&text=This is a slightly old interview with Microsoft&rsquo;s Scott Schnoll where he talks about backup strategy in Exchange 2010. While some c...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-12-20T05:08:46-06:00" itemprop="datePublished">20 Dec, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/12/exchange-server-deployment-assistant-coexistence-scenario">Exchange Server Deployment Assistant &ndash; Coexistence Scenario</a></h2>
    </header>

    <div class="post-content">
        <p>I <a href="http://www.cgoosen.com/2009/11/exchange-server-2010-deployment-assistant/" target="_blank">previously posted</a> about the Exchange Server Deployment Assistant. The Deployment Assistant asks you some questions about your particular Exchange environment and, based on your answers, it provides a checklist with instructions that are designed to help you deploy Exchange 2010 quickly and easily. Each step has a huge amount of valuable information to guide you through your deployment.</p>
<p>This great tool has recently been enhanced to include rich coexistence information for those interested in maintaining some users on-premises and some users hosted by Microsoft Office 365 for enterprises in the cloud. As of now, the available scenario is targeted solely at those organizations with a current Exchange 2003 on-premises implementation, but additional scenarios for supporting Exchange 2007 and Exchange 2010 will be coming soon.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/12/image.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2010/12/image_thumb.png" width="568" height="211" /></a> </p>
<p>The Exchange Server Deployment Assistant can be <a href="http://technet.microsoft.com/en-us/exdeploy2010/default.aspx" target="_blank">found here</a> Be sure to bookmark it!</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange Server Deployment Assistant &ndash; Coexistence Scenario&p[summary]=I previously posted about the Exchange Server Deployment Assistant. The Deployment Assistant asks you some questions about your particula...&p[url]=http://172.16.7.177:4000/2010/12/exchange-server-deployment-assistant-coexistence-scenario" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/12/exchange-server-deployment-assistant-coexistence-scenario&text=I previously posted about the Exchange Server Deployment Assistant. The Deployment Assistant asks you some questions about your particula...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-11-19T08:30:18-06:00" itemprop="datePublished">19 Nov, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/11/exchange-2010-mailbox-role-calculator-and-specint2006-rate-value">Exchange 2010 Mailbox Role Calculator and SPECint2006 Rate Value</a></h2>
    </header>

    <div class="post-content">
        <p>I often talk about the Exchange 2010 Mailbox role calculator, I&rsquo;m sure everyone uses it (everyone should be using it!) during the planning phases of any Exchange 2010 deployment. If you have no idea what I am talking about, <a href="http://msexchangeteam.com/archive/2009/11/09/453117.aspx" target="_blank">click here now!</a></p>
<p>There is an area on the input tab where you define the number of processor cores that will have deployed for each mailbox server within your primary and secondary data centres, as well as, enter the SPECint2006 rate value for the system you have selected. The SPECint2006 rate value often causes some confusion so I thought I would write this post to try and clarify what to enter in the SPECint2006 rate value field.</p>
<p>In previous versions of the Exchange 2010 Mailbox role calculator (prior to 12.8) you had to enter the &ldquo;Adjusted Megacycles / Core&rdquo; which meant that you needed to normalise your server platform against the baseline platform -Intel Xeon x5470 3.33GHZ processors (2x4 core arrangement) and enter that value. To get to this value, you had to find your rate value and then use the following formula to calculate the &ldquo;Adjusted Megacycles / Core&rdquo; value: </p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/11/image.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2010/11/image_thumb.png" width="321" height="42" /></a> </p>
<p>In version 12.8, the field name has changed to &ldquo;SPECint2006 Rate Value&rdquo; which means you no longer need to normalise your server platform against the baseline platform and you merely enter the rate value. </p>
<p>To find the rate value, <a href="http://www.spec.org" target="_blank">go here</a>, click on &ldquo;Results&rdquo;, highlight &ldquo;CPU2006&rdquo; and then select &ldquo;Search CPU2006 Results&rdquo;. Under &ldquo;Available Configurations&rdquo;, select &ldquo;SPECint2006 Rates&rdquo; and click Go. Under &ldquo;Simple Request&rdquo;, enter the search criteria (e.g. Processor matches x5550) and find the server and processor you are planning to deploy and take note of the result value. </p>
<p>For example, let's say you are deploying a Dell PowerEdge M710 8-core server with Intel x5550 2.67GHz processors (2670 Hertz); the SPECint_rate2006 results value is 240, simply go back to the Exchange 2010 Mailbox role calculator and select &ldquo;8&rdquo; in the &ldquo;Processor Cores / Server&rdquo; field and enter &ldquo;240&rdquo; in &ldquo;SPECint2006 Rate Value&rdquo; field. Easy, huh?</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2010 Mailbox Role Calculator and SPECint2006 Rate Value&p[summary]=I often talk about the Exchange 2010 Mailbox role calculator, I&rsquo;m sure everyone uses it (everyone should be using it!) during the p...&p[url]=http://172.16.7.177:4000/2010/11/exchange-2010-mailbox-role-calculator-and-specint2006-rate-value" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/11/exchange-2010-mailbox-role-calculator-and-specint2006-rate-value&text=I often talk about the Exchange 2010 Mailbox role calculator, I&rsquo;m sure everyone uses it (everyone should be using it!) during the p...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-11-17T08:49:09-06:00" itemprop="datePublished">17 Nov, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/11/outlook-anywhere-and-wildcard-certificates">Outlook Anywhere and Wildcard Certificates</a></h2>
    </header>

    <div class="post-content">
        <p>Exchange 2007 brought about a change in the way Exchange uses certificates and introduced us to the concept of a Unified Communications Certificate which makes use of Subject Alternative Names (SAN). While this is the recommended way to secure Exchange services, every now and then I come across a customer that already owns a wildcard certificate for their entire domain (eg. *.cgoosen.com) and would like to use this certificate instead.</p>
<p>One of the problems with wildcard certificates is that they don&rsquo;t always play nicely with Outlook Anywhere. If the principle name on the certificate is not the same as the mail server FQDN Outlook may not authenticate correctly. When testing Outlook Anywhere connectivity with <a href="https://www.testexchangeconnectivity.com/" target="_blank">Exchange Server Remote Connectivity Analyzer (ExRCA)</a> you may see something like this:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/11/d1.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="d1" border="0" alt="d1" src="http://www.cgoosen.com/wp-content/uploads/2010/11/d1_thumb.png" width="368" height="84" /></a> </p>
<p align="left">Additional Details would be similar to this:</p>
<p align="center"><em>The certificate common name *.domain.com doesn't validate against the mutual authentication string that was provided: msstd:mail.domain.com</em></p>
<p align="left">The easiest way to correct this problem is to use Autodiscover to send the correct principle name to your Outlook clients. Use the Exchange Management Shell to configure Autodiscover settings by using the <em>Set-OutlookProvider</em> cmdlet</p>
<p align="left">You can check the existing configuration by issuing the <em>Get-OutlookProvider</em> cmdlet</p>
<p align="left">The command should look something like this:</p>
<p align="left"><font face="Courier">Set-OutlookProvider -Identity EXPR -CertPrincipalName msstd:*.domain.com</font></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/11/d2.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="d2" border="0" alt="d2" src="http://www.cgoosen.com/wp-content/uploads/2010/11/d2_thumb.png" width="568" height="222" /></a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Outlook Anywhere and Wildcard Certificates&p[summary]=Exchange 2007 brought about a change in the way Exchange uses certificates and introduced us to the concept of a Unified Communications C...&p[url]=http://172.16.7.177:4000/2010/11/outlook-anywhere-and-wildcard-certificates" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/11/outlook-anywhere-and-wildcard-certificates&text=Exchange 2007 brought about a change in the way Exchange uses certificates and introduced us to the concept of a Unified Communications C...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-11-16T05:44:36-06:00" itemprop="datePublished">16 Nov, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/11/jetstress-field-guide">Jetstress Field Guide</a></h2>
    </header>

    <div class="post-content">
        <p>I&rsquo;m often asked by my customers and colleagues about Jetstress. While I always recommend that Jetstress be used to validate their storage design during an Exchange implementation, I&rsquo;ve never really seen any good documentation to refer them to. Until now that is! </p>
<p>Neil Johnson from MCS has recently published a great whitepaper that explains the process and requirements for validating an Exchange storage solution prior to releasing an Exchange deployment into production. His whitepaper explains how Jetstress works, how to plan for and perform a test, and how to automate the process. His whitepaper, &ldquo;Jetstress Field Guide&rdquo;, can be used with any version of Exchange.</p>
<p>Download it <a href="http://msexchangeteam.com/files/12/attachments/entry456925.aspx" target="_blank">here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Jetstress Field Guide&p[summary]=I&rsquo;m often asked by my customers and colleagues about Jetstress. While I always recommend that Jetstress be used to validate their s...&p[url]=http://172.16.7.177:4000/2010/11/jetstress-field-guide" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/11/jetstress-field-guide&text=I&rsquo;m often asked by my customers and colleagues about Jetstress. While I always recommend that Jetstress be used to validate their s...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-10-11T10:22:06-05:00" itemprop="datePublished">11 Oct, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/10/rollup-rollup">Rollup, Rollup!</a></h2>
    </header>

    <div class="post-content">
        <p>The last month has seen the release of <a href="http://www.microsoft.com/downloads/en/details.aspx?FamilyID=ae45d06e-dcb7-43d8-b1ff-d3953836425b&amp;displaylang=en" target="_blank">Update Rollup 1 for Exchange 2007 SP3</a> and <a href="http://www.microsoft.com/downloads/en/details.aspx?FamilyID=a371fa96-e85b-4a4f-8242-15d56595d0ec&amp;displaylang=en" target="_blank">Update Rollup 1 for Exchange 2010.</a></p>
<p>For a full list of the fixes included in Update Rollup 1 for Exchange 2007 SP3, see <a href="http://support.microsoft.com/?kbid=2279665" target="_blank">KB2279665</a></p>
<p>For a full list of the fixes included in Update Rollup 1 for Exchange 2010 SP1, see <a href="http://support.microsoft.com/?kbid=2407028" target="_blank">KB2407028</a></p>
<p><strong><span style="color: #ff0000;">Note for Forefront Protection for Exchange users</span></strong><br />
For those running Forefront Protection for Exchange, be sure you perform these important steps from the command line in the Forefront directory before and after installing this rollup. Without these steps, the Information Store and Transport services will not start.</p>
<ol>
<li>Before installing the rollup, disable ForeFront by using the "fscutility /disable" command</li>
<li>After rollup installation completes, re-enable ForeFront by running the "fscutility /enable" command</li>
</ol>
<p>Download Links:</p>
<ul>
<li><a href="http://www.microsoft.com/downloads/en/details.aspx?FamilyID=ae45d06e-dcb7-43d8-b1ff-d3953836425b&amp;displaylang=en" target="_blank">Update Rollup 1 for Exchange 2007 SP3</a></li>
<li><a href="http://www.microsoft.com/downloads/en/details.aspx?FamilyID=a371fa96-e85b-4a4f-8242-15d56595d0ec&amp;displaylang=en" target="_blank">Update Rollup 1 for Exchange 2010 SP1</a></li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Rollup, Rollup!&p[summary]=The last month has seen the release of Update Rollup 1 for Exchange 2007 SP3 and Update Rollup 1 for Exchange 2010.
For a full list of th...&p[url]=http://172.16.7.177:4000/2010/10/rollup-rollup" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/10/rollup-rollup&text=The last month has seen the release of Update Rollup 1 for Exchange 2007 SP3 and Update Rollup 1 for Exchange 2010.
For a full list of th...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-10-11T10:06:42-05:00" itemprop="datePublished">11 Oct, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/10/forefront-tmg-error-2146233088">Forefront TMG error : %%-2146233088</a></h2>
    </header>

    <div class="post-content">
        <p>Earlier this year I post a 6 part post entitled <a href="http://www.cgoosen.com/2010/05/securing-exchange-2010-with-forefront-threat-management-gateway-tmg-2010-part-1-the-introduction/" target="_blank">&ldquo;Securing Exchange 2010 with Forefront Threat Management Gateway (TMG) 2010&rdquo;</a> which covered colocating Exchange 2010 Edge and Forefront TMG 2010 on the same server to create a a single, secure point of entry for all mail related services.</p>
<p>When Exchange 2010 SP1 <a href="http://www.cgoosen.com/2010/08/exchange-2010-sp1-is-here/" target="_blank">was released</a> in late August many people started to report seeing the following error in their event log:</p>
<p><em>&ldquo;Microsoft Forefront TMG Managed Control service fails to start and the event viewer will contain a message that the service terminated with the following error : %%-2146233088&rdquo;</em></p>
<p>The reason for this is that SP1 removed some of the existing cmdlets, in particular <em>get-antispamupdates </em>which is used by TMG when spam filtering functionality is enabled.</p>
<p>The forefront team <a href="http://blogs.technet.com/b/isablog/archive/2010/09/20/software-update-1-for-microsoft-forefront-threat-management-gateway-tmg-2010-service-pack-1-now-available-for-download.aspx" target="_blank">recently announced</a> the release of Software Update 1 for Forefront TMG 2010 SP1. This update resolves the issue.</p>
<p>Download Software Update 1 for Forefront TMG 2010 SP1 <a href="http://www.microsoft.com/downloads/en/details.aspx?FamilyID=695d0709-0d8b-45ee-afdb-727c4428ca4d" target="_blank">here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Forefront TMG error : %%-2146233088&p[summary]=Earlier this year I post a 6 part post entitled &ldquo;Securing Exchange 2010 with Forefront Threat Management Gateway (TMG) 2010&rdquo; ...&p[url]=http://172.16.7.177:4000/2010/10/forefront-tmg-error-2146233088" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/10/forefront-tmg-error-2146233088&text=Earlier this year I post a 6 part post entitled &ldquo;Securing Exchange 2010 with Forefront Threat Management Gateway (TMG) 2010&rdquo; ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-09-07T13:09:37-05:00" itemprop="datePublished">7 Sep, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/09/exchange-2010-moving-mail-queue">Exchange 2010 Moving Mail Queue</a></h2>
    </header>

    <div class="post-content">
        <p>In early 2009 I wrote an post entitled &ldquo;<a href="http://www.cgoosen.com/2009/02/exchange-2007-sp1-moving-mail-queuetransport-dumpster/" target="_blank">Exchange 2007 SP1 Moving Mail Queue/Transport Dumpster</a>&rdquo;. This post is still one of the most frequently viewed posts on my blog so I thought it was time to post an update for Exchange 2010.</p>
<p>In Exchange 2010, the location of the queue database and queue database transaction logs are controlled by the <em>QueueDatabasePath</em> and <em>QueueDatabaseLoggingPath</em> parameters in the EdgeTransport.exe.config application configuration file. This file is located in the C:\Program Files\Microsoft\Exchange Server\V14\Bin directory. To change the location of the queue database and queue database transaction logs, simple open this file in Notepad and locate the following values under <em><appSettings></em></p>
<p><em><add key="QueueDatabasePath" value="<LocalPath>" /></em></p>
<p><em><add key="QueueDatabaseLoggingPath" value="<LocalPath>" /></em></p>
<p>Change these paths to match your requirements and save the file.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/09/excas19.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="excas19" border="0" alt="excas19" src="http://www.cgoosen.com/wp-content/uploads/2010/09/excas19_thumb.png" width="561" height="172" /></a> </p>
<p align="left">Restart the Microsoft Exchange Transport service for these changes to take effect. Once restarted, you should notice that new Mail.que and Trn.chk files are created at the new <em>QueueDatabasePath</em> location and new Trn.log, Trntmp.log, Trnres00001.jrs, Trnres00002.jrs, and Temp.edb files at the new <em>QueueDatabaseLoggingPath </em>location.</p>
<p align="left">There are a few things to note about this process. Firstly, If the target directory doesn't exist, it will be automatically created if the parent directory has the following permissions:</p>
<ul>
<li>
<div align="left">Network Service: Full Control</div>
</li>
<li>
<div align="left">System: Full Control</div>
</li>
<li>
<div align="left">Administrators: Full Control </div>
</li>
</ul>
<p>The existing queue database and log files are not moved. New files are created at the new location and existing database files are left at the old location. These old files are no longer used.</p>
<p>If you would like to change the location of the queue database but reuse the existing queue database files, you must move or copy the database files when the Microsoft Exchange Transport service is stopped.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2010 Moving Mail Queue&p[summary]=In early 2009 I wrote an post entitled &ldquo;Exchange 2007 SP1 Moving Mail Queue/Transport Dumpster&rdquo;. This post is still one of th...&p[url]=http://172.16.7.177:4000/2010/09/exchange-2010-moving-mail-queue" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/09/exchange-2010-moving-mail-queue&text=In early 2009 I wrote an post entitled &ldquo;Exchange 2007 SP1 Moving Mail Queue/Transport Dumpster&rdquo;. This post is still one of th...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-08-30T13:35:12-05:00" itemprop="datePublished">30 Aug, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/08/exchange-2010-sp1-prerequisites">Exchange 2010 SP1 Prerequisites</a></h2>
    </header>

    <div class="post-content">
        <p>I <a href="http://www.cgoosen.com/2010/08/exchange-2010-sp1-is-here/" target="_blank">recently posted</a> about the availability of Exchange 2010 SP1 and thought I would provide some feedback about the installation process.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/08/sp1_2.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="sp1_2" border="0" alt="sp1_2" src="http://www.cgoosen.com/wp-content/uploads/2010/08/sp1_2_thumb.png" width="504" height="378" /></a> </p>
<p align="left">Before installing SP1 for Exchange 2010, there <font size="2">are</font> several updates and hot fixes that need to be installed first. An important thing to note is that <em>all the Unified Messaging language packs other than US English (en-US) need to be uninstalled before upgrading the Unified Messaging server role.</em> I have split these up then up by server role:</p>
<p><strong>Hub Transport Role Prerequisites:</strong>     <br /><a href="http://support.microsoft.com/?kbid=979099" target="_blank">Microsoft Knowledge Base article 979099</a>     <br /><a href="http://go.microsoft.com/fwlink/?LinkID=191548" target="_blank">Microsoft Office 2010 Filter Packs</a></p>
<p><strong>Client Access Role Prerequisites:</strong>     <br /><a href="http://code.msdn.microsoft.com/KB982867" target="_blank">Microsoft Knowledge Base article 982867</a> *requires a restart    <br /><a href="http://code.msdn.microsoft.com/KB979744" target="_blank">Microsoft Knowledge Base article 979744</a> *requires a restart    <br /><a href="http://code.msdn.microsoft.com/KB983440" target="_blank">Microsoft Knowledge Base article 983440</a> *requires a restart    <br /><a href="http://code.msdn.microsoft.com/KB977020" target="_blank">Microsoft Knowledge Base article 977020</a>     <br /><a href="http://support.microsoft.com/?kbid=979099" target="_blank">Knowledge Base article 979099</a> </p>
<p><strong>Mailbox Role Prerequisites:</strong>     <br /><a href="http://support.microsoft.com/?kbid=979099 " target="_blank">Microsoft Knowledge Base article 979099</a>    <br /><a href="http://go.microsoft.com/fwlink/?LinkID=191548" target="_blank">Microsoft Office 2010 Filter Packs</a></p>
<p><strong>Unified Messaging Role Prerequisites:      <br /></strong><a href="http://go.microsoft.com/fwlink/?LinkID=180957" target="_blank">Microsoft Unified Communications Managed API, Core Runtime 64-bit</a>    <br /><a href="http://go.microsoft.com/fwlink/?LinkID=180958" target="_blank">Microsoft Server Speech Platform Runtime 64-bit</a>     <br /><a href="http://support.microsoft.com/?kbid=979099" target="_blank">Microsoft Knowledge Base article 979099</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2010 SP1 Prerequisites&p[summary]=I recently posted about the availability of Exchange 2010 SP1 and thought I would provide some feedback about the installation process.
 ...&p[url]=http://172.16.7.177:4000/2010/08/exchange-2010-sp1-prerequisites" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/08/exchange-2010-sp1-prerequisites&text=I recently posted about the availability of Exchange 2010 SP1 and thought I would provide some feedback about the installation process.
 ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-08-27T10:30:39-05:00" itemprop="datePublished">27 Aug, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/08/exchange-2010-sp1-is-here">Exchange 2010 SP1 is here!</a></h2>
    </header>

    <div class="post-content">
        <p>In <a href="http://www.cgoosen.com/2010/04/first-look-at-exchange-2010-sp1/" target="_blank">April I posted</a> about some of the new features that will be available in Exchange 2010 SP1. The most notable of these is the ability to provision a user&rsquo;s personal archive to a different mailbox database from their primary mailbox. </p>
<p>Many people have been eagerly awaiting the release of SP1, the good news is that it is now available for download. For more information, see this <a href="http://msexchangeteam.com/archive/2010/08/25/455861.aspx" target="_blank">Exchange Team Blog entry</a>. </p>
<p>To download Exchange 2010 SP1, <a href="http://go.microsoft.com/fwlink/?LinkID=199950" target="_blank">click here.</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2010 SP1 is here!&p[summary]=In April I posted about some of the new features that will be available in Exchange 2010 SP1. The most notable of these is the ability to...&p[url]=http://172.16.7.177:4000/2010/08/exchange-2010-sp1-is-here" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/08/exchange-2010-sp1-is-here&text=In April I posted about some of the new features that will be available in Exchange 2010 SP1. The most notable of these is the ability to...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-08-18T13:10:09-05:00" itemprop="datePublished">18 Aug, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/08/exchange-2010-the-user-domainusername-isnt-assigned-to-any-management-roles">Exchange 2010: The user "domain\username" isn't assigned to any management roles.</a></h2>
    </header>

    <div class="post-content">
        <p>I was running through the Exchange 2010 installation process earlier today, during the installation process, everything went really smoothly and I only had &ldquo;green ticks&rdquo;!</p>
<p>Once done, I opened the Exchange Management Console and saw the following error:</p>
<p><em>&lsquo;The following error occurred when searching for On-Premises Exchange server:[myservername.local] Processing data from remote server failed with the following error message: The user "domain\username" isn't assigned to any management roles. For more.... It was running "Discover-ExchangeServer - USeWIA $true -SupressError $true&rsquo;</em></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/08/error.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="error" border="0" alt="error" src="http://www.cgoosen.com/wp-content/uploads/2010/08/error_thumb.png" width="554" height="126" /></a> </p>
<p>It was rather confusing at first as I had completed the installation using an admin account that was a member of the Enterprise Admins group. Digging a little deeper, saw the following error in the event log:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/08/error2.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="error2" border="0" alt="error2" src="http://www.cgoosen.com/wp-content/uploads/2010/08/error2_thumb.png" width="484" height="338" /></a> </p>
<p align="left">After some further digging, I realised what had happened. A colleague of mine did the AD schema preparation using his admin account a few days ago, during that part of the process, the account being used was automatically added to the &ldquo;Organization Management&rdquo; AD security group. When I then resumed the installation process with my account, I was not a member of this group. To rectify the problem, I had to manually add my account to the &ldquo;Organization Management&rdquo; AD security group.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/08/errorfix.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="error -fix" border="0" alt="error -fix" src="http://www.cgoosen.com/wp-content/uploads/2010/08/errorfix_thumb.png" width="404" height="523" /></a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2010: The user "domain\username" isn't assigned to any management roles.&p[summary]=I was running through the Exchange 2010 installation process earlier today, during the installation process, everything went really smoot...&p[url]=http://172.16.7.177:4000/2010/08/exchange-2010-the-user-domainusername-isnt-assigned-to-any-management-roles" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/08/exchange-2010-the-user-domainusername-isnt-assigned-to-any-management-roles&text=I was running through the Exchange 2010 installation process earlier today, during the installation process, everything went really smoot...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-07-05T12:26:06-05:00" itemprop="datePublished">5 Jul, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/07/gartner-positions-microsoft-in-the-leaders-quadrant">Gartner positions Microsoft in the Leaders quadrant</a></h2>
    </header>

    <div class="post-content">
        <p>On the strength of its market position, Microsoft has recently been placed in the Leaders Quadrant in Gartner&rsquo;s Magic Quadrant for Secure E-mail Gateway.</p>
<p>The Secure Messaging solution offers customers a hybrid model of in-the-cloud services &ndash; <strong>Forefront Online Protection for Exchange</strong> &ndash; and on-premises software &ndash; <strong>Forefront Protection 2010 for Exchange Server</strong> &ndash; to provide defence-in-depth protection.</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2010/07/image4.png"><img style="border-bottom: 0px; border-left: 0px; display: block; float: none; margin-left: auto; border-top: 0px; margin-right: auto; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2010/07/image_thumb4.png" width="371" height="431" /></a></p>
<p>For the complete report, <a href="http://imagesrv.gartner.com/media-products/pdf/microsoft/issue1_secure_web_final.pdf" target="_blank">click here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Gartner positions Microsoft in the Leaders quadrant&p[summary]=On the strength of its market position, Microsoft has recently been placed in the Leaders Quadrant in Gartner&rsquo;s Magic Quadrant for ...&p[url]=http://172.16.7.177:4000/2010/07/gartner-positions-microsoft-in-the-leaders-quadrant" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/07/gartner-positions-microsoft-in-the-leaders-quadrant&text=On the strength of its market position, Microsoft has recently been placed in the Leaders Quadrant in Gartner&rsquo;s Magic Quadrant for ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-07-05T09:44:50-05:00" itemprop="datePublished">5 Jul, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/07/client-network-requirements-in-exchange-2010">Client Network Requirements in Exchange 2010</a></h2>
    </header>

    <div class="post-content">
        <p>Client network traffic is area that often generates many questions. This area is frequently the subject of discussion when site consolidation is being discussed which also raises the issues of network cost and sizing.</p>
<p>While there is some information available on how to estimate this client network traffic, this is mostly relevant to Exchange 2007 and Outlook 2007. I am not aware of any changes in Exchange 2010 and Outlook 2010 that will change the client network requirements, so the information below is based on this.</p>
<p>The first bit of information you need are user profiles, use the Microsoft Exchange Server Profile Analyzer tool to collect this information if you don&rsquo;t already have it. You can download the Microsoft Exchange Server Profile Analyzer tool from the links provided at the bottom of this page.</p>
<div align="center">
<table width="479" border="0" align="center" bgcolor="#ffffff">
<tbody>
<tr>
<td width="136"><strong>Profile</strong></td>
<td width="48"><strong>Light</strong></td>
<td><strong>Medium</strong></td>
<td><strong>Heavy</strong></td>
<td width="143"><strong>Very Heavy</strong></td>
</tr>
<tr>
<td width="136">Sent/Day</td>
<td width="48">5</td>
<td>10</td>
<td>20</td>
<td width="143">30</td>
</tr>
<tr>
<td width="136">Received/Day</td>
<td width="48">20</td>
<td>40</td>
<td>80</td>
<td width="143">120</td>
</tr>
<tr>
<td width="136">Ave Msg Size</td>
<td width="48">75kb</td>
<td>75kb</td>
<td>75kb</td>
<td width="143">75kb</td>
</tr>
<tr>
<td width="136">Msgs Read/Day</td>
<td width="48">20</td>
<td>40</td>
<td>80</td>
<td width="143">120</td>
</tr>
<tr>
<td width="136">Msgs Del&rsquo;d/Day</td>
<td width="48">10</td>
<td>20</td>
<td>40</td>
<td width="143">60</td>
</tr>
<tr>
<td width="136">OWA logon/Day</td>
<td width="48">2</td>
<td>2</td>
<td>2</td>
<td width="143">2</td>
</tr>
</tbody>
</table>
</div>
<div align="center"></div>
<p>Next we determine how much traffic is generated by each user profile per day. In the table below, all values are in Kilobytes/User/Day. The table separates sending from all other actions which are labelled as aggregate.</p>
<div align="left">
<table width="579" border="0" align="left" bgcolor="#ffffff">
<tbody>
<tr>
<td width="243"><strong>Profile</strong></td>
<td width="87"></td>
<td width="20"><strong>Light</strong></td>
<td width="58"><strong>Medium</strong></td>
<td width="38"><strong>Heavy</strong></td>
<td width="131"><strong>Very Heavy</strong></td>
</tr>
<tr>
<td width="243"></td>
<td width="87"></td>
<td width="20"></td>
<td width="58"></td>
<td width="38"></td>
<td width="131"></td>
</tr>
<tr>
<td width="243"></td>
<td width="87">Sending</td>
<td width="20">285</td>
<td width="58">570</td>
<td width="38">1,140</td>
<td width="131">1,710</td>
</tr>
<tr>
<td width="243"><strong>Outlook - Online</strong></td>
<td width="87">Aggregate</td>
<td width="20">3,765</td>
<td width="58">7,545</td>
<td width="38">15,075</td>
<td width="131">22,605</td>
</tr>
<tr>
<td width="243"></td>
<td width="87">Total</td>
<td width="20">4,050</td>
<td width="58">8,115</td>
<td width="38">16,215</td>
<td width="131">24,315</td>
</tr>
<tr>
<td width="243"></td>
<td width="87"></td>
<td width="20"></td>
<td width="58"></td>
<td width="38"></td>
<td width="131"></td>
</tr>
<tr>
<td width="243"></td>
<td width="87">Sending</td>
<td width="20">390</td>
<td width="58">780</td>
<td width="38">1,560</td>
<td width="131">2,340</td>
</tr>
<tr>
<td width="243"><strong>Outlook - Cached Mode</strong></td>
<td width="87">Aggregate</td>
<td width="20">1,560</td>
<td width="58">3,120</td>
<td width="38">6,240</td>
<td width="131">9,360</td>
</tr>
<tr>
<td width="243"></td>
<td width="87">Total</td>
<td width="20">1,950</td>
<td width="58">3,900</td>
<td width="38">7,800</td>
<td width="131">11,700</td>
</tr>
<tr>
<td width="243"></td>
<td width="87"></td>
<td width="20"></td>
<td width="58"></td>
<td width="38"></td>
<td width="131"></td>
</tr>
<tr>
<td width="243"></td>
<td width="87">Sending</td>
<td width="20">465</td>
<td width="58">930</td>
<td width="38">1,845</td>
<td width="131">2,775</td>
</tr>
<tr>
<td width="243"><strong>Outlook Anywhere</strong></td>
<td width="87">Aggregate</td>
<td width="20">1,845</td>
<td width="58">3,705</td>
<td width="38">7,410</td>
<td width="131">11,100</td>
</tr>
<tr>
<td width="243"></td>
<td width="87">Total</td>
<td width="20">2,310</td>
<td width="58">4,635</td>
<td width="38">9,255</td>
<td width="131">13,875</td>
</tr>
<tr>
<td width="243"></td>
<td width="87"></td>
<td width="20"></td>
<td width="58"></td>
<td width="38"></td>
<td width="131"></td>
</tr>
<tr>
<td width="243"></td>
<td width="87">Sending</td>
<td width="20">1,200</td>
<td width="58">2,400</td>
<td width="38">4,800</td>
<td width="131">7,200</td>
</tr>
<tr>
<td width="243"><strong>Outlook Web App</strong></td>
<td width="87">Aggregate</td>
<td width="20">8,085</td>
<td width="58">15,930</td>
<td width="38">31,605</td>
<td width="131">47,295</td>
</tr>
<tr>
<td width="243"></td>
<td width="87">Total</td>
<td width="20">9,285</td>
<td width="58">18,330</td>
<td width="38">36,405</td>
<td width="131">54,495<span style="line-height: 1.6em; color: #333333; font-family: georgia, times, serif; font-size: 14px;">&nbsp;</span></td>
</tr>
</tbody>
</table>
</div>
<p>Now that we have these values, how do we use them? The last piece of the puzzle is the formula. The following formula can be used to estimate the network traffic (in KB/Sec) required by your Exchange 2010 clients.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/07/image.png"><img style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/07/image_thumb.png" alt="image" width="443" height="33" border="0" /></a></p>
<p>Using this formula and the data in the above tables, if we wanted to calculate the network requirements for 2,500 heavy users who use Outlook in Cached Mode it would look something like this:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/07/image1.png"><img style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/07/image_thumb1.png" alt="image" width="268" height="42" border="0" /></a></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/07/image2.png"><img style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/07/image_thumb2.png" alt="image" width="240" height="29" border="0" /></a></p>
<p align="left">Network Traffic (KB/Sec) = 677 KB/Sec. To convert this to Mbps:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/07/image3.png"><img style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/07/image_thumb3.png" alt="image" width="240" height="28" border="0" /></a></p>
<p align="center">
<p>Network Traffic (Mbps) = 5.4 Mbps.</p>
<p>This formula assumes all these users are in the same time zone, so they do the majority of the work during an 8 hour day.</p>
<p>This information is based on the <a href="http://msexchangeteam.com/archive/2008/04/10/448668.aspx" target="_blank">original post</a> from MS Exchange Team blog.</p>
<p>Download Microsoft Exchange Server Profile Analyzer (32 bit) <a href="http://www.microsoft.com/downloads/details.aspx?FamilyId=8F575F60-BD80-44AA-858B-A1F721108FAD&amp;displaylang=en" target="_blank">here</a></p>
<p>Download Microsoft Exchange Server Profile Analyzer (64 bit) <a href="http://www.microsoft.com/downloads/details.aspx?familyid=C009C049-9F4C-4519-A389-69C281B2ABDA&amp;displaylang=en" target="_blank">here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Client Network Requirements in Exchange 2010&p[summary]=Client network traffic is area that often generates many questions. This area is frequently the subject of discussion when site consolida...&p[url]=http://172.16.7.177:4000/2010/07/client-network-requirements-in-exchange-2010" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/07/client-network-requirements-in-exchange-2010&text=Client network traffic is area that often generates many questions. This area is frequently the subject of discussion when site consolida...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-06-22T08:32:11-05:00" itemprop="datePublished">22 Jun, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/06/exchange-2007-sp3-released">Exchange 2007 SP3 Released!</a></h2>
    </header>

    <div class="post-content">
        <p>In November last year <a href="http://www.cgoosen.com/2009/11/exchange-2007-on-windows-2008-r2/" target="_blank">I mentioned</a> that Windows 2008 R2 support for Exchange 2007 was been announced. The Exchange product team <a href="http://msexchangeteam.com/archive/2010/06/21/455145.aspx" target="_blank">yesterday announced</a> the release of Exchange 2007 Service Pack 3 (SP3). </p>
<p>SP3 for Exchange 2007 enables Exchange 2007 to be installed on the Windows Server 2008 R2 version of the operating system as well as Windows 7 support for the Exchange management tools. Other enhancements include advanced protection options against e-mail security threats, such as spam and viruses and tools which help manage internal compliance and high availability.</p>
<p>For more information about Exchange 2007 SP3, see <a href="http://technet.microsoft.com/en-us/library/ff607226%28EXCHG.80%29.aspx" target="_blank">Microsoft TechNet</a></p>
<p>Download Exchange 2007 SP3 <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=1687160b-634a-43cb-a65a-f355cff0afa6" target="_blank">here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2007 SP3 Released!&p[summary]=In November last year I mentioned that Windows 2008 R2 support for Exchange 2007 was been announced. The Exchange product team yesterday ...&p[url]=http://172.16.7.177:4000/2010/06/exchange-2007-sp3-released" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/06/exchange-2007-sp3-released&text=In November last year I mentioned that Windows 2008 R2 support for Exchange 2007 was been announced. The Exchange product team yesterday ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-06-16T06:10:46-05:00" itemprop="datePublished">16 Jun, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/06/updates-to-the-exchange-mailbox-server-role-requirements-calculators">Updates to the Exchange Mailbox Server Role Requirements Calculators</a></h2>
    </header>

    <div class="post-content">
        <p>The Exchange 2007 and Exchange 2010 Mailbox Server Role Requirements Calculators have recently been updated. If you use either of these tools often, you&rsquo;ll no doubt appreciate how much effort must to into keeping them updated. </p>
<p>Apart from some bug fixes, there have been a few enhancements too, for the Exchange 2010 calculator, these include:</p>
<ul>
<li>Added two new columns to the primary datacenter &ldquo;Active Database Configuration / DAG&rdquo; table.&#160; These columns now expose the total number of databases activated in each site after server failure events.&#160; This change was added to expose cross-site database failover events.</li>
<li>The calculator now includes an option to activation block secondary datacenter mailbox servers that host HA database copies.&#160; This allows you to design a solution where you can activate the secondary datacenter in the event of a primary datacenter failure mode, or choose to activate a copy in the secondary datacenter manually, but prohibits Active Manager from automatically activating a copy in the secondary datacenter.&#160; </li>
<li>Added support for 32-cores.</li>
</ul>
<p>For detailed information on these and other enhancements, see the following links:</p>
<ul>
<li><a href="http://msexchangeteam.com/archive/2007/07/05/445802.aspx" target="_blank">Updates to the Exchange 2007 Mailbox Server Role Storage Requirements Calculator</a></li>
<li><a href="http://msexchangeteam.com/archive/2010/01/22/453859.aspx" target="_blank">Updates to the Exchange 2010 Mailbox Server Role Requirements Calculator</a></li>
</ul>
<p>To download the revised version, click <a href="http://msexchangeteam.com/files/12/attachments/entry438481.aspx" target="_blank">here for Exchange 2007</a> and <a href="http://msexchangeteam.com/files/12/attachments/entry453145.aspx" target="_blank">here for Exchange 2010</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Updates to the Exchange Mailbox Server Role Requirements Calculators&p[summary]=The Exchange 2007 and Exchange 2010 Mailbox Server Role Requirements Calculators have recently been updated. If you use either of these t...&p[url]=http://172.16.7.177:4000/2010/06/updates-to-the-exchange-mailbox-server-role-requirements-calculators" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/06/updates-to-the-exchange-mailbox-server-role-requirements-calculators&text=The Exchange 2007 and Exchange 2010 Mailbox Server Role Requirements Calculators have recently been updated. If you use either of these t...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-06-09T10:50:54-05:00" itemprop="datePublished">9 Jun, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/06/exchange-humor-epic-awesomeness">Exchange Humor.. Epic Awesomeness!</a></h2>
    </header>

    <div class="post-content">
        <p>I was looking around the attachments section of the MS Exchange Team blog earlier trying to find an older version of the Exchange 2010 Mailbox Server Role Requirements Calculator when I came across &ldquo;E2010+MBX+Role+Calc+Spoof.xlsx&rdquo; I was curious to see what it was so I downloaded it.. lets just say it was not the version I was looking for, but it made me laugh..</p>
<p><img style="border-bottom: 0px; border-left: 0px; display: block; float: none; margin-left: auto; border-top: 0px; margin-right: auto; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2010/06/image_thumb.png" width="504" height="310" /></p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2010/06/image.png"><img style="border-bottom: 0px; border-left: 0px; display: block; float: none; margin-left: auto; border-top: 0px; margin-right: auto; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2010/06/image_thumb1.png" width="504" height="312" /></a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange Humor.. Epic Awesomeness!&p[summary]=I was looking around the attachments section of the MS Exchange Team blog earlier trying to find an older version of the Exchange 2010 Ma...&p[url]=http://172.16.7.177:4000/2010/06/exchange-humor-epic-awesomeness" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/06/exchange-humor-epic-awesomeness&text=I was looking around the attachments section of the MS Exchange Team blog earlier trying to find an older version of the Exchange 2010 Ma...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-06-09T08:43:44-05:00" itemprop="datePublished">9 Jun, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/06/exchange-2010-sp1-beta-now-available">Exchange 2010 SP1 beta now available!</a></h2>
    </header>

    <div class="post-content">
        <p>I <a href="http://www.cgoosen.com/2010/04/first-look-at-exchange-2010-sp1/" target="_blank">recently posted</a> about the new features that will be available in Exchange 2010 Service Pack 1 (SP1). Microsoft have announce the availability of Exchange Server 2010 SP1 Beta. This could be very useful for those currently planning their deployment and looking to have a test some of the new features.</p>
<p>The SP1 beta is available to the public and can be <a href="http://go.microsoft.com/fwlink/?linkid=193120" target="_blank">downloaded here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2010 SP1 beta now available!&p[summary]=I recently posted about the new features that will be available in Exchange 2010 Service Pack 1 (SP1). Microsoft have announce the availa...&p[url]=http://172.16.7.177:4000/2010/06/exchange-2010-sp1-beta-now-available" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/06/exchange-2010-sp1-beta-now-available&text=I recently posted about the new features that will be available in Exchange 2010 Service Pack 1 (SP1). Microsoft have announce the availa...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-06-02T08:00:00-05:00" itemprop="datePublished">2 Jun, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/06/securing-exchange-2010-with-forefront-threat-management-gateway-tmg-2010-part-6-publishing-outlook-web-app">Securing Exchange 2010 with Forefront Threat Management Gateway (TMG) 2010, Part 6 - Publishing Outlook Web App</a></h2>
    </header>

    <div class="post-content">
        <p>In the first 5 parts of this series, I went through all the steps required to successfully install Forefront Protection 2010 for Exchange Server and Forefront Threat Management Gateway (TMG) 2010 on the same server as your Exchange Server Edge Transport role. I also looked at some basic configuration so we should now be able to send and receive email.</p>
<p>What about external access? TMG 2010 can also securely publish all your Exchange Server related services such as Outlook Web App (OWA), Outlook Anywhere and ActiveSync (EAS).</p>
<p>In this final part of the series I&rsquo;ll look at publishing OWA to the internet. While my focus is mainly on OWA, Outlook Anywhere and EAS should also work after very little or no additional configuration. I&rsquo;ll start by creating a new certificate request and then submitting it to certificate authority and then install the issued certificate. I&rsquo;ll then go over how to correctly export the issued certificate and import it on the TMG server. I&rsquo;ll then conclude the series by creating a new &ldquo;Exchange Web Client Access Publishing Rule&rdquo;.</p>
<p>A few notes before I begin.. When working with certificates, there are two options, I have opted to use my own Enterprise Root CA which has been installed on my domain controller. You are of course welcome to purchase a certificate from a third-party CA, if you decide that this is a better option for you, the basic configuration steps below will not differ all that much, the only difference will be in how you submit the request to the CA. I highly recommend purchasing a UC Certificate for this, please see the following <a href="http://support.microsoft.com/kb/929395" target="_blank">Microsoft TechNet</a> article for more information.</p>
<p>This post also assumes that your domain controllers already accept LDAP connections over SSL. To enable this, you need to install a server certificate on each of your domain controllers. The following <a href="http://support.microsoft.com/kb/321051" target="_blank">Microsoft TechNet</a> article may provide some guidance if you need further assistance with this.</p>
<p>The first step is to confirm out OWA configuration, this is done by opening the Exchange Management Console, expand &ldquo;Server Configuration&rdquo;, click &ldquo;Client Access&rdquo; and then right-click &ldquo;owa (Default Web Site)&rdquo; and select &ldquo;Properties&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image37.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image3_thumb.png" border="0" alt="image" width="504" height="584" /></a></p>
<p>It is also important to change the authentication settings by clicking on the &ldquo;Authentication&rdquo; tab. We need to disable forms based authentication as TMG will be providing this feature. If you keep Exchange forms based authentication enabled your users will be prompted to log into OWA twice.</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image61.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image6_thumb1.png" border="0" alt="image" width="504" height="581" /></a></p>
<p>We now need to create a certificate request for the certificate that will be used to OWA. This can of course be done from the Exchange Management Shell by making use of the <em>New-ExchangeCertifate </em>cmdlet or by making use of the new wizard included in the Exchange Management Console. To access the wizard, click &ldquo;Server Configuration&rdquo;, select your CAS server and click &ldquo;New Exchange Certificate&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image91.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image9_thumb.png" border="0" alt="image" width="204" height="215" /></a></p>
<p>&ldquo;Enter a friendly name for the certificate&rdquo;, I usually use the external FQDN here. Click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image121.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image12_thumb1.png" border="0" alt="image" width="504" height="442" /></a></p>
<p>If you are using a wildcard certificate, you can enter the root domain name here, I have elected not to use a wildcard certificate. Click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image151.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image15_thumb1.png" border="0" alt="image" width="504" height="437" /></a></p>
<p>Next, select your required configuration. Enter your configuration and click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image181.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image18_thumb1.png" border="0" alt="image" width="504" height="442" /></a></p>
<p>Review your certificate domains, I usually enter the server name without a suffix as well, but this is not necessarily required. Ensure that you have your internal, external and both autodiscover names listed and click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image211.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image21_thumb.png" border="0" alt="image" width="504" height="442" /></a></p>
<p>Enter your organization and location details and click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image241.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image24_thumb1.png" border="0" alt="image" width="504" height="439" /></a></p>
<p>Review your certificate configuration summary and click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image272.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image27_thumb2.png" border="0" alt="image" width="504" height="439" /></a></p>
<p>Once complete, click &ldquo;Finish&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image301.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image30_thumb1.png" border="0" alt="image" width="504" height="439" /></a></p>
<p>For those looking to use the Exchange Management Shell to complete this request, the command would look something like this:</p>
<p><em>New-ExchangeCertificate -FriendlyName 'dogfood.cgoosen.com' &ndash;GenerateRequest -PrivateKeyExportable $true -KeySize '2048' -SubjectName 'C=AU,S="NSW",L="Sydney",O="cgoosen.com",OU="test lab",CN=dogfood.cgoosen.com' &ndash;DomainName 'tlex01.testlab.local','dogfood.cgoosen.com','autodiscover.testlab.local','autodiscover.dogfood.cgoosen.com','tlex01' -Server 'TLEX01'</em></p>
<p>Now that we have completed out certificate request, it is time to submit this request to a CA. I&rsquo;ll be using my Enterprise Root CA which is installed on my domain controller, so I&rsquo;ll just submit the request opening <a href="https://tldc01.testlab.local/CertSrv">https://tldc01.testlab.local/CertSrv</a> Click &ldquo;Request a certificate&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image40.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image_thumb15.png" border="0" alt="image" width="504" height="237" /></a></p>
<p>Then click on &ldquo;advanced certificate request&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image333.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image33_thumb3.png" border="0" alt="image" width="504" height="229" /></a></p>
<p>Since we have already created the certificate request, select &ldquo;Submit a certificate request by using a base-64-encoded CMC or PKCS#10 file, or submit a renewal request by using a base-64-encoded PKCS#7 file&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image362.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image36_thumb2.png" border="0" alt="image" width="504" height="112" /></a></p>
<p>Paste the certificate request in the box provided, select the &ldquo;Web Server&rdquo; template and click &ldquo;Submit&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image391.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image39_thumb1.png" border="0" alt="image" width="504" height="279" /></a></p>
<p>Click &ldquo;Yes&rdquo; to acknowledge the &ldquo;Web Access Confirmation&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image42.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image42_thumb.png" border="0" alt="image" width="354" height="205" /></a></p>
<p>Next download only the &ldquo;DER encoded&rdquo; certificate.</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image451.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image45_thumb1.png" border="0" alt="image" width="354" height="172" /></a></p>
<p>Now that we have our new certificate, it&rsquo;s time to install it. Once again, click &ldquo;Server Configuration&rdquo; and select your new certificate. Click &ldquo;Complete Pending Request&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image511.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image51_thumb1.png" border="0" alt="image" width="504" height="96" /></a></p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image481.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image48_thumb1.png" border="0" alt="image" width="204" height="109" /></a></p>
<p>Select your new certificate and click &ldquo;Complete&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image541.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image54_thumb1.png" border="0" alt="image" width="504" height="444" /></a></p>
<p>Once completed, click &ldquo;Finish&rdquo;. You have now installed your new certificate.</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image571.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image57_thumb1.png" border="0" alt="image" width="504" height="439" /></a></p>
<p>We now need to assign services to the certificate, click &ldquo;Server Configuration&rdquo; and select your new certificate. Click &ldquo;Assign Services to Certificate&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image60.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image60_thumb.png" border="0" alt="image" width="204" height="164" /></a></p>
<p>Select your CAS server and click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image631.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image63_thumb1.png" border="0" alt="image" width="504" height="439" /></a></p>
<p>Ensure that you have selected &ldquo;Internet Information Services&rdquo; and click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image661.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image66_thumb1.png" border="0" alt="image" width="504" height="442" /></a></p>
<p>Review the configuration summary and click &ldquo;Assign&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image691.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image69_thumb1.png" border="0" alt="image" width="504" height="442" /></a></p>
<p>Once completed, click &ldquo;Finish&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image72.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image72_thumb.png" border="0" alt="image" width="504" height="442" /></a></p>
<p>Now that we&rsquo;ve installed the new certificate and assigned services to it, lets give it a quick test internally. My internal URL is <a href="https://tlex01.testlab.local/owa">https://tlex01.testlab.local/owa</a></p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image751.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image75_thumb1.png" border="0" alt="image" width="504" height="206" /></a></p>
<p>Before we can import the certificate on the TMG server, you need to export the certificate along with its private key from the CAS server. Open the &ldquo;Certificates&rdquo; MMC and make sure you are viewing the &ldquo;Local Computer&rdquo;. We need to export 2 certificates. The first is the Enterprise Root CA certificate located in the &ldquo;Trusted Root Certificate Authorities&rdquo; store.</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image781.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image78_thumb1.png" border="0" alt="image" width="504" height="152" /></a></p>
<p>The second certificate is the new exchange certificate we just installed, it should be located in the &ldquo;Personal&rdquo; store.</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image811.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image81_thumb1.png" border="0" alt="image" width="504" height="146" /></a></p>
<p>Lets start with the Enterprise Root CA certificate, right-click the certificate and click &ldquo;Export&rdquo;. Click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image84.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image84_thumb.png" border="0" alt="image" width="504" height="454" /></a></p>
<p>Select &ldquo;DER encoded binary X.509 (.CER)&rdquo; and click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image87.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image87_thumb.png" border="0" alt="image" width="504" height="456" /></a></p>
<p>Give it a meaningful and name be sure to note down the location and click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image901.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image90_thumb1.png" border="0" alt="image" width="504" height="454" /></a></p>
<p>Review the settings and click &ldquo;Finish&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image931.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image93_thumb1.png" border="0" alt="image" width="504" height="454" /></a></p>
<p>Once completed successfully, click &ldquo;Ok&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image96.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image96_thumb.png" border="0" alt="image" width="204" height="141" /></a></p>
<p>Next we export the exchange certificate along with its private key. right-click the certificate and click &ldquo;Export&rdquo;. Click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image841.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image84_thumb1.png" border="0" alt="image" width="504" height="454" /></a></p>
<p>Ensure that you have selected &ldquo;Yes, export the private key&rdquo; and click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image99.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image99_thumb.png" border="0" alt="image" width="504" height="454" /></a></p>
<p>Ensure that you have selected &ldquo;Export all extended properties&rdquo; and click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image105.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image105_thumb.png" border="0" alt="image" width="504" height="456" /></a></p>
<p>You need to protect the private key by using a password, be sure to remember what password you enter here and click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image108.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image108_thumb.png" border="0" alt="image" width="504" height="454" /></a></p>
<p>Give it a meaningful and name be sure to note down the location and click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image111.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image111_thumb.png" border="0" alt="image" width="504" height="458" /></a></p>
<p>Review the settings and click &ldquo;Finish&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image114.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image114_thumb.png" border="0" alt="image" width="504" height="454" /></a></p>
<p>Once completed successfully, click &ldquo;Ok&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image961.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image96_thumb1.png" border="0" alt="image" width="204" height="141" /></a></p>
<p>Once you have those 2 certificates, (ca_cert.cer and cas_cert.pfx if you followed my naming convention) copy them to your TMG server. The log onto the TMG server and open the &ldquo;Certificates&rdquo; MMC and make sure you are viewing the &ldquo;Local Computer&rdquo;. We now repeat the previous process in reverse.</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image117.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image117_thumb.png" border="0" alt="image" width="504" height="135" /></a></p>
<p>First we import the Enterprise Root CA certificate, expand the &ldquo;Trusted Root Certificate Authorities&rdquo; store, right-click &ldquo;Certificates&rdquo; and select &ldquo;Import&rdquo;. Click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image120.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image120_thumb.png" border="0" alt="image" width="504" height="454" /></a></p>
<p>Locate the certificate and click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image123.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image123_thumb.png" border="0" alt="image" width="504" height="454" /></a></p>
<p>You will notice that it will already have the correct location specified, do not change this, just click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image126.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image126_thumb.png" border="0" alt="image" width="504" height="456" /></a></p>
<p>Review the settings and click &ldquo;Finish&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image129.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image129_thumb.png" border="0" alt="image" width="504" height="456" /></a></p>
<p>Once completed successfully, click &ldquo;Ok&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image132.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image132_thumb.png" border="0" alt="image" width="204" height="133" /></a></p>
<p>We then import the exchange certificate. Expand the &ldquo;Personal&rdquo; store right-click &ldquo;Certificates&rdquo; and select &ldquo;Import&rdquo;. Click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image1201.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image120_thumb1.png" border="0" alt="image" width="504" height="454" /></a></p>
<p>Locate the certificate and click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image135.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image135_thumb.png" border="0" alt="image" width="504" height="456" /></a></p>
<p>Enter the private key password (you do remember it, right?) Ensure that you have selected &ldquo;Include all extended properties&rdquo; and click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image138.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image138_thumb.png" border="0" alt="image" width="504" height="454" /></a></p>
<p>The correct location should already be specified, do not change this, just click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image141.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image141_thumb.png" border="0" alt="image" width="504" height="454" /></a></p>
<p>Review the settings and click &ldquo;Finish&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image144.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image144_thumb.png" border="0" alt="image" width="504" height="454" /></a></p>
<p>Once completed successfully, click &ldquo;Ok&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image1321.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image132_thumb1.png" border="0" alt="image" width="204" height="133" /></a></p>
<p>Once this is done, should should be able to double-click the exchange certificate and check the status. Both certificates should be &ldquo;Ok&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image147.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image147_thumb.png" border="0" alt="image" width="354" height="435" /></a></p>
<p>The final step in the process is to create a &ldquo;Exchange Web Client Access Publishing Rule&rdquo;. Open the TMG Management Console, right-click &ldquo;Firewall Policy&rdquo;, select &ldquo;New&rdquo; and then select &ldquo;Exchange Web Client Access Publishing Rule&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image150.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image150_thumb.png" border="0" alt="image" width="504" height="256" /></a></p>
<p>Give your rule a meaningful name and click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image153.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image153_thumb.png" border="0" alt="image" width="504" height="475" /></a></p>
<p>Select your Exchange version and select &ldquo;Outlook Web Access&rdquo;, then click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image156.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image156_thumb.png" border="0" alt="image" width="504" height="475" /></a></p>
<p>Select your publishing type and then click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image159.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image159_thumb.png" border="0" alt="image" width="504" height="475" /></a></p>
<p>Since we will be using SSL, select that option and click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image162.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image162_thumb.png" border="0" alt="image" width="504" height="477" /></a></p>
<p>Enter your internal site name, only enter the FQDN, there is no need to add HTTP/S or /OWA. Click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image165.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image165_thumb.png" border="0" alt="image" width="504" height="475" /></a></p>
<p>Enter your public name here, again only the FQDN. Click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image168.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image168_thumb.png" border="0" alt="image" width="504" height="475" /></a></p>
<p>Select your web listener, since I don&rsquo;t already have one, I am going to create a new one by clicking &ldquo;New&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image171.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image171_thumb.png" border="0" alt="image" width="504" height="475" /></a></p>
<p>Enter a meaningful name and click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image174.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image174_thumb.png" border="0" alt="image" width="504" height="473" /></a></p>
<p>We will be using SSL and want to require SSL connections from all clients. Click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image177.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image177_thumb.png" border="0" alt="image" width="504" height="475" /></a></p>
<p>Select your listener IP address, this should be your external network address. Click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image180.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image180_thumb.png" border="0" alt="image" width="504" height="475" /></a></p>
<p>Click &ldquo;Select Certificate&rdquo; and then select the exchange certificate we installed in the previously. Click &ldquo;Select&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image183.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image183_thumb.png" border="0" alt="image" width="504" height="429" /></a></p>
<p>Click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image186.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image186_thumb.png" border="0" alt="image" width="504" height="474" /></a></p>
<p>Next we look at authentication settings, since our server is not a part of the domain, we are unable to use &ldquo;Windows&rdquo; authentication. Make sure &ldquo;HTML Form Authentication&rdquo; is selected, select &ldquo;LDAP (Active Directory)&rdquo; and click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image189.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image189_thumb.png" border="0" alt="image" width="504" height="475" /></a></p>
<p>I won&rsquo;t be making use of SSO, make your selection and click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image192.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image192_thumb.png" border="0" alt="image" width="504" height="473" /></a></p>
<p>We need to add at least one LDAP server for user authentication, add your domain controllers here, type your domain name and I highly recommend that you make use of LDAP over SSL. Click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image198.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image198_thumb.png" border="0" alt="image" width="504" height="473" /></a></p>
<p>Review your web listener configuration and click &ldquo;Finish&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image195.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image195_thumb.png" border="0" alt="image" width="504" height="477" /></a></p>
<p>Select the web listener you just created and click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image201.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image201_thumb.png" border="0" alt="image" width="504" height="473" /></a></p>
<p>Select &ldquo;Basic Authentication&rdquo; and then click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image204.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image204_thumb.png" border="0" alt="image" width="504" height="474" /></a></p>
<p>This rule will apply to &ldquo;All Authenticated Users&rdquo;, click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image207.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image207_thumb.png" border="0" alt="image" width="504" height="475" /></a></p>
<p>Review your configuration and then click &ldquo;Finish&rdquo; to create the rule.</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image210.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image210_thumb.png" border="0" alt="image" width="504" height="475" /></a></p>
<p>Once the rule has been created, we need to apply it to TMG, click &ldquo;Apply&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image213.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image213_thumb.png" border="0" alt="image" width="504" height="123" /></a></p>
<p>You should now see your rule listed..</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image216.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image216_thumb.png" border="0" alt="image" width="504" height="108" /></a></p>
<p>Now for the fun part, lets test our configuration. If you visit your external URL, mine is <a href="https://dogfood.cgoosen.com/owa">https://dogfood.cgoosen.com/owa</a> you should be presented with a OWA login form. Notice the &ldquo;Secured by Microsoft Forefront Threat Management Gateway&rdquo; banner at the bottom.</p>
<p>Enter your user name in the format &ldquo;Domain\user name&rdquo; and your password and click &ldquo;Log On&rdquo; If you have any certificate alerts, you may need to install your Root CA certificate to the &ldquo;Trusted Root Certification Authorities&rdquo; store on your workstation. If you are using an Enterprise Root CA, it uses Group Policy to propagate its certificate to the &ldquo;Trusted Root Certification Authorities&rdquo; store for all users and computers in the domain.</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image219.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image219_thumb.png" border="0" alt="image" width="504" height="466" /></a></p>
<p>If everything has been correctly configured, you should be presented with your inbox.</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image2221.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image222_thumb.png" border="0" alt="image" width="504" height="145" /></a></p>
<p>To summarise, in this final part of the series I created a new certificate request and then submitted it to certificate authority. Once I had downloaded the issued certificate, I installed it on my exchange CAS server and assigned services to it. I then exported the issued certificate and imported it on the TMG server. To complete the process, I created a new &ldquo;Exchange Web Client Access Publishing Rule&rdquo;.</p>
<p>In this 6 part series, I went through the process of installing Exchange Server Edge, Forefront Protection 2010 for Exchange Server and TMG 2010 on the same server. Consolidating these services greatly reduces management complexity and overhead.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Securing Exchange 2010 with Forefront Threat Management Gateway (TMG) 2010, Part 6 - Publishing Outlook Web App&p[summary]=In the first 5 parts of this series, I went through all the steps required to successfully install Forefront Protection 2010 for Exchange...&p[url]=http://172.16.7.177:4000/2010/06/securing-exchange-2010-with-forefront-threat-management-gateway-tmg-2010-part-6-publishing-outlook-web-app" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/06/securing-exchange-2010-with-forefront-threat-management-gateway-tmg-2010-part-6-publishing-outlook-web-app&text=In the first 5 parts of this series, I went through all the steps required to successfully install Forefront Protection 2010 for Exchange...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-06-01T01:45:00-05:00" itemprop="datePublished">1 Jun, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/06/securing-exchange-2010-with-forefront-threat-management-gateway-tmg-2010-part-5-putting-it-all-together">Securing Exchange 2010 with Forefront Threat Management Gateway (TMG) 2010, Part 5 - Putting it all together</a></h2>
    </header>

    <div class="post-content">
        <p>We finally have our consolidated Exchange Server Edge and TMG 2010 server installed, but what now? How do we take advantage of all the great new features? In this part of the series, I&rsquo;ll configure our E-Mail Policy, create a new Edge Subscription and then configure Antivirus and File Filters</p>
<p>Firstly, we&rsquo;ll configure our E-Mail Policy. If you open the TMG Management Console, select &ldquo;E-Mail Policy&rdquo; and then select &ldquo;Configure E-Mail Policy&rdquo; from the tasks pane.</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image5.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image_thumb4.png" border="0" alt="image" width="504" height="200" /></a></p>
<p>On the &ldquo;Welcome to the E-Mail Policy Wizard&rdquo; screen, click &ldquo;Next&rdquo; to continue</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image41.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image4_thumb.png" border="0" alt="image" width="504" height="444" /></a></p>
<p>On the &ldquo;Internal Mail Server Configuration&rdquo; screen, add all the Exchange hub servers that you want to forward incoming mail to. You also need to add your accepted domains. Then click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image711.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image711_thumb.png" border="0" alt="image" width="504" height="446" /></a></p>
<p>For the &ldquo;Internal E-Mail Listener&rdquo; choose the Internal network. You can also specify which IP to listen on if multiple IPs are available. Click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image10.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image10_thumb.png" border="0" alt="image" width="504" height="444" /></a></p>
<p>For the &ldquo;External E-Mail Listener&rdquo; choose to listen on the External network and specify the FQDN that will be presented in HELO and EHLO commands.</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image13111.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image13111_thumb.png" border="0" alt="image" width="504" height="444" /></a></p>
<p>Enable spam filtering, virus and content filtering. You also have the option to enable EdgeSync Traffic, you should enable this here as it will create the relevant System Policy to allow port 50636 for communication with the Exchange hub transport server.</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image16.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image16_thumb.png" border="0" alt="image" width="504" height="444" /></a></p>
<p>Click &ldquo;Finish&rdquo; to complete the e-mail policy wizard</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image19.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image19_thumb.png" border="0" alt="image" width="504" height="444" /></a></p>
<p>TMG will prompt you to create a System Policy, click &ldquo;Yes&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image2211.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image2211_thumb.png" border="0" alt="image" width="354" height="164" /></a></p>
<p>Once done, click &ldquo;Apply&rdquo; to apply the new E-Mail Policy</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image251.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image251_thumb.png" border="0" alt="image" width="504" height="123" /></a></p>
<p>Next, we setup a new edge subscription, From the TMG Management console, navigate to &ldquo;E-Mail Policy&rdquo; and in the &ldquo;Tasks&rdquo; plane, click &ldquo;Generate Edge Subscription Files&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image281.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image281_thumb.png" border="0" alt="image" width="504" height="239" /></a></p>
<p>Make a note of where you save this file. Once complete, copy the edge subscription file to your Hub Transport server.</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image3111.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image3111_thumb.png" border="0" alt="image" width="354" height="126" /></a></p>
<p>Log on to your Hub Transport server and open the Exchange Management Console, then expand &ldquo;Organization Configuration&rdquo; and click on &ldquo;Hub Transport&rdquo;. Click &ldquo;New Edge Subscription under the &ldquo;Actions&rdquo; menu.</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image341.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image341_thumb.png" border="0" alt="image" width="504" height="210" /></a></p>
<p>Select the appropriate AD site and locate the edge subscription file copied from your TMG server. Click &ldquo;New&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image371.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image371_thumb.png" border="0" alt="image" width="504" height="439" /></a></p>
<p>Once the wizard completes successfully, click &ldquo;Finish&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image401.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image401_thumb.png" border="0" alt="image" width="504" height="439" /></a></p>
<p>Expand &ldquo;Organization Configuration&rdquo;, click on &ldquo;Hub Transport&rdquo; and select the &ldquo;Edge Subscriptions&rdquo; tab. You should now see your edge subscription listed there.</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image46.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image46_thumb.png" border="0" alt="image" width="504" height="108" /></a></p>
<p>On your Hub Transport server, ensure that the &ldquo;Microsoft Exchange EdgeSync&rdquo; service is set to automatically start.</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image131.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image13_thumb1.png" border="0" alt="image" width="504" height="567" /></a></p>
<p>On the Hub Transport server, open the Exchange Management Shell and start edge synchronization by issuing the following cmdlet</p>
<p><em>Start-EdgeSynchronization</em></p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image11.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image11_thumb.png" border="0" alt="image" width="504" height="331" /></a></p>
<p>After a few minutes, you should be able to verify that your edge synchronization is working by opening the &ldquo;Exchange Management Shell&rdquo; and issuing the following cmdlet:</p>
<p><em>Get-SendConnector</em></p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image71.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image71_thumb.png" border="0" alt="image" width="504" height="144" /></a></p>
<p>Next, We need to verify the authentication settings on the Receive Connectors.</p>
<p>On the Hub Transport server, open the Exchange Management Console and expand to "Server Configuration", click on "Hub Transport", right click on the "Default Receive Connector" and select Properties. On the Authentication tab, verify that TLS and Exchange Server authentication are selected.</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image1611.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image1611_thumb.png" border="0" alt="image" width="504" height="565" /></a></p>
<p>On the TMG server, open the TMG Management console and navigate to "E-Mail Policy", right click on the "Internal_Mail_Servers" route and select Properties. On the Listener tab, click "Authentication Settings" and verify that only TLS and Exchange Server Authentication are selected.</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image191.png"><img class="aligncenter" style="display: inline; border: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image191_thumb.png" border="0" alt="image" width="354" height="255" /></a></p>
<p>Lastly, we can configure Antivirus scanning and file filtering settings. In this example I will enable a 3 antivirus engines and configure file filtering to block .EXE files.</p>
<p>On the TMG server, open the TMG Management console, click &ldquo;E-Mail Policy, then select the &ldquo;Virus and Content Filtering&rdquo; tab,</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image8.png"><img class="aligncenter" style="display: inline; border: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image_thumb5.png" border="0" alt="image" width="504" height="196" /></a></p>
<p>Click &ldquo;Select AV Engines&rdquo; on the Tasks Pane. Select one or more engines from the list. The click &ldquo;OK&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image222.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image22_thumb2.png" border="0" alt="image" width="504" height="560" /></a></p>
<p>Next, click the &ldquo;Enabled&rdquo; link below &ldquo;File Filtering&rdquo;. On the File Filters&rdquo; tab, click &ldquo;Add&rdquo; and then on the General tab give it a meaningful name. You can apply the filter to inbound and/or outbound messages.</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image25.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image25_thumb.png" border="0" alt="image" width="504" height="560" /></a></p>
<p>On the File Types tab select Microsoft Windows Executable. Click &ldquo;Apply&rdquo;</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image28.png"><img style="display: block; float: none; margin-left: auto; margin-right: auto; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image28_thumb.png" border="0" alt="image" width="504" height="560" /></a></p>
<p>Confirm that the filter has been added and click &ldquo;OK&rdquo;</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image9.png"></a></p>
<p><a href="file:///D:/Users/T812609/AppData/Local/Temp/WindowsLiveWriter-429641856/supfiles179D955/image121.png"></a></p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image14.png"><img class="aligncenter" style="display: inline; border: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image_thumb6.png" border="0" alt="image" width="504" height="554" /></a></p>
<p>Once done, click &ldquo;Apply&rdquo; to apply the settings</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image251.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image251_thumb.png" border="0" alt="image" width="504" height="123" /></a></p>
<p>To summarise, in this part of the series I configured my E-Mail Policy/ I then created and verified a new Edge Subscription. I finished off by configuring Antivirus and creating a File Filter to block .EXE files.</p>
<p>In the next and final part of this series, I&rsquo;ll look at how to securely publish Outlook Web App.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Securing Exchange 2010 with Forefront Threat Management Gateway (TMG) 2010, Part 5 - Putting it all together&p[summary]=We finally have our consolidated Exchange Server Edge and TMG 2010 server installed, but what now? How do we take advantage of all the gr...&p[url]=http://172.16.7.177:4000/2010/06/securing-exchange-2010-with-forefront-threat-management-gateway-tmg-2010-part-5-putting-it-all-together" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/06/securing-exchange-2010-with-forefront-threat-management-gateway-tmg-2010-part-5-putting-it-all-together&text=We finally have our consolidated Exchange Server Edge and TMG 2010 server installed, but what now? How do we take advantage of all the gr...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-05-28T03:48:00-05:00" itemprop="datePublished">28 May, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/05/securing-exchange-2010-with-forefront-threat-management-gateway-tmg-2010-part-4-installing-forefront-threat-management-gateway">Securing Exchange 2010 with Forefront Threat Management Gateway (TMG) 2010, Part 4 - Installing Forefront Threat Management Gateway</a></h2>
    </header>

    <div class="post-content">
        <p>Here we are, Part 4 of the series. To recap what I have done thus far.. I&rsquo;ve installed the Exchange Server Edge role followed by Forefront Protection 2010 for Exchange Server.</p>
<p>In this part I install TMG 2010 and perform some basic configuration. The minimum system requirements for TMG 2010 can be found on <a href="http://technet.microsoft.com/en-us/library/dd896981.aspx" target="_blank">Microsoft TechNet</a>.</p>
<p>To get started, insert your Forefront Threat Management Gateway 2010 installation media and then select &ldquo;Run Preparation Tool&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image4.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image_thumb3.png" border="0" alt="image" width="504" height="358" /></a></p>
<p>This launches the &ldquo;Forefront TMG Preparation Tool&rdquo;, read through the notes on the welcome screen and click &ldquo;Next&rdquo;. Read and accept the License Agreement and click &ldquo;Next&rdquo;</p>
<p>Depending on your environment, select the appropriate Installation Type. I won&rsquo;t be installing a TMG array so I selected &ldquo;Forefront TMG services and Management&rdquo;. Then click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image12.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image12_thumb.png" border="0" alt="image" width="504" height="352" /></a></p>
<p>Once all the prerequisite features have been installed, click &ldquo;Finish&rdquo; to launch the TMG 2010 installation wizard.</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image15.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image15_thumb.png" border="0" alt="image" width="504" height="352" /></a></p>
<p>Click &ldquo;Next&rdquo; on the welcome screen. Read and accept the License Agreement and click &ldquo;Next&rdquo;</p>
<p>Next you will be presented with the &ldquo;Customer Information&rdquo; page with the Product Serial Number. Once you have entered the appropriate details, click &ldquo;Next&rdquo; and verify the installation path. Change this as appropriate and click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image24.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image24_thumb.png" border="0" alt="image" width="504" height="379" /></a></p>
<p>Next we need to define our internal network ranges. Be sure to include all of them there, mine are fairly simple and are all included in the range 172.0.0.0-172.0.0.255.</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image271.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image27_thumb1.png" border="0" alt="image" width="504" height="376" /></a></p>
<p>During the installation, some services will be restarted. Acknowledge this warning by clicking &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image30.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image30_thumb.png" border="0" alt="image" width="504" height="379" /></a></p>
<p>Click &ldquo;Install&rdquo; to begin the installation.</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image332.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image33_thumb2.png" border="0" alt="image" width="504" height="379" /></a></p>
<p>Once the installation has completed successfully, click &ldquo;Finish&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image361.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image36_thumb1.png" border="0" alt="image" width="504" height="383" /></a></p>
<p>Congratulations, you now have TMG 2010 installed. Lets look at some basic configuration. The first time you launch the TMG Management Console, you&rsquo;ll be presented with the &ldquo;Getting Started Wizard&rdquo; The first step is to &ldquo;Configure network settings&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image39.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image39_thumb.png" border="0" alt="image" width="504" height="452" /></a></p>
<p>Click &ldquo;Next&rdquo; to continue and then select the appropriate network template, you&rsquo;ll want to select &ldquo;Edge Firewall&rdquo; here. It should be noted that the &ldquo;Single network adaptor&rdquo; template has many limitations and will not work in our scenario. <a href="http://technet.microsoft.com/en-us/library/cc995236.aspx" target="_blank">Click here to read more about single network adapter limitations</a>. Click &ldquo;Next&rdquo; to continue</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image45.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image45_thumb.png" border="0" alt="image" width="504" height="437" /></a></p>
<p>Ensure that your LAN or &ldquo;Internal&rdquo; network settings are configured correctly and click &ldquo;Next&rdquo; *note the absence of a &ldquo;Default Gateway&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image48.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image48_thumb.png" border="0" alt="image" width="504" height="440" /></a></p>
<p>Then, ensure that your Internet or &ldquo;External&rdquo; network settings are configured correctly and click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image51.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image51_thumb.png" border="0" alt="image" width="504" height="443" /></a></p>
<p>Click &ldquo;Finish&rdquo; to complete the network setup wizard.</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image54.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image54_thumb.png" border="0" alt="image" width="504" height="440" /></a></p>
<p>The next step is to &ldquo;Configure system settings&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image57.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image57_thumb.png" border="0" alt="image" width="504" height="452" /></a></p>
<p>Click &ldquo;Next&rdquo; to continue and then confirm the &ldquo;Host Identification&rdquo; settings, note once again that this server is a member of a workgroup and is not part of the domain. Click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image63.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image63_thumb.png" border="0" alt="image" width="504" height="439" /></a></p>
<p>Click &ldquo;Finish&rdquo; to complete the system configuration wizard</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image66.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image66_thumb.png" border="0" alt="image" width="504" height="438" /></a></p>
<p>The final step is to &ldquo;Define deployment options&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image69.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image69_thumb.png" border="0" alt="image" width="504" height="454" /></a></p>
<p>Click &ldquo;Next&rdquo; to continue and on the &ldquo;Microsoft Update Setup&rdquo; screen, select the appropriate setting and click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image75.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image75_thumb.png" border="0" alt="image" width="504" height="443" /></a></p>
<p>Activate the relevant licenses and features and click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image78.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image78_thumb.png" border="0" alt="image" width="504" height="443" /></a></p>
<p>On the &ldquo;NIS Signature Update Settings&rdquo; screen, select the appropriate setting and click &ldquo;Next&rdquo; if in doubt, just leave the defaults</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image81.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image81_thumb.png" border="0" alt="image" width="504" height="442" /></a></p>
<p>Would you like to join the &ldquo;Customer Experience Improvement Program&rdquo;? make your selection and click &ldquo;Next&rdquo; and then decide if you would like to participate in the &ldquo;Microsoft Telemetry Reporting Service&rdquo;, make your selection and click &ldquo;Next&rdquo;</p>
<p>Click &ldquo;Finish&rdquo; to complete the deployment wizard</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image90.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image90_thumb.png" border="0" alt="image" width="504" height="441" /></a></p>
<p>You have now completed the &ldquo;Getting Started Wizard&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image93.png"><img class="aligncenter" style="display: inline; border-width: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image93_thumb.png" border="0" alt="image" width="504" height="454" /></a></p>
<p>To summarise, in this part of the series I installed TMG 2010 and then proceeded to perform some basic configuration. In the next part of the series, I&rsquo;ll configure our email policy and create a new Edge Subscription</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Securing Exchange 2010 with Forefront Threat Management Gateway (TMG) 2010, Part 4 - Installing Forefront Threat Management Gateway&p[summary]=Here we are, Part 4 of the series. To recap what I have done thus far.. I&rsquo;ve installed the Exchange Server Edge role followed by Fo...&p[url]=http://172.16.7.177:4000/2010/05/securing-exchange-2010-with-forefront-threat-management-gateway-tmg-2010-part-4-installing-forefront-threat-management-gateway" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/05/securing-exchange-2010-with-forefront-threat-management-gateway-tmg-2010-part-4-installing-forefront-threat-management-gateway&text=Here we are, Part 4 of the series. To recap what I have done thus far.. I&rsquo;ve installed the Exchange Server Edge role followed by Fo...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-05-25T13:39:00-05:00" itemprop="datePublished">25 May, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/05/securing-exchange-2010-with-forefront-threat-management-gateway-tmg-2010-part-3-installing-forefront-protection-for-exchange-server">Securing Exchange 2010 with Forefront Threat Management Gateway (TMG) 2010, Part 3 - Installing Forefront Protection for Exchange Server</a></h2>
    </header>

    <div class="post-content">
        <p>Welcome to Part 3! In the pervious part of the series I looked at the process of preparing a Windows Server 2008 R2 server for installation. I then installed the Exchange Server Edge Transport Transport role.</p>
<p>In Part 3 of the series I&rsquo;ll install Forefront Protection 2010 for Exchange Server, the installation is fairly quick and painless so it should not take too long! I recommend checking out the minimum system requirements on <a href="http://technet.microsoft.com/en-au/library/cc482970.aspx" target="_blank">Microsoft TechNet</a>.</p>
<p>To get started, insert your Forefront Threat Management Gateway 2010 installation media and then select &ldquo;Install Microsoft Forefront Protection 2010 for Exchange Server.</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image3.png"><img style="display: block; margin-left: auto; margin-right: auto; border: 0pt none;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image_thumb2.png" border="0" alt="image" width="500" height="359" /></a></p>
<p>The first step is to read and accept the License Agreement and click &ldquo;Next&rdquo;. &ldquo;During the installation, it may be necessary to stop and start the following services..&rdquo; read and accept this message by clicking &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image6.png"><img class="aligncenter" style="display: inline; border: 0pt none;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image6_thumb.png" border="0" alt="image" width="500" height="406" /></a></p>
<p>Select the appropriate installation paths and click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image13.png"><img class="aligncenter" style="display: inline; border: 0pt none;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image13_thumb.png" border="0" alt="image" width="500" height="404" /></a></p>
<p>Enter any proxy server information (if any) and click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image18.png"><img class="aligncenter" style="display: inline; border: 0pt none;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image18_thumb.png" border="0" alt="image" width="500" height="404" /></a></p>
<p>Decide if you would like to enable Antispam now or later, these settings can be changed again once installed. Click &ldquo;Next&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image221.png"><img class="aligncenter" style="display: inline; border: 0pt none;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image22_thumb1.png" border="0" alt="image" width="500" height="404" /></a></p>
<p>Decide if you would like to enable Microsoft Update and click &ldquo;Next&rdquo; *note: I have selected to not enable Microsoft Update at this time, depending on your environment, your selection may or may not be the same. It is always recommended to keep your servers up to date.</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image27.png"><img class="aligncenter" style="display: inline; border: 0pt none;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image27_thumb.png" border="0" alt="image" width="500" height="404" /></a></p>
<p>Would you like to join the &ldquo;Customer Experience Improvement Program?&rdquo; decide and then click &ldquo;Next&rdquo;. Once you have confirmed your settings and click &ldquo;Next&rdquo; to begin the installation</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image331.png"><img class="aligncenter" style="display: inline; border: 0pt none;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image33_thumb1.png" border="0" alt="image" width="500" height="406" /></a></p>
<p>Once the installation has completed successfully, click &ldquo;Finish&rdquo;</p>
<p style="text-align: center;"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image36.png"><img class="aligncenter" style="display: inline; border: 0pt none;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image36_thumb.png" border="0" alt="image" width="500" height="404" /></a></p>
<p>To summarise, in this part of the series I installed Forefront Protection 2010 for Exchange Server on the same server that already has the Exchange Edge Transport role installed from Part 2.</p>
<p>In the next part of the series I&rsquo;ll install Forefront Threat Management Gateway 2010 on the same server.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Securing Exchange 2010 with Forefront Threat Management Gateway (TMG) 2010, Part 3 - Installing Forefront Protection for Exchange Server&p[summary]=Welcome to Part 3! In the pervious part of the series I looked at the process of preparing a Windows Server 2008 R2 server for installati...&p[url]=http://172.16.7.177:4000/2010/05/securing-exchange-2010-with-forefront-threat-management-gateway-tmg-2010-part-3-installing-forefront-protection-for-exchange-server" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/05/securing-exchange-2010-with-forefront-threat-management-gateway-tmg-2010-part-3-installing-forefront-protection-for-exchange-server&text=Welcome to Part 3! In the pervious part of the series I looked at the process of preparing a Windows Server 2008 R2 server for installati...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-05-23T07:22:00-05:00" itemprop="datePublished">23 May, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/05/moving-to-microsoft-exchange-online-is-easy">Moving to Microsoft Exchange Online is easy&hellip;</a></h2>
    </header>

    <div class="post-content">
        <p>I recently decided to move my personal domain (cgoosen.com), to Microsoft Exchange Online and I thought it would be appropriate to share my experience. I had previously been using my web hosting providers mail service and when I starting having some unusual mail delivery problems I took that as a sign to do what I have been meaning to do for some time now.</p>
<p>Microsoft Exchange Online is Microsoft's own hosted enterprise messaging solution based on Microsoft Exchange Server 2007. There are a number of reasons why I chose Exchange Online instead of just going with an Exchange Server based solution from a Microsoft partner, the main reason is that I anticipate this solution will continue to grow in popularity, especially once it is upgraded to Exchange 2010 and more organizations start making use of &ldquo;Hybrid&rdquo; installations.</p>
<p>I live in Australia, which meant that I had to purchase my Exchange Online services from <a href="http://www.telstrabusiness.com/business/portal/online/site/productsservices/tsuiteapplications.11003" target="_blank">Telstra Business</a> instead of going directly to <a href="http://www.microsoft.com/online/exchange-online.mspx" target="_blank">Microsoft</a>. Once I had signed up, I was sent a link to the Microsoft Online admin panel. </p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image20.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image_thumb7.png" width="354" height="229" /></a> </p>
<p>At this point, the only Telstra involvement is that they are billing me around $3.50 US per month more that if I was able to go direct to Microsoft and I personally don&rsquo;t see the value they are adding. Just my opinion!</p>
<p>Once I had signed in, I was presented with a list of &ldquo;Tasks I need To Do&rdquo;</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image21.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image_thumb8.png" width="354" height="170" /></a> </p>
<p>The first step is to &ldquo;Add your domain to Microsoft Online Services&rdquo;. You also need to decided if you would like Exchange Online to be authoritative for your domain or not.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image23.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image_thumb9.png" width="504" height="377" /></a> </p>
<p>As you would expect, you need to validate that you actually own that domain, this is done by creating a DNS CNAME record on your primary DNS server. Mine only took a couple of minutes.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image26.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image_thumb10.png" width="504" height="350" /></a> </p></p></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image31.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image_thumb11.png" width="504" height="221" /></a> </p>
<p align="left">The next step is to enable inbound messaging and change your MX record.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image32.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image_thumb12.png" width="504" height="477" /></a> </p></p>
<p>The final step is to create some user accounts and assign services to them. The services available depend on the licenses you have purchased.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image34.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image_thumb13.png" width="504" height="354" /></a>&#160;</p>
<p>User accounts can be created manually of if you have a large amount of accounts to create, these can be imported from a .CSV file. There are sample and template .CSV files available for download if you are unsure of the format.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image35.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image_thumb14.png" width="504" height="283" /></a>&#160;</p>
<p align="left">The entire process was so simple and I was up and running in less than 30 minutes. I would recommend keeping your existing mailboxes in place for at least 48 hours to allow the new MX record to full replicate.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Moving to Microsoft Exchange Online is easy&hellip;&p[summary]=I recently decided to move my personal domain (cgoosen.com), to Microsoft Exchange Online and I thought it would be appropriate to share ...&p[url]=http://172.16.7.177:4000/2010/05/moving-to-microsoft-exchange-online-is-easy" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/05/moving-to-microsoft-exchange-online-is-easy&text=I recently decided to move my personal domain (cgoosen.com), to Microsoft Exchange Online and I thought it would be appropriate to share ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-05-20T13:16:00-05:00" itemprop="datePublished">20 May, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/05/securing-exchange-2010-with-forefront-threat-management-gateway-tmg-2010-part-2-installing-exchange-server-edge">Securing Exchange 2010 with Forefront Threat Management Gateway (TMG) 2010, Part 2 - Installing Exchange Server Edge</a></h2>
    </header>

    <div class="post-content">
        <p>In Part 1 of the series I talked about Forefront Threat Management Gateway (TMG) 2010 and how it allows administrators to consolidate their perimeter infrastructure into a single, secure point of entry for email and other messaging related services.</p>
<p>In this part of the series, it&rsquo;s time to start getting our hands dirty so to speak and start the installation process. Microsoft recommends the following installation order:</p>
<ol>
<li>Install Active Directory Lightweight Directory Services (AD LDS). </li>
<li>Install the Exchange Server Edge Transport Transport role. </li>
<li>Install Forefront Protection 2010 for Exchange Server. </li>
<li>Install TMG 2010 </li>
</ol>
<p>In Part 2, we will start by installing Exchange Server Edge. For more information, on the minimum system requirements, see <a href="http://technet.microsoft.com/en-us/library/dd896981.aspx" target="_blank">Microsoft TechNet</a></p>
<p>To get started, I have already installed Windows Server 2008 R2. </p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image.png"><img style="border-right-width: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image_thumb.png" width="504" height="167" /></a></p>
<p>It is important to ensure that you have a Primary DNS suffix set, to set this, </p>
<ol>
<li>Right-click My Computer, and then click Properties. The System Properties dialog box will appear. </li>
<li>Click the Computer Name tab. </li>
<li>Click Change. The Computer Name Changes dialog box will appear. </li>
<li>Click More. The DNS Suffix and NetBIOS Computer Name dialog box will appear. </li>
<li>Enter the appropriate DNS suffix for the domain. </li>
<li>Select the Change primary DNS suffix when domain membership changes check box. </li>
<li>Click OK to save the changes, and then click OK to exit the Computer Name Changes dialog box. </li>
<li>Click OK to close the System Properties dialog box, and then restart the computer for the change to take effect. </li>
</ol>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image29.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image29_thumb.png" width="354" height="206" /></a>&#160;</p>
<p>The first step is to install Active Directory Lightweight Directory Services (AD LDS), I have elected to do this via the &ldquo;Add Roles Wizard&rdquo; in &ldquo;Server Manager&rdquo;. If you do not already have .NET Framework 3.5.1 installed, it will prompt you to install this feature as well.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image2.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image2_thumb.png" width="504" height="244" /></a>&#160;</p>
<p align="left"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image7.png"><img style="border-right-width: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image7_thumb.png" width="504" height="131" /></a> </p>
<p align="left">Once this part of the installation has completed, it is time to install the Exchange Server Edge Transport Role. Once you launch Exchange Server 2010 setup, you can click Step 3 and choose your Exchange language option, I&rsquo;m going to be installing only languages on the DVD. Then click &ldquo;Step 4: Install Microsoft Exchange&rdquo;</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image1.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image_thumb1.png" width="504" height="379" /></a> </p>
<p align="left">Read the introduction window of the setup wizard and click &ldquo;Next&rdquo;. Read and accept the License Agreement and click &ldquo;Next&rdquo; again. Make your selection on the &ldquo;Error Reporting&rdquo; window and Click &ldquo;Next&rdquo;. Select &ldquo;Custom Exchange Server Installation&rdquo; on the &ldquo;Installation Type&rdquo; window, verify the installation path and click &ldquo;Next&rdquo;</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image17.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image17_thumb.png" width="504" height="437" /></a> </p>
<p align="left">On the &ldquo;Server Role Selection&rdquo; window, select &ldquo;Edge Transport Role&rdquo;</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image22.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image22_thumb.png" width="504" height="439" /></a> </p>
<p align="left">Read about the &ldquo;Customer Experience Improvement Program&rdquo; and make your selection about joining. Then click &ldquo;Next&rdquo;&#160; Verify that all Readiness Checks are successful and click &ldquo;Install&rdquo; to proceed with the installation.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image33.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image33_thumb.png" width="504" height="438" /></a> </p>
<p>Once the installation process completes successfully, click &ldquo;Finish&rdquo;</p></p></p></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/image38.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2010/05/image38_thumb.png" width="504" height="438" /></a></p>
<p align="left">To summarise, in this part of the series I prepared a Windows Server 2008 R2 server by firstly ensuring that it had a Primary DNS suffix set, and installed Active Directory Lightweight Directory Services (AD LDS) and .NET Framework 3.5.1. I then proceeded to install the Exchange Server Edge Transport Role.</p>
<p align="left">In Part 3 I&rsquo;ll install Forefront Protection 2010 for Exchange Server.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Securing Exchange 2010 with Forefront Threat Management Gateway (TMG) 2010, Part 2 - Installing Exchange Server Edge&p[summary]=In Part 1 of the series I talked about Forefront Threat Management Gateway (TMG) 2010 and how it allows administrators to consolidate the...&p[url]=http://172.16.7.177:4000/2010/05/securing-exchange-2010-with-forefront-threat-management-gateway-tmg-2010-part-2-installing-exchange-server-edge" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/05/securing-exchange-2010-with-forefront-threat-management-gateway-tmg-2010-part-2-installing-exchange-server-edge&text=In Part 1 of the series I talked about Forefront Threat Management Gateway (TMG) 2010 and how it allows administrators to consolidate the...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-05-18T13:14:30-05:00" itemprop="datePublished">18 May, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/05/securing-exchange-2010-with-forefront-threat-management-gateway-tmg-2010-part-1-the-introduction">Securing Exchange 2010 with Forefront Threat Management Gateway (TMG) 2010, Part 1 &ndash; The Introduction</a></h2>
    </header>

    <div class="post-content">
        <p>November 2009 was an exciting time.. not only did I turn another year older, but, Microsoft launched both Exchange Server 2010 and Forefront Threat Management Gateway (TMG) 2010. Both of these products were eagerly awaited and while the new features and great benefits of Exchange Server 2010 have already been (and will continue to be!) discussed, I am excited to talk about how TMG 2010 now allows administrators to consolidate their perimeter infrastructure into a single, secure point of entry for email and other messaging related services.</p>
<p>What is Forefront Threat Management Gateway (TMG) 2010? TMG is essentially the next generation of ISA server (we&rsquo;ve all come to know and love ISA 2006 since it&rsquo;s release in late 2006) but with a few fantastic changes. The first of these is that, as with Exchange Server, it is 64bit only. Other new features include URL Filtering, Web antivirus/anti-malware protection and many more.</p>
<p>I mentioned earlier in the introduction that TMG 2010 allows administrators to consolidate their perimeter infrastructure into a single, secure point of entry, this is done by combining with a couple of other great technologies. It is now possible to install Exchange Edge, Forefront Protection for Exchange Server (FPES) and TMG 2010 on the same server. Management of the Exchange Server Edge, FPES&#160; and TMG 2010 services are all integrated into the TMG Management console greatly reducing management complexity and overhead.</p>
<p>In this 6 part series, I&rsquo;ll go through the process of installing Exchange Server Edge, FPES and TMG 2010 on the same server. The series will consist of the following posts:</p>
<ul>
<li>Part 1 &ndash; The Introduction </li>
<li>Part 2 &ndash; Installing Exchange Server Edge </li>
<li>Part 3 &ndash; Installing Forefront Protection 2010 for Exchange Server </li>
<li>Part 4 &ndash; Installing Forefront Threat Management Gateway 2010 </li>
<li>Part 5 &ndash; Putting it all together </li>
<li>Part 6 &ndash; Publishing Outlook Web App </li>
</ul>
<p align="left">This series is intended to be a detailed &ldquo;how to&rdquo; so I&rsquo;ll make use of a lot of screen shots of each of the steps of the process. There are many areas (especially when configuring Exchange Server) where making use of the Powershell or Exchange Management Shell (EMS) may be quicker, but I have opted to use the MMC throughout.</p>
<p>Here is a brief overview of the environment I&rsquo;ll use throughout this series, the environment is my lab environment. Here is a high level diagram of the environment, I&rsquo;ll discuss each server in a little more detail below:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/05/lab.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="lab" border="0" alt="lab" src="http://www.cgoosen.com/wp-content/uploads/2010/05/lab_thumb.png" width="504" height="335" /></a> </p>
<p align="left"><strong>tltmg01.testlab.local:</strong> Windows 2008 R2 x64 with 2 NICS (Internal &amp; External) &ndash; This is the Forefront TMG 2010 server with Exchange Server 2010 Edge and Forefront Protection 2010 for Exchange Server installed.</p>
<p align="left"><strong>tlex01.testlab.local:</strong> Windows 2008 R2 x64 &ndash; This is the Exchange 2010 Hub Transport and Client Access server.</p>
<p align="left"><strong>tlex02.testlab.local:</strong> Windows 2008 R2 x64 &ndash; This is the Exchange 2010 Mailbox server</p>
<p align="left"><strong>tldc01.testlab.local:</strong> Windows 2008 x64 &ndash; This is a Domain Controller and Global Catalog. This server also acts as a DNS server and is the Enterprise Root Certificate Authority.</p>
<p align="left">Some things to look out for.. there are a few important things to look out for when deploying this solution for the first time, there are:</p>
<ul>
<li>
<div align="left"><strong>Time Sync</strong> &ndash; make sure the time on your Exchange servers and TMG/Exchange Edge is perfectly in sync</div>
</li>
<li>
<div align="left"><strong>DNS</strong> &ndash; Mis-configuring DNS is a very common mistake in ISA/TMG deployments. There are many schools of thought here, but regardless of which one you follow, it is important to note that DNS entries are not NIC specific so make sure you assign a DNS server to either the internal OR external NIC. Your TMG/Exchange Edge server must be able to resolve names internally either through DNS or host entries</div>
</li>
<li>
<div align="left"><strong>Workgroup</strong> &ndash; Since we will be installing Exchange Server Edge, our TMG server will NOT be a domain member. It is important to put sufficient thought into how you will configure authentication for both reverse and forward proxy since AD authentication will not work</div>
</li>
<li>
<div align="left"><strong>Primary DNS suffix</strong> &ndash; The TMG/Exchange Edge will need it&rsquo;s Primary DNS suffix manually set as it will not be a part of the domain</div>
</li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Securing Exchange 2010 with Forefront Threat Management Gateway (TMG) 2010, Part 1 &ndash; The Introduction&p[summary]=November 2009 was an exciting time.. not only did I turn another year older, but, Microsoft launched both Exchange Server 2010 and Forefr...&p[url]=http://172.16.7.177:4000/2010/05/securing-exchange-2010-with-forefront-threat-management-gateway-tmg-2010-part-1-the-introduction" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/05/securing-exchange-2010-with-forefront-threat-management-gateway-tmg-2010-part-1-the-introduction&text=November 2009 was an exciting time.. not only did I turn another year older, but, Microsoft launched both Exchange Server 2010 and Forefr...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-04-30T08:10:28-05:00" itemprop="datePublished">30 Apr, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/04/easy-exchange-2010-cas-pre-req-installation">Easy Exchange 2010 CAS pre-req installation</a></h2>
    </header>

    <div class="post-content">
        <p>Just a short post, hope this will help someone by making Exchange 2010 even easier to deploy. Open Powershell with elevated rights and run the following 3 cmdlets:</p>
<ul>
<li>Import-Module ServerManager</li>
<li>Add-WindowsFeature NET-Framework,RSAT-ADDS,Web-Server,Web-Basic-Auth,Web-Windows-Auth,Web-Metabase,Web-Net-Ext,Web-Lgcy-Mgmt-Console,WAS-Process-Model,RSAT-Web-Server,Web-ISAPI-Ext,Web-Digest-Auth,Web-Dyn-Compression,NET-HTTP-Activation,RPC-Over-HTTP-Proxy &ndash;Restart</li>
<li>Set-Service NetTcpPortSharing -StartupType Automatic</li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Easy Exchange 2010 CAS pre-req installation&p[summary]=Just a short post, hope this will help someone by making Exchange 2010 even easier to deploy. Open Powershell with elevated rights and ru...&p[url]=http://172.16.7.177:4000/2010/04/easy-exchange-2010-cas-pre-req-installation" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/04/easy-exchange-2010-cas-pre-req-installation&text=Just a short post, hope this will help someone by making Exchange 2010 even easier to deploy. Open Powershell with elevated rights and ru...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-04-14T05:47:31-05:00" itemprop="datePublished">14 Apr, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/04/vulnerabilities-in-microsoft-exchange-and-windows-smtp-service-could-allow-denial-of-service">Vulnerabilities in Microsoft Exchange and Windows SMTP Service Could Allow Denial of Service</a></h2>
    </header>

    <div class="post-content">
        <p>Microsoft yesterday published <a href="http://www.microsoft.com/technet/security/bulletin/ms10-024.mspx" target="_blank">Microsoft Security Bulletin MS10-024</a>. This security update resolves one publicly disclosed vulnerability and one privately reported vulnerability in Microsoft Exchange and Windows SMTP Service. The more severe of these vulnerabilities could allow denial of service if an attacker sent a specially crafted DNS response to a computer running the SMTP service. </p>
<p><a href="http://support.microsoft.com/?kbid=976323" target="_blank">KB976323</a> provides detailed information on the security update for Windows SMTP Service, for Exchange Server specific information, see the following links:</p>
<ul>
<li>For Exchange 2000 Server see <a href="http://support.microsoft.com/?kbid=976703" target="_blank">KB976703</a> or <a href="http://www.microsoft.com/downloads/details.aspx?familyid=e47c90a0-c9c8-43b7-bec7-34107ddde294" target="_blank">download here</a></li>
<li>For Exchange Server 2003 SP2 see <a href="http://support.microsoft.com/?kbid=976702" target="_blank">KB976702</a> or <a href="http://www.microsoft.com/downloads/details.aspx?familyid=bc8391f8-5335-496b-ad4c-bae38509be4a" target="_blank">download here</a></li>
<li>For Exchange Server 2007 SP1 see <a href="http://support.microsoft.com/?kbid=981407" target="_blank">KB981407</a> - Update Rollup 10 or <a href="http://www.microsoft.com/downloads/details.aspx?familyid=6a894b4e-12b6-4a91-9555-d813956b6aac" target="_blank">download here</a></li>
<li>For Exchange Server 2007 SP2 see <a href="http://support.microsoft.com/?kbid=981383" target="_blank">KB981383</a> - Update Rollup 4 or <a href="http://www.microsoft.com/downloads/details.aspx?familyid=b8f7f872-16d5-49d6-9867-adc01351c06f" target="_blank">download here</a></li>
<li>For Exchange Server 2010 see <a href="http://support.microsoft.com/?kbid=981401" target="_blank">KB981401</a> - Update Rollup 3 or <a href="http://www.microsoft.com/downloads/details.aspx?familyid=7dcf2390-dff7-4e3a-acca-03f4d43fb79a" target="_blank">download here</a></li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Vulnerabilities in Microsoft Exchange and Windows SMTP Service Could Allow Denial of Service&p[summary]=Microsoft yesterday published Microsoft Security Bulletin MS10-024. This security update resolves one publicly disclosed vulnerability an...&p[url]=http://172.16.7.177:4000/2010/04/vulnerabilities-in-microsoft-exchange-and-windows-smtp-service-could-allow-denial-of-service" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/04/vulnerabilities-in-microsoft-exchange-and-windows-smtp-service-could-allow-denial-of-service&text=Microsoft yesterday published Microsoft Security Bulletin MS10-024. This security update resolves one publicly disclosed vulnerability an...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-04-08T07:39:08-05:00" itemprop="datePublished">8 Apr, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/04/first-look-at-exchange-2010-sp1">First look at Exchange 2010 SP1</a></h2>
    </header>

    <div class="post-content">
        <p>The Microsoft Exchange Team <a href="http://msexchangeteam.com/archive/2010/04/07/454533.aspx" target="_blank">yesterday announced</a> the upcoming release of Exchange 2010 Service Pack 1 (SP1). As one would expect, SP1 will include fixes and tweaks including a roll-up of the roll-ups released to date. There will also be several feature enhancements, here is an overview of some of these:</p>
<ul>
<li>Improvements to the Multi-Mailbox Search: search preview, search result de-duplication &amp; annotation of reviewed items.</li>
<li>Outlook Web App: Improved reading experience, users will also be able to share their calendars to anonymous viewers via the web (assuming you enable this), the reading pane can be placed on the bottom or the right side.</li>
<li>Mobility: Support for send-as, full implementation of conversation view, and more..</li>
<li>Several new management UI enhancements including: RBAC role management in ECP, Configure MailTips in ECP, Configure Transport Rules in ECP, Configure Database Availability Group (DAG) IP Addresses and Alternate Witness Server in EMC, Recursive public folder settings management (including permissions) in EMC </li>
</ul>
<p>While these are all great feature improvements, I thought I would call out the two that I am very excited about. There are two things that always come up when I talk to customers about Exchange Server 2010 and the integrated archiving capabilities. The first is the lack of ability to provision a user's personal archive to a different mailbox database from their primary mailbox. The second is that users are unable to access their personal archives from Outlook 2007. The good news is that SP1 will enable the support of both these. Thanks guys!</p>
<p>Exchange 2010 SP1 is due for release later this year.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=First look at Exchange 2010 SP1&p[summary]=The Microsoft Exchange Team yesterday announced the upcoming release of Exchange 2010 Service Pack 1 (SP1). As one would expect, SP1 will...&p[url]=http://172.16.7.177:4000/2010/04/first-look-at-exchange-2010-sp1" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/04/first-look-at-exchange-2010-sp1&text=The Microsoft Exchange Team yesterday announced the upcoming release of Exchange 2010 Service Pack 1 (SP1). As one would expect, SP1 will...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-03-30T09:31:21-05:00" itemprop="datePublished">30 Mar, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/03/busted-top-10-exchange-storage-myths">Busted&hellip; Top 10 Exchange Storage Myths</a></h2>
    </header>

    <div class="post-content">
        <p>Exchange 2010 includes improvements in performance, reliability, and high availability that enable organizations to run Exchange on a wide range of storage options. Building on improvements to disk input/output (IO) that were introduced in Exchange 2007, the latest version of Exchange requires less storage performance and is more tolerant of storage failures.</p>
<p>The Microsoft Exchange Team <a href="http://msexchangeteam.com/archive/2010/03/29/454443.aspx" target="_blank">recently posted the &ldquo;Top 10 Exchange Storage Myths&rdquo;</a> and I thought I would share a lot of that excellent content here</p>
<p><strong>Myth #1:</strong> Exchange requires expensive, high-performing storage . I can't afford large mailboxes!     <br /><em><u>Reality:</u></em> Exchange 2010 enables you to implement large, low-cost mailboxes. It performs well on less expensive disks and supports a range of storage options. See the <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=e3303d34-af6c-4108-861b-dc05f9cf3e76&amp;displaylang=en" target="_blank">Large Mailbox Vision Whitepaper.</a> </p>
<p><strong>Myth #2:</strong> Exchange 2010 doesn't support storage area networks (SANs).     <br /><em><u>Reality:</u></em> Exchange 2010 doesn't support network-attached storage (NAS) (maybe the similar spelling confuses people ?), but it does support a large range of storage options including SAN and DAS. Depending on your high availability model, storage can be configured using RAID or RAID-less (JBOD) storage. Different customers will require different solutions based on their requirements, but everyone has the ability to deploy large mailboxes at low cost. </p>
<p><strong>Myth #3:</strong> I already have a SAN (or I just bought one), so it doesn't make sense to implement DAS. By the way, my SAN can use those less expensive SATA disks too.     <br /><em><u>Reality:</u></em> This one is not really a myth, but it is often misunderstood. SAN deployment may make sense for customers as long as you are able to deploy large mailboxes at low cost. Remember that Exchange supports a range of storage options including SAN and DAS. If you are looking to take advantage of multiple independent copies of databases, then consider the full cost of your storage solution. </p>
<p><strong>Myth #4:</strong> JBOD configurations are not practical because the re-seed process after a disk failure takes too long, and this generates too much operational overhead.     <br /><em><u>Reality:</u></em> Microsoft IT uses a JBOD configuration very successfully and it can be a very low cost solution. However, a level of operational maturity is required to manage the environment appropriately. There are a multitude of factors that can affect seeding throughput rates, and internally in our JBOD architecture we see between 35-70 GB/hour. </p>
<p><strong>Myth #5:</strong> Large mailboxes perform badly with Outlook.     <br /><em><u>Reality:</u></em> Exchange 2010 supports up to 100,000 items per folder, up from 20,000 in Exchange 2007. In addition to this, Outlook 2007 SP1 Feb09 update, Outlook 2007 SP2 &amp; Outlook 2010 provide good performance for Cached Exchange Mode for mailboxes up to 10 GB in size, and even larger (25GB) using faster disks like 7.2K drives or SSD. Larger Mailboxes? The Exchange 2010 store was improved to support very large mailboxes (100 GB+) in online mode and with OWA. You can also use the Exchange 2010 <a href="http://technet.microsoft.com/en-us/library/dd979795.aspx" target="_blank">personal archive</a> to reduce mailbox size for Cached Exchange Mode clients. </p>
<p><strong>Myth #6:</strong> When I migrate to Exchange 2010 my database size will explode because Exchange 2010 doesn't have single instance storage (SIS).     <br /><em><u>Reality:</u></em> Exchange storage planning guidance has always dictated designing the storage without SIS in mind. SIS reduces Exchange Server's ability to do sequential data access, and the changes made help to provide the 70% IO reduction. Exchange 2010 does provide 20% database compression for HTML/Plain Text Messages. For more details about Exchange 2010 and SIS, see previous post &mdash; <a href="http://msexchangeteam.com/archive/2010/02/22/454051.aspx" target="_blank">Dude, Where's My Single Instance?.</a> </p>
<p><strong>Myth #7:</strong> My Exchange guy knows nothing about storage - it needs to be managed by the storage experts. Less expensive storage is too hard/time-consuming/expensive to manage.     <br /><em><u>Reality:</u></em> We know from the many organizations we have talked to who are using DAS (including Microsoft's own deployment), that they have not needed any additional people to manage less expensive exchange storage, nor have they increased their operational costs. When storage is expensive, you can spend a lot of time and resources optimizing for your storage investment. Using less expensive storage enables you to take a conservative approach and enables you to over-provision. The storage is then never touched except for firmware/driver updates or disk failures. You can use server management staff to manage the storage since the tasks are very similar (driver, firmware updates). </p>
<p><strong>Myth #8:</strong> I can't backup large Exchange databases.     <br /><em><u>Reality:</u></em> With the ability to have multiple copies of each database, along with features such as single item recovery and lagged copy support, you might not need to use traditional backups. You can also look at reducing the number of backups to weekly or bi-monthly full backups, you can backup from passive database copies, and you can use DPM "express" backups to save space. </p>
<p><strong>Myth #9:</strong> We need a 3rd party archiving solution because Exchange data needs expensive storage and we need to put archived data on less expensive storage.     <br /><em><u>Reality:</u></em> You can put all Exchange data on less expensive storage, not just the archive data. Co-locate hot and cold data to efficiently utilize large low cost disks and simplify management by using a single storage type. </p>
<p><strong>Myth #10:</strong> All Exchange storage designs must follow the Exchange Mailbox Role Requirements Calculator verbatim, otherwise they will not be supported.     <br /><em><u>Reality:</u></em> The Exchange Mailbox Role Requirements Calculator (Exchange 2010 / Exchange 2007) provides design guidelines but does not have anything to do with supportability. <a href="http://technet.microsoft.com/en-us/exchange/bb412164.aspx" target="_blank">The Exchange Solution Reviewed Program (ESRP)</a> - Storage also has information from our storage partners.</p>
<p>For more information on large mailboxes, be sure to check out the <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=e3303d34-af6c-4108-861b-dc05f9cf3e76&amp;displaylang=en" target="_blank">Large Mailbox Vision Whitepaper.</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Busted&hellip; Top 10 Exchange Storage Myths&p[summary]=Exchange 2010 includes improvements in performance, reliability, and high availability that enable organizations to run Exchange on a wid...&p[url]=http://172.16.7.177:4000/2010/03/busted-top-10-exchange-storage-myths" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/03/busted-top-10-exchange-storage-myths&text=Exchange 2010 includes improvements in performance, reliability, and high availability that enable organizations to run Exchange on a wid...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-03-22T06:16:16-05:00" itemprop="datePublished">22 Mar, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/03/recent-update-rollups-for-exchange">Recent Update Rollups for Exchange</a></h2>
    </header>

    <div class="post-content">
        <p>The last three weeks have seen the release of a couple of update rollups. The first of these was Update Rollup 2 for Exchange Server 2010 RTM.&#160; Article ID: <a href="http://support.microsoft.com/?kbid=979611" target="_blank">979611</a> describes all issues that the update rollup fixes.</p>
<p>Article ID: <a href="http://support.microsoft.com/?kbid=979784" target="_blank">979784</a> describes Update Rollup 3 for Exchange Server 2007 Service Pack 2 which was released on 18/03/2010. This update rollup does not apply to Exchange Server 2007 RTM or to Exchange 2007 Service Pack 1. The series of update rollup packages for Exchange Server 2007 SP2 is independent of the corresponding series of update rollups for Exchange Server 2007 RTM or Exchange 2007 SP1. For a list of update rollups that apply to Exchange Server 2007 RTM or to Exchange Server 2007 SP1, see <a href="http://technet.microsoft.com/en-us/library/ee221180(EXCHG.80).aspx" target="_blank">How to Obtain the Latest Service Pack or Update Rollup for Exchange 2007</a></p>
<p><font color="#ff0000">Important information for customers who install the update rollup on computers that are not connected to the Internet:</font></p>
<p>When you install the update rollup on a computer that is not connected to the Internet, you may experience long installation times. Additionally, you may receive the following message: </p>
<p><strong><em>"Creating Native images for .Net assemblies."</em></strong> </p>
<p>This behavior is caused by network requests that connect to the <a href="http://crl.microsoft.com/pki/crl/products/CodeSigPCA.crl">http://crl.microsoft.com/pki/crl/products/CodeSigPCA.crl</a> Web site. The network requests look up the certificate revocation list for each assembly that native image generation (NGen) compiles to native code. However, the Exchange Server is not connected to the Internet. Therefore, each request must wait to time-out before it moves on. To fix this problem, turn off the &ldquo;Check for publisher&rsquo;s certificate revocation&rdquo; security option on the server that is being upgraded. To do this, follow these steps:</p>
<ol>
<li>In Internet Explorer, select Tools, select Internet Options, and then click the Advanced Tab.</li>
<li>In the Security section, click to clear the Check for publisher's certificate revocation check box.</li>
<li>Click OK to close the Internet Options dialog box.</li>
</ol>
<p>When setup is complete, recheck the &ldquo;Check for publisher&rsquo;s certificate revocation&rdquo; check box.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Recent Update Rollups for Exchange&p[summary]=The last three weeks have seen the release of a couple of update rollups. The first of these was Update Rollup 2 for Exchange Server 2010...&p[url]=http://172.16.7.177:4000/2010/03/recent-update-rollups-for-exchange" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/03/recent-update-rollups-for-exchange&text=The last three weeks have seen the release of a couple of update rollups. The first of these was Update Rollup 2 for Exchange Server 2010...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-02-26T08:38:07-06:00" itemprop="datePublished">26 Feb, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/02/exchange-server-pre-deployment-analyzer-expda">Exchange Server Pre-Deployment Analyzer (ExPDA)</a></h2>
    </header>

    <div class="post-content">
        <p>Microsoft recently released the Exchange Pre-Deployment Analyzer. The Exchange Pre-Deployment Analyzer performs an overall topology readiness scan of your environment. When you run the Exchange Pre-Deployment Analyzer, it provides a detailed report that will alert you if there are any issues within your organization, which could prevent you from deploying Exchange 2010. </p>
<p>The checks performed by ExPDA are similar to the pre-requisite checks implemented (ExBPA) in the Exchange 2010 Setup program. However, unlike Exchange 2010 setup, this tool focuses only on overall topology readiness and not the ability to run Exchange 2010 on the local computer. The scan also performs a deep analysis of each existing Exchange 2003/2007 server to verify that it has the necessary updates and configuration in-place to support Exchange 2010.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2010/02/image.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2010/02/image_thumb.png" width="546" height="377" /></a> </p>
<p align="left">For more information about the Exchange Pre-Deployment Analyzer (ExPDA), visit The Microsoft Exchange Team blog <a href="http://msexchangeteam.com/archive/2010/02/24/454083.aspx" target="_blank">here</a></p>
<p align="left">To download ExPDA, click <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=88b304e7-9912-4cb0-8ead-7479dab1abf2&amp;displaylang=en" target="_blank">here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange Server Pre-Deployment Analyzer (ExPDA)&p[summary]=Microsoft recently released the Exchange Pre-Deployment Analyzer. The Exchange Pre-Deployment Analyzer performs an overall topology readi...&p[url]=http://172.16.7.177:4000/2010/02/exchange-server-pre-deployment-analyzer-expda" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/02/exchange-server-pre-deployment-analyzer-expda&text=Microsoft recently released the Exchange Pre-Deployment Analyzer. The Exchange Pre-Deployment Analyzer performs an overall topology readi...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2010-02-25T04:52:16-06:00" itemprop="datePublished">25 Feb, 2010</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2010/02/exchange-server-virtualization">Exchange Server Virtualization</a></h2>
    </header>

    <div class="post-content">
        <p>I am often asked about virtualization when talking to my customers about Exchange. Virtualization has been a big thing in the industry for a while now, so it makes sense that many customers are looking to take advantage of the many benefits, including server consolidation. What does Microsoft support? Virtualization support has not changed much since Exchange Server 2007 SP1.</p>
<p>Microsoft supports Exchange Server in production on hardware virtualization software only when all the following conditions are true:</p>
<ol>
<li>The hardware virtualization software is running:      <br />Windows Server 2008 with Hyper-V technology       <br />Windows Server 2008 R2 with Hyper-V technology       <br />Microsoft Hyper-V Server 2008       <br />Microsoft Hyper-V Server 2008 R2       <br />Any third-party hypervisor that has been validated under the <a href="http://go.microsoft.com/fwlink/?LinkId=125375" target="_blank">Windows Server Virtualization Validation Program (SVVP).</a></li>
<li>The Exchange guest virtual machine:      <br />Is running Microsoft Exchange 2007 SP1 or Exchange 2010.       <br />Is deployed on the Windows Server 2008 and above       <br />Doesn't have the Unified Messaging server role installed. All Exchange server roles, except for the Unified Messaging server role, are supported in a virtualization environment. </li>
<li>The storage used by the Exchange guest machine can be virtual storage of a fixed size, SCSI pass-through storage, or iSCSI storage. In a Hyper-V environment, each fixed VHD must be less than 2,040 GB.Virtual disks that dynamically expand or use differencing or delta mechanisms aren't supported by Exchange.</li>
<li>Only management software can be deployed on the physical root machine. The root machine should be dedicated to running guest virtual machines. </li>
<li>Microsoft doesn't support combining Exchange high availability solutions (SCC, CCR, DAGs) with hypervisor-based clustering, high availability, or migration solutions. DAGs are supported in hardware virtualization environments provided that the virtualization environment doesn't employ clustered root servers.</li>
<li>Virtual machine snapshots of an Exchange guest virtual machine is not supported. </li>
<li>Exchange supports a virtual processor-to-logical processor ratio no greater than 2:1. For example, a dual processor system using quad core processors contains a total of 8 logical processors in the host system. On a system with this configuration, do not allocate more than a total of 16 virtual processors to all guest virtual machines combined. </li>
<li>The operating system for an Exchange guest machine must use a fixed sized disk that has a minimum size equal to 15 GB plus the size of the virtual memory that's allocated to the guest machine. This requirement is necessary to account for the operating system and paging file disk requirements.</li>
</ol>
<p>&#160;</p>
<p>For more detailed information on Exchange Server Virtualization see the following Technet documentation:</p>
<ul>
<li><a href="http://technet.microsoft.com/en-us/library/cc794548%28EXCHG.80%29.aspx" target="_blank">Microsoft Support Policies and Recommendations for Exchange Servers in Hardware Virtualization Environments</a> </li>
<li><a href="http://technet.microsoft.com/en-us/library/aa996719.aspx" target="_blank">Exchange 2010 System Requirements</a> </li>
<li><a href="http://support.microsoft.com/kb/957006" target="_blank">Microsoft server software and supported virtualization environments</a></li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange Server Virtualization&p[summary]=I am often asked about virtualization when talking to my customers about Exchange. Virtualization has been a big thing in the industry fo...&p[url]=http://172.16.7.177:4000/2010/02/exchange-server-virtualization" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2010/02/exchange-server-virtualization&text=I am often asked about virtualization when talking to my customers about Exchange. Virtualization has been a big thing in the industry fo...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-12-10T09:08:15-06:00" itemprop="datePublished">10 Dec, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/12/exchange-2010-update-rollup-1-released">Exchange 2010 Update Rollup 1 Released</a></h2>
    </header>

    <div class="post-content">
        <p>Microsoft have announced the release of Update Rollup 1 for Exchange Server 2010.</p>
<p>For more information about the rollup and to download it see <a href="http://support.microsoft.com/default.aspx/kb/976573" target="_blank">Article ID: 976573</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2010 Update Rollup 1 Released&p[summary]=Microsoft have announced the release of Update Rollup 1 for Exchange Server 2010.
For more information about the rollup and to download i...&p[url]=http://172.16.7.177:4000/2009/12/exchange-2010-update-rollup-1-released" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/12/exchange-2010-update-rollup-1-released&text=Microsoft have announced the release of Update Rollup 1 for Exchange Server 2010.
For more information about the rollup and to download i...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-12-09T04:12:08-06:00" itemprop="datePublished">9 Dec, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/12/exchange-2010-server-editions">Exchange 2010 Server editions</a></h2>
    </header>

    <div class="post-content">
        <p>About a month ago I wrote a <a href="http://www.cgoosen.com/2009/11/dags-supported-in-the-exchange-2010-standard-edition/" target="_blank">short post</a> about how customers using Exchange 2010 are also able to make use of DAG&rsquo;s for high availability provided that they are using Windows Server 2008 Enterprise edition. </p>
<p>The first question that then comes to mind is: &ldquo;Why would I need Exchange 2010 Enterprise edition then?&rdquo;. Standard edition is designed for the mailbox needs of small to medium organizations and is also appropriate for non-mailbox roles in a larger Exchange deployment while Enterprise edition is ideal for larger organizations that may require a greater number of mailbox databases.</p>
<p>The following table provides a feature breakdown for each server edition of Exchange Server 2010:</p>
<div align="center">&#160;</div>
<div align="center">
<table border="1" cellspacing="0" cellpadding="2" width="431" align="center">
<tbody>
<tr>
<td valign="top" width="176"><font size="2"><strong>Feature</strong></font></td>
<td valign="top" width="124"><font size="2"><strong>Standard edition</strong></font></td>
<td valign="top" width="129"><font size="2"><strong>Enterprise edition</strong></font></td>
</tr>
<tr>
<td valign="top" width="176"><font size="2">Mailbox Databases</font></td>
<td valign="top" width="124"><font size="2">1 &ndash; 5 databases</font></td>
<td valign="top" width="129"><font size="2">6 &ndash; 100 databases</font></td>
</tr>
<tr>
<td valign="top" width="176"><font size="2">Role based access &amp; control</font></td>
<td valign="top" width="124"><font size="2">Yes</font></td>
<td valign="top" width="129"><font size="2">Yes</font></td>
</tr>
<tr>
<td valign="top" width="176"><font size="2">Transport resiliency</font></td>
<td valign="top" width="124"><font size="2">Yes</font></td>
<td valign="top" width="129"><font size="2">Yes</font></td>
</tr>
<tr>
<td valign="top" width="176"><font size="2">Remote powershell</font></td>
<td valign="top" width="124"><font size="2">Yes</font></td>
<td valign="top" width="129"><font size="2">Yes</font></td>
</tr>
<tr>
<td valign="top" width="176"><font size="2">Online move mailbox</font></td>
<td valign="top" width="124"><font size="2">Yes</font></td>
<td valign="top" width="129"><font size="2">Yes</font></td>
</tr>
<tr>
<td valign="top" width="176"><font size="2">Web-based administration</font></td>
<td valign="top" width="124"><font size="2">Yes</font></td>
<td valign="top" width="129"><font size="2">Yes</font></td>
</tr>
<tr>
<td valign="top" width="176"><font size="2">Mailbox resiliency</font></td>
<td valign="top" width="124"><font size="2">Yes</font></td>
<td valign="top" width="129"><font size="2">Yes</font></td>
</tr>
</tbody>
</table></div>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2010 Server editions&p[summary]=About a month ago I wrote a short post about how customers using Exchange 2010 are also able to make use of DAG&rsquo;s for high availabi...&p[url]=http://172.16.7.177:4000/2009/12/exchange-2010-server-editions" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/12/exchange-2010-server-editions&text=About a month ago I wrote a short post about how customers using Exchange 2010 are also able to make use of DAG&rsquo;s for high availabi...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-11-13T04:49:36-06:00" itemprop="datePublished">13 Nov, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/11/exchange-server-2010-deployment-assistant">Exchange Server 2010 Deployment Assistant</a></h2>
    </header>

    <div class="post-content">
        <p>Now that Exchange 2010 has been officially launched and made available, I&rsquo;m sure many organisations are already thinking about or planning their deployment. I my opinion, this will be especially true for those who still have Exchange 2003 deployed.</p>
<p>Microsoft have once again stepped up and just when you thought they&rsquo;ve outdone themselves, they announce the release of the Exchange Server 2010 Deployment Assistant. This awesome tool is a result of feedback from the early adopters of Exchange 2010 and of course Microsoft wanting to help streamline the experience of deploying Exchange 2010.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2009/11/image.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/11/image_thumb.png" width="547" height="443" /></a> </p>
<p>The current version offers the Upgrade from Exchange 2003 scenario.Once the deployment scenario is selected, you are taken through a series of questions and then presented with a list of steps to complete. Each step has a huge amount of valuable information to guide you through your deployment.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2009/11/image1.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/11/image_thumb1.png" width="548" height="448" /></a> </p>
<p>Additional scenarios will be available in early 2010, these include:</p>
<ul>
<li>Upgrade from Exchange 2007</li>
<li>Upgrade from Exchange 2003/2007</li>
<li>New installation of Exchange 2010</li>
</ul>
<p>The Exchange Server 2010 Deployment Assistant can <a href="http://technet.microsoft.com/exdeploy2010 " target="_blank">be found here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange Server 2010 Deployment Assistant&p[summary]=Now that Exchange 2010 has been officially launched and made available, I&rsquo;m sure many organisations are already thinking about or p...&p[url]=http://172.16.7.177:4000/2009/11/exchange-server-2010-deployment-assistant" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/11/exchange-server-2010-deployment-assistant&text=Now that Exchange 2010 has been officially launched and made available, I&rsquo;m sure many organisations are already thinking about or p...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-11-05T03:40:44-06:00" itemprop="datePublished">5 Nov, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/11/exchange-2007-on-windows-2008-r2">Exchange 2007 on Windows 2008 R2</a></h2>
    </header>

    <div class="post-content">
        <p>Kevin Allison, GM Exchange Customer Experience announced on the <a href="http://msexchangeteam.com/archive/2009/11/04/453026.aspx" target="_blank">Exchange Team blog</a> yesterday that Microsoft will be releasing an update for Exchange 2007 enabling full support of Windows Server 2008 R2. </p>
<p>Microsoft had earlier decided not to update Exchange 2007 to support its latest server operating system, Windows Server 2008 R2. This change is a result of customer feedback, so all I can say about it is thanks for listening!</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2007 on Windows 2008 R2&p[summary]=Kevin Allison, GM Exchange Customer Experience announced on the Exchange Team blog yesterday that Microsoft will be releasing an update f...&p[url]=http://172.16.7.177:4000/2009/11/exchange-2007-on-windows-2008-r2" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/11/exchange-2007-on-windows-2008-r2&text=Kevin Allison, GM Exchange Customer Experience announced on the Exchange Team blog yesterday that Microsoft will be releasing an update f...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-11-03T09:35:05-06:00" itemprop="datePublished">3 Nov, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/11/dags-supported-in-the-exchange-2010-standard-edition">DAG&rsquo;s supported in the Exchange 2010 Standard edition</a></h2>
    </header>

    <div class="post-content">
        <p>Microsoft have announced that the new high availability feature of Exchange 2010, namely, Database Availability Group, or DAG will be available in Exchange Standard edition. This is yet another great way they are helping make high availability affordable and appealing to smaller customers.</p>
<p>It is also worth mentioning though that since a DAG makes use of Windows Failover Clustering (WFC) included with Windows Server 2008 Enterprise edition, this Windows Server edition is still required.</p>
<p>For more info see <a href="http://blogs.technet.com/uc/archive/2009/10/27/exchange-2010-revving-the-engines-for-launch.aspx" target="_blank">this UC Blog post</a></p>
<p>For more info on DAG&rsquo;s, <a href="http://blogs.technet.com/ucedsg/archive/2009/05/12/exchange-2010-and-high-availability-part-i-dag.aspx" target="_blank">click here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=DAG&rsquo;s supported in the Exchange 2010 Standard edition&p[summary]=Microsoft have announced that the new high availability feature of Exchange 2010, namely, Database Availability Group, or DAG will be ava...&p[url]=http://172.16.7.177:4000/2009/11/dags-supported-in-the-exchange-2010-standard-edition" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/11/dags-supported-in-the-exchange-2010-standard-edition&text=Microsoft have announced that the new high availability feature of Exchange 2010, namely, Database Availability Group, or DAG will be ava...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-10-29T09:57:59-05:00" itemprop="datePublished">29 Oct, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/10/microsoft-virtualization-best-practices-for-exchange-server">Microsoft Virtualization Best Practices for Exchange Server</a></h2>
    </header>

    <div class="post-content">
        <p>Microsoft have got a webcast coming up next week to discuss recommendations for virtualizing Exchange server and the benefits of using Hyper-V + System Center for virtualization.</p>
<p>The webcast is on Wednesday, Nov. 4 at 10am Pacific time, which is Thursday, Nov 5 at 5am for those in Sydney.</p>
<p>For more information and to register for the webcast, <a href="http://msevents.microsoft.com/CUI/WebCastEventDetails.aspx?EventID=1032428203&amp;EventCategory=4&amp;culture=en-US&amp;CountryCode=US" target="_blank">click here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Microsoft Virtualization Best Practices for Exchange Server&p[summary]=Microsoft have got a webcast coming up next week to discuss recommendations for virtualizing Exchange server and the benefits of using Hy...&p[url]=http://172.16.7.177:4000/2009/10/microsoft-virtualization-best-practices-for-exchange-server" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/10/microsoft-virtualization-best-practices-for-exchange-server&text=Microsoft have got a webcast coming up next week to discuss recommendations for virtualizing Exchange server and the benefits of using Hy...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-10-20T09:58:03-05:00" itemprop="datePublished">20 Oct, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/10/exchange-remote-connectivity-analyzer-has-been-updated">Exchange Remote Connectivity Analyzer has been updated!</a></h2>
    </header>

    <div class="post-content">
        <p>The Exchange Team have released an updated version of the <a href="https://www.testexchangeconnectivity.com/" target="_blank">Exchange Remote Connectivity Analyzer</a></p>
<p>The tool simulates several client logon and mail flow scenarios. When a test fails, many of the errors have troubleshooting tips to assist you in correcting the problem. You may recall <a href="http://www.cgoosen.com/2008/12/microsoft-exchange-server-remote-connectivity-analyzer/" target="_blank">reading about it before..</a></p>
<p>Some new features include:</p>
<ul>
<li>Updated user interface </li>
<li>New CAPTCHA implementation</li>
<li>Updated the Outlook Anywhere test logic to work with Exchange 2010</li>
<li>Added a password confirmation text box to ensure the proper password was entered before running a test. This will reduce the number of tests that fail simply due to a typo in the password.</li>
</ul>
<p>&#160;</p>
<p>Additional tests include:</p>
<ul>
<li>Exchange Web Services - This allows you to perform connectivity testing for Exchange Web Services client such as Entourage. Developers can also use the Service Account Verification test to ensure things are configured and working properly for access with an alternate account or Exchange Impersonation. </li>
<li>Outbound SMTP - Performs Reverse DNS testing, DNS RBL Checks, and SenderID validation against a provided "outbound" IP address</li>
</ul>
<p>&#160;</p>
<p align="center"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/10/image_thumb.png" width="533" height="330" /></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange Remote Connectivity Analyzer has been updated!&p[summary]=The Exchange Team have released an updated version of the Exchange Remote Connectivity Analyzer
The tool simulates several client logon a...&p[url]=http://172.16.7.177:4000/2009/10/exchange-remote-connectivity-analyzer-has-been-updated" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/10/exchange-remote-connectivity-analyzer-has-been-updated&text=The Exchange Team have released an updated version of the Exchange Remote Connectivity Analyzer
The tool simulates several client logon a...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-10-09T06:19:06-05:00" itemprop="datePublished">9 Oct, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/10/exchange-2010-launche">Exchange 2010 launching at Tech-Ed Europe 2009!</a></h2>
    </header>

    <div class="post-content">
        <p>The Exchange product team have announced that Exchange 2010 is Code Complete and they are looking to launch at <a href="http://www.microsoft.com/europe/teched/" target="_blank">Tech&middot;Ed Europe 2009</a> in early November.</p>
<p>Congrats guys, great effort!</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2010 launching at Tech-Ed Europe 2009!&p[summary]=The Exchange product team have announced that Exchange 2010 is Code Complete and they are looking to launch at Tech&middot;Ed Europe 2009...&p[url]=http://172.16.7.177:4000/2009/10/exchange-2010-launche" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/10/exchange-2010-launche&text=The Exchange product team have announced that Exchange 2010 is Code Complete and they are looking to launch at Tech&middot;Ed Europe 2009...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-09-23T09:34:52-05:00" itemprop="datePublished">23 Sep, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/09/how-to-determine-your-ad-and-exchange-schema-version">How to determine your AD and Exchange Schema version</a></h2>
    </header>

    <div class="post-content">
        <p>I was looking for a good reference of AD and Exchange schema version numbers yesterday and thought it would be handy to combine all the bits of information I came across into a single post. </p>
<p>There are a couple of ways to find the schema version number, I prefer using &ldquo;DSQuery&rdquo; to &ldquo;ADSIEdit&rdquo; so I&rsquo;ll be making use of &ldquo;DSQuery&rdquo; in the following examples.</p>
<p>To determine the version of your AD schema, we use &ldquo;DSQuery&rdquo; to find the value of the &ldquo;objectVersion&rdquo; attribute:</p>
<blockquote><p>dsquery * cn=schema,cn=configuration,dc=yourdomain,dc=local -scope base &ndash;attr objectVersion</p>
</blockquote>
<p>Here is a mapping between the &ldquo;objectVersion&rdquo; attribute value and the AD schema version:</p>
<p>&#160;</p>
<div align="center">
<table border="0" cellspacing="0" cellpadding="2" width="551" align="center">
<tbody>
<tr>
<td valign="top" width="273">
<h5><strong><em>Value</em></strong></h5>
</td>
<td valign="top" width="276">
<h5><strong><em>Schema Version</em></strong></h5>
</td>
</tr>
<tr>
<td valign="top" width="273">&#160;</td>
<td valign="top" width="276">&#160;</td>
</tr>
<tr>
<td valign="top" width="273">
<h6 align="left">13</h6>
</td>
<td valign="top" width="276">
<h6 align="left">Windows 2000 Server </h6>
</td>
</tr>
<tr>
<td valign="top" width="273">
<h6 align="left">30</h6>
</td>
<td valign="top" width="276">
<h6 align="left">Windows Server 2003 RTM/SP1/SP2</h6>
</td>
</tr>
<tr>
<td valign="top" width="273">
<h6 align="left">31</h6>
</td>
<td valign="top" width="276">
<h6 align="left">Windows Server 2003 R2</h6>
</td>
</tr>
<tr>
<td valign="top" width="273">
<h6 align="left">44</h6>
</td>
<td valign="top" width="276">
<h6 align="left">Windows Server 2008 RTM</h6>
</td>
</tr>
</tbody>
</table></div>
<p>To determine the version of your Exchange schema, we use &ldquo;DSQuery&rdquo; to find the value of the &ldquo;rangeUpper&rdquo; attribute:</p>
<blockquote><p>dsquery * CN=ms-Exch-Schema-Version-Pt,cn=schema,cn=configuration,dc=yourdomain,dc=local -scope base &ndash;attr rangeUpper</p>
</blockquote>
<p>Here is a mapping between the &ldquo;rangeUpper&rdquo; attribute value and the Exchange schema version:</p>
<p>&#160;</p>
<div align="center">
<table border="0" cellspacing="0" cellpadding="2" width="551" align="center">
<tbody>
<tr>
<td valign="top" width="274">
<h5><strong><em>Value</em></strong></h5>
</td>
<td valign="top" width="275">
<h5><strong><em>Schema Version</em></strong></h5>
</td>
</tr>
<tr>
<td valign="top" width="274">&#160;</td>
<td valign="top" width="275">&#160;</td>
</tr>
<tr>
<td valign="top" width="274">
<h6 align="left">4397</h6>
</td>
<td valign="top" width="275">
<h6 align="left">Exchange Server 2000 RTM</h6>
</td>
</tr>
<tr>
<td valign="top" width="274">
<h6 align="left">4406</h6>
</td>
<td valign="top" width="275">
<h6 align="left">Exchange Server 2000 SP3</h6>
</td>
</tr>
<tr>
<td valign="top" width="274">
<h6 align="left">6870</h6>
</td>
<td valign="top" width="275">
<h6 align="left">Exchange Server 2003 RTM</h6>
</td>
</tr>
<tr>
<td valign="top" width="274">
<h6 align="left">6936</h6>
</td>
<td valign="top" width="275">
<h6 align="left">Exchange Server 2003 SP3</h6>
</td>
</tr>
<tr>
<td valign="top" width="274">
<h6 align="left">10628</h6>
</td>
<td valign="top" width="275">
<h6 align="left">Exchange Server 2007 RTM</h6>
</td>
</tr>
<tr>
<td valign="top" width="274">
<h6 align="left">11116</h6>
</td>
<td valign="top" width="275">
<h6 align="left">Exchange Server 2007 SP1</h6>
</td>
</tr>
<tr>
<td valign="top" width="274">
<h6 align="left">14622</h6>
</td>
<td valign="top" width="275">
<h6 align="left">Exchange Server 2007 SP2</h6>
</td>
</tr>
</tbody>
</table></div>
<div align="left">&#160;</div>
<p>NOTE: in both examples, it is assumed that your domain name is &ldquo;youdomain.local&rdquo;</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=How to determine your AD and Exchange Schema version&p[summary]=I was looking for a good reference of AD and Exchange schema version numbers yesterday and thought it would be handy to combine all the b...&p[url]=http://172.16.7.177:4000/2009/09/how-to-determine-your-ad-and-exchange-schema-version" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/09/how-to-determine-your-ad-and-exchange-schema-version&text=I was looking for a good reference of AD and Exchange schema version numbers yesterday and thought it would be handy to combine all the b...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-09-02T06:56:55-05:00" itemprop="datePublished">2 Sep, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/09/microsoft-exchange-server-jetstress-2010-beta">Microsoft Exchange Server Jetstress 2010 Beta</a></h2>
    </header>

    <div class="post-content">
        <p>Jetstress has been updated to support Exchange 2010. The beta build is now available. There are a few significant changes in this version, for a comprehensive list, see the <a href="http://msexchangeteam.com/archive/2009/09/01/452271.aspx" target="_blank">following post</a> on The Exchange Server Team blog.</p>
<p>To download Jetstress 2010 Beta, <a href="http://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=13267027-8120-48ed-931b-29eb0aa52aa6#tm" target="_blank">click here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Microsoft Exchange Server Jetstress 2010 Beta&p[summary]=Jetstress has been updated to support Exchange 2010. The beta build is now available. There are a few significant changes in this version...&p[url]=http://172.16.7.177:4000/2009/09/microsoft-exchange-server-jetstress-2010-beta" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/09/microsoft-exchange-server-jetstress-2010-beta&text=Jetstress has been updated to support Exchange 2010. The beta build is now available. There are a few significant changes in this version...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-08-31T05:12:01-05:00" itemprop="datePublished">31 Aug, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/08/exchange-2007-sp2-released">Exchange 2007 SP2 Released</a></h2>
    </header>

    <div class="post-content">
        <p>Microsoft <a href="http://msexchangeteam.com/archive/2009/08/25/452095.aspx" target="_blank">recently announced</a> the release of Exchange 2007 SP2. One of the key and long awaited features of SP2 is that it sets the foundation for the transition to Exchange Server 2010, which is expected to be available soon. Other features include:</p>
<ul>
<li>Enhanced Auditing</li>
<li>Exchange Volume Snapshot Backup Functionality</li>
<li>Dynamic Active Directory Schema Update and Validation</li>
<li>Public Folder Quota Management</li>
<li>Centralized Organizational Settings</li>
<li>Named Properties cmdlets</li>
<li>New User Interface for Managing Diagnostic Logging</li>
</ul>
<p>For more&#160; detailed information, see the <a href="http://msexchangeteam.com/archive/2009/08/25/452095.aspx" target="_blank">release announcement</a> on The Microsoft Exchange Team Blog. To download it, <a href="http://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=4c4bd2a3-5e50-42b0-8bbb-2cc9afe3216a" target="_blank">click here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2007 SP2 Released&p[summary]=Microsoft recently announced the release of Exchange 2007 SP2. One of the key and long awaited features of SP2 is that it sets the founda...&p[url]=http://172.16.7.177:4000/2009/08/exchange-2007-sp2-released" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/08/exchange-2007-sp2-released&text=Microsoft recently announced the release of Exchange 2007 SP2. One of the key and long awaited features of SP2 is that it sets the founda...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-07-24T12:27:27-05:00" itemprop="datePublished">24 Jul, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/07/exchange-2007-sp1-setup-failed-due-to-insufficient-permissions">Exchange 2007 SP1 Setup failed due to insufficient permissions</a></h2>
    </header>

    <div class="post-content">
        <p>I came across this error for the first time the other day, not entirely sure why I have not seen it before on Win 2008. This particular server was Windows 2008 Ent with SP2.</p>
<p>&ldquo;Setup failed due to insufficient permissions&hellip;.&rdquo;</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2009/07/image.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/07/image-thumb1.png" width="410" height="165" /></a> </p>
<p>At first I thought it was pretty obvious that my account did not have the correct permissions, right? that's what the error suggests.. checked AD and it turns out I had been granted the correct permissions. What else could it be? As a test, I tried to open the Security Log and that worked.. I was a little confused. Then I realised what it was.. UAC</p>
<p>User Account Control (UAC) is a technology and security infrastructure introduced with Microsoft's Windows Vista operating system. It aims to improve the security of Microsoft Windows by limiting application software to standard user privileges until an administrator authorizes an increase in privilege level. In this way, only applications that the user trusts receive higher privileges, and malware should be kept from receiving the privileges necessary to compromise the operating system. In other words, a user account may have administrator privileges assigned to it, but applications that the user runs do not also have those privileges unless they are approved beforehand or the user explicitly authorizes it to have higher privileges. Windows 2008 also uses UAC.</p>
<p>The workaround I used was to turn off UAC and reboot the server, setup worked perfectly after that.</p>
<p>To turn off UAC, go to &ldquo;Control Panel&rdquo;, then &ldquo;User Accounts&rdquo;.</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2009/07/image2.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/07/image-thumb3.png" width="561" height="178" /></a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2007 SP1 Setup failed due to insufficient permissions&p[summary]=I came across this error for the first time the other day, not entirely sure why I have not seen it before on Win 2008. This particular s...&p[url]=http://172.16.7.177:4000/2009/07/exchange-2007-sp1-setup-failed-due-to-insufficient-permissions" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/07/exchange-2007-sp1-setup-failed-due-to-insufficient-permissions&text=I came across this error for the first time the other day, not entirely sure why I have not seen it before on Win 2008. This particular s...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-07-20T05:19:22-05:00" itemprop="datePublished">20 Jul, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/07/exchange-2007-update-rollup-9-released">Exchange 2007 Update Rollup 9 Released</a></h2>
    </header>

    <div class="post-content">
        <p>Microsoft have released Update Rollup 9 for Exchange 2007 SP1. This rollup includes included many bug fixes, but also enables support for Windows Server 2008 R2 Domain Controllers in the environment. For a full list of the issues that the update rollup fixes, <a href="http://support.microsoft.com/kb/970162" target="_blank">click here</a></p>
<p>Update Rollup 9 for Exchange Server 2007 SP1 is a cumulative update. This update replaces rollups 1 &ndash; 8.</p>
<p>To download and for more information, <a href="http://support.microsoft.com/kb/970162" target="_blank">click here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2007 Update Rollup 9 Released&p[summary]=Microsoft have released Update Rollup 9 for Exchange 2007 SP1. This rollup includes included many bug fixes, but also enables support for...&p[url]=http://172.16.7.177:4000/2009/07/exchange-2007-update-rollup-9-released" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/07/exchange-2007-update-rollup-9-released&text=Microsoft have released Update Rollup 9 for Exchange 2007 SP1. This rollup includes included many bug fixes, but also enables support for...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-06-30T04:56:45-05:00" itemprop="datePublished">30 Jun, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/06/high-availability-in-exchange-server-2010">High Availability in Exchange Server 2010</a></h2>
    </header>

    <div class="post-content">
        <p>There has been a serious lack of original content on my blog this month, with the financial year coming to an end here in Australia, I&rsquo;ve been flat out</p>
<p>Never fear though, Scott Schnoll over at <a href="http://msexchangeteam.com" target="_blank">The Microsoft Exchange Team Blog</a> has put together a great 4 part video series on high availability in Exchange Server 2010:</p>
<p>In <a href="http://msexchangeteam.com/archive/2009/05/18/451353.aspx" target="_blank">Part 1</a> he introduces the concept of database mobility, and the features known as database availability groups (DAGs) and mailbox database copies.</p>
<p>In <a href="http://msexchangeteam.com/archive/2009/05/21/451400.aspx" target="_blank">Part 2</a> he demonstrates how to create a DAG and how to add mailbox servers to a DAG</p>
<p>In <a href="http://msexchangeteam.com/archive/2009/06/03/451542.aspx" target="_blank">Part 3</a> he shows how to add a mailbox database copy</p>
<p>and, in <a href="http://msexchangeteam.com/archive/2009/06/14/451609.aspx" target="_blank">Part 4</a> he performs a database switchover using the Exchange Management Console (EMC)</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=High Availability in Exchange Server 2010&p[summary]=There has been a serious lack of original content on my blog this month, with the financial year coming to an end here in Australia, I&rs...&p[url]=http://172.16.7.177:4000/2009/06/high-availability-in-exchange-server-2010" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/06/high-availability-in-exchange-server-2010&text=There has been a serious lack of original content on my blog this month, with the financial year coming to an end here in Australia, I&rs...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-05-21T11:02:42-05:00" itemprop="datePublished">21 May, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/05/no-32-bit-support-in-exchange-2010">No 32-bit support in Exchange 2010!</a></h2>
    </header>

    <div class="post-content">
        <p>That&rsquo;s right.. as we already know, when Exchange 2007 was released, a 32-bit version (which was unsupported in production environments) was made available for use in lab environments, for demos etc.</p>
<p>This will not be the case with Exchange 2010 as Microsoft will not be shipping a 32-bit version at all. What now? well.. I&rsquo;m sure we&rsquo;ll all agree that this a probably a good thing in the long run, forcing organisations to start seriously considering the deployment of 64-bit servers for things other than Exchange, like, for example DC&rsquo;s.</p>
<p>It certainly is the start of a interesting journey, hopefully other software vendors will be prompted to start making more of an effort to make their applications 64-bit compliant too, it is, in my opinion, long overdue!</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=No 32-bit support in Exchange 2010!&p[summary]=That&rsquo;s right.. as we already know, when Exchange 2007 was released, a 32-bit version (which was unsupported in production environme...&p[url]=http://172.16.7.177:4000/2009/05/no-32-bit-support-in-exchange-2010" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/05/no-32-bit-support-in-exchange-2010&text=That&rsquo;s right.. as we already know, when Exchange 2007 was released, a 32-bit version (which was unsupported in production environme...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-05-21T06:20:27-05:00" itemprop="datePublished">21 May, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/05/exchange-2010-the-future-of-collaboration-webcast">Exchange 2010: The Future of Collaboration Webcast</a></h2>
    </header>

    <div class="post-content">
        <p>The webcast will be hosted by Johann Kruse on Friday, June 19, 2009 11:00 AM Australia (East). To register for this webcast, <a href="http://msevents.microsoft.com/cui/WebCastEventDetails.aspx?EventID=1032416536&amp;EventCategory=4&amp;IO=EItdjnI1afvMAllu0RhXiw%3d%3d&amp;culture=en-US&amp;CountryCode=US" target="_blank">click here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2010: The Future of Collaboration Webcast&p[summary]=The webcast will be hosted by Johann Kruse on Friday, June 19, 2009 11:00 AM Australia (East). To register for this webcast, click here
&p[url]=http://172.16.7.177:4000/2009/05/exchange-2010-the-future-of-collaboration-webcast" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/05/exchange-2010-the-future-of-collaboration-webcast&text=The webcast will be hosted by Johann Kruse on Friday, June 19, 2009 11:00 AM Australia (East). To register for this webcast, click here
&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-05-15T10:06:07-05:00" itemprop="datePublished">15 May, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/05/exchange-server-2007-sp-2-due-in-q3-2009">Exchange Server 2007 SP 2 due in Q3 2009</a></h2>
    </header>

    <div class="post-content">
        <p>Microsoft recently announced that Exchange 2007 SP2 has been slated for release later this year. Exchange Server 2007 SP2 enables customers to increase their operational efficiency and it sets the foundation for the transition to Exchange Server 2010, which is expected to be available in the second half of 2009. In case you haven&rsquo;t heard, a public beta of Exchange Server 2010 is available for download <a href="http://www.microsoft.com/exchange/2010/" target="_blank">here</a></p>
<p>Key new features of Exchange Server 2007 SP2 include: </p>
<ul>
<li>Enhanced Auditing</li>
<li>Dynamic Active Directory Schema Update and Validation</li>
<li>Public Folder Quota Management</li>
<li>Centralized Organizational Settings</li>
<li>Named Properties cmdlets</li>
<li>New User Interface for Managing Diagnostic Logging</li>
<li>Exchange Volume Snapshot Backup Functionality</li>
</ul>
<p>The last feature is worth expanding on as it has been the subject of much discussion. Exchange 2007 SP2 will ship with a backup plug-in that will enable Windows Server Backup to backup Exchange data. A few things worth noting about this are:</p>
<ul>
<li>The backup is volume-based and as such there is no specific "Exchange only" granularity</li>
<li>Only VSS backups are supported</li>
<li>The backup will support backing up to a local hard disk or network share</li>
<li>There is no remote server backup functionality</li>
<li>The plug-in supports only full backups of the active copy if using CCR</li>
<li>When restoring, you do not have to restore the whole backed up volume, but can choose to restore only Exchange application data</li>
<li>Recovery can be done either in-place or out of place</li>
<li>You will be able to open different "backup sets", even if they were created on servers different than the one where you are restoring</li>
</ul>
<p>Detailed documentation will be available when SP2 ships, but for more detailed information, check out <a href="http://msexchangeteam.com/archive/2009/05/13/451311.aspx" target="_blank">this post</a> on the Exchange Team Blog</p>
<p>For more detailed information about Exchange 2007 SP2, <a href="http://msexchangeteam.com/archive/2009/05/11/451281.aspx" target="_blank">click here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange Server 2007 SP 2 due in Q3 2009&p[summary]=Microsoft recently announced that Exchange 2007 SP2 has been slated for release later this year. Exchange Server 2007 SP2 enables custome...&p[url]=http://172.16.7.177:4000/2009/05/exchange-server-2007-sp-2-due-in-q3-2009" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/05/exchange-server-2007-sp-2-due-in-q3-2009&text=Microsoft recently announced that Exchange 2007 SP2 has been slated for release later this year. Exchange Server 2007 SP2 enables custome...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-05-06T07:39:56-05:00" itemprop="datePublished">6 May, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/05/exchange-2010-typical-installation-part-2">Exchange 2010 &ldquo;Typical Installation&rdquo;: Part 2</a></h2>
    </header>

    <div class="post-content">
        <p>In <a href="http://www.cgoosen.com/2009/05/exchange-2010-typical-installation-part-1/" target="_blank">Part 1</a> we looked at preparing our server for the installation of Exchange 2010. What about preparing Active Directory and domains? As you&rsquo;ll see during the installation, if you run the Exchange 2010 Setup wizard with an account that has the permissions required to prepare Active Directory and the domain, the wizard will automatically do it for you. You can, of course, prepare Active Directory manually the way you have always been able to &ndash; Refer to <a href="http://technet.microsoft.com/en-au/library/bb125224(EXCHG.140).aspx" target="_blank">Microsoft Technet</a> for more information.</p>
<p>If you&rsquo;ve reached this phase of the installation you&rsquo;ve probably already downloaded a copy of the Exchange 2010 Beta. If not, simply <a href="http://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=1898ed2c-2f88-48ac-824e-d3d20fad77d7" target="_blank">click here</a> to download it!</p>
<p>Once extracted, launch the Exchange 2010 Setup wizard..</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2009/05/image2.png"><img style="border-bottom: 0px; border-left: 0px; display: block; float: none; margin-left: auto; border-top: 0px; margin-right: auto; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/05/image-thumb2.png" width="462" height="347" /></a>If you have not installed all the prerequisites, Setup will link you to the appropriate sites where you can download the components. We did this in Part 1, so we simply click &ldquo;Step 4: Install Microsoft Exchange&rdquo;</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2009/05/image3.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/05/image-thumb3.png" width="457" height="399" /></a></p>
<p align="left">After clicking &ldquo;Next&rdquo; on the Introduction page, we are presented with the following options relating to the location of the language files. I selected the &ldquo;Download latest language files from the Web&rdquo; option.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2009/05/image4.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/05/image-thumb4.png" width="456" height="397" /></a> </p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2009/05/image5.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/05/image-thumb5.png" width="456" height="398" /></a> </p>
<p>Once you acknowledge the confirmation, the Setup wizard will &ldquo;acquire&rdquo; the latest language files.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2009/05/image6.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/05/image-thumb6.png" width="459" height="402" /></a> </p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2009/05/image16.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/05/image-thumb16.png" width="458" height="401" /></a> </p>
<p align="left">Accept the License Agreement and click &ldquo;Next&rdquo;</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2009/05/image17.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/05/image-thumb17.png" width="455" height="399" /></a> </p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2009/05/image18.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/05/image-thumb18.png" width="451" height="393" /></a> </p>
<p align="left">Next we select the installation type, here we select &ldquo;Typical Exchange Server Installation&rdquo; which will install the Hub Transport, Client Access and Mailbox Server Roles on our single server. Because we selected the &ldquo;Typical Exchange Server Installation&rdquo; option, we will not be able to install the Unified Messaging Server Role, Edge Transport Server Role, or Clustered Mailbox servers during this installation.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2009/05/image19.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/05/image-thumb19.png" width="451" height="394" /></a> </p>
<p align="left">Because this is the first Exchange Server in the organization, we are asked to provide a name for the Organization. The Exchange organization name can't contain more than 64 characters and can contain only the following characters: </p>
<ul>
<li>A to Z</li>
<li>a to z</li>
<li>0 to 9</li>
<li>Space (not leading or trailing)</li>
<li>Hyphen or dash</li>
</ul>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2009/05/image20.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/05/image-thumb20.png" width="447" height="392" /></a> </p>
<p align="left">Since this is the first Exchange Server in the organization, on the &ldquo;Client Settings&rdquo; page we select the option that describes the client computers in our organization that are running Microsoft Office Outlook. If you select &ldquo;No&rdquo;, Exchange Setup will not create a public folder database on the Mailbox server. You can add a public folder database later. For example, if you add client computers that are running Outlook 2003 and you need a public folder database, you can create one on the Exchange Mailbox server. You must then configure the offline address book for public folder distribution, and then restart the Microsoft Exchange Information Store service before client computers that are running Outlook 2003 and earlier will be able to connect to the server.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2009/05/image21.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/05/image-thumb21.png" width="445" height="388" /></a> </p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2009/05/image22.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/05/image-thumb22.png" width="446" height="389" /></a> </p>
<p>On the &ldquo;Readiness Checks&rdquo; page, view the status to determine if the organization and Server Role prerequisite checks completed successfully. If they have completed successfully, click &ldquo;Install&rdquo; to install Exchange.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2009/05/image23.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/05/image-thumb23.png" width="458" height="401" /></a> </p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2009/05/image24.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/05/image-thumb24.png" width="461" height="404" /></a> </p>
<p>Congratulations, you have successfully completed a &ldquo;Typical Installation&rdquo; of Exchange 2010. I highly recommend reading the Exchange 2010 documentation on <a href="http://technet.microsoft.com/en-au/library/bb124558(EXCHG.140).aspx" target="_blank">Microsoft Technet.</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2010 &ldquo;Typical Installation&rdquo;: Part 2&p[summary]=In Part 1 we looked at preparing our server for the installation of Exchange 2010. What about preparing Active Directory and domains? As ...&p[url]=http://172.16.7.177:4000/2009/05/exchange-2010-typical-installation-part-2" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/05/exchange-2010-typical-installation-part-2&text=In Part 1 we looked at preparing our server for the installation of Exchange 2010. What about preparing Active Directory and domains? As ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-05-04T12:25:52-05:00" itemprop="datePublished">4 May, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/05/exchange-2010-typical-installation-part-1">Exchange 2010 &ldquo;Typical Installation&rdquo;: Part 1</a></h2>
    </header>

    <div class="post-content">
        <p>Since the release of Exchange 2010 Beta last month, I have been itching to deploy it in my test environment and really get my hands dirty. I have split this post into 2 parts because I want to use screen shots (hey, I&rsquo;m a techie, we like pictures!) to really show off the product.</p>
<p>In part 1 of this 2 part post, we&rsquo;ll look at how to prepare your server for a &ldquo;Typical Installation&rdquo; of Exchange. Notice how &ldquo;Typical Installation&rdquo; appears in quotation marks, this is because we refer to a &ldquo;Typical Installation&rdquo; when the Hub Transport, Client Access and Mailbox server roles are installed on a single server. Regardless of the installation options you use, installing Exchange does require a certain degree of planning and preparation.</p>
<p>To give you a brief overview of my test environment: I have a single Active Directory domain and all my servers are running Windows Server 2008, 64bit SP1. IPv6 is disabled on all my servers.</p>
<p>Exchange 2010 requires the following to be installed prior to installation (I completed my installation in the following order as well):</p>
<ul>
<li><a href="http://go.microsoft.com/fwlink/?LinkID=137039" target="_blank">Microsoft .NET Framework 3.5.</a></li>
<li>ServerManagerCmd -i RSAT-ADDS </li>
</ul>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2009/05/image.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/05/image-thumb.png" width="575" height="287" /></a> </p>
<ul>
<li><a href="http://go.microsoft.com/fwlink/?LinkId=135126" target="_blank">Windows Remote Management ( WinRM ) 2.0 Community Technology Preview 3 (CTP3).</a> </li>
<li><a href="http://go.microsoft.com/fwlink/?LinkId=135123" target="_blank">Windows PowerShell V2 CTP3.</a> </li>
<li><a href="http://go.microsoft.com/fwlink/?LinkId=3052&amp;kbid=951725" target="_blank">Update for the Microsoft Management Console (MMC) in Windows Server 2008. See KB951725.</a></li>
<li><a href="http://go.microsoft.com/fwlink/?LinkId=137040" target="_blank">Extensions for ASP.NET AJAX 1.0.</a> </li>
<li><a href="http://go.microsoft.com/fwlink/?LinkId=137042" target="_blank">2007 Office System Converter: Microsoft Filter Pack.</a> </li>
<li>ServerManagerCmd -i Web-Server</li>
<li>ServerManagerCmd -i Web-ISAPI-Ext</li>
<li>ServerManagerCmd -i Web-Metabase</li>
<li>ServerManagerCmd -i Web-Lgcy-Mgmt-Console</li>
<li>ServerManagerCmd -i Web-Basic-Auth</li>
<li>ServerManagerCmd -i Web-Digest-Auth</li>
<li>ServerManagerCmd -i Web-Windows-Auth</li>
<li>ServerManagerCmd -i Web-Dyn-Compression</li>
<li>ServerManagerCmd -i NET-HTTP-Activation</li>
<li>ServerManagerCmd -I RPC-over-HTTP-proxy</li>
</ul>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2009/05/image1.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/05/image-thumb1.png" width="578" height="290" /></a>&#160;</p>
<ul>
<li><a href="http://support.microsoft.com/?kbid=950888" target="_blank">Msdrm.dll Update. See KB950888</a></li>
<li><a href="http://support.microsoft.com/?kbid=958178" target="_blank">Load Balancing Update. See KB958178</a></li>
</ul>
<p>&#160;</p>
<p>In Part 2, its&#160; we&rsquo;ll look at the exciting stuff, the actual installation.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2010 &ldquo;Typical Installation&rdquo;: Part 1&p[summary]=Since the release of Exchange 2010 Beta last month, I have been itching to deploy it in my test environment and really get my hands dirty...&p[url]=http://172.16.7.177:4000/2009/05/exchange-2010-typical-installation-part-1" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/05/exchange-2010-typical-installation-part-1&text=Since the release of Exchange 2010 Beta last month, I have been itching to deploy it in my test environment and really get my hands dirty...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-04-21T12:25:46-05:00" itemprop="datePublished">21 Apr, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/04/exchange-2010-beta-released">Exchange 2010 Beta released</a></h2>
    </header>

    <div class="post-content">
        <p>We&rsquo;ve all been waiting for it for some time now, Microsoft announced the release of Exchange 2010 Beta last week. </p>
<p>Exchange 2010 was built from the ground up with Software + Services in mind with more than 5 million users are already enjoying the benefits of Exchange 2010 as a service today.</p>
<p>Exchange 2010 will help organizations reduce costs, protect communications and delight e-mail users with capabilities to do the following:</p>
<ul>
<li><b>Lower costs with more flexible deployment and management options.</b></li>
<li><b>Protect information and meet compliance requirements with the new e-mail archive.</b></li>
<li><b>Improve user productivity with the ultimate inbox experience.</b></li>
</ul>
<p>Exchange 2010 brings many new and exciting features to the table, for an overview of these, check out <a href="http://edge.technet.com/Media/Announcing-Exchange-2010-Beta/" target="_blank">this video on Technet Edge</a></p>
<p>To download the Exchange 2010 Beta, <a href="http://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=1898ed2c-2f88-48ac-824e-d3d20fad77d7" target="_blank">click here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2010 Beta released&p[summary]=We&rsquo;ve all been waiting for it for some time now, Microsoft announced the release of Exchange 2010 Beta last week. 
Exchange 2010 wa...&p[url]=http://172.16.7.177:4000/2009/04/exchange-2010-beta-released" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/04/exchange-2010-beta-released&text=We&rsquo;ve all been waiting for it for some time now, Microsoft announced the release of Exchange 2010 Beta last week. 
Exchange 2010 wa...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-04-03T10:49:00-05:00" itemprop="datePublished">3 Apr, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/04/exchange-2007-post-deployment-testing-part-2">Exchange 2007 Post Deployment Testing: Part 2</a></h2>
    </header>

    <div class="post-content">
        <p><a href="http://www.cgoosen.com/2009/03/exchange-2007-post-deployment-testing-part-1/" target="_blank">In part 1</a> of this series, I wrote about how to go about testing your new deployment by making use of several <em>&ldquo;Test-&ldquo; </em>cmdlets in EMS. The Exchange Server Remote Connectivity Analyzer is a great way to test external access. The Exchange Server Remote Connectivity Analyzer (<a title="https://www.testexchangeconnectivity.com/" href="https://www.testexchangeconnectivity.com/">https://www.testexchangeconnectivity.com/</a>) allows administrators to perform the following remote tests:</p>
<ul>
<li>Microsoft Exchange ActiveSync Test </li>
<li>Microsoft Exchange ActiveSync AutoDiscover Test </li>
<li>Microsoft Office Outlook 2007 Autodiscover Connectivity Test </li>
<li>Microsoft Office Outlook 2003 RPC/HTTP Connectivity Test </li>
<li>Inbound SMTP Email Test </li>
</ul>
<p>&#160;</p>
<p>In the below example, we&rsquo;ll perform an Inbound SMTP Email Test:</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2009/04/image.png"><img style="border-bottom: 0px; border-left: 0px; display: block; float: none; margin-left: auto; border-top: 0px; margin-right: auto; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/04/image-thumb.png" width="409" height="301" /></a> </p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2009/04/image1.png"><img style="border-bottom: 0px; border-left: 0px; display: block; float: none; margin-left: auto; border-top: 0px; margin-right: auto; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/04/image-thumb1.png" width="506" height="314" /></a> </p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2009/04/image2.png"><img style="border-bottom: 0px; border-left: 0px; display: block; float: none; margin-left: auto; border-top: 0px; margin-right: auto; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/04/image-thumb2.png" width="371" height="306" /></a> </p>
<p>The above process generates a test email that looks similar to this:</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2009/04/image3.png"><img style="border-bottom: 0px; border-left: 0px; display: block; float: none; margin-left: auto; border-top: 0px; margin-right: auto; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/04/image-thumb3.png" width="406" height="240" /></a> </p>
<p>In summary, the Exchange Server Remote Connectivity Analyzer is a great tool for testing remote functionality of your Exchange environment. For more information on this tool, including a short introduction video, <a href="http://msexchangeteam.com/archive/2009/03/25/450908.aspx" target="_blank">click here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2007 Post Deployment Testing: Part 2&p[summary]=In part 1 of this series, I wrote about how to go about testing your new deployment by making use of several &ldquo;Test-&ldquo; cmdlets ...&p[url]=http://172.16.7.177:4000/2009/04/exchange-2007-post-deployment-testing-part-2" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/04/exchange-2007-post-deployment-testing-part-2&text=In part 1 of this series, I wrote about how to go about testing your new deployment by making use of several &ldquo;Test-&ldquo; cmdlets ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-03-23T09:18:34-05:00" itemprop="datePublished">23 Mar, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/03/how-to-find-and-export-mailboxes-by-size-in-exchange-2007">How to find and export mailboxes by size in Exchange 2007</a></h2>
    </header>

    <div class="post-content">
        <p>My friend Nicolas recently wrote a great post on how to find and export mailboxes by size from the Exchange Management Shell (EMS). I&rsquo;m sure many administrators will find this pretty handy. </p>
<p><a href="http://blankmanblog.blogspot.com/2009/03/how-to-find-mailboxes-by-size.html" target="_blank">Read his post here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=How to find and export mailboxes by size in Exchange 2007&p[summary]=My friend Nicolas recently wrote a great post on how to find and export mailboxes by size from the Exchange Management Shell (EMS). I&rsq...&p[url]=http://172.16.7.177:4000/2009/03/how-to-find-and-export-mailboxes-by-size-in-exchange-2007" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/03/how-to-find-and-export-mailboxes-by-size-in-exchange-2007&text=My friend Nicolas recently wrote a great post on how to find and export mailboxes by size from the Exchange Management Shell (EMS). I&rsq...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-03-20T05:59:31-05:00" itemprop="datePublished">20 Mar, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/03/exchange-2007-post-deployment-testing-part-1">Exchange 2007 Post Deployment Testing: Part 1</a></h2>
    </header>

    <div class="post-content">
        <p>After your planning and deployment phases have been completed, its very important to ensure proper testing of your new environment before moving user accounts and putting the servers into production. Exchange 2007 provides several powershell cmdlets that make it really easy.</p>
<p>a list of all test cmdlets can be obtained by issuing the <em>Get-Command Test*</em> cmd in EMS.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2009/03/image7.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/03/image-thumb7.png" width="548" height="273" /></a>&#160;</p>
<p align="left">For the purposes of this post, lets look at a couple of these:</p>
<p align="left"><em>Test-Mailfow</em></p>
<p align="left">The <em>Test-Mailflow</em> cmdlet is used to check whether mail can be successfully sent from and delivered to the System Mailbox mailbox on a computer that has the Mailbox server role installed.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2009/03/image8.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/03/image-thumb8.png" width="546" height="146" /></a> <em></em></p>
<p align="left"><em>Test-ServiceHealth</em></p>
<p align="left">Use the <em>Test-ServiceHealth</em> cmdlet to test whether all the required services that are configured to start automatically on a server have started. The Test-ServiceHealth cmdlet returns an error for any service that is required by a configured role and is set to start automatically but is not currently running. The output will vary depending on the role of the server you issue the cmd on.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2009/03/image9.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/03/image-thumb9.png" width="546" height="264" /></a> </p>
<p> <em><font size="2"></font></em></p>
<p>For a full list of cmdlets, see <a href="http://technet.microsoft.com/en-us/library/bb123703.aspx">Microsoft Technet</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2007 Post Deployment Testing: Part 1&p[summary]=After your planning and deployment phases have been completed, its very important to ensure proper testing of your new environment before...&p[url]=http://172.16.7.177:4000/2009/03/exchange-2007-post-deployment-testing-part-1" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/03/exchange-2007-post-deployment-testing-part-1&text=After your planning and deployment phases have been completed, its very important to ensure proper testing of your new environment before...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-03-19T04:46:22-05:00" itemprop="datePublished">19 Mar, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/03/exchange-2007-update-rollup-7-released">Exchange 2007 Update Rollup 7 Released</a></h2>
    </header>

    <div class="post-content">
        <p>A mere 5 weeks after Update Rollup 6, Microsoft have released Update Rollup 7 for Exchange 2007 Sp1. The update fixes around 50 issues.</p>
<p>For more info on the update and to download it, see <a href="http://support.microsoft.com/kb/953469">KB953469</a>&#160;</p>
<p>I would like to highlight the following:</p>
<p>&ldquo;Note Certain Exchange Server 2007 managed code services may not start after you install this update rollup. This is true if the services cannot access the following Microsoft Web site:   <br /><a href="http://crl.microsoft.com/pki/crl/products/CodeSigPCA.crl">http://crl.microsoft.com/pki/crl/products/CodeSigPCA.crl</a> </p>
<p>For more information about how to resolve or to work around this issue, click the following article number to view the article in the Microsoft Knowledge Base:    <br /><a href="http://support.microsoft.com/kb/944752">944752</a> Exchange 2007 managed code services do not start after you install an update rollup for Exchange 2007&rdquo;</p>
<p>I also strongly recommend reading the &ldquo;Known Issues&rdquo; section before applying this update.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2007 Update Rollup 7 Released&p[summary]=A mere 5 weeks after Update Rollup 6, Microsoft have released Update Rollup 7 for Exchange 2007 Sp1. The update fixes around 50 issues.
F...&p[url]=http://172.16.7.177:4000/2009/03/exchange-2007-update-rollup-7-released" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/03/exchange-2007-update-rollup-7-released&text=A mere 5 weeks after Update Rollup 6, Microsoft have released Update Rollup 7 for Exchange 2007 Sp1. The update fixes around 50 issues.
F...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-03-18T11:08:49-05:00" itemprop="datePublished">18 Mar, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/03/quest-softwares-uc-solutions">Quest Software&rsquo;s UC Solutions</a></h2>
    </header>

    <div class="post-content">
        <p>Quest have some really cool products to add value to UC implementations (like you need it, right?)</p>
<p>Some of the key products are:</p>
<p><strong>Spotlight on Messaging:     <br /></strong>Spotlight&reg; on Messaging helps administrators get more out of their messaging environments by diagnosing and resolving problems across multiple platforms. A comprehensive view into an organization&rsquo;s messaging infrastructure, Spotlight on Messaging:</p>
<ul>
<li>Reduces cost and improves productivity by identifying issues and performance bottlenecks before they affect end users</li>
<li>Accelerates problem resolution by significantly reducing the time-to-resolution during outages     <br />Improves system performance by maximizing the availability and responsiveness of messaging servers</li>
</ul>
<p>&#160;</p>
<p><strong>MessageStats:</strong>    <br />MessageStats is the most complete and comprehensive messaging reporting and analysis solution in the industry. Used on more than 15 million Exchange mailboxes around the world everyday, MessageStats helps reduce and quantify your Exchange investment. An essential tool to keeping tabs on the cost of your infrastructure, MessageStats gathers, analyzes, and reports on Exchange and other messaging components to: </p>
<ul>
<li>Better understand usage and trends</li>
<li>Find unused and excess capacity</li>
<li>Justify expenses</li>
<li>Optimize operational efficiencies </li>
</ul>
<p>Providing a complete view of all messaging components from one interface, MessageStats delivers platform-specific business- and technical-focused reports for:</p>
<ul>
<li>BlackBerry</li>
<li>Windows Mobile</li>
<li>Microsoft Office Communications Server </li>
<li>Microsoft Exchange</li>
<li>Outlook Web Access</li>
<li>And more..</li>
</ul>
<p>&#160;</p>
<p>For more info on these and other value add products from Quest Software, visit their <a href="http://www.quest.com">site here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Quest Software&rsquo;s UC Solutions&p[summary]=Quest have some really cool products to add value to UC implementations (like you need it, right?)
Some of the key products are:
Spotligh...&p[url]=http://172.16.7.177:4000/2009/03/quest-softwares-uc-solutions" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/03/quest-softwares-uc-solutions&text=Quest have some really cool products to add value to UC implementations (like you need it, right?)
Some of the key products are:
Spotligh...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-02-25T10:02:11-06:00" itemprop="datePublished">25 Feb, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/02/exchange-2007-sp1-moving-mail-queuetransport-dumpster">Exchange 2007 SP1 Moving Mail Queue/Transport Dumpster</a></h2>
    </header>

    <div class="post-content">
        <p><span style="color: #ff0000;">UPDATE:</span> For information on how to move the Exchange 2010 Mail Queue, see "<a href="http://www.cgoosen.com/2010/09/exchange-2010-moving-mail-queue/" target="_blank">Exchange 2010 Moving Mail Queue</a>"</p>
<p>One problem that Exchange Administrators run into after successfully transitioning to Exchange 2007 is back pressure. Back pressure is a system resource monitoring feature of the Microsoft Exchange Transport service that exists on computers that are running Microsoft Exchange Server 2007 that have the Hub Transport server role or Edge Transport server role installed. Important system resources, such as available hard disk drive space and available memory, are monitored. If utilization of a system resource exceeds the specified limit, the Exchange server stops accepting new connections and messages. This prevents the system resources from being completely overwhelmed and enables the Exchange server to deliver the existing messages. When utilization of the system resource returns to a normal level, the Exchange server accepts new connections and messages.</p>
<p>The following system resources are monitored as part of the back pressure feature:</p>
<ul>
<li>Free space on the hard disk drive that stores the message queue database.</li>
<li>Free space on the hard disk drive that stores the message queue database transaction logs.</li>
<li>The number of uncommitted message queue database transactions that exist in memory.</li>
<li>The memory that is used by the EdgeTransport.exe process.<br />
The memory that is used by all processes.</li>
</ul>
<p>One solution is to ensure that you have sufficient disk space for your queue database and logs. An important thing to note is that if you are making use of CCR, Exchange holds the data for the transport dumpster in the transport queue file.</p>
<p>Moving the queue database and logs is a fairly simple operation and can be done via the Exchange Management Shell with the <em>Move-TransportDatabase</em> cmdlet.</p>
<p>The following command will move the database and logs to D:\Queue from the default location of C:\Program Files\Microsoft\Exchange Server\TransportRoles\data\Queue:</p>
<p><em>Move-TransportDatabase -QueueDatabasePath: D:\Queue -QueueDatabaseLoggingPath: D:\Queue</em></p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2009/02/image3.png"><img style="border-width: 0px;" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/02/image-thumb3.png" width="598" height="428" border="0" /></a></p>
<p>For more information on Back Pressure, <a href="http://technet.microsoft.com/en-us/library/bb201658.aspx" target="_blank">visit Microsoft Technet</a></p>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;">
<h2 class="post-title entry-title"><a title="Exchange 2010 Moving Mail Queue" href="../2010/09/exchange-2010-moving-mail-queue/" rel="bookmark">Exchange 2010 Moving Mail Queue</a></h2>
</div>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2007 SP1 Moving Mail Queue/Transport Dumpster&p[summary]=UPDATE: For information on how to move the Exchange 2010 Mail Queue, see "Exchange 2010 Moving Mail Queue"
One problem that Exchange Admi...&p[url]=http://172.16.7.177:4000/2009/02/exchange-2007-sp1-moving-mail-queuetransport-dumpster" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/02/exchange-2007-sp1-moving-mail-queuetransport-dumpster&text=UPDATE: For information on how to move the Exchange 2010 Mail Queue, see "Exchange 2010 Moving Mail Queue"
One problem that Exchange Admi...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-02-25T09:42:01-06:00" itemprop="datePublished">25 Feb, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/02/new-zealand-internet-blackout-a-remarkable-victory">New Zealand Internet Blackout: "A remarkable victory"</a></h2>
    </header>

    <div class="post-content">
        <p><a href="http://www.cgoosen.com/2009/02/join-the-new-zealand-internet-blackout/" target="_blank">I recently posted about the NZ Internet Blackout</a> and I am happy to report that the campaign was very successful. </p>
<p>Thanks to an impressive campaign spearheaded by Creative Freedom NZ, New Zealand&#8217;s controversial &#8216;guilt upon accusation&#8217; clause, s 92A, will be delayed and may be suspended and may be abandoned.</p>
<p><a href="http://www.efa.org.au/2009/02/23/a-remarkable-victory-nz-s-92a-delayed/" target="_blank">Read the full story here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=New Zealand Internet Blackout: "A remarkable victory"&p[summary]=I recently posted about the NZ Internet Blackout and I am happy to report that the campaign was very successful. 
Thanks to an impressive...&p[url]=http://172.16.7.177:4000/2009/02/new-zealand-internet-blackout-a-remarkable-victory" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/02/new-zealand-internet-blackout-a-remarkable-victory&text=I recently posted about the NZ Internet Blackout and I am happy to report that the campaign was very successful. 
Thanks to an impressive...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-02-23T04:19:34-06:00" itemprop="datePublished">23 Feb, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/02/exchange-2007-update-rollup-6-my-experience">Exchange 2007 Update Rollup 6 - My Experience</a></h2>
    </header>

    <div class="post-content">
        <p>On 12 Feb <a href="http://www.cgoosen.com/2009/02/exchange-2007-update-rollup-6/" target="_blank">I blogged about Exchange 2007 Update Rollup 6</a> having been released and that it also includes a fix for the critical security issue that was published under <a href="http://www.microsoft.com/technet/security/bulletin/ms09-003.mspx?pubDate=2009-02-10" target="_blank">Microsoft Security Bulletin MS09-003</a>. </p>
<p>I have seen a lot of posts on the internet about problems experienced after applying this update, so I recently decided to apply the update to a non-production environment. Here are my experiences.</p>
<p>About the environment:</p>
<ul>
<li>2 x CAS servers in a NLB</li>
<li>2 x Hub transport servers</li>
<li>1 x CCR Mailbox cluster</li>
<li>All servers run Server 2008 with SP1</li>
<li>All servers are physical machines</li>
</ul>
<p>&#160;</p>
<p>The only "strange" thing I experienced was that the installer sits on "Creating native images for .NET assemblies..." for more than an hour.</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2009/02/image2.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="332" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/02/image-thumb2.png" width="555" border="0" /></a>&#160;</p>
<p>After it does complete, and the servers are rebooted, everything seems to work perfectly.I had no problems with services not starting or OWA not working after applying this update.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2007 Update Rollup 6 - My Experience&p[summary]=On 12 Feb I blogged about Exchange 2007 Update Rollup 6 having been released and that it also includes a fix for the critical security is...&p[url]=http://172.16.7.177:4000/2009/02/exchange-2007-update-rollup-6-my-experience" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/02/exchange-2007-update-rollup-6-my-experience&text=On 12 Feb I blogged about Exchange 2007 Update Rollup 6 having been released and that it also includes a fix for the critical security is...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-02-20T10:34:39-06:00" itemprop="datePublished">20 Feb, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/02/exchange-2007-sp1-ccr-passive-node-installation-failure">Exchange 2007 SP1 CCR Passive node installation failure</a></h2>
    </header>

    <div class="post-content">
        <p>When installing a Exchange 2007 SP1 in Cluster Continuous Replication (CCR) cluster, the passive node installation fails with the following error: </p>
<p>&#8220;This is not a passive node. A clustered mailbox server represented by the cluster resource group [name of cluster] was found on this node.&#8221;</p>
<p>&#160;</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2009/02/image.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="510" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/02/image-thumb.png" width="583" border="0" /></a></p>
<p align="left">After a bit of head scratching, I realised that this occurs because after the installation of the passive node, Exchange setup asks you to restart your server thus causing the cluster to fail over. </p>
<p align="left">The solution: well.. simply restart the passive node and run Exchange setup again.</p>
<p align="left">&#160;</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2009/02/image1.png"><img style="border-right: 0px; border-top: 0px; border-left: 0px; border-bottom: 0px" height="513" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2009/02/image-thumb1.png" width="584" border="0" /></a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2007 SP1 CCR Passive node installation failure&p[summary]=When installing a Exchange 2007 SP1 in Cluster Continuous Replication (CCR) cluster, the passive node installation fails with the followi...&p[url]=http://172.16.7.177:4000/2009/02/exchange-2007-sp1-ccr-passive-node-installation-failure" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/02/exchange-2007-sp1-ccr-passive-node-installation-failure&text=When installing a Exchange 2007 SP1 in Cluster Continuous Replication (CCR) cluster, the passive node installation fails with the followi...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-02-12T03:25:00-06:00" itemprop="datePublished">12 Feb, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/02/exchange-2007-update-rollup-6">Exchange 2007 Update Rollup 6</a></h2>
    </header>

    <div class="post-content">
        <p>Microsoft has released Update Rollup 6 for Microsoft Exchange Server 2007 Service Pack 1. More information about this update is <a href="http://support.microsoft.com/kb/959241" target="_blank">available here</a></p>
<p>It is worth mentioning that this update also includes a fix for the critical security issue that was published under <a href="http://www.microsoft.com/technet/security/bulletin/ms09-003.mspx?pubDate=2009-02-10" target="_blank">Microsoft Security Bulletin MS09-003</a> on 10 February 2009.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2007 Update Rollup 6&p[summary]=Microsoft has released Update Rollup 6 for Microsoft Exchange Server 2007 Service Pack 1. More information about this update is available...&p[url]=http://172.16.7.177:4000/2009/02/exchange-2007-update-rollup-6" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/02/exchange-2007-update-rollup-6&text=Microsoft has released Update Rollup 6 for Microsoft Exchange Server 2007 Service Pack 1. More information about this update is available...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-01-14T05:12:01-06:00" itemprop="datePublished">14 Jan, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/01/say-ehlo-to-exchange-14">Say EHLO to Exchange 14!</a></h2>
    </header>

    <div class="post-content">
        <p>Already being tested by 3.5 million users and aligned with Microsoft's software plus services strategy. What I find fascinating is that Microsoft found the cost of running Exchange 2007 to be roughly half that of running Exchange 2003. It is thought that E14 will bring that cost down by a similar margin yet again.</p>
<p>&nbsp;</p>
<div align="center">
<div class="wlWriterSmartContent" id="scid:5737277B-5D6D-4f48-ABFC-DD9C333F4C5D:cecbed57-4561-4d29-ba3c-aff0f6fb8622" style="padding-right: 0px; display: inline; padding-left: 0px; padding-bottom: 0px; margin: 0px; padding-top: 0px">
<div id="683a3945-adcb-4396-a74f-33e6ad1d012c" style="margin: 0px; padding: 0px; display: inline;">
<div><a href="http://www.youtube.com/watch?v=yERrrjNNQzM&amp;hl=en&amp;fs=1" target="_new"><img src="http://www.cgoosen.com/wp-content/uploads/2009/01/video19e11e348e51.jpg" galleryimg="no" onload="var downlevelDiv = document.getElementById('683a3945-adcb-4396-a74f-33e6ad1d012c'); downlevelDiv.innerHTML = "
<div><object width=\"425\" height=\"355\"><param name=\"movie\" value=\"http://www.youtube.com/v/yERrrjNNQzM&amp;hl=en&amp;fs=1\"><\/param><param name=\"wmode\" value=\"transparent\"><\/param><embed src=\"http://www.youtube.com/v/yERrrjNNQzM&amp;hl=en&amp;fs=1\" type=\"application/x-shockwave-flash\" wmode=\"transparent\" width=\"425\" height=\"355\"><\/embed><\/object><\/div>";" alt=""></a></div>
</div>
</div>
</div>
<div align="center">&nbsp;</div>
<p>See the original post on <a href="http://edge.technet.com/Media/announcing-Exchange14/" target="_blank">Technet</a> and <a href="http://msexchangeteam.com/archive/2009/01/13/450397.aspx" target="_blank">Exchange Team Blog</a></p>
<div align="center">
<pre>&nbsp;</pre>
</div>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Say EHLO to Exchange 14!&p[summary]=Already being tested by 3.5 million users and aligned with Microsoft's software plus services strategy. What I find fascinating is that M...&p[url]=http://172.16.7.177:4000/2009/01/say-ehlo-to-exchange-14" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/01/say-ehlo-to-exchange-14&text=Already being tested by 3.5 million users and aligned with Microsoft's software plus services strategy. What I find fascinating is that M...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2009-01-08T08:27:21-06:00" itemprop="datePublished">8 Jan, 2009</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2009/01/mailbox-server-role-storage-requirements-calculator-update">Mailbox Server Role Storage Requirements Calculator Update</a></h2>
    </header>

    <div class="post-content">
        <p>In order to assist customers in designing their storage layout for Exchange 2007, Microsoft put together a calculator that focuses on driving the storage requirements (I/O performance and capacity) and what the optimal LUN layout should be based on a set of input factors. </p>
<p>The Mailbox Server Role Storage Requirements Calculator has recently been updated to version 16.3.</p>
<p>For more info on the Mailbox Server Role Storage Requirements Calculator and to download the latest version, visit the <a href="http://msexchangeteam.com/archive/2007/01/15/432207.aspx" target="_blank">Exchange Team Blog</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Mailbox Server Role Storage Requirements Calculator Update&p[summary]=In order to assist customers in designing their storage layout for Exchange 2007, Microsoft put together a calculator that focuses on dri...&p[url]=http://172.16.7.177:4000/2009/01/mailbox-server-role-storage-requirements-calculator-update" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2009/01/mailbox-server-role-storage-requirements-calculator-update&text=In order to assist customers in designing their storage layout for Exchange 2007, Microsoft put together a calculator that focuses on dri...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2008-12-19T03:30:32-06:00" itemprop="datePublished">19 Dec, 2008</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2008/12/microsoft-exchange-server-remote-connectivity-analyzer">Microsoft Exchange Server Remote Connectivity Analyzer</a></h2>
    </header>

    <div class="post-content">
        <p>I first heard about this tool at Tech-Ed back in October. The Exchange Server Remote Connectivity Analyzer (ExRCA) tool is a neat online tool which allows Exchange Administrators to test and validate various aspects of their Exchange , including for example, Exchange 2003 RCP over HTTP. </p>
<p>The tool currently provides the following tests:</p>
<ul>
<li>Microsoft Exchange ActiveSync Test</li>
<li>Microsoft Exchange ActiveSync AutoDiscover Test</li>
<li>Microsoft Office Outlook 2007 AutoDiscover Connectivity Test</li>
<li>Microsoft Office Outlook 2003 RPC/HTTP Connectivity Test</li>
<li>Inbound SMTP Email Test</li>
</ul>
<p>ExRCA can found at <a title="https://www.testexchangeconnectivity.com/" href="https://www.testexchangeconnectivity.com/">https://www.testexchangeconnectivity.com/</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Microsoft Exchange Server Remote Connectivity Analyzer&p[summary]=I first heard about this tool at Tech-Ed back in October. The Exchange Server Remote Connectivity Analyzer (ExRCA) tool is a neat online ...&p[url]=http://172.16.7.177:4000/2008/12/microsoft-exchange-server-remote-connectivity-analyzer" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2008/12/microsoft-exchange-server-remote-connectivity-analyzer&text=I first heard about this tool at Tech-Ed back in October. The Exchange Server Remote Connectivity Analyzer (ExRCA) tool is a neat online ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2008-12-11T08:21:58-06:00" itemprop="datePublished">11 Dec, 2008</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2008/12/exchange-2007-mailbox-server-memory-recommendations">Exchange 2007 Mailbox server memory recommendations</a></h2>
    </header>

    <div class="post-content">
        <p>Exchange 2007 enables much better memory utilization than Exchange 2003 due to its 64-bit architecture. Because of the virtual address space limitations of a 32-bit platform, Exchange 2003 is limited to using 4 GB or less of physical memory.</p>
<p>The memory configuration process for the Mailbox role is more involved than the other roles since the optimal memory configuration depends upon the mailbox count, client profile and number of storage groups.</p>
<p>The recommended configuration for the Mailbox role is based predominantly on mailbox count and user profile.The rule of thumb sizing for the Mailbox server role requires an understanding of the average client user profile. This profile can be collected using the <a href="http://technet.microsoft.com/en-us/library/bb508856.aspx" target="_blank">Microsoft Exchange Server Profile Analyzer (EPA)</a>.</p>
<p>&#160;</p>
<div align="left">
<table cellspacing="0" cellpadding="2" width="400" align="center" border="0">
<tbody>
<tr>
<td valign="top" width="165"><font size="2"><strong>User Type</strong></font></td>
<td valign="top" width="233"><font size="2"><strong>Send/Receive per day</strong> </font></td>
</tr>
<tr>
<td valign="top" width="165"><font size="2">Light</font></td>
<td valign="top" width="233"><font size="2">5 sent/20 received</font></td>
</tr>
<tr>
<td valign="top" width="165"><font size="2">Average</font></td>
<td valign="top" width="233"><font size="2">10 sent/40 received </font></td>
</tr>
<tr>
<td valign="top" width="165"><font size="2">Heavy</font></td>
<td valign="top" width="233"><font size="2">20 sent/80 received</font></td>
</tr>
<tr>
<td valign="top" width="165"><font size="2">Very Heavy</font></td>
<td valign="top" width="233"><font size="2">30 sent/120 received</font> </td>
</tr>
</tbody>
</table></div>
<p>&#160;</p>
<p>The maximum number of Storage Groups configurable in Exchange 2007 has been increased to 50 in the Enterprise Edition (up from 4 with Exchange 2003) and 5 in Standard Edition (up from 1 with Exchange 2003). This increase provides much greater flexibility in server/storage architecture, but the increase has a significant effect on the memory utilization of the Exchange 2007 Mailbox server so Storage Group count is now a factor in minimum memory configuration for Mailbox and Multi-Role servers. In Exchange 2007 Service Pack 1 (SP1), several performance enhancements were made to the Extensible Storage Engine (ESE) that reduce the memory requirements for the Mailbox server role. The following table identifies the specific minimum memory requirements per server, based on the number of storage groups on the server for Exchange 2007 and Exchange 2007 SP1.</p>
<p>&#160;</p>
<table cellspacing="0" cellpadding="2" width="402" align="center" border="0">
<tbody>
<tr>
<td valign="top" width="163"><font size="2"><strong>Storage Group Count</strong></font></td>
<td valign="top" width="237"><font size="2"><strong>Minimum Required Physical Memory</strong> </font></td>
</tr>
<tr>
<td valign="top" width="163">1<font size="2">-4</font></td>
<td valign="top" width="237"><font size="2">2 GB</font></td>
</tr>
<tr>
<td valign="top" width="163"><font size="2">5-8</font></td>
<td valign="top" width="237"><font size="2">4 GB</font></td>
</tr>
<tr>
<td valign="top" width="163"><font size="2">9-12</font></td>
<td valign="top" width="237"><font size="2">5 GB</font></td>
</tr>
<tr>
<td valign="top" width="163"><font size="2">13-16</font></td>
<td valign="top" width="237"><font size="2">6 GB</font></td>
</tr>
<tr>
<td valign="top" width="163"><font size="2">17-20</font></td>
<td valign="top" width="237"><font size="2">7 GB</font></td>
</tr>
<tr>
<td valign="top" width="163"><font size="2">21-24</font></td>
<td valign="top" width="237"><font size="2">8 GB</font></td>
</tr>
<tr>
<td valign="top" width="163"><font size="2">25-28</font></td>
<td valign="top" width="237"><font size="2">9 GB</font></td>
</tr>
<tr>
<td valign="top" width="163"><font size="2">29-32</font></td>
<td valign="top" width="237"><font size="2">10 GB</font></td>
</tr>
<tr>
<td valign="top" width="163"><font size="2">33-36</font></td>
<td valign="top" width="237"><font size="2">11 GB</font></td>
</tr>
<tr>
<td valign="top" width="163"><font size="2">37-40</font></td>
<td valign="top" width="237"><font size="2">12 GB</font></td>
</tr>
<tr>
<td valign="top" width="163"><font size="2">41-44</font></td>
<td valign="top" width="237"><font size="2">13 GB</font></td>
</tr>
<tr>
<td valign="top" width="163"><font size="2">45-48</font></td>
<td valign="top" width="237"><font size="2">14 GB</font></td>
</tr>
<tr>
<td valign="top" width="163"><font size="2">49-50</font></td>
<td valign="top" width="237"><font size="2">15 GB</font></td>
</tr>
</tbody>
</table>
<p>&#160;</p>
<p>Based on the above information, the following table can be used to assist in estimating the memory requirements of a given mailbox server with a given number of hosted mailboxes with a given profile type:</p>
<p>&#160;</p>
<table cellspacing="0" cellpadding="2" width="402" align="center" border="0">
<tbody>
<tr>
<td valign="top" width="163"><font size="2"><strong>User Type</strong></font></td>
<td valign="top" width="237"><font size="2"><strong>Recommended memory</strong>&#160;</font></td>
</tr>
<tr>
<td valign="top" width="163"><font size="2">Light</font></td>
<td valign="top" width="237"><font size="2">SG Minimum + 2 MB per mailbox</font></td>
</tr>
<tr>
<td valign="top" width="163"><font size="2">Average</font></td>
<td valign="top" width="237"><font size="2">SG Minimum + 3.5 MB per mailbox</font></td>
</tr>
<tr>
<td valign="top" width="163"><font size="2">Heavy</font></td>
<td valign="top" width="237"><font size="2">SG Minimum + 5 MB per mailbox</font></td>
</tr>
</tbody>
</table>
<p>&#160;</p>
<p>More more information, see the <a href="http://technet.microsoft.com/en-us/library/bb738124.aspx" target="_blank">Exchange 2007: Planning Memory Configurations guide</a> on Microsoft Technet.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2007 Mailbox server memory recommendations&p[summary]=Exchange 2007 enables much better memory utilization than Exchange 2003 due to its 64-bit architecture. Because of the virtual address sp...&p[url]=http://172.16.7.177:4000/2008/12/exchange-2007-mailbox-server-memory-recommendations" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2008/12/exchange-2007-mailbox-server-memory-recommendations&text=Exchange 2007 enables much better memory utilization than Exchange 2003 due to its 64-bit architecture. Because of the virtual address sp...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

            </main>
        </div>

        <script src="http://172.16.7.177:4000/assets/js/jquery-1.12.2.min.js"></script>
<script src="http://172.16.7.177:4000/assets/js/backtotop.js"></script>
<script src="http://172.16.7.177:4000/assets/js/lunr.min.js"></script>
<script src="http://172.16.7.177:4000/assets/js/lunr-feed.js"></script>
<script src="http://172.16.7.177:4000/assets/js/jquery.fitvids.js"></script>
<script src="http://172.16.7.177:4000/assets/js/svg4everybody.min.js"></script>
<script src="http://172.16.7.177:4000/assets/js/scripts.js"></script>


    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-XXXXXXX-2', 'auto');
        ga('send', 'pageview');
    </script>

        <style>
.lightbox {width: 100%; height: 100%; position: fixed; top: 0; left: 0; background: rgba(0,0,0,0.85); z-index: 9999999; line-height: 0; cursor: pointer;}
.lightbox .img {
	position: relative; 
	top: 50%;
	left: 50%;
	-ms-transform: translateX(-50%) translateY(-50%);
	-webkit-transform: translate(-50%,-50%);
	transform: translate(-50%,-50%);
	max-width: 100%;
	max-height: 100%;
}
.lightbox .img img {opacity: 0; pointer-events: none; width: auto;}
@media screen and (min-width: 1200px) {
    .lightbox .img {
		max-width: 1200px;
    }
}
@media screen and (min-height: 1200px) {
    .lightbox img {
		max-height: 1200px;
	}
}
.lightbox span {display: block; position: fixed; bottom: 13px; height: 1.5em; line-height: 1.4em; width: 100%; text-align: center; color: white; text-shadow:
    -1px -1px 0 #000,
    1px -1px 0 #000,
    -1px 1px 0 #000,
    1px 1px 0 #000;  
}






.lightbox .videoWrapperContainer {
	position: relative; 
	top: 50%;
	left: 50%;
	-ms-transform: translateX(-50%) translateY(-50%);
	-webkit-transform: translate(-50%,-50%);
	transform: translate(-50%,-50%);
	max-width: 900px;
	max-height: 100%;
}
.lightbox .videoWrapperContainer .videoWrapper {
	height: 0;
	line-height: 0;
	margin: 0;
	padding: 0;
	position: relative;
	padding-bottom: 56.333%; /* custom */
	background: black;
} 
.lightbox .videoWrapper iframe {
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
	border: 0;
	display: block;
}   
.lightbox #prev, .lightbox #next {height: 50px; line-height: 36px; display: none; margin-top: -25px; position: fixed; top: 50%; padding: 0 15px; cursor: pointer; text-decoration: none; z-index: 99; color: white; font-size: 60px;}
.lightbox.gallery #prev, .lightbox.gallery #next {display: block;}
.lightbox #prev {left: 0;}
.lightbox #next {right: 0;}
.lightbox #close {height: 50px; width: 50px; position: fixed; cursor: pointer; text-decoration: none; z-index: 99; right: 0; top: 0;}
.lightbox #close:after, .lightbox #close:before {position: absolute; margin-top: 22px; margin-left: 14px; content: ""; height: 3px; background: white; width: 23px;
-webkit-transform-origin: 50% 50%;
-moz-transform-origin: 50% 50%;
-o-transform-origin: 50% 50%;
transform-origin: 50% 50%;
/* Safari */
-webkit-transform: rotate(-45deg);
/* Firefox */
-moz-transform: rotate(-45deg);
/* IE */
-ms-transform: rotate(-45deg);
/* Opera */
-o-transform: rotate(-45deg);
}
.lightbox #close:after {
/* Safari */
-webkit-transform: rotate(45deg);
/* Firefox */
-moz-transform: rotate(45deg);
/* IE */
-ms-transform: rotate(45deg);
/* Opera */
-o-transform: rotate(45deg);
}
.lightbox, .lightbox * {
    -webkit-user-select: none;  
    -moz-user-select: none;    
    -ms-user-select: none;      
    user-select: none;
}
</style>
		
<script>
function is_youtubelink(url) {
  var p = /^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/;
  return (url.match(p)) ? RegExp.$1 : false;
}
function is_imagelink(url) {
	var p = /([a-z\-_0-9\/\:\.]*\.(jpg|jpeg|png|gif))/i;
	return (url.match(p)) ? true : false;
}
function is_vimeolink(url,el) {
	var id = false;
	$.ajax({
	  url: 'https://vimeo.com/api/oembed.json?url='+url,
	  async: true,
	  success: function(response) {
		if(response.video_id) {
		  id = response.video_id;
		  $(el).addClass('lightbox-vimeo').attr('data-id',id);
		}
	  }
	});
}

$(document).ready(function() {
	//add classes to links to be able to initiate lightboxes
	$("a").each(function(){
		var url = $(this).attr('href');
		if(url) {
			if(url.indexOf('vimeo') !== -1 && !$(this).hasClass('no-lightbox')) is_vimeolink(url,$(this));
			if(is_youtubelink(url) && !$(this).hasClass('no-lightbox')) $(this).addClass('lightbox-youtube').attr('data-id',is_youtubelink(url));
			if(is_imagelink(url) && !$(this).hasClass('no-lightbox')) {
				$(this).addClass('lightbox-image');
				var href = $(this).attr('href');
				var filename = href.split('/').pop();
				var split = filename.split(".");
				var name = split[0];
				$(this).attr('title',name);
			}
		}
	});
	//remove the clicked lightbox
	$("body").on("click", ".lightbox", function(event){
		if($(this).hasClass('gallery')) {
			$(this).remove();
			if($(event.target).attr('id')=='next') {
				//next item
				if($("a.gallery.current").nextAll("a.gallery:first").length) $("a.gallery.current").nextAll("a.gallery:first").click();
				else $("a.gallery.current").parent().find("a.gallery").first().click();
			}
			else if ($(event.target).attr('id')=='prev') {
				//prev item
				if($("a.gallery.current").prevAll("a.gallery:first").length) $("a.gallery.current").prevAll("a.gallery:first").click();
				else $("a.gallery.current").parent().find("a.gallery").last().click();
			}
			else {
				$("a.gallery").removeClass('gallery');
			}
		}
		else $(this).remove();
	});
	//prevent image from being draggable (for swipe)
	$("body").on('dragstart', ".lightbox img", function(event) { event.preventDefault(); });
	//add the youtube lightbox on click
	$("a.lightbox-youtube").click(function(event){
		event.preventDefault();
		$('<div class="lightbox"><a id="close"></a><a id="next">&rsaquo;</a><a id="prev">&lsaquo;</a><div class="videoWrapperContainer"><div class="videoWrapper"><iframe src="https://www.youtube.com/embed/'+$(this).attr('data-id')+'?autoplay=1&showinfo=0&rel=0"></iframe></div></div></div>').appendTo('body');
	});
	//add the image lightbox on click
	$("a.lightbox-image").click(function(event){
		event.preventDefault();
		$('<div class="lightbox"><a id="close"></a><a id="next">&rsaquo;</a><a id="prev">&lsaquo;</a><div class="img" style="background: url('+$(this).attr('href')+') center center / contain no-repeat;" title="'+$(this).attr('title')+'" ><img src="'+$(this).attr('href')+'" alt="'+$(this).attr('title')+'" /></div><span>'+$(this).attr('title')+'</span></div>').appendTo('body');
	});
	//add the vimeo lightbox on click
	$("body").on("click", "a.lightbox-vimeo", function(event){
		event.preventDefault();
		$('<div class="lightbox"><a id="close"></a><a id="next">&rsaquo;</a><a id="prev">&lsaquo;</a><div class="videoWrapperContainer"><div class="videoWrapper"><iframe src="https://player.vimeo.com/video/'+$(this).attr('data-id')+'/?autoplay=1&byline=0&title=0&portrait=0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div></div></div>').appendTo('body');
	});

	$("body").on("click", "a[class*='lightbox-']", function(){
		var link_elements = $(this).parent().find("a[class*='lightbox-']");
		$(link_elements).removeClass('current');
		for (var i=0; i<link_elements.length; i++) {
			if($(this).attr('href') == $(link_elements[i]).attr('href')) {
				$(link_elements[i]).addClass('current');
			}
		}
		if(link_elements.length>1) {
			$('.lightbox').addClass('gallery');
			$(link_elements).addClass('gallery');
		}
	});

	
});

$(document).keydown(function(e) {
    switch(e.which) {
        case 37: // left
        $("#prev").click();
        break;
        case 39: // right
        $("#next").click();
        break;
	case 27: // esc
        $("#close").click();
        break;
        default: return; // exit this handler for other keys
    }
    e.preventDefault(); // prevent the default action (scroll / move caret)
});

  /*===========================
  Swipe-it v1.4.1
  An event listener for swiping gestures with vanilla js.
  https://github.com/tri613/swipe-it#readme
 
  @Create 2016/09/22
  @Update 2017/08/11
  @Author Trina Lu
  ===========================*/
  "use strict";var _slicedToArray=function(){function n(n,t){var e=[],i=!0,o=!1,r=void 0;try{for(var u,c=n[Symbol.iterator]();!(i=(u=c.next()).done)&&(e.push(u.value),!t||e.length!==t);i=!0);}catch(n){o=!0,r=n}finally{try{!i&&c.return&&c.return()}finally{if(o)throw r}}return e}return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();!function(n,t,e){function i(n){function e(){o("touchstart",m,w),o("touchmove",d,w),o("touchend",p,w),E.mouseEvent&&o("mousedown",s,w)}function i(){y=!1,D=!1,A=!1,b=!1,a=!1}function s(n){a=this,y=n.clientX,D=n.clientY,o("mousemove",l,v),o("mouseup",h,v)}function l(n){n.preventDefault(),y&&D&&(A=n.clientX,b=n.clientY)}function h(n){r("mousemove",l,v),r("mouseup",h,v),p(n)}function m(n){a=this,y=n.touches[0].clientX,D=n.touches[0].clientY}function d(n){A=n.touches[0].clientX,b=n.touches[0].clientY}function p(n){if(y&&D&&A&&b){var t=y-A,e=D-b,o=[t,e].map(Math.abs),r=_slicedToArray(o,2),c=r[0],s=r[1],v=E.minDistance;if(c>v){var f=y<A?"swipeRight":"swipeLeft";u(f,a,{distance:t,start:y,end:A})}if(s>v){var l=D>b?"swipeUp":"swipeDown";u(l,a,{distance:e,start:D,end:b})}(c>v||s>v)&&u("swipe",a)}i()}var E=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},w=c(t.querySelectorAll(n)),y=void 0,D=void 0,A=void 0,b=void 0;E.mouseEvent=void 0===E.mouseEvent?f.mouseEvent:E.mouseEvent,E.minDistance=void 0===E.minDistance?f.minDistance:E.minDistance,i(),e(),this.on=function(n,t){return o(n,t,w),this}}function o(n,t,e){s(e).forEach(function(e){return e.addEventListener(n,t)})}function r(n,t,e){s(e).forEach(function(e){return e.removeEventListener(n,t)})}function u(n,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=t.createEvent("Event");o.initEvent(n,!0,!0),o.swipe=i,s(e).forEach(function(n){return n.dispatchEvent(o)})}function c(n){for(var t=[],e=0;e<n.length;e++)t.push(n[e]);return t}function s(n){return Array.isArray(n)?n:[n]}var a=!1,v=[n],f={mouseEvent:!0,minDistance:30};n[e]=i}(window,document,"SwipeIt");

var mySwipeIt = new SwipeIt('body');
mySwipeIt.on('swipeLeft',function(e){
	//check if lightbox is present
	if($('.lightbox').length >  0 ) {
		$("#next").click();
	}
}).on('swipeRight',function(e){
	//check if lightbox is present
	if($('.lightbox').length >  0 ) {
		$("#prev").click();
	}
});
</script>

    </body>
</html>