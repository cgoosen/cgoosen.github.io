<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Category: Azure | Chris&#39;s Blog &mdash; It&#39;s called thinking...  go with it! </title>
    <meta property="og:title" content="Category: Azure | Chris&#39;s Blog &mdash; It&#39;s called thinking...  go with it! " />
    <meta name="twitter:title" content="Category: Azure | Chris&#39;s Blog &mdash; It&#39;s called thinking...  go with it! " />

    <meta name="description" content="Category: Azure">
    <meta name="description" property="og:description" content="Category: Azure" />
    <meta name="twitter:description" content="Category: Azure" />

    <meta name="twitter:card" content="summary_large_image" />
    
    <meta name="twitter:site" content="@chrisgoosen" />
    
    <meta property="og:url" content="http://172.16.7.177:4000/categories/Azure/" />

    <meta property="og:image" content="" />
    <meta name="twitter:image" content="" />

    <meta name="author" content="Chris's Blog" />

    <meta name="copyright" content="Copyright by Chris's Blog. All Rights Reserved." />

    <style>
        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 300;
            src: local('Roboto Light'), local('Roboto-Light'), url(https://fonts.gstatic.com/s/roboto/v15/Hgo13k-tfSpn0qi1SFdUfVtXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 400;
            src: local('Roboto'), local('Roboto-Regular'), url(https://fonts.gstatic.com/s/roboto/v15/CWB0XYA8bzo0kSThX0UTuA.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 700;
            src: local('Roboto Bold'), local('Roboto-Bold'), url(https://fonts.gstatic.com/s/roboto/v15/d-6IYplOFocCacKzxwXSOFtXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 900;
            src: local('Roboto Black'), local('Roboto-Black'), url(https://fonts.gstatic.com/s/roboto/v15/mnpfi9pxYH-Go5UiibESIltXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 300;
            src: local('Roboto Light Italic'), local('Roboto-LightItalic'), url(https://fonts.gstatic.com/s/roboto/v15/7m8l7TlFO-S3VkhHuR0at44P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 400;
            src: local('Roboto Italic'), local('Roboto-Italic'), url(https://fonts.gstatic.com/s/roboto/v15/vPcynSL0qHq_6dX7lKVByfesZW2xOQ-xsNqO47m55DA.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 700;
            src: local('Roboto Bold Italic'), local('Roboto-BoldItalic'), url(https://fonts.gstatic.com/s/roboto/v15/t6Nd4cfPRhZP44Q5QAjcC44P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 900;
            src: local('Roboto Black Italic'), local('Roboto-BlackItalic'), url(https://fonts.gstatic.com/s/roboto/v15/bmC0pGMXrhphrZJmniIZpY4P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }
    </style>
    
    <link href="/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    
    <link rel="stylesheet" href="http://172.16.7.177:4000/assets/css/main.css">

    <link rel="canonical" href="http://172.16.7.177:4000/categories/Azure/">

    <link rel="alternate" type="application/rss+xml" title="" href="http://172.16.7.177:4000/feed.xml">
</head>

    <body>
        <div class="wrapper">
            <aside class="user-profile fixed" role="complementary">
    <div class="burger">
        <input class="trigger hidden" id="toggleBurger" type="checkbox" />
        <label for="toggleBurger">
            <span>Navigation</span>
        </label>
    </div>

    <div class="compact-header">
        <a class="avatar" href="http://172.16.7.177:4000"><img alt="Avatar" src="/assets/img/headshot.jpg" /></a>
        <div class="my-info">
            <strong class="my-name">Chris's Blog</strong>
            <span class="my-job-title">It's called thinking...  go with it!</span>
        </div>
    </div>

    
        
        <div class="mainmenu">
            <a href="http://172.16.7.177:4000" >Home</a>
            
                
            
                
            
                
                    <a href="http://172.16.7.177:4000/contact/" >Contact</a>
                
            
                
                    <a href="http://172.16.7.177:4000/about/" >About</a>
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
        </div>
        
    
    
    <div>
    	<img src="/assets/img/mvp.png" style="width:181px;height:74px;">
    </div>

    <p class="about-me"> </p>
    
    <ul class="socials">
        <li><a href="https://twitter.com/chrisgoosen" target="_blank"><svg title="twitter" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li><li><a href="https://www.linkedin.com/in/ctgoosen/" target="_blank"><svg title="linkedin" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#linkedin-icon"></use></svg></a></li><li><a href="https://github.com/cgoosen" target="_blank"><svg title="github" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#github-icon"></use></svg></a></li>

        
            <li><a href="/contact" target="_blank"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#email-icon"></use></svg></a></li>
        

        
         <li><a href="http://feeds.cgoosen.com/cgoosen"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#rss-icon"></use></svg></a></li>
        
    </ul>
</aside>


            <main class="the-content" role="main">
                <div class="search" role="search">
    <div>
        <div class="show-results-count">0 Results</div>
        <div class="search-holder">
            <input type="text" id="search-input" placeholder="search for..." />
        </div>
    </div>
    <ul id="results-container" class="results-container"></ul>
</div>


                <h1>Posts From Category: Azure</h1>


<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2018-12-14T06:30:52-06:00" itemprop="datePublished">14 Dec, 2018</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2018/12/tca-podcast-episode-21-get-iotepisode-guestname-anthony-bartolo">TCA Podcast Episode 21: Get-IoTEpisode -GuestName &ldquo;Anthony Bartolo&rdquo;</a></h2>
    </header>

    <div class="post-content">
        <p>The Internet of things (IoT) seems to be everywhere these days. Anything from connected light bulbs and door bells to sensors that monitor and report the drying and curing of concrete in real time, there seems to be an IoT solution for every problem but IoT is so much more than just a sensor connected to a Raspberry PI. Microsoft&rsquo;s&nbsp;Anthony Bartolo sat down with us at Ignite to explain what IoT is, why IT Pros should pay attention and how to get started.</p>
<iframe width="100%" height="300" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/544434648&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"></iframe>
<p>For more information on The Cloud Architects podcast, check us out on <a href="https://soundcloud.com/thecloudarchitects/" target="_blank" rel="noopener noreferrer">SoundCloud</a>. We are also available on your favorite podcast app:</p>
<ul>
<li><a href="https://itunes.apple.com/us/podcast/the-cloud-architects-podcast/id1264479296?mt=2" target="_blank" rel="noopener noreferrer">iTunes</a></li>
<li><a href="https://www.stitcher.com/podcast/the-cloud-architects/the-cloud-achitects" target="_blank" rel="noopener noreferrer">Stitcher</a></li>
<li><a href="https://tunein.com/radio/The-Cloud-Architects-Podcast-p1026315/" target="_blank" rel="noopener noreferrer">Tunein</a></li>
<li><a href="https://www.acast.com/thecloudarchitectspodcast" target="_blank" rel="noopener noreferrer">Acast</a></li>
</ul>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=TCA Podcast Episode 21: Get-IoTEpisode -GuestName &ldquo;Anthony Bartolo&rdquo;&p[summary]=The Internet of things (IoT) seems to be everywhere these days. Anything from connected light bulbs and door bells to sensors that monito...&p[url]=http://172.16.7.177:4000/2018/12/tca-podcast-episode-21-get-iotepisode-guestname-anthony-bartolo" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2018/12/tca-podcast-episode-21-get-iotepisode-guestname-anthony-bartolo&text=The Internet of things (IoT) seems to be everywhere these days. Anything from connected light bulbs and door bells to sensors that monito...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2018-02-27T14:00:12-06:00" itemprop="datePublished">27 Feb, 2018</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2018/02/fun-with-azure-automation-and-table-service-rest-api">Fun with Azure Automation and Table Service REST API</a></h2>
    </header>

    <div class="post-content">
        <p>I love PowerShell and I really love to automate things! I recently started looking into leveraging Azure services for some automation tasks&nbsp;and discovered how powerful it could be. I also had a lot of fun doing it and wanted to share some of what I learned.</p>
<p>Azure&nbsp;Automation is for scheduling tasks or scripts that run on some sort of schedule and is especially useful for any automation you might be doing with Office 365. Your code is stored in a Runbook (PowerShell or Python) and executed according to a schedule. Interacting with modules is a little different to working with your local PowerShell installation, however the <a href="https://docs.microsoft.com/en-us/azure/automation/automation-runbook-gallery" target="_blank" rel="noopener noreferrer">module gallery makes it pretty simple</a>. Getting started is simple, let's assume in this example we will be automating a report in Exchange Online. First you create an Automation Account:</p>
<p><a href="/assets/img/2018/02/auto1.png"><img src="/assets/img/2018/02/auto1.png" style="width:145px;height:300px;" /></a></p>
<p><a href="/assets/img/2018/02/auto2.png"><img src="/assets/img/2018/02/auto2.png" style="width:300px;height:222px;" /></a></p>
<p>Create a credential set for your Exchange Online credentials - remember what you call it.&nbsp;"TenantCreds" in my case.</p>
<p><a href="/assets/img/2018/02/auto4.png"><img src="/assets/img/2018/02/auto4.png" style="width:300px;height:176px;" /></a></p>
<p>Then create a new Runbook:</p>
<p><a href="/assets/img/2018/02/auto3.png"><img src="/assets/img/2018/02/auto3.png" style="width:300px;height:185px;" /></a></p>
<p>Next it's time to add some PowerShell to the Runbook. Since we will be working in Exchange Online, we need to create and import that session. This is similar to working with Exchange Online sessions on your local machine, but you will notice that we don't need to include the credentials in the code and simply reference the credential set we created earlier:</p>
<p><figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="code"><pre><span class="o">&lt;</span><span class="n">br</span> <span class="sr">/&gt;
$UserCredential = Get-AutomationPSCredential -Name "TenantCreds"&lt;br /</span><span class="o">&gt;</span>
<span class="vg">$Session</span> <span class="o">=</span> <span class="no">New</span><span class="o">-</span><span class="no">PSSession</span> <span class="o">-</span><span class="no">ConfigurationName</span> <span class="no">Microsoft</span><span class="o">.</span><span class="no">Exchange</span> <span class="o">-</span><span class="no">ConnectionUri</span> <span class="n">https</span><span class="ss">:/</span><span class="o">/</span><span class="n">outlook</span><span class="p">.</span><span class="nf">office365</span><span class="p">.</span><span class="nf">com</span><span class="o">/</span><span class="n">powershell</span><span class="o">-</span><span class="n">liveid</span><span class="o">/</span> <span class="o">-</span><span class="no">Credential</span> <span class="vg">$UserCredential</span> <span class="o">-</span><span class="no">Authentication</span> <span class="no">Basic</span> <span class="o">-</span><span class="no">AllowRedirection</span><span class="o">&lt;</span><span class="n">br</span> <span class="sr">/&gt;
$Commands = @("Get-MigrationBatch","Get-MigrationUser","Get-MigrationUserStatistics","Get-MoveRequestStatistics","Get-MoveRequest")&lt;br /</span><span class="o">&gt;</span>
<span class="no">Import</span><span class="o">-</span><span class="no">PSSession</span> <span class="o">-</span><span class="no">Session</span> <span class="vg">$Session</span> <span class="o">-</span><span class="no">Prefix</span> <span class="s2">"EXO"</span> <span class="o">-</span><span class="no">DisableNameChecking</span><span class="p">:</span><span class="vg">$true</span> <span class="o">-</span><span class="no">AllowClobber</span><span class="p">:</span><span class="vg">$true</span> <span class="o">-</span><span class="no">CommandName</span> <span class="vg">$Commands</span> <span class="o">|</span> <span class="no">Out</span><span class="o">-</span><span class="no">Null</span><span class="o">&lt;</span><span class="n">br</span> <span class="sr">/&gt;</span></pre></td></tr></tbody></table></code></pre></figure></p>
<p>I had some errors when trying to import all Exchange Online cmdlets, so I limit it&nbsp;to only the cmdlets I intend to use in the script. I also add a prefix of "EXO" to these, so these cmdlets are used as follows:</p>
<p><figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
</pre></td><td class="code"><pre><span class="o">&lt;</span><span class="n">br</span> <span class="sr">/&gt;
$MigBatch = Get-EXOMigrationBatch | Where-Object {$_.Identity -like '*MyMigration*'} | foreach {$_.BatchGuid}&lt;br /</span><span class="o">&gt;</span></pre></td></tr></tbody></table></code></pre></figure></p>
<p>Lastly, we need to create a schedule for the automation job:</p>
<p><a href="/assets/img/2018/02/schedule1.png"><img src="/assets/img/2018/02/schedule1.png" style="width:300px;height:146px;" /></a></p>
<p>Once the schedule has been created, you can link it to the Runbook:</p>
<p><a href="/assets/img/2018/02/schedule2.png"><img src="/assets/img/2018/02/schedule2.png" style="width:300px;height:142px;" /></a></p>
<p>This is great if you need to perform tasks that don't generate any output. What happens when something (e.g .CSV file) is generated? There are a couple of ways to deal with that. You could just use the temp folder to store your data and <a href="http://www.cgoosen.com/2015/04/user-powershell-to-bulk-email-your-users/" target="_blank" rel="noopener noreferrer">then email it to yourself</a> - remember, data stored in the temp folder will not persist:</p>
<p><figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
</pre></td><td class="code"><pre><span class="o">&lt;</span><span class="n">br</span> <span class="sr">/&gt;
$TmpPath = $env:TEMP&lt;br /</span><span class="o">&gt;</span></pre></td></tr></tbody></table></code></pre></figure></p>
<p>Another way to deal with this data is to write it to Azure Storage. There is a <a href="https://docs.microsoft.com/en-us/azure/storage/common/storage-powershell-guide-full" target="_blank" rel="noopener noreferrer">PowerShell module available</a> for Azure Storage that can be used with Azure Automation, but you can also use the APIs. Since&nbsp;I figured out how to use the API, it has become my go to method because it is actually much faster. I have also been able to use it in environments where it isn't possible to install modules.</p>
<p>The first thing we need to do is create a Storage Account in Azure:</p>
<p><a href="/assets/img/2018/02/storage1.png"><img src="/assets/img/2018/02/storage1.png" style="width:138px;height:300px;" /></a></p>
<p>We then create a Shared Access Signature (SAS) for that Storage Account:</p>
<p><a href="/assets/img/2018/02/storage2.png"><img src="/assets/img/2018/02/storage1.png" style="width:300px;height:218px;" /></a></p>
<p>The result should look similar to this:</p>
<p><a href="/assets/img/2018/02/storage3.png"><img src="/assets/img/2018/02/storage1.png" style="width:300px;height:142px;" /></a></p>
<p>In this example, we are going to store our script output in the Table Service, so we'll be using the&nbsp;Table Service REST API. When working with the Table Service it is <a href="https://docs.microsoft.com/en-us/rest/api/storageservices/understanding-the-table-service-data-model" target="_blank" rel="noopener noreferrer">important to understand tables, entities, system properties and other limitations</a>, but for the&nbsp;purposes of this post I'm going to simplify things a little.&nbsp;Tables store data as collections of entities - entities are similar to rows&nbsp;and have&nbsp;a primary key and a set of properties. A property is similar to a column.</p>
<p>Each entity always has the following system properties:</p>
<ul>
<li>PartitionKey</li>
<li>RowKey</li>
<li>Timestamp</li>
</ul>
<p>Timestamp is managed automatically and isn't something you can change. The&nbsp;PartitionKey and RowKey are always required and are used for scalability and indexing of the content so it is important to consider these when designing your table. <a href="https://docs.microsoft.com/en-us/rest/api/storageservices/designing-a-scalable-partitioning-strategy-for-azure-table-storage" target="_blank" rel="noopener noreferrer">Here is some really good information to read up on.</a>&nbsp;In this&nbsp;example, I'll looking up migration status of a mailbox in Exchange Online and will be inserting this data into a table. I'm going to use the "BatchID" as the&nbsp;PartitionKey and the "Status" as the&nbsp;RowKey. The table name in the example will use the "Alias" of the mailbox.</p>
<p>First, lets define the data we are going to insert. This could easily be used in a script or automation Runbook as a Foreach() loop, but to keep it simple I'm just going to manually define them in the example</p>
<p><figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="code"><pre><span class="o">&lt;</span><span class="n">br</span> <span class="sr">/&gt;
$UserTable = "ZacTurner"&lt;br /</span><span class="o">&gt;</span>
<span class="vg">$PartitionKey</span> <span class="o">=</span> <span class="s2">"Batch02"</span><span class="o">&lt;</span><span class="n">br</span> <span class="sr">/&gt;
$RowKey = "Synced"&lt;br /</span><span class="o">&gt;</span>
<span class="vg">$PrimaryEmailAddress</span> <span class="o">=</span> <span class="s2">"ZacTurner@o365testlab.com"</span><span class="o">&lt;</span><span class="n">br</span> <span class="sr">/&gt;
$MbxGuid = "e31949b2-ebc6-4f57-b9ae-0aa8ae73bb2c"&lt;br /</span><span class="o">&gt;</span>
<span class="vg">$Batch</span> <span class="o">=</span> <span class="s2">"Batch02"</span><span class="o">&lt;</span><span class="n">br</span> <span class="sr">/&gt;
$Status = "Synced"&lt;br /</span><span class="o">&gt;</span>
<span class="vg">$Skipped</span> <span class="o">=</span> <span class="s2">"4"</span><span class="o">&lt;</span><span class="n">br</span> <span class="sr">/&gt;
$LastCheck = "2/</span><span class="mi">27</span><span class="o">/</span><span class="mi">2018</span> <span class="mi">8</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mo">01</span> <span class="no">PM</span><span class="s2">"&lt;br /&gt;</span></pre></td></tr></tbody></table></code></pre></figure></p>
<p>Next we will import this information, during the import, we'll first check to see if a unique table already exists (using the Alias). If one does exist, we'll insert the data, if one doesn't exist we will create it.</p>
<p><figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class="code"><pre><span class="o">&lt;</span><span class="n">br</span> <span class="sr">/&gt;
$AzureEndpoint = 'https:/</span><span class="o">/</span><span class="n">cgblogpostdemo</span><span class="p">.</span><span class="nf">table</span><span class="p">.</span><span class="nf">core</span><span class="p">.</span><span class="nf">windows</span><span class="p">.</span><span class="nf">net</span><span class="o">/</span><span class="s1">'&lt;br /&gt;
$AzureSAS = "?sv=2017-07-29&amp;amp;ss=bfqt&amp;amp;srt=sco&amp;amp;sp=rwdlacup&amp;amp;se=2018-04-05T02:31:38Z&amp;amp;st=2018-02-27T19:31:38Z&amp;amp;spr=https&amp;amp;sig=&lt;removed&gt;"&lt;br /&gt;
$AzureRequestHeaders = @{&lt;br /&gt;
		"x-ms-date"=(Get-Date -Format r);&lt;br /&gt;
		"x-ms-version"="2016-05-31";&lt;br /&gt;
		"Accept-Charset"="UTF-8";&lt;br /&gt;
		"DataServiceVersion"="3.0;NetFx";&lt;br /&gt;
		"MaxDataServiceVersion"="3.0;NetFx";&lt;br /&gt;
		"Accept"="application/json;odata=nometadata"}&lt;/p&gt;
&lt;p&gt;$UserURI = $AzureEndpoint + $UserTable + "/" + $AzureSAS&lt;/p&gt;
&lt;p&gt;#Check if table already exists&lt;br /&gt;
$UserTableExists = Invoke-WebRequest -Method GET -Uri $UserURI -Headers $AzureRequestHeaders&lt;br /&gt;
$UserTableExists = $UserTableExists.StatusCode&lt;/p&gt;
&lt;p&gt;If ($UserTableExists -ne "200"){&lt;br /&gt;
		 $TableRequestBody = ConvertTo-Json -InputObject @{&lt;br /&gt;
							"TableName"=$UserTable}&lt;br /&gt;
		 $EncodedTableRequestBody = [System.Text.Encoding]::UTF8.GetBytes($TableRequestBody)&lt;br /&gt;
		 $TableURI = $AzureEndpoint + '</span><span class="no">Tables</span><span class="o">/</span><span class="err">'</span> <span class="o">+</span> <span class="vg">$AzureSAS</span><span class="o">&lt;</span><span class="n">br</span> <span class="sr">/&gt;
		Invoke-WebRequest -Method POST -Uri $TableURI -Headers $AzureRequestHeaders -Body $EncodedTableRequestBody -ContentType "application/</span><span class="n">json</span><span class="s2">"&lt;br /&gt;
			}&lt;/p&gt;
&lt;p&gt;#Insert data&lt;br /&gt;
$AzureRequestBody = ConvertTo-Json -InputObject @{&lt;br /&gt;
		"</span><span class="no">PartitionKey</span><span class="s2">"= "</span><span class="vg">$PartitionKey</span><span class="s2">";&lt;br /&gt;
		"</span><span class="no">RowKey</span><span class="s2">"= "</span><span class="vg">$RowKey</span><span class="s2">";&lt;br /&gt;
		"</span><span class="no">PrimaryEmailAddress</span><span class="s2">"= "</span><span class="vg">$PrimaryEmailAddress</span><span class="s2">";&lt;br /&gt;
		"</span><span class="no">MbxGuid</span><span class="s2">"= "</span><span class="vg">$MbxGuid</span><span class="s2">";&lt;br /&gt;
		"</span><span class="no">BatchName</span><span class="s2">"= "</span><span class="vg">$Batch</span><span class="s2">";&lt;br /&gt;
		"</span><span class="no">Status</span><span class="s2">"= "</span><span class="vg">$Status</span><span class="s2">";&lt;br /&gt;
		"</span><span class="no">ItemsSkipped</span><span class="s2">"= "</span><span class="vg">$Skipped</span><span class="s2">";&lt;br /&gt;
		"</span><span class="no">LastCheck</span><span class="s2">"= "</span><span class="vg">$LastCheck</span><span class="s2">"}&lt;br /&gt;
$EncodedAzureRequestBody = [System.Text.Encoding]::UTF8.GetBytes($AzureRequestBody)&lt;br /&gt;
Invoke-WebRequest -Method POST -Uri $UserURI -Headers $AzureRequestHeaders -Body $EncodedAzureRequestBody -ContentType "</span><span class="n">application</span><span class="o">/</span><span class="n">json</span><span class="s2">"&lt;br /&gt;</span></pre></td></tr></tbody></table></code></pre></figure></p>
<p>You could also use <a href="https://docs.microsoft.com/en-us/powershell/module/Microsoft.PowerShell.Utility/Invoke-RestMethod?view=powershell-5.1" target="_blank" rel="noopener noreferrer">Invoke-RestMethod</a> instead of Invoke-WebRequest. The resulting tables should look like this:</p>
<p><a href="/assets/img/2018/02/storage4-1.png"><img src="/assets/img/2018/02/storage4-1.png" style="width:300px;height:144px;" /></a></p>
<p style="text-align: left;">Credit to&nbsp;a couple of Stack Overflow posts that were really helpful&nbsp;when I was trying to figure this out:</p>
<ul>
<li style="text-align: left;"><a href="https://stackoverflow.com/questions/42792430/adding-azure-table-entity-with-powershell-with-rest-api" target="_blank" rel="noopener noreferrer">Here</a></li>
<li style="text-align: left;"><a href="https://stackoverflow.com/questions/47214227/powershell-invoke-restmethod-error-415-unsupported-media-type" target="_blank" rel="noopener noreferrer">Here</a></li>
</ul>



        
            <p><a href="/2018/02/fun-with-azure-automation-and-table-service-rest-api" role="button">Read More</a></p>
        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Fun with Azure Automation and Table Service REST API&p[summary]=I love PowerShell and I really love to automate things! I recently started looking into leveraging Azure services for some automation tas...&p[url]=http://172.16.7.177:4000/2018/02/fun-with-azure-automation-and-table-service-rest-api" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2018/02/fun-with-azure-automation-and-table-service-rest-api&text=I love PowerShell and I really love to automate things! I recently started looking into leveraging Azure services for some automation tas...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2017-10-10T12:53:25-05:00" itemprop="datePublished">10 Oct, 2017</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2017/10/the-cloud-architects-podcast">The Cloud Architects Podcast</a></h2>
    </header>

    <div class="post-content">
        <p>Better late than never.. I'm delighted to annouce that I'll be joining <a href="http://thearchitects.cloud" target="_blank" rel="noopener noreferrer">The Cloud Architects Podcast</a> as a co-host. Started by fellow MVPs <a href="https://twitter.com/nicolasblank" target="_blank" rel="noopener noreferrer">Nicolas Blank</a> and <a href="https://twitter.com/warrendt" target="_blank" rel="noopener noreferrer">Warren du Toit</a>, the Cloud Architects podcast is about best practice, guidance, news and cutting edge Microsoft cloud technologies - I'm really excited to be involved.</p>
<p>Microsoft&nbsp;Ignite gave us a great opportunity to connect with and talk to some really interesting people - those episodes will be published soon, but in the meantime, we recently recorded in introductory episode where we talk about some of the complexities of adopting cloud technologies at scale:</p>
<iframe width="100%" height="300" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/352195508&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"></iframe>
<p>&nbsp;</p>
<p>For more information about the podcast, <a href="http://thearchitects.cloud" target="_blank" rel="noopener noreferrer">visit us on the web</a> or <a href="https://twitter.com/theCloudArch" target="_blank" rel="noopener noreferrer">twitter</a>. We are still getting started and experimenting with show formats, etc. and would love feedback so feel free to get in touch and let us know how we are doing.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=The Cloud Architects Podcast&p[summary]=Better late than never.. I'm delighted to annouce that I'll be joining The Cloud Architects Podcast as a co-host. Started by fellow MVPs ...&p[url]=http://172.16.7.177:4000/2017/10/the-cloud-architects-podcast" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2017/10/the-cloud-architects-podcast&text=Better late than never.. I'm delighted to annouce that I'll be joining The Cloud Architects Podcast as a co-host. Started by fellow MVPs ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2015-10-29T10:34:43-05:00" itemprop="datePublished">29 Oct, 2015</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2015/10/my-connect-exo-ps1-script-has-been-updated">My Connect-EXO.ps1 script has been updated!</a></h2>
    </header>

    <div class="post-content">
        <p>I recently published an updated version of my Connect-EXO.ps1 script. Version 3.0 includes the option to connect to Azure AD. Based on the options selected it will connect to either or both services, here is a screenshot of the new interface:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/10/Capture.png"><img title="Capture" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="Capture" src="http://www.cgoosen.com/wp-content/uploads/2015/10/Capture_thumb.png" width="507" height="336"></a></p>
<p>The update has been published to the TechNet Gallery, <a href="http://cgoo.se/1srvTiS">it can be downloaded by clicking here&hellip;</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=My Connect-EXO.ps1 script has been updated!&p[summary]=I recently published an updated version of my Connect-EXO.ps1 script. Version 3.0 includes the option to connect to Azure AD. Based on th...&p[url]=http://172.16.7.177:4000/2015/10/my-connect-exo-ps1-script-has-been-updated" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2015/10/my-connect-exo-ps1-script-has-been-updated&text=I recently published an updated version of my Connect-EXO.ps1 script. Version 3.0 includes the option to connect to Azure AD. Based on th...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2015-06-25T02:56:27-05:00" itemprop="datePublished">25 Jun, 2015</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2015/06/upgrading-to-azure-ad-connect">Upgrading to Azure AD Connect</a></h2>
    </header>

    <div class="post-content">
        <p>It&rsquo;s here! <a href="http://blogs.technet.com/b/ad/archive/2015/06/24/azure-ad-connect-amp-connect-health-is-now-ga.aspx" target="_blank">Yesterday, Microsoft announced</a> the general availability of Azure AD Connect (AAD Connect). Over the years the humble DirSync tool has evolved and AAD Connect is the simplest way yet to integrate on-premises AD identities with Azure Active Directory. There has been a lot of confusion out there about which tool to use for directory synchronization but Microsoft has been hard at work on one tool to rule them all and as noted on the Microsoft Azure site, this tool is AAD Connect:</p>
<blockquote><p><em>Azure AD Connect incorporates the components and functionality previously released as Dirsync and AAD Sync. These tools are no longer being released individually, and all future improvements will be included in updates to Azure AD Connect, so that you always know where to get the most current functionality.</em></p>
</blockquote>
<p>One of the great features of AAD Connect is that it will upgrade your existing deployment of DirSync or AAD Sync, it&rsquo;s a simple wizard and 5 clicks away!</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/06/22.png"><img title="2" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="2" src="http://www.cgoosen.com/wp-content/uploads/2015/06/2_thumb2.png" width="543" height="383"></a></p>
<p align="left"><a href="https://azure.microsoft.com/en-us/documentation/articles/active-directory-aadconnect/" target="_blank">Click here for more</a> Azure AD Connect information and resources.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Upgrading to Azure AD Connect&p[summary]=It&rsquo;s here! Yesterday, Microsoft announced the general availability of Azure AD Connect (AAD Connect). Over the years the humble Dir...&p[url]=http://172.16.7.177:4000/2015/06/upgrading-to-azure-ad-connect" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2015/06/upgrading-to-azure-ad-connect&text=It&rsquo;s here! Yesterday, Microsoft announced the general availability of Azure AD Connect (AAD Connect). Over the years the humble Dir...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2015-03-31T08:47:22-05:00" itemprop="datePublished">31 Mar, 2015</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2015/03/using-azure-scheduler-to-feed-your-pets-sort-of">Using Azure Scheduler to feed your pets (sort of)</a></h2>
    </header>

    <div class="post-content">
        <p>One of the things I learned shortly after we adopted our cat Kensington is that he doesn&rsquo;t care too much about my sleeping habits, if he&rsquo;s hungry he&rsquo;ll happily let us know. I don&rsquo;t have kids and having to wake up in the early hours of the morning to feed a hungry cat was a troubling proposition so I thought I'd&nbsp;find a better way. After some thought, I decided we needed a automated pet feeder but I wasn&rsquo;t able to find a commercially available one that met my criteria so I had to make my own which ended up being a really fun project.</p>
<p>My pet feeder had the following requirements:</p>
<ul>
<li>It had to be internet enabled</li>
<li>It needed Wi-Fi connectivity so it could be more portable</li>
<li>It needed to be small and not an eyesore</li>
<li>It needed to support scheduling as well as&nbsp;manual operation</li>
</ul>
<p>I found a few ideas online (it seems my situation isn&rsquo;t unique!) but yet again none of them met my criteria. After a lot of thought, I settled on a design that I thought would be functional and give me the flexibility that I was looking for and off I went to Home Depot to get the material. I ended up with a few lengths of PVC piping of varying sizes and a polycarbonate sheet. For the electronic brain of the feeder I used the following:</p>
<ul>
<li><a href="https://store.spark.io/?product=spark-core" target="_blank">1 x Spark Core</a> (Wi-Fi development board)</li>
<li>1 x Continuous Rotation Servo</li>
<li>1 x Green LED (Feed indicator)</li>
<li>1 x Red LED (Power indicator)</li>
<li>1 x Glue stick (to create a cheap linear actuator)</li>
<li>2 x resistors, some leads and a mini breadboard</li>
</ul>
<p>The idea is that cat food is deposited in the top part of the feeder, the Spark Core drives the actuator which lowers and then raises a platform inside the main pipe chamber. Lowering the actuator exposes the opening &lsquo;elbow&rsquo; in the middle section of the feeder and the food then falls down the smaller section of pipe and is deposited in the bowl. I wanted to ensure that only&nbsp;1-2 cups of food is dispensed and was able to do this by tweaking how wide of an opening is created when the actuator is lowered and how long it is kept open for. To remove any guessing, I added some LEDs to show me what was happening at all times. The red LED is always lit when the feeder is powered on and the green LED only lights up during a feed operation. I played around with various designs for the platform that moves up and down inside the main chamber and ended up creating an angular platform.&nbsp;Here are some pictures of the feeder:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/03/DPP_0002.jpg"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="DPP_0002" src="http://www.cgoosen.com/wp-content/uploads/2015/03/DPP_0002_thumb.jpg" alt="DPP_0002" width="500" height="333" border="0" /></a></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/03/DPP_0003.jpg"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="DPP_0003" src="http://www.cgoosen.com/wp-content/uploads/2015/03/DPP_0003_thumb.jpg" alt="DPP_0003" width="500" height="333" border="0" /></a></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/03/DPP_0005.jpg"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="DPP_0005" src="http://www.cgoosen.com/wp-content/uploads/2015/03/DPP_0005_thumb.jpg" alt="DPP_0005" width="500" height="333" border="0" /></a></p>
<p align="left">Operating the feeder is done by interacting with the Spark Core via the Spark API. Before this can be done, the board first has to have the relevant operating instructions flashed to it and I put together the following to achieve this:</p>
<p>[shell]<br />
Servo myServo;&nbsp; // create servo object to control a servo<br />
int redLed = D0; // red power LED on pin D0<br />
int greenLed = D1; //green feed LED on pin D1</p>
<p>void setup()<br />
{<br />
myServo.attach(A0);&nbsp; // attaches the servo on the pin A0</p>
<p>Spark.function("feed", feedKenny);&nbsp;&nbsp; // register the function</p>
<p>pinMode(redLed, OUTPUT);<br />
pinMode(greenLed, OUTPUT);<br />
}</p>
<p>void loop()<br />
{<br />
digitalWrite(redLed, HIGH); // red LED always on<br />
}</p>
<p>int feedKenny(String command)&nbsp; //called upon a matching POST request<br />
{<br />
digitalWrite(greenLed, HIGH); // turn on green LED when feeding<br />
myServo.writeMicroseconds(1000);<br />
delay(7500);<br />
myServo.writeMicroseconds(1500);<br />
delay(2500);<br />
myServo.writeMicroseconds(2000);<br />
delay(7500);<br />
myServo.writeMicroseconds(1500);<br />
digitalWrite(greenLed, LOW); // turn off green LED<br />
return 200;<br />
}<br />
[/shell]</p>
<p>Once the Spark Core is connected to the Wi-Fi network and the application code has been flashed you can interact with it using a regular HTTP POST. For testing, you can use PowerShell and Invoke-RestMethod to do this:</p>
<p>[ps]<br />
Invoke-RestMethod -Uri 'https://api.spark.io/v1/devices/YOUR-DEVICE-ID/FUNCTION?access_token=YOUR-TOKEN' -Method Post<br />
[/ps]</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/03/pscap.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="pscap" src="http://www.cgoosen.com/wp-content/uploads/2015/03/pscap_thumb.png" alt="pscap" width="550" height="128" border="0" /></a></p>
<p align="left">PowerShell is great for testing, but not very practical for daily use, fortunately this is easily remedied with a few lines for HTML code. I created a very simple form and put it on web server on my home network. This page is not secured and is only accessible when I&rsquo;m on my home network.</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/03/wp_ss_20150331_00021.jpg"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="wp_ss_20150331_0002" src="http://www.cgoosen.com/wp-content/uploads/2015/03/wp_ss_20150331_0002_thumb1.jpg" alt="wp_ss_20150331_0002" width="220" height="387" border="0" /></a></p>
<p align="left">Scheduling regular feeding times is really easy with <a href="http://azure.microsoft.com/en-us/services/scheduler/" target="_blank">Azure Scheduler.</a> Sign in to your Azure subscription and click &lsquo;Scheduler&rsquo;</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/03/sched1.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="sched1" src="http://www.cgoosen.com/wp-content/uploads/2015/03/sched1_thumb.png" alt="sched1" width="550" height="115" border="0" /></a></p>
<p align="left">Create a new Job Collection and give it a meaningful name</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2015/03/image.png"><img style="background-image: none; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; margin-right: auto; border: 0px;" title="image" src="http://www.cgoosen.com/wp-content/uploads/2015/03/image_thumb.png" alt="image" width="240" height="223" border="0" /></a></p>
<p align="left">The wizard will also give you&nbsp;the option of creating your first Job. Since the Spark API requires a HTTPS POST, be sure to select that option and schedule it accordingly</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/03/sched2.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="sched2" src="http://www.cgoosen.com/wp-content/uploads/2015/03/sched2_thumb.png" alt="sched2" width="228" height="240" border="0" /></a></p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/03/sched3.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="sched3" src="http://www.cgoosen.com/wp-content/uploads/2015/03/sched3_thumb.png" alt="sched3" width="240" height="230" border="0" /></a></p>
<p align="left">Once the wizard completes, you can add more Jobs to the Job Collection as appropriate:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2015/03/sched4.png"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="sched4" src="http://www.cgoosen.com/wp-content/uploads/2015/03/sched4_thumb.png" alt="sched4" width="240" height="48" border="0" /></a></p>
<p align="left">Here is a quick demonstration of how the feeder works:</p>
<p>[embed]https://www.youtube.com/watch?v=O226R01mmD0[/embed]</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Using Azure Scheduler to feed your pets (sort of)&p[summary]=One of the things I learned shortly after we adopted our cat Kensington is that he doesn&rsquo;t care too much about my sleeping habits, ...&p[url]=http://172.16.7.177:4000/2015/03/using-azure-scheduler-to-feed-your-pets-sort-of" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2015/03/using-azure-scheduler-to-feed-your-pets-sort-of&text=One of the things I learned shortly after we adopted our cat Kensington is that he doesn&rsquo;t care too much about my sleeping habits, ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

            </main>
        </div>

        <script src="http://172.16.7.177:4000/assets/js/jquery-1.12.2.min.js"></script>
<script src="http://172.16.7.177:4000/assets/js/backtotop.js"></script>
<script src="http://172.16.7.177:4000/assets/js/lunr.min.js"></script>
<script src="http://172.16.7.177:4000/assets/js/lunr-feed.js"></script>
<script src="http://172.16.7.177:4000/assets/js/jquery.fitvids.js"></script>
<script src="http://172.16.7.177:4000/assets/js/svg4everybody.min.js"></script>
<script src="http://172.16.7.177:4000/assets/js/scripts.js"></script>


    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-XXXXXXX-2', 'auto');
        ga('send', 'pageview');
    </script>

        <style>
.lightbox {width: 100%; height: 100%; position: fixed; top: 0; left: 0; background: rgba(0,0,0,0.85); z-index: 9999999; line-height: 0; cursor: pointer;}
.lightbox .img {
	position: relative; 
	top: 50%;
	left: 50%;
	-ms-transform: translateX(-50%) translateY(-50%);
	-webkit-transform: translate(-50%,-50%);
	transform: translate(-50%,-50%);
	max-width: 100%;
	max-height: 100%;
}
.lightbox .img img {opacity: 0; pointer-events: none; width: auto;}
@media screen and (min-width: 1200px) {
    .lightbox .img {
		max-width: 1200px;
    }
}
@media screen and (min-height: 1200px) {
    .lightbox img {
		max-height: 1200px;
	}
}
.lightbox span {display: block; position: fixed; bottom: 13px; height: 1.5em; line-height: 1.4em; width: 100%; text-align: center; color: white; text-shadow:
    -1px -1px 0 #000,
    1px -1px 0 #000,
    -1px 1px 0 #000,
    1px 1px 0 #000;  
}






.lightbox .videoWrapperContainer {
	position: relative; 
	top: 50%;
	left: 50%;
	-ms-transform: translateX(-50%) translateY(-50%);
	-webkit-transform: translate(-50%,-50%);
	transform: translate(-50%,-50%);
	max-width: 900px;
	max-height: 100%;
}
.lightbox .videoWrapperContainer .videoWrapper {
	height: 0;
	line-height: 0;
	margin: 0;
	padding: 0;
	position: relative;
	padding-bottom: 56.333%; /* custom */
	background: black;
} 
.lightbox .videoWrapper iframe {
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
	border: 0;
	display: block;
}   
.lightbox #prev, .lightbox #next {height: 50px; line-height: 36px; display: none; margin-top: -25px; position: fixed; top: 50%; padding: 0 15px; cursor: pointer; text-decoration: none; z-index: 99; color: white; font-size: 60px;}
.lightbox.gallery #prev, .lightbox.gallery #next {display: block;}
.lightbox #prev {left: 0;}
.lightbox #next {right: 0;}
.lightbox #close {height: 50px; width: 50px; position: fixed; cursor: pointer; text-decoration: none; z-index: 99; right: 0; top: 0;}
.lightbox #close:after, .lightbox #close:before {position: absolute; margin-top: 22px; margin-left: 14px; content: ""; height: 3px; background: white; width: 23px;
-webkit-transform-origin: 50% 50%;
-moz-transform-origin: 50% 50%;
-o-transform-origin: 50% 50%;
transform-origin: 50% 50%;
/* Safari */
-webkit-transform: rotate(-45deg);
/* Firefox */
-moz-transform: rotate(-45deg);
/* IE */
-ms-transform: rotate(-45deg);
/* Opera */
-o-transform: rotate(-45deg);
}
.lightbox #close:after {
/* Safari */
-webkit-transform: rotate(45deg);
/* Firefox */
-moz-transform: rotate(45deg);
/* IE */
-ms-transform: rotate(45deg);
/* Opera */
-o-transform: rotate(45deg);
}
.lightbox, .lightbox * {
    -webkit-user-select: none;  
    -moz-user-select: none;    
    -ms-user-select: none;      
    user-select: none;
}
</style>
		
<script>
function is_youtubelink(url) {
  var p = /^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/;
  return (url.match(p)) ? RegExp.$1 : false;
}
function is_imagelink(url) {
	var p = /([a-z\-_0-9\/\:\.]*\.(jpg|jpeg|png|gif))/i;
	return (url.match(p)) ? true : false;
}
function is_vimeolink(url,el) {
	var id = false;
	$.ajax({
	  url: 'https://vimeo.com/api/oembed.json?url='+url,
	  async: true,
	  success: function(response) {
		if(response.video_id) {
		  id = response.video_id;
		  $(el).addClass('lightbox-vimeo').attr('data-id',id);
		}
	  }
	});
}

$(document).ready(function() {
	//add classes to links to be able to initiate lightboxes
	$("a").each(function(){
		var url = $(this).attr('href');
		if(url) {
			if(url.indexOf('vimeo') !== -1 && !$(this).hasClass('no-lightbox')) is_vimeolink(url,$(this));
			if(is_youtubelink(url) && !$(this).hasClass('no-lightbox')) $(this).addClass('lightbox-youtube').attr('data-id',is_youtubelink(url));
			if(is_imagelink(url) && !$(this).hasClass('no-lightbox')) {
				$(this).addClass('lightbox-image');
				var href = $(this).attr('href');
				var filename = href.split('/').pop();
				var split = filename.split(".");
				var name = split[0];
				$(this).attr('title',name);
			}
		}
	});
	//remove the clicked lightbox
	$("body").on("click", ".lightbox", function(event){
		if($(this).hasClass('gallery')) {
			$(this).remove();
			if($(event.target).attr('id')=='next') {
				//next item
				if($("a.gallery.current").nextAll("a.gallery:first").length) $("a.gallery.current").nextAll("a.gallery:first").click();
				else $("a.gallery.current").parent().find("a.gallery").first().click();
			}
			else if ($(event.target).attr('id')=='prev') {
				//prev item
				if($("a.gallery.current").prevAll("a.gallery:first").length) $("a.gallery.current").prevAll("a.gallery:first").click();
				else $("a.gallery.current").parent().find("a.gallery").last().click();
			}
			else {
				$("a.gallery").removeClass('gallery');
			}
		}
		else $(this).remove();
	});
	//prevent image from being draggable (for swipe)
	$("body").on('dragstart', ".lightbox img", function(event) { event.preventDefault(); });
	//add the youtube lightbox on click
	$("a.lightbox-youtube").click(function(event){
		event.preventDefault();
		$('<div class="lightbox"><a id="close"></a><a id="next">&rsaquo;</a><a id="prev">&lsaquo;</a><div class="videoWrapperContainer"><div class="videoWrapper"><iframe src="https://www.youtube.com/embed/'+$(this).attr('data-id')+'?autoplay=1&showinfo=0&rel=0"></iframe></div></div></div>').appendTo('body');
	});
	//add the image lightbox on click
	$("a.lightbox-image").click(function(event){
		event.preventDefault();
		$('<div class="lightbox"><a id="close"></a><a id="next">&rsaquo;</a><a id="prev">&lsaquo;</a><div class="img" style="background: url('+$(this).attr('href')+') center center / contain no-repeat;" title="'+$(this).attr('title')+'" ><img src="'+$(this).attr('href')+'" alt="'+$(this).attr('title')+'" /></div><span>'+$(this).attr('title')+'</span></div>').appendTo('body');
	});
	//add the vimeo lightbox on click
	$("body").on("click", "a.lightbox-vimeo", function(event){
		event.preventDefault();
		$('<div class="lightbox"><a id="close"></a><a id="next">&rsaquo;</a><a id="prev">&lsaquo;</a><div class="videoWrapperContainer"><div class="videoWrapper"><iframe src="https://player.vimeo.com/video/'+$(this).attr('data-id')+'/?autoplay=1&byline=0&title=0&portrait=0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div></div></div>').appendTo('body');
	});

	$("body").on("click", "a[class*='lightbox-']", function(){
		var link_elements = $(this).parent().find("a[class*='lightbox-']");
		$(link_elements).removeClass('current');
		for (var i=0; i<link_elements.length; i++) {
			if($(this).attr('href') == $(link_elements[i]).attr('href')) {
				$(link_elements[i]).addClass('current');
			}
		}
		if(link_elements.length>1) {
			$('.lightbox').addClass('gallery');
			$(link_elements).addClass('gallery');
		}
	});

	
});

$(document).keydown(function(e) {
    switch(e.which) {
        case 37: // left
        $("#prev").click();
        break;
        case 39: // right
        $("#next").click();
        break;
	case 27: // esc
        $("#close").click();
        break;
        default: return; // exit this handler for other keys
    }
    e.preventDefault(); // prevent the default action (scroll / move caret)
});

  /*===========================
  Swipe-it v1.4.1
  An event listener for swiping gestures with vanilla js.
  https://github.com/tri613/swipe-it#readme
 
  @Create 2016/09/22
  @Update 2017/08/11
  @Author Trina Lu
  ===========================*/
  "use strict";var _slicedToArray=function(){function n(n,t){var e=[],i=!0,o=!1,r=void 0;try{for(var u,c=n[Symbol.iterator]();!(i=(u=c.next()).done)&&(e.push(u.value),!t||e.length!==t);i=!0);}catch(n){o=!0,r=n}finally{try{!i&&c.return&&c.return()}finally{if(o)throw r}}return e}return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();!function(n,t,e){function i(n){function e(){o("touchstart",m,w),o("touchmove",d,w),o("touchend",p,w),E.mouseEvent&&o("mousedown",s,w)}function i(){y=!1,D=!1,A=!1,b=!1,a=!1}function s(n){a=this,y=n.clientX,D=n.clientY,o("mousemove",l,v),o("mouseup",h,v)}function l(n){n.preventDefault(),y&&D&&(A=n.clientX,b=n.clientY)}function h(n){r("mousemove",l,v),r("mouseup",h,v),p(n)}function m(n){a=this,y=n.touches[0].clientX,D=n.touches[0].clientY}function d(n){A=n.touches[0].clientX,b=n.touches[0].clientY}function p(n){if(y&&D&&A&&b){var t=y-A,e=D-b,o=[t,e].map(Math.abs),r=_slicedToArray(o,2),c=r[0],s=r[1],v=E.minDistance;if(c>v){var f=y<A?"swipeRight":"swipeLeft";u(f,a,{distance:t,start:y,end:A})}if(s>v){var l=D>b?"swipeUp":"swipeDown";u(l,a,{distance:e,start:D,end:b})}(c>v||s>v)&&u("swipe",a)}i()}var E=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},w=c(t.querySelectorAll(n)),y=void 0,D=void 0,A=void 0,b=void 0;E.mouseEvent=void 0===E.mouseEvent?f.mouseEvent:E.mouseEvent,E.minDistance=void 0===E.minDistance?f.minDistance:E.minDistance,i(),e(),this.on=function(n,t){return o(n,t,w),this}}function o(n,t,e){s(e).forEach(function(e){return e.addEventListener(n,t)})}function r(n,t,e){s(e).forEach(function(e){return e.removeEventListener(n,t)})}function u(n,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=t.createEvent("Event");o.initEvent(n,!0,!0),o.swipe=i,s(e).forEach(function(n){return n.dispatchEvent(o)})}function c(n){for(var t=[],e=0;e<n.length;e++)t.push(n[e]);return t}function s(n){return Array.isArray(n)?n:[n]}var a=!1,v=[n],f={mouseEvent:!0,minDistance:30};n[e]=i}(window,document,"SwipeIt");

var mySwipeIt = new SwipeIt('body');
mySwipeIt.on('swipeLeft',function(e){
	//check if lightbox is present
	if($('.lightbox').length >  0 ) {
		$("#next").click();
	}
}).on('swipeRight',function(e){
	//check if lightbox is present
	if($('.lightbox').length >  0 ) {
		$("#prev").click();
	}
});
</script>

    </body>
</html>