<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title> Chris&#39;s Blog &mdash; It&#39;s called thinking...  go with it! </title>
    <meta property="og:title" content=" Chris&#39;s Blog &mdash; It&#39;s called thinking...  go with it! " />
    <meta name="twitter:title" content=" Chris&#39;s Blog &mdash; It&#39;s called thinking...  go with it! " />

    <meta name="description" content="">
    <meta name="description" property="og:description" content="" />
    <meta name="twitter:description" content="" />

    <meta name="twitter:card" content="summary_large_image" />
    
    <meta name="twitter:site" content="@chrisgoosen" />
    
    <meta property="og:url" content="http://172.16.7.177:4000/page12/" />

    <meta property="og:image" content="" />
    <meta name="twitter:image" content="" />

    <meta name="author" content="Chris's Blog" />

    <meta name="copyright" content="Copyright by Chris's Blog. All Rights Reserved." />

    <style>
        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 300;
            src: local('Roboto Light'), local('Roboto-Light'), url(https://fonts.gstatic.com/s/roboto/v15/Hgo13k-tfSpn0qi1SFdUfVtXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 400;
            src: local('Roboto'), local('Roboto-Regular'), url(https://fonts.gstatic.com/s/roboto/v15/CWB0XYA8bzo0kSThX0UTuA.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 700;
            src: local('Roboto Bold'), local('Roboto-Bold'), url(https://fonts.gstatic.com/s/roboto/v15/d-6IYplOFocCacKzxwXSOFtXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: normal;
            font-weight: 900;
            src: local('Roboto Black'), local('Roboto-Black'), url(https://fonts.gstatic.com/s/roboto/v15/mnpfi9pxYH-Go5UiibESIltXRa8TVwTICgirnJhmVJw.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 300;
            src: local('Roboto Light Italic'), local('Roboto-LightItalic'), url(https://fonts.gstatic.com/s/roboto/v15/7m8l7TlFO-S3VkhHuR0at44P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 400;
            src: local('Roboto Italic'), local('Roboto-Italic'), url(https://fonts.gstatic.com/s/roboto/v15/vPcynSL0qHq_6dX7lKVByfesZW2xOQ-xsNqO47m55DA.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 700;
            src: local('Roboto Bold Italic'), local('Roboto-BoldItalic'), url(https://fonts.gstatic.com/s/roboto/v15/t6Nd4cfPRhZP44Q5QAjcC44P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }

        @font-face {
            font-family: 'Roboto';
            font-style: italic;
            font-weight: 900;
            src: local('Roboto Black Italic'), local('Roboto-BlackItalic'), url(https://fonts.gstatic.com/s/roboto/v15/bmC0pGMXrhphrZJmniIZpY4P5ICox8Kq3LLUNMylGO4.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
        }
    </style>
    
    <link href="/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    
    <link rel="stylesheet" href="http://172.16.7.177:4000/assets/css/main.css">

    <link rel="canonical" href="http://172.16.7.177:4000/page12/">

    <link rel="alternate" type="application/rss+xml" title="" href="http://172.16.7.177:4000/feed.xml">
</head>

    <body>
        <div class="wrapper">
            <aside class="user-profile fixed" role="complementary">
    <div class="burger">
        <input class="trigger hidden" id="toggleBurger" type="checkbox" />
        <label for="toggleBurger">
            <span>Navigation</span>
        </label>
    </div>

    <div class="compact-header">
        <a class="avatar" href="http://172.16.7.177:4000"><img alt="Avatar" src="/assets/img/headshot.jpg" /></a>
        <div class="my-info">
            <strong class="my-name">Chris's Blog</strong>
            <span class="my-job-title">It's called thinking...  go with it!</span>
        </div>
    </div>

    
        
        <div class="mainmenu">
            <a href="http://172.16.7.177:4000" >Home</a>
            
                
            
                
            
                
                    <a href="http://172.16.7.177:4000/contact/" >Contact</a>
                
            
                
                    <a href="http://172.16.7.177:4000/about/" >About</a>
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
        </div>
        
    
    
    <div>
    	<img src="/assets/img/mvp.png" style="width:181px;height:74px;">
    </div>

    <p class="about-me"> </p>
    
    <ul class="socials">
        <li><a href="https://twitter.com/chrisgoosen" target="_blank"><svg title="twitter" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li><li><a href="https://www.linkedin.com/in/ctgoosen/" target="_blank"><svg title="linkedin" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#linkedin-icon"></use></svg></a></li><li><a href="https://github.com/cgoosen" target="_blank"><svg title="github" width="16" height="16" ><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#github-icon"></use></svg></a></li>

        
            <li><a href="/contact" target="_blank"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#email-icon"></use></svg></a></li>
        

        
         <li><a href="http://feeds.cgoosen.com/cgoosen"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#rss-icon"></use></svg></a></li>
        
    </ul>
</aside>


            <main class="the-content" role="main">
                <div class="search" role="search">
    <div>
        <div class="show-results-count">0 Results</div>
        <div class="search-holder">
            <input type="text" id="search-input" placeholder="search for..." />
        </div>
    </div>
    <ul id="results-container" class="results-container"></ul>
</div>


                
<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2012-01-04T08:42:53-06:00" itemprop="datePublished">4 Jan, 2012</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2012/01/exchange-2010-anonymous-relay-receive-connector">Exchange 2010 &ldquo;Anonymous Relay&rdquo; Receive Connector</a></h2>
    </header>

    <div class="post-content">
        <p>In almost every environment I have ever seen there are usually some devices and/or systems that need to send email and typically these will require some SMTP server to relay these messages. More often than not these also do not have the ability to authenticate to the relaying host.</p>
<p>How do we deal with these in Exchange? I have seen some pretty silly solutions and the default answer seems to be &ldquo;Just allow anonymous users on the default connector&rdquo;. This is not true and is actually quite a dangerous thing to do, so my advice is DON&rsquo;T. In fact, I would go so far as to say, don&rsquo;t ever touch the default connector. The correct way is to create a new receive connector and allow relay from only the devices that are required to use this connector.</p>
<p>Allowing anonymous relay is serious and requires thought and planning. If could be exploited by spammers and IMHO should not be configured on internet-facing servers.</p>
<p>So lets say that we have three devices that need to relay anonymously, their IPs are 10.0.0.30, 10.0.0.31 and 10.0.0.32. First we need to create a new receive connector:</p>
<blockquote><p><span style="font-family: 'Courier New';">New-ReceiveConnector -Name "Anonymous Relay Connector" -Usage Custom -PermissionGroups AnonymousUsers -Bindings 10.0.0.20:25 -RemoteIpRanges 10.0.0.30-10.0.0.32 &ndash;Banner "220 Anonymous Relay Connector"</span></p></blockquote>
<p>Next we need to to grant relay permission to anonymous connections on the new Receive connector:</p>
<blockquote><p><span style="font-family: 'Courier New';">Get-ReceiveConnector -Identity "Anonymous Relay Connector" | Add-ADPermission -User "NT AUTHORITY\ANONYMOUS LOGON" -ExtendedRights "Ms-Exch-SMTP-Accept-Any-Recipient"</span></p></blockquote>
<p>What happens if you have multiple servers and would like to duplicate your receive connector settings. Say for example you have two Exchange servers and you have a receive connector on a server called EXHUB01 that allows 100 devices to relay. You would now like to create the same connector on EXHUB02. Instead of manually adding each address, you could do this:</p>
<blockquote><p><span style="font-family: 'Courier New';">New-ReceiveConnector "Anonymous Relay Connector" -Server EXHUB02 -Usage Custom -PermissionGroups AnonymousUsers -Bindings 10.0.0.21:25 -RemoteIPRanges ( Get-ReceiveConnector "EXHUB01\Anonymous Relay Connector" ).RemoteIPRanges -Banner "220 Anonymous Relay Connector"</span></p></blockquote>
<p>Don&rsquo;t forget to grant relay permission to anonymous connections on the new Receive connector:</p>
<blockquote><p><span style="font-family: 'Courier New';">Get-ReceiveConnector -Identity "EXHUB02\Anonymous Relay Connector" | Add-ADPermission -User "NT AUTHORITY\ANONYMOUS LOGON" -ExtendedRights "Ms-Exch-SMTP-Accept-Any-Recipient"</span></p></blockquote>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2010 &ldquo;Anonymous Relay&rdquo; Receive Connector&p[summary]=In almost every environment I have ever seen there are usually some devices and/or systems that need to send email and typically these wi...&p[url]=http://172.16.7.177:4000/2012/01/exchange-2010-anonymous-relay-receive-connector" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2012/01/exchange-2010-anonymous-relay-receive-connector&text=In almost every environment I have ever seen there are usually some devices and/or systems that need to send email and typically these wi...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-12-23T12:56:12-06:00" itemprop="datePublished">23 Dec, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/12/exchange-2010-service-pack-2-sp2">Exchange 2010 Service Pack 2 (SP2)</a></h2>
    </header>

    <div class="post-content">
        <p>Just in case you missed it, Exchange 2010 SP2 was released earlier this month. The following features and functionality has changed since Service Pack 1 for Exchange 2010:</p>
<ul>
<li>Hybrid Configuration Wizard </li>
<li>Address Book Policies </li>
<li>Cross-Site Silent Redirection for Outlook Web App </li>
<li>Mini Version of Outlook Web App </li>
<li>Mailbox Replication Service </li>
<li>Mailbox Auto-Mapping </li>
<li>Multi-Valued Custom Attributes </li>
<li>Litigation Hold</li>
</ul>
<p>I wanted to call out a couple of these that I have been eagerly awaiting:</p>
<p><strong>Hybrid Configuration Wizard     <br /></strong>Exchange 2010 SP2 introduces the Hybrid Configuration Wizard which provides you with a streamlined process to configure a hybrid deployment between on-premises and Office 365 Exchange organizations. Hybrid deployments provide the seamless look and feel of a single Exchange organization and offer administrators the ability to extend the feature-rich experience and administrative control of an on-premises organization to the cloud.</p>
<p><strong>Cross-Site Silent Redirection for Outlook Web App</strong>    <br />In Exchange 2010 SP1, there was three types of redirection for OWA in Exchange 2010 on-premises:</p>
<ul>
<li>Manual Redirection </li>
<li>Temporary Manual Redirection </li>
<li>Legacy Silent Redirection (for Exchange 2003/2007)</li>
</ul>
<p>With Exchange 2010 SP2, you can enable a silent redirection when a Client Access server receives a client request that is better serviced by a Client Access server located in another Active Directory site. This silent redirection can also provide a single sign-on experience when forms-based authentication is enabled on each Client Access server.</p>
<p>For more information about what&rsquo;s new in Exchange 2010 SP2, <a href="http://technet.microsoft.com/en-us/library/hh529924.aspx" target="_blank">click here</a></p>
<p>To download Exchange 2010 SP2, <a href="http://www.microsoft.com/download/en/details.aspx?displaylang=en&amp;id=28190" target="_blank">click here</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2010 Service Pack 2 (SP2)&p[summary]=Just in case you missed it, Exchange 2010 SP2 was released earlier this month. The following features and functionality has changed since...&p[url]=http://172.16.7.177:4000/2011/12/exchange-2010-service-pack-2-sp2" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/12/exchange-2010-service-pack-2-sp2&text=Just in case you missed it, Exchange 2010 SP2 was released earlier this month. The following features and functionality has changed since...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-11-02T07:28:12-05:00" itemprop="datePublished">2 Nov, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/11/microsoft-online-services-internet-connection-performance-test">Microsoft Online Services Internet Connection Performance Test</a></h2>
    </header>

    <div class="post-content">
        <p>This handy little tool has been around for some time now but I&rsquo;ve found that it does not seem to be very well known so I thought I would write up a quick post.</p>
<blockquote><p>This performance tool tests your Internet connection to a Microsoft Online Services data center and measures the response times, bandwidth, and overall connection quality. The results can help you evaluate your network configuration for potential use with Microsoft Online Services.</p>
</blockquote>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2011/11/image.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2011/11/image_thumb.png" width="544" height="368" /></a></p>
<p>For America use <a href="http://speedtest.microsoftonline.com" target="_blank">http://speedtest.microsoftonline.com</a></p>
<p>For Asia Pacific use <a href="http://speedtest.apac.microsoftonline.com" target="_blank">http://speedtest.apac.microsoftonline.com</a></p>
<p>For Europe, Middle East and Africa use <a href="http://speedtest.emea.microsoftonline.com" target="_blank">http://speedtest.emea.microsoftonline.com</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Microsoft Online Services Internet Connection Performance Test&p[summary]=This handy little tool has been around for some time now but I&rsquo;ve found that it does not seem to be very well known so I thought I ...&p[url]=http://172.16.7.177:4000/2011/11/microsoft-online-services-internet-connection-performance-test" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/11/microsoft-online-services-internet-connection-performance-test&text=This handy little tool has been around for some time now but I&rsquo;ve found that it does not seem to be very well known so I thought I ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-10-28T11:06:23-05:00" itemprop="datePublished">28 Oct, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/10/jetstress-error-the-msexchange-database-or-msexchange-database-instrances-performance-counter-category-isnt-registered">Jetstress Error: The MSExchange Database or MSExchange Database ==> Instrances performance counter category isn't registered</a></h2>
    </header>

    <div class="post-content">
        <p>I recently came across this error while using Jetstress to test and validate the performance of their Exchange storage. I was running the tool on Windows Server 2008 R2 and I don&rsquo;t recall ever seeing this before. After finding what is actually an easy fix, I thought I would&#160; write up this post just in case this has anyone else baffled. The entire error was:</p>
<blockquote><p>Ensure that you&rsquo;re running the application as a member of built-in Administrators security group.</p>
<p>The MSExchange Database or MSExchange Database ==> Instrances performance counter category isn't registered.</p>
</blockquote>
<p><font style="background-color: #eef8ff"><a href="http://www.cgoosen.com/wp-content/uploads/2011/10/jetstress1.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; margin-left: auto; border-top: 0px; margin-right: auto; border-right: 0px; padding-top: 0px" title="jetstress1" border="0" alt="jetstress1" src="http://www.cgoosen.com/wp-content/uploads/2011/10/jetstress1_thumb.png" width="596" height="345" /></a></font></p>
<p>The admin account I was using is a member of the domain admins security group so I assumed I had the correct permissions but went away and checked just to be sure. I also checked to make sure that the domain admins group was a member of the local built-in Administrators security group, which it was. After spending a few minutes thinking about it, I thought I would try running Jetstress &ldquo;as an administrator&rdquo; (right-click the shortcut and select &ldquo;Run as administrator&rdquo;</p>
<p>That solved the problem.</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2011/10/jetstress2.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; margin-left: auto; border-top: 0px; margin-right: auto; border-right: 0px; padding-top: 0px" title="jetstress2" border="0" alt="jetstress2" src="http://www.cgoosen.com/wp-content/uploads/2011/10/jetstress2_thumb.png" width="603" height="329" /></a></p>
<p>I have since checked the Jetstress installation in my Exchange 2010 Lab which also runs on Windows Server 2008 R2 and this step is not required there, it works fine by just clicking the Jetstress shortcut (no right-click required). Not really worth spending time investigating the cause as it may just be a once-off occurrence, but at least it is now documented.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Jetstress Error: The MSExchange Database or MSExchange Database ==> Instrances performance counter category isn't registered&p[summary]=I recently came across this error while using Jetstress to test and validate the performance of their Exchange storage. I was running the...&p[url]=http://172.16.7.177:4000/2011/10/jetstress-error-the-msexchange-database-or-msexchange-database-instrances-performance-counter-category-isnt-registered" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/10/jetstress-error-the-msexchange-database-or-msexchange-database-instrances-performance-counter-category-isnt-registered&text=I recently came across this error while using Jetstress to test and validate the performance of their Exchange storage. I was running the...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-10-14T14:25:26-05:00" itemprop="datePublished">14 Oct, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/10/tech-ed-australia-to-go-moving-email-from-on-premise-into-the-cloud">Tech-Ed Australia To Go: Moving Email from On Premise Into the Cloud</a></h2>
    </header>

    <div class="post-content">
        <p>Toby and I talking about our &ldquo;Microsoft Office 365: From Simple Migration to a Hybrid Environment&rdquo; session at At Tech-Ed Australia 2011.</p>
<div id="scid:5737277B-5D6D-4f48-ABFC-DD9C333F4C5D:7d607b52-f893-4cd2-b511-6cfdf46e7597" class="wlWriterEditableSmartContent" style="margin: 0px auto; width: 542px; display: block; float: none; padding: 0px;">
<div><object width="542" height="304" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"><param name="src" value="http://www.youtube.com/v/JsRlLKN7d8s?hl=en&amp;hd=1" /><embed width="542" height="304" type="application/x-shockwave-flash" src="http://www.youtube.com/v/JsRlLKN7d8s?hl=en&amp;hd=1" /></object></div>
<div style="width: 542px; clear: both; font-size: .8em;">Toby and I talking about our session at At Tech-Ed Australia 2011</div>
</div>
<p>&nbsp;</p>
<p>If you missed it, the recorded session and slides are available for download here: <a href="http://cgoo.se/ndiUkE" target="_blank">http://cgoo.se/ndiUkE</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Tech-Ed Australia To Go: Moving Email from On Premise Into the Cloud&p[summary]=Toby and I talking about our &ldquo;Microsoft Office 365: From Simple Migration to a Hybrid Environment&rdquo; session at At Tech-Ed Aust...&p[url]=http://172.16.7.177:4000/2011/10/tech-ed-australia-to-go-moving-email-from-on-premise-into-the-cloud" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/10/tech-ed-australia-to-go-moving-email-from-on-premise-into-the-cloud&text=Toby and I talking about our &ldquo;Microsoft Office 365: From Simple Migration to a Hybrid Environment&rdquo; session at At Tech-Ed Aust...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-09-28T12:33:17-05:00" itemprop="datePublished">28 Sep, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/09/chriss-blog-now-mobile-friendly">Chris&rsquo;s Blog - Now mobile friendly :)</a></h2>
    </header>

    <div class="post-content">
        <p>This post is slightly off-topic compared to my regular posts, but its something I&rsquo;ve been thinking about for some time now and has been one of those things sitting on my to do list that always gets trumped by something more important. </p>
<p>While my blog has never been inaccessible from mobile devices, I have never really put much thought or effort into improving the experience for mobile users. I was recently reading some interesting statistics on the explosive growth of mobile internet usage and that prompted me to do something about it. These statistics are probably best summarised by this:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2011/09/image.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2011/09/image_thumb.png" width="471" height="408" /></a></p>
<p>You will now be able to access all the same content from your mobile device in a much more mobile friendly manner. And just because I am a geek I&rsquo;ve even added a .mobil domain name so you&rsquo;ll also be able to access it at <a href="http://cgoosen.mobi">http://cgoosen.mobi</a></p>
<p>I also wanted to share this great video that goes into some smartphone mobile marketing statistics. Don&rsquo;t worry.. I don&rsquo;t ever intend on introducing ads or marketing of any kind here, I just think the stats are interesting.</p>
<div style="padding-bottom: 0px; padding-left: 0px; width: 448px; padding-right: 0px; display: block; float: none; margin-left: auto; margin-right: auto; padding-top: 0px" id="scid:5737277B-5D6D-4f48-ABFC-DD9C333F4C5D:cc87ab2e-23f3-484e-8d0c-20621d88a19c" class="wlWriterEditableSmartContent">
<div><object width="448" height="252"><param name="movie" value="http://www.youtube.com/v/xzmQm-hRgTg?hl=en&amp;hd=1"></param><embed src="http://www.youtube.com/v/xzmQm-hRgTg?hl=en&amp;hd=1" type="application/x-shockwave-flash" width="448" height="252"></embed></object></div>
</div>
<p> 
<p><a href="http://www.digitalbuzzblog.com/2011-mobile-statistics-stats-facts-marketing-infographic/" target="_blank">Inforgraphic source</a></p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Chris&rsquo;s Blog - Now mobile friendly :)&p[summary]=This post is slightly off-topic compared to my regular posts, but its something I&rsquo;ve been thinking about for some time now and has ...&p[url]=http://172.16.7.177:4000/2011/09/chriss-blog-now-mobile-friendly" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/09/chriss-blog-now-mobile-friendly&text=This post is slightly off-topic compared to my regular posts, but its something I&rsquo;ve been thinking about for some time now and has ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-09-06T12:33:45-05:00" itemprop="datePublished">6 Sep, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/09/microsoft-future-of-productivity">Microsoft "Future of productivity"</a></h2>
    </header>

    <div class="post-content">
        <p>I recently saw this at Tech-Ed Australia and finally managed <a href="http://cloudthemind.com/2011/03/23/productivity-vision-looking-back-to-get-a-sense-of-today/" target="_blank">to track it down</a> so I could share it. I think it&rsquo;s such a great video and just excites me about the "future of productivity".</p>
<div style="padding-bottom: 0px; padding-left: 0px; width: 554px; padding-right: 0px; display: block; float: none; margin-left: auto; margin-right: auto; padding-top: 0px" id="scid:5737277B-5D6D-4f48-ABFC-DD9C333F4C5D:7e992584-a640-42d8-a110-905625d709d3" class="wlWriterEditableSmartContent">
<div><object width="554" height="310"><param name="movie" value="http://www.youtube.com/v/BU-TGk5JBT4?hl=en&amp;hd=1"></param><embed src="http://www.youtube.com/v/BU-TGk5JBT4?hl=en&amp;hd=1" type="application/x-shockwave-flash" width="554" height="310"></embed></object></div>
</div>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Microsoft "Future of productivity"&p[summary]=I recently saw this at Tech-Ed Australia and finally managed to track it down so I could share it. I think it&rsquo;s such a great video ...&p[url]=http://172.16.7.177:4000/2011/09/microsoft-future-of-productivity" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/09/microsoft-future-of-productivity&text=I recently saw this at Tech-Ed Australia and finally managed to track it down so I could share it. I think it&rsquo;s such a great video ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-08-30T16:57:38-05:00" itemprop="datePublished">30 Aug, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/08/tech-ed-australia-2011-must-see-sessions">Tech-Ed Australia 2011 &ndash; Must see sessions</a></h2>
    </header>

    <div class="post-content">
        <p>After an interesting and somewhat different keynote, Tech-Ed 2011 has officially kicked off. While everyone is enjoying a few cold ones, I thought I would take the time to tell you about some of the sessions I am excited about attending this year.</p>
<p>There are many great speakers at Tech-Ed this year, these are just some of the sessions I plan to attend.</p>
<ul>
<li>EXL310: "Upgrading to Exchange 2010: Notes from Field" with Colin Lee and Sofiane Behraoui</li>
<li>EXL309: "Microsoft Lync 2010: How to go big with voice" with Brendan Carius and Selvan Loganathan</li>
<li>OFS-OFC309: "From Zero to Productivity with Office 365" with Ben Walters, Chris Oconnor and Lee Hickin</li>
<li>EXL303: "Exchange Server 2010: High Availability Concepts" with Scott Schnoll</li>
<li>EXL304: "Load Balancing with Microsoft Exchange Server 2010" with Andrew Ehrensing</li>
</ul>
<p>Then of course there is my session with Toby Knight, EXL-OFC311: &ldquo;Microsoft Office 365: From Simple Migration to a Hybrid Environment&rdquo; we will be in Arena 1B at 5 PM tomorrow&hellip; we&rsquo;ve got some great schwag so make sure you stop by!</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Tech-Ed Australia 2011 &ndash; Must see sessions&p[summary]=After an interesting and somewhat different keynote, Tech-Ed 2011 has officially kicked off. While everyone is enjoying a few cold ones, ...&p[url]=http://172.16.7.177:4000/2011/08/tech-ed-australia-2011-must-see-sessions" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/08/tech-ed-australia-2011-must-see-sessions&text=After an interesting and somewhat different keynote, Tech-Ed 2011 has officially kicked off. While everyone is enjoying a few cold ones, ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-08-25T09:51:17-05:00" itemprop="datePublished">25 Aug, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/08/exchange-2010-you-must-close-all-dialog-boxes-before-you-can-close-exchange-management-console">Exchange 2010 &ldquo;You must close all dialog boxes before you can close Exchange Management Console&rdquo;</a></h2>
    </header>

    <div class="post-content">
        <p>I&rsquo;ve seen this error around a few times over the last while but have never really paid too much attention to it:</p>
<p align="center"><a href="http://www.cgoosen.com/wp-content/uploads/2011/08/image2.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2011/08/image_thumb2.png" width="350" height="131" /></a></p>
<p>It seems it only occurs in the management console if you have IE9 installed on your Exchange 2010 SP1 server. Previously the recommendation was to uninstall IE9 or just live with it. I recently installed <a href="http://www.cgoosen.com/2011/08/update-rollup-5-for-exchange-server-2010-service-pack-1/" target="_blank">Update Rollup 5 for Exchange 2010 SP1</a> in my lab environment and it seems to have fixed this error. </p>
<p>Obviously I would recommend thorough testing before deploying any updates in production, but I thought it would be worth mentioning that it does seem to fix this error as well.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2010 &ldquo;You must close all dialog boxes before you can close Exchange Management Console&rdquo;&p[summary]=I&rsquo;ve seen this error around a few times over the last while but have never really paid too much attention to it:

It seems it only ...&p[url]=http://172.16.7.177:4000/2011/08/exchange-2010-you-must-close-all-dialog-boxes-before-you-can-close-exchange-management-console" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/08/exchange-2010-you-must-close-all-dialog-boxes-before-you-can-close-exchange-management-console&text=I&rsquo;ve seen this error around a few times over the last while but have never really paid too much attention to it:

It seems it only ...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>

<article class="post" role="article" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="post-header">
        <ul>
            <li><time datetime="2011-08-25T09:32:44-05:00" itemprop="datePublished">25 Aug, 2011</time></li>
            
        </ul>
        <h2 itemprop="name headline"><a href="http://172.16.7.177:4000/2011/08/exchange-2010-remote-mailbox-move-to-office-365-microsoft-exchange-critical-error">Exchange 2010 remote mailbox move to Office 365 &ldquo;Microsoft Exchange Critical Error&rdquo;</a></h2>
    </header>

    <div class="post-content">
        <p>I&rsquo;ve been having a problem with remote mailbox moves to Office 365. The move completes successfully and everything works ok, but it always generates the following error:</p>
<p>&ldquo;Could not load type 'Microsoft.Exchange.MailboxReplicationService.RequestPriority'&hellip;&rdquo;</p>
<p><a href="http://www.cgoosen.com/wp-content/uploads/2011/08/image1.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; margin-left: auto; border-top: 0px; margin-right: auto; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://www.cgoosen.com/wp-content/uploads/2011/08/image_thumb1.png" width="395" height="229" /></a></p>
<p>I&rsquo;ve seen this mentioned a few times on the Office 365 community forums and some of my colleagues are also seeing this. The good news is that after installing <a href="http://www.cgoosen.com/2011/08/update-rollup-5-for-exchange-server-2010-service-pack-1/" target="_blank">Update Rollup 5 for Exchange 2010 SP1</a> this error no longer appears.</p>


        
    </div>

    <footer class="post-footer">
        <div class="share">Share
            <ul class="social-networks">
                <li class="share-facebook"><a href="https://www.facebook.com/sharer.php?s=100&p[title]=Exchange 2010 remote mailbox move to Office 365 &ldquo;Microsoft Exchange Critical Error&rdquo;&p[summary]=I&rsquo;ve been having a problem with remote mailbox moves to Office 365. The move completes successfully and everything works ok, but it...&p[url]=http://172.16.7.177:4000/2011/08/exchange-2010-remote-mailbox-move-to-office-365-microsoft-exchange-critical-error" class="s_facebook" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#facebook-icon"></use></svg></a></a></li>
                <li class="share-twitter"><a href="http://twitter.com/share?url=http://172.16.7.177:4000/2011/08/exchange-2010-remote-mailbox-move-to-office-365-microsoft-exchange-critical-error&text=I&rsquo;ve been having a problem with remote mailbox moves to Office 365. The move completes successfully and everything works ok, but it...&hashtags=" rel="noreferrer" target="_blank" onclick="window.open(this.href, '','width=700,height=300');return false;"><svg title="" width="16" height="16"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://172.16.7.177:4000/assets/svg/social-icons.svg#twitter-icon"></use></svg></a></li>
            </ul>
        </div>
        
        <div class="tags">
            <ul>
                
            </ul>
        </div>
        
    </footer>
</article>




<div class="pagination" role="navigation" aria-label="pagination">
    
        <a href="/page11/" class="previous">&larr; Previous</a>
    

    <span class="page_number">Page 12 of 24</span>

    
        <a href="/page13/" class="next">Next &rarr;</a>
    
</div>

            </main>
        </div>

        <script src="http://172.16.7.177:4000/assets/js/jquery-1.12.2.min.js"></script>
<script src="http://172.16.7.177:4000/assets/js/backtotop.js"></script>
<script src="http://172.16.7.177:4000/assets/js/lunr.min.js"></script>
<script src="http://172.16.7.177:4000/assets/js/lunr-feed.js"></script>
<script src="http://172.16.7.177:4000/assets/js/jquery.fitvids.js"></script>
<script src="http://172.16.7.177:4000/assets/js/svg4everybody.min.js"></script>
<script src="http://172.16.7.177:4000/assets/js/scripts.js"></script>


    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-XXXXXXX-2', 'auto');
        ga('send', 'pageview');
    </script>

        <style>
.lightbox {width: 100%; height: 100%; position: fixed; top: 0; left: 0; background: rgba(0,0,0,0.85); z-index: 9999999; line-height: 0; cursor: pointer;}
.lightbox .img {
	position: relative; 
	top: 50%;
	left: 50%;
	-ms-transform: translateX(-50%) translateY(-50%);
	-webkit-transform: translate(-50%,-50%);
	transform: translate(-50%,-50%);
	max-width: 100%;
	max-height: 100%;
}
.lightbox .img img {opacity: 0; pointer-events: none; width: auto;}
@media screen and (min-width: 1200px) {
    .lightbox .img {
		max-width: 1200px;
    }
}
@media screen and (min-height: 1200px) {
    .lightbox img {
		max-height: 1200px;
	}
}
.lightbox span {display: block; position: fixed; bottom: 13px; height: 1.5em; line-height: 1.4em; width: 100%; text-align: center; color: white; text-shadow:
    -1px -1px 0 #000,
    1px -1px 0 #000,
    -1px 1px 0 #000,
    1px 1px 0 #000;  
}






.lightbox .videoWrapperContainer {
	position: relative; 
	top: 50%;
	left: 50%;
	-ms-transform: translateX(-50%) translateY(-50%);
	-webkit-transform: translate(-50%,-50%);
	transform: translate(-50%,-50%);
	max-width: 900px;
	max-height: 100%;
}
.lightbox .videoWrapperContainer .videoWrapper {
	height: 0;
	line-height: 0;
	margin: 0;
	padding: 0;
	position: relative;
	padding-bottom: 56.333%; /* custom */
	background: black;
} 
.lightbox .videoWrapper iframe {
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
	border: 0;
	display: block;
}   
.lightbox #prev, .lightbox #next {height: 50px; line-height: 36px; display: none; margin-top: -25px; position: fixed; top: 50%; padding: 0 15px; cursor: pointer; text-decoration: none; z-index: 99; color: white; font-size: 60px;}
.lightbox.gallery #prev, .lightbox.gallery #next {display: block;}
.lightbox #prev {left: 0;}
.lightbox #next {right: 0;}
.lightbox #close {height: 50px; width: 50px; position: fixed; cursor: pointer; text-decoration: none; z-index: 99; right: 0; top: 0;}
.lightbox #close:after, .lightbox #close:before {position: absolute; margin-top: 22px; margin-left: 14px; content: ""; height: 3px; background: white; width: 23px;
-webkit-transform-origin: 50% 50%;
-moz-transform-origin: 50% 50%;
-o-transform-origin: 50% 50%;
transform-origin: 50% 50%;
/* Safari */
-webkit-transform: rotate(-45deg);
/* Firefox */
-moz-transform: rotate(-45deg);
/* IE */
-ms-transform: rotate(-45deg);
/* Opera */
-o-transform: rotate(-45deg);
}
.lightbox #close:after {
/* Safari */
-webkit-transform: rotate(45deg);
/* Firefox */
-moz-transform: rotate(45deg);
/* IE */
-ms-transform: rotate(45deg);
/* Opera */
-o-transform: rotate(45deg);
}
.lightbox, .lightbox * {
    -webkit-user-select: none;  
    -moz-user-select: none;    
    -ms-user-select: none;      
    user-select: none;
}
</style>
		
<script>
function is_youtubelink(url) {
  var p = /^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/;
  return (url.match(p)) ? RegExp.$1 : false;
}
function is_imagelink(url) {
	var p = /([a-z\-_0-9\/\:\.]*\.(jpg|jpeg|png|gif))/i;
	return (url.match(p)) ? true : false;
}
function is_vimeolink(url,el) {
	var id = false;
	$.ajax({
	  url: 'https://vimeo.com/api/oembed.json?url='+url,
	  async: true,
	  success: function(response) {
		if(response.video_id) {
		  id = response.video_id;
		  $(el).addClass('lightbox-vimeo').attr('data-id',id);
		}
	  }
	});
}

$(document).ready(function() {
	//add classes to links to be able to initiate lightboxes
	$("a").each(function(){
		var url = $(this).attr('href');
		if(url) {
			if(url.indexOf('vimeo') !== -1 && !$(this).hasClass('no-lightbox')) is_vimeolink(url,$(this));
			if(is_youtubelink(url) && !$(this).hasClass('no-lightbox')) $(this).addClass('lightbox-youtube').attr('data-id',is_youtubelink(url));
			if(is_imagelink(url) && !$(this).hasClass('no-lightbox')) {
				$(this).addClass('lightbox-image');
				var href = $(this).attr('href');
				var filename = href.split('/').pop();
				var split = filename.split(".");
				var name = split[0];
				$(this).attr('title',name);
			}
		}
	});
	//remove the clicked lightbox
	$("body").on("click", ".lightbox", function(event){
		if($(this).hasClass('gallery')) {
			$(this).remove();
			if($(event.target).attr('id')=='next') {
				//next item
				if($("a.gallery.current").nextAll("a.gallery:first").length) $("a.gallery.current").nextAll("a.gallery:first").click();
				else $("a.gallery.current").parent().find("a.gallery").first().click();
			}
			else if ($(event.target).attr('id')=='prev') {
				//prev item
				if($("a.gallery.current").prevAll("a.gallery:first").length) $("a.gallery.current").prevAll("a.gallery:first").click();
				else $("a.gallery.current").parent().find("a.gallery").last().click();
			}
			else {
				$("a.gallery").removeClass('gallery');
			}
		}
		else $(this).remove();
	});
	//prevent image from being draggable (for swipe)
	$("body").on('dragstart', ".lightbox img", function(event) { event.preventDefault(); });
	//add the youtube lightbox on click
	$("a.lightbox-youtube").click(function(event){
		event.preventDefault();
		$('<div class="lightbox"><a id="close"></a><a id="next">&rsaquo;</a><a id="prev">&lsaquo;</a><div class="videoWrapperContainer"><div class="videoWrapper"><iframe src="https://www.youtube.com/embed/'+$(this).attr('data-id')+'?autoplay=1&showinfo=0&rel=0"></iframe></div></div></div>').appendTo('body');
	});
	//add the image lightbox on click
	$("a.lightbox-image").click(function(event){
		event.preventDefault();
		$('<div class="lightbox"><a id="close"></a><a id="next">&rsaquo;</a><a id="prev">&lsaquo;</a><div class="img" style="background: url('+$(this).attr('href')+') center center / contain no-repeat;" title="'+$(this).attr('title')+'" ><img src="'+$(this).attr('href')+'" alt="'+$(this).attr('title')+'" /></div><span>'+$(this).attr('title')+'</span></div>').appendTo('body');
	});
	//add the vimeo lightbox on click
	$("body").on("click", "a.lightbox-vimeo", function(event){
		event.preventDefault();
		$('<div class="lightbox"><a id="close"></a><a id="next">&rsaquo;</a><a id="prev">&lsaquo;</a><div class="videoWrapperContainer"><div class="videoWrapper"><iframe src="https://player.vimeo.com/video/'+$(this).attr('data-id')+'/?autoplay=1&byline=0&title=0&portrait=0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div></div></div>').appendTo('body');
	});

	$("body").on("click", "a[class*='lightbox-']", function(){
		var link_elements = $(this).parent().find("a[class*='lightbox-']");
		$(link_elements).removeClass('current');
		for (var i=0; i<link_elements.length; i++) {
			if($(this).attr('href') == $(link_elements[i]).attr('href')) {
				$(link_elements[i]).addClass('current');
			}
		}
		if(link_elements.length>1) {
			$('.lightbox').addClass('gallery');
			$(link_elements).addClass('gallery');
		}
	});

	
});

$(document).keydown(function(e) {
    switch(e.which) {
        case 37: // left
        $("#prev").click();
        break;
        case 39: // right
        $("#next").click();
        break;
	case 27: // esc
        $("#close").click();
        break;
        default: return; // exit this handler for other keys
    }
    e.preventDefault(); // prevent the default action (scroll / move caret)
});

  /*===========================
  Swipe-it v1.4.1
  An event listener for swiping gestures with vanilla js.
  https://github.com/tri613/swipe-it#readme
 
  @Create 2016/09/22
  @Update 2017/08/11
  @Author Trina Lu
  ===========================*/
  "use strict";var _slicedToArray=function(){function n(n,t){var e=[],i=!0,o=!1,r=void 0;try{for(var u,c=n[Symbol.iterator]();!(i=(u=c.next()).done)&&(e.push(u.value),!t||e.length!==t);i=!0);}catch(n){o=!0,r=n}finally{try{!i&&c.return&&c.return()}finally{if(o)throw r}}return e}return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();!function(n,t,e){function i(n){function e(){o("touchstart",m,w),o("touchmove",d,w),o("touchend",p,w),E.mouseEvent&&o("mousedown",s,w)}function i(){y=!1,D=!1,A=!1,b=!1,a=!1}function s(n){a=this,y=n.clientX,D=n.clientY,o("mousemove",l,v),o("mouseup",h,v)}function l(n){n.preventDefault(),y&&D&&(A=n.clientX,b=n.clientY)}function h(n){r("mousemove",l,v),r("mouseup",h,v),p(n)}function m(n){a=this,y=n.touches[0].clientX,D=n.touches[0].clientY}function d(n){A=n.touches[0].clientX,b=n.touches[0].clientY}function p(n){if(y&&D&&A&&b){var t=y-A,e=D-b,o=[t,e].map(Math.abs),r=_slicedToArray(o,2),c=r[0],s=r[1],v=E.minDistance;if(c>v){var f=y<A?"swipeRight":"swipeLeft";u(f,a,{distance:t,start:y,end:A})}if(s>v){var l=D>b?"swipeUp":"swipeDown";u(l,a,{distance:e,start:D,end:b})}(c>v||s>v)&&u("swipe",a)}i()}var E=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},w=c(t.querySelectorAll(n)),y=void 0,D=void 0,A=void 0,b=void 0;E.mouseEvent=void 0===E.mouseEvent?f.mouseEvent:E.mouseEvent,E.minDistance=void 0===E.minDistance?f.minDistance:E.minDistance,i(),e(),this.on=function(n,t){return o(n,t,w),this}}function o(n,t,e){s(e).forEach(function(e){return e.addEventListener(n,t)})}function r(n,t,e){s(e).forEach(function(e){return e.removeEventListener(n,t)})}function u(n,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=t.createEvent("Event");o.initEvent(n,!0,!0),o.swipe=i,s(e).forEach(function(n){return n.dispatchEvent(o)})}function c(n){for(var t=[],e=0;e<n.length;e++)t.push(n[e]);return t}function s(n){return Array.isArray(n)?n:[n]}var a=!1,v=[n],f={mouseEvent:!0,minDistance:30};n[e]=i}(window,document,"SwipeIt");

var mySwipeIt = new SwipeIt('body');
mySwipeIt.on('swipeLeft',function(e){
	//check if lightbox is present
	if($('.lightbox').length >  0 ) {
		$("#next").click();
	}
}).on('swipeRight',function(e){
	//check if lightbox is present
	if($('.lightbox').length >  0 ) {
		$("#prev").click();
	}
});
</script>

    </body>
</html>